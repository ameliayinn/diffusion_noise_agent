git push origin main[Kbash scripts/script[K[K[K[Kript_normal_dif_test.sh 
[?2004l[2025-03-27 03:03:06,445] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-03-27 03:03:09,382] [WARNING] [runner.py:215:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2025-03-27 03:03:09,383] [INFO] [runner.py:607:main] cmd = /hpc2hdd/home/yli045/.conda/envs/ywj/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None main.py --image_size 8 --batch_size 1 --num_epochs 20 --timesteps 100 --lr 2e-4 --time_emb_dim 32 --mu1 4 --sigma1 1 --num1 900 --mu2 10 --sigma2 4 --num2 100 --samples_dir ./samples --checkpoints_dir ./checkpoints --fp16 --mode train --model_path  --num_images 1000 --simulation_distribution normal --use_different_noise --use_moe --num_experts 2 --moe_hidden_dim 2 --moe_tau 0.1
[2025-03-27 03:03:11,572] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-03-27 03:03:13,061] [INFO] [launch.py:146:main] WORLD INFO DICT: {'localhost': [0]}
[2025-03-27 03:03:13,061] [INFO] [launch.py:152:main] nnodes=1, num_local_procs=1, node_rank=0
[2025-03-27 03:03:13,061] [INFO] [launch.py:163:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2025-03-27 03:03:13,061] [INFO] [launch.py:164:main] dist_world_size=1
[2025-03-27 03:03:13,061] [INFO] [launch.py:168:main] Setting CUDA_VISIBLE_DEVICES=0
[2025-03-27 03:03:13,062] [INFO] [launch.py:256:main] process 362516 spawned with command: ['/hpc2hdd/home/yli045/.conda/envs/ywj/bin/python', '-u', 'main.py', '--local_rank=0', '--image_size', '8', '--batch_size', '1', '--num_epochs', '20', '--timesteps', '100', '--lr', '2e-4', '--time_emb_dim', '32', '--mu1', '4', '--sigma1', '1', '--num1', '900', '--mu2', '10', '--sigma2', '4', '--num2', '100', '--samples_dir', './samples', '--checkpoints_dir', './checkpoints', '--fp16', '--mode', 'train', '--model_path', '', '--num_images', '1000', '--simulation_distribution', 'normal', '--use_different_noise', '--use_moe', '--num_experts', '2', '--moe_hidden_dim', '2', '--moe_tau', '0.1']
[2025-03-27 03:03:16,891] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-03-27 03:03:23,062] [INFO] [logging.py:128:log_dist] [Rank -1] DeepSpeed info: version=0.16.4, git-hash=unknown, git-branch=unknown
[2025-03-27 03:03:23,062] [INFO] [comm.py:658:init_distributed] cdb=None
[2025-03-27 03:03:23,062] [INFO] [comm.py:689:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2025-03-27 03:03:23,066] [INFO] [config.py:734:__init__] Config mesh_device None world_size = 1
[rank0]: Traceback (most recent call last):
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/main.py", line 9, in <module>
[rank0]:     train_deepspeed(cfg)
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/train.py", line 100, in train_deepspeed
[rank0]:     model_engine, optimizer, train_loader, _ = deepspeed.initialize(
[rank0]:                                                ^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/deepspeed/__init__.py", line 193, in initialize
[rank0]:     engine = DeepSpeedEngine(args=args,
[rank0]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/deepspeed/runtime/engine.py", line 273, in __init__
[rank0]:     self._configure_distributed_model(model)
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/deepspeed/runtime/engine.py", line 1237, in _configure_distributed_model
[rank0]:     self.module.to(self.device)
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1343, in to
[rank0]:     return self._apply(convert)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 903, in _apply
[rank0]:     module._apply(fn)
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 903, in _apply
[rank0]:     module._apply(fn)
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 903, in _apply
[rank0]:     module._apply(fn)
[rank0]:   [Previous line repeated 1 more time]
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 991, in _apply
[rank0]:     self._buffers[key] = fn(buf)
[rank0]:                          ^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1329, in convert
[rank0]:     return t.to(
[rank0]:            ^^^^^
[rank0]: RuntimeError: CUDA error: out of memory
[rank0]: CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
[rank0]: For debugging consider passing CUDA_LAUNCH_BLOCKING=1
[rank0]: Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

[rank0]:[W327 03:03:25.128338231 ProcessGroupNCCL.cpp:1496] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[2025-03-27 03:03:26,064] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 362516
[2025-03-27 03:03:26,064] [ERROR] [launch.py:325:sigkill_handler] ['/hpc2hdd/home/yli045/.conda/envs/ywj/bin/python', '-u', 'main.py', '--local_rank=0', '--image_size', '8', '--batch_size', '1', '--num_epochs', '20', '--timesteps', '100', '--lr', '2e-4', '--time_emb_dim', '32', '--mu1', '4', '--sigma1', '1', '--num1', '900', '--mu2', '10', '--sigma2', '4', '--num2', '100', '--samples_dir', './samples', '--checkpoints_dir', './checkpoints', '--fp16', '--mode', 'train', '--model_path', '', '--num_images', '1000', '--simulation_distribution', 'normal', '--use_different_noise', '--use_moe', '--num_experts', '2', '--moe_hidden_dim', '2', '--moe_tau', '0.1'] exits with return code = 1
[?2004h(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ export CUDA_VISIBLE_DEVICES=""
[?2004l[?2004h(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ export CUDA_VISIBLE_DEVICES=""bash scripts/script_normal_dif_test.sh 
[?2004l[2025-03-27 03:09:49,175] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-27 03:09:49,207] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-27 03:09:51,843] [WARNING] [runner.py:215:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2025-03-27 03:09:51,844] [INFO] [runner.py:607:main] cmd = /hpc2hdd/home/yli045/.conda/envs/ywj/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None main.py --image_size 8 --batch_size 1 --num_epochs 20 --timesteps 100 --lr 2e-4 --time_emb_dim 32 --mu1 4 --sigma1 1 --num1 900 --mu2 10 --sigma2 4 --num2 100 --samples_dir ./samples --checkpoints_dir ./checkpoints --fp16 --mode train --model_path  --num_images 1000 --simulation_distribution normal --use_different_noise --use_moe --num_experts 2 --moe_hidden_dim 2 --moe_tau 0.1
[2025-03-27 03:09:53,851] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-27 03:09:53,859] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-27 03:09:55,015] [INFO] [launch.py:146:main] WORLD INFO DICT: {'localhost': [0]}
[2025-03-27 03:09:55,015] [INFO] [launch.py:152:main] nnodes=1, num_local_procs=1, node_rank=0
[2025-03-27 03:09:55,015] [INFO] [launch.py:163:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2025-03-27 03:09:55,015] [INFO] [launch.py:164:main] dist_world_size=1
[2025-03-27 03:09:55,015] [INFO] [launch.py:168:main] Setting CUDA_VISIBLE_DEVICES=0
[2025-03-27 03:09:55,016] [INFO] [launch.py:256:main] process 363891 spawned with command: ['/hpc2hdd/home/yli045/.conda/envs/ywj/bin/python', '-u', 'main.py', '--local_rank=0', '--image_size', '8', '--batch_size', '1', '--num_epochs', '20', '--timesteps', '100', '--lr', '2e-4', '--time_emb_dim', '32', '--mu1', '4', '--sigma1', '1', '--num1', '900', '--mu2', '10', '--sigma2', '4', '--num2', '100', '--samples_dir', './samples', '--checkpoints_dir', './checkpoints', '--fp16', '--mode', 'train', '--model_path', '', '--num_images', '1000', '--simulation_distribution', 'normal', '--use_different_noise', '--use_moe', '--num_experts', '2', '--moe_hidden_dim', '2', '--moe_tau', '0.1']
[2025-03-27 03:09:59,251] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-03-27 03:10:05,465] [INFO] [logging.py:128:log_dist] [Rank -1] DeepSpeed info: version=0.16.4, git-hash=unknown, git-branch=unknown
[2025-03-27 03:10:05,466] [INFO] [comm.py:658:init_distributed] cdb=None
[2025-03-27 03:10:05,466] [INFO] [comm.py:689:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2025-03-27 03:10:05,470] [INFO] [config.py:734:__init__] Config mesh_device None world_size = 1
[rank0]: Traceback (most recent call last):
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/main.py", line 9, in <module>
[rank0]:     train_deepspeed(cfg)
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/train.py", line 100, in train_deepspeed
[rank0]:     model_engine, optimizer, train_loader, _ = deepspeed.initialize(
[rank0]:                                                ^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/deepspeed/__init__.py", line 193, in initialize
[rank0]:     engine = DeepSpeedEngine(args=args,
[rank0]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/deepspeed/runtime/engine.py", line 273, in __init__
[rank0]:     self._configure_distributed_model(model)
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/deepspeed/runtime/engine.py", line 1237, in _configure_distributed_model
[rank0]:     self.module.to(self.device)
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1343, in to
[rank0]:     return self._apply(convert)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 903, in _apply
[rank0]:     module._apply(fn)
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 903, in _apply
[rank0]:     module._apply(fn)
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 903, in _apply
[rank0]:     module._apply(fn)
[rank0]:   [Previous line repeated 1 more time]
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 991, in _apply
[rank0]:     self._buffers[key] = fn(buf)
[rank0]:                          ^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1329, in convert
[rank0]:     return t.to(
[rank0]:            ^^^^^
[rank0]: RuntimeError: CUDA error: out of memory
[rank0]: CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
[rank0]: For debugging consider passing CUDA_LAUNCH_BLOCKING=1
[rank0]: Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

[rank0]:[W327 03:10:06.099891591 ProcessGroupNCCL.cpp:1496] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[2025-03-27 03:10:07,018] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 363891
[2025-03-27 03:10:07,019] [ERROR] [launch.py:325:sigkill_handler] ['/hpc2hdd/home/yli045/.conda/envs/ywj/bin/python', '-u', 'main.py', '--local_rank=0', '--image_size', '8', '--batch_size', '1', '--num_epochs', '20', '--timesteps', '100', '--lr', '2e-4', '--time_emb_dim', '32', '--mu1', '4', '--sigma1', '1', '--num1', '900', '--mu2', '10', '--sigma2', '4', '--num2', '100', '--samples_dir', './samples', '--checkpoints_dir', './checkpoints', '--fp16', '--mode', 'train', '--model_path', '', '--num_images', '1000', '--simulation_distribution', 'normal', '--use_different_noise', '--use_moe', '--num_experts', '2', '--moe_hidden_dim', '2', '--moe_tau', '0.1'] exits with return code = 1
[?2004h(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ bash scripts/script_normal_dif_test.sh 
[?2004l[2025-03-27 03:11:45,320] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-27 03:11:45,328] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-27 03:11:47,018] [WARNING] [runner.py:215:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2025-03-27 03:11:47,019] [INFO] [runner.py:607:main] cmd = /hpc2hdd/home/yli045/.conda/envs/ywj/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None main.py --image_size 8 --batch_size 1 --num_epochs 20 --timesteps 100 --lr 2e-4 --time_emb_dim 32 --mu1 4 --sigma1 1 --num1 900 --mu2 10 --sigma2 4 --num2 100 --samples_dir ./samples --checkpoints_dir ./checkpoints --fp16 --mode train --model_path  --num_images 1000 --simulation_distribution normal --use_different_noise --use_moe --num_experts 2 --moe_hidden_dim 2 --moe_tau 0.1
[2025-03-27 03:11:49,115] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-27 03:11:49,123] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-27 03:11:50,319] [INFO] [launch.py:146:main] WORLD INFO DICT: {'localhost': [0]}
[2025-03-27 03:11:50,320] [INFO] [launch.py:152:main] nnodes=1, num_local_procs=1, node_rank=0
[2025-03-27 03:11:50,320] [INFO] [launch.py:163:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2025-03-27 03:11:50,320] [INFO] [launch.py:164:main] dist_world_size=1
[2025-03-27 03:11:50,320] [INFO] [launch.py:168:main] Setting CUDA_VISIBLE_DEVICES=0
[2025-03-27 03:11:50,427] [INFO] [launch.py:256:main] process 364479 spawned with command: ['/hpc2hdd/home/yli045/.conda/envs/ywj/bin/python', '-u', 'main.py', '--local_rank=0', '--image_size', '8', '--batch_size', '1', '--num_epochs', '20', '--timesteps', '100', '--lr', '2e-4', '--time_emb_dim', '32', '--mu1', '4', '--sigma1', '1', '--num1', '900', '--mu2', '10', '--sigma2', '4', '--num2', '100', '--samples_dir', './samples', '--checkpoints_dir', './checkpoints', '--fp16', '--mode', 'train', '--model_path', '', '--num_images', '1000', '--simulation_distribution', 'normal', '--use_different_noise', '--use_moe', '--num_experts', '2', '--moe_hidden_dim', '2', '--moe_tau', '0.1']
[2025-03-27 03:11:54,445] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-03-27 03:11:59,268] [INFO] [logging.py:128:log_dist] [Rank -1] DeepSpeed info: version=0.16.4, git-hash=unknown, git-branch=unknown
[2025-03-27 03:11:59,268] [INFO] [comm.py:658:init_distributed] cdb=None
[2025-03-27 03:11:59,268] [INFO] [comm.py:689:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2025-03-27 03:11:59,271] [INFO] [config.py:734:__init__] Config mesh_device None world_size = 1
[rank0]: Traceback (most recent call last):
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/main.py", line 9, in <module>
[rank0]:     train_deepspeed(cfg)
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/train.py", line 103, in train_deepspeed
[rank0]:     model_engine, optimizer, train_loader, _ = deepspeed.initialize(
[rank0]:                                                ^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/deepspeed/__init__.py", line 193, in initialize
[rank0]:     engine = DeepSpeedEngine(args=args,
[rank0]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/deepspeed/runtime/engine.py", line 273, in __init__
[rank0]:     self._configure_distributed_model(model)
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/deepspeed/runtime/engine.py", line 1237, in _configure_distributed_model
[rank0]:     self.module.to(self.device)
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1343, in to
[rank0]:     return self._apply(convert)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 903, in _apply
[rank0]:     module._apply(fn)
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 903, in _apply
[rank0]:     module._apply(fn)
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 903, in _apply
[rank0]:     module._apply(fn)
[rank0]:   [Previous line repeated 1 more time]
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 991, in _apply
[rank0]:     self._buffers[key] = fn(buf)
[rank0]:                          ^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1329, in convert
[rank0]:     return t.to(
[rank0]:            ^^^^^
[rank0]: RuntimeError: CUDA error: out of memory
[rank0]: CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
[rank0]: For debugging consider passing CUDA_LAUNCH_BLOCKING=1
[rank0]: Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

[rank0]:[W327 03:11:59.817470348 ProcessGroupNCCL.cpp:1496] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[2025-03-27 03:12:01,439] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 364479
[2025-03-27 03:12:01,440] [ERROR] [launch.py:325:sigkill_handler] ['/hpc2hdd/home/yli045/.conda/envs/ywj/bin/python', '-u', 'main.py', '--local_rank=0', '--image_size', '8', '--batch_size', '1', '--num_epochs', '20', '--timesteps', '100', '--lr', '2e-4', '--time_emb_dim', '32', '--mu1', '4', '--sigma1', '1', '--num1', '900', '--mu2', '10', '--sigma2', '4', '--num2', '100', '--samples_dir', './samples', '--checkpoints_dir', './checkpoints', '--fp16', '--mode', 'train', '--model_path', '', '--num_images', '1000', '--simulation_distribution', 'normal', '--use_different_noise', '--use_moe', '--num_experts', '2', '--moe_hidden_dim', '2', '--moe_tau', '0.1'] exits with return code = 1
[?2004h(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ bash scripts/script_normal_dif_test.sh 
[?2004l[2025-03-27 03:13:52,754] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-27 03:13:52,762] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-27 03:13:54,638] [WARNING] [runner.py:215:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2025-03-27 03:13:54,639] [INFO] [runner.py:607:main] cmd = /hpc2hdd/home/yli045/.conda/envs/ywj/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None main.py --image_size 8 --batch_size 1 --num_epochs 20 --timesteps 100 --lr 2e-4 --time_emb_dim 32 --mu1 4 --sigma1 1 --num1 900 --mu2 10 --sigma2 4 --num2 100 --samples_dir ./samples --checkpoints_dir ./checkpoints --fp16 --mode train --model_path  --num_images 1000 --simulation_distribution normal --use_different_noise --use_moe --num_experts 2 --moe_hidden_dim 2 --moe_tau 0.1
[2025-03-27 03:13:56,788] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-27 03:13:56,796] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-27 03:13:57,940] [INFO] [launch.py:146:main] WORLD INFO DICT: {'localhost': [0]}
[2025-03-27 03:13:57,941] [INFO] [launch.py:152:main] nnodes=1, num_local_procs=1, node_rank=0
[2025-03-27 03:13:57,941] [INFO] [launch.py:163:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2025-03-27 03:13:57,941] [INFO] [launch.py:164:main] dist_world_size=1
[2025-03-27 03:13:57,941] [INFO] [launch.py:168:main] Setting CUDA_VISIBLE_DEVICES=0
[2025-03-27 03:13:57,952] [INFO] [launch.py:256:main] process 365036 spawned with command: ['/hpc2hdd/home/yli045/.conda/envs/ywj/bin/python', '-u', 'main.py', '--local_rank=0', '--image_size', '8', '--batch_size', '1', '--num_epochs', '20', '--timesteps', '100', '--lr', '2e-4', '--time_emb_dim', '32', '--mu1', '4', '--sigma1', '1', '--num1', '900', '--mu2', '10', '--sigma2', '4', '--num2', '100', '--samples_dir', './samples', '--checkpoints_dir', './checkpoints', '--fp16', '--mode', 'train', '--model_path', '', '--num_images', '1000', '--simulation_distribution', 'normal', '--use_different_noise', '--use_moe', '--num_experts', '2', '--moe_hidden_dim', '2', '--moe_tau', '0.1']
[2025-03-27 03:14:01,805] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-03-27 03:14:06,673] [INFO] [logging.py:128:log_dist] [Rank -1] DeepSpeed info: version=0.16.4, git-hash=unknown, git-branch=unknown
[2025-03-27 03:14:06,673] [INFO] [comm.py:658:init_distributed] cdb=None
[2025-03-27 03:14:06,674] [INFO] [comm.py:689:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2025-03-27 03:14:06,678] [INFO] [config.py:734:__init__] Config mesh_device None world_size = 1
[rank0]: Traceback (most recent call last):
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/main.py", line 9, in <module>
[rank0]:     train_deepspeed(cfg)
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/train.py", line 103, in train_deepspeed
[rank0]:     model_engine, optimizer, train_loader, _ = deepspeed.initialize(
[rank0]:                                                ^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/deepspeed/__init__.py", line 193, in initialize
[rank0]:     engine = DeepSpeedEngine(args=args,
[rank0]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/deepspeed/runtime/engine.py", line 273, in __init__
[rank0]:     self._configure_distributed_model(model)
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/deepspeed/runtime/engine.py", line 1237, in _configure_distributed_model
[rank0]:     self.module.to(self.device)
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1343, in to
[rank0]:     return self._apply(convert)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 903, in _apply
[rank0]:     module._apply(fn)
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 903, in _apply
[rank0]:     module._apply(fn)
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 903, in _apply
[rank0]:     module._apply(fn)
[rank0]:   [Previous line repeated 1 more time]
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 991, in _apply
[rank0]:     self._buffers[key] = fn(buf)
[rank0]:                          ^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1329, in convert
[rank0]:     return t.to(
[rank0]:            ^^^^^
[rank0]: RuntimeError: CUDA error: out of memory
[rank0]: CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
[rank0]: For debugging consider passing CUDA_LAUNCH_BLOCKING=1
[rank0]: Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

[rank0]:[W327 03:14:07.456922016 ProcessGroupNCCL.cpp:1496] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[2025-03-27 03:14:07,953] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 365036
[2025-03-27 03:14:07,954] [ERROR] [launch.py:325:sigkill_handler] ['/hpc2hdd/home/yli045/.conda/envs/ywj/bin/python', '-u', 'main.py', '--local_rank=0', '--image_size', '8', '--batch_size', '1', '--num_epochs', '20', '--timesteps', '100', '--lr', '2e-4', '--time_emb_dim', '32', '--mu1', '4', '--sigma1', '1', '--num1', '900', '--mu2', '10', '--sigma2', '4', '--num2', '100', '--samples_dir', './samples', '--checkpoints_dir', './checkpoints', '--fp16', '--mode', 'train', '--model_path', '', '--num_images', '1000', '--simulation_distribution', 'normal', '--use_different_noise', '--use_moe', '--num_experts', '2', '--moe_hidden_dim', '2', '--moe_tau', '0.1'] exits with return code = 1
[?2004h(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ cp ../diffusion_noise/generate.py ./
[?2004l[?2004h(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ cp ../diffusion_noise/train.py 
[?2004lcp: missing destination file operand after '../diffusion_noise/train.py'
Try 'cp --help' for more information.
[?2004h(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ cp ../diffusion_noise/train.py ./
[?2004l[?2004h(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ cp ../diffusion_noise/diffusion.py ./
[?2004l[?2004h(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ cp ../diffusion_noise/unet.py ./
[?2004l[?2004h(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ bash scripts/script_normal_dif_test.sh 
[?2004l[2025-03-27 16:47:42,062] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-27 16:47:42,095] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-27 16:47:55,772] [WARNING] [runner.py:215:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2025-03-27 16:47:55,774] [INFO] [runner.py:607:main] cmd = /hpc2hdd/home/yli045/.conda/envs/ywj/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None main.py --image_size 8 --batch_size 1 --num_epochs 20 --timesteps 100 --lr 2e-4 --time_emb_dim 32 --mu1 4 --sigma1 1 --num1 900 --mu2 10 --sigma2 4 --num2 100 --samples_dir ./samples --checkpoints_dir ./checkpoints --fp16 --mode train --model_path  --num_images 1000 --simulation_distribution normal --use_different_noise --use_moe --num_experts 2 --moe_hidden_dim 2 --moe_tau 0.1
[2025-03-27 16:48:30,609] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-27 16:48:30,617] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-27 16:48:32,558] [INFO] [launch.py:146:main] WORLD INFO DICT: {'localhost': [0]}
[2025-03-27 16:48:32,558] [INFO] [launch.py:152:main] nnodes=1, num_local_procs=1, node_rank=0
[2025-03-27 16:48:32,559] [INFO] [launch.py:163:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2025-03-27 16:48:32,559] [INFO] [launch.py:164:main] dist_world_size=1
[2025-03-27 16:48:32,559] [INFO] [launch.py:168:main] Setting CUDA_VISIBLE_DEVICES=0
[2025-03-27 16:48:32,654] [INFO] [launch.py:256:main] process 491856 spawned with command: ['/hpc2hdd/home/yli045/.conda/envs/ywj/bin/python', '-u', 'main.py', '--local_rank=0', '--image_size', '8', '--batch_size', '1', '--num_epochs', '20', '--timesteps', '100', '--lr', '2e-4', '--time_emb_dim', '32', '--mu1', '4', '--sigma1', '1', '--num1', '900', '--mu2', '10', '--sigma2', '4', '--num2', '100', '--samples_dir', './samples', '--checkpoints_dir', './checkpoints', '--fp16', '--mode', 'train', '--model_path', '', '--num_images', '1000', '--simulation_distribution', 'normal', '--use_different_noise', '--use_moe', '--num_experts', '2', '--moe_hidden_dim', '2', '--moe_tau', '0.1']
[2025-03-27 16:49:11,669] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
Traceback (most recent call last):
  File "/hpc2hdd/home/yli045/diffusion_noise_agent/main.py", line 3, in <module>
    from archive.train_2 import train_deepspeed
  File "/hpc2hdd/home/yli045/diffusion_noise_agent/archive/train_2.py", line 9, in <module>
    from archive.diffusion_2 import linear_beta_schedule
ImportError: cannot import name 'linear_beta_schedule' from 'archive.diffusion_2' (/hpc2hdd/home/yli045/diffusion_noise_agent/archive/diffusion_2.py)
[2025-03-27 16:49:14,660] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 491856
[2025-03-27 16:49:14,660] [ERROR] [launch.py:325:sigkill_handler] ['/hpc2hdd/home/yli045/.conda/envs/ywj/bin/python', '-u', 'main.py', '--local_rank=0', '--image_size', '8', '--batch_size', '1', '--num_epochs', '20', '--timesteps', '100', '--lr', '2e-4', '--time_emb_dim', '32', '--mu1', '4', '--sigma1', '1', '--num1', '900', '--mu2', '10', '--sigma2', '4', '--num2', '100', '--samples_dir', './samples', '--checkpoints_dir', './checkpoints', '--fp16', '--mode', 'train', '--model_path', '', '--num_images', '1000', '--simulation_distribution', 'normal', '--use_different_noise', '--use_moe', '--num_experts', '2', '--moe_hidden_dim', '2', '--moe_tau', '0.1'] exits with return code = 1
[?2004h(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ bash scripts/script_normal_dif_test.sh 
[?2004l[2025-03-27 16:50:31,743] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-27 16:50:31,763] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-27 16:50:36,170] [WARNING] [runner.py:215:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2025-03-27 16:50:36,172] [INFO] [runner.py:607:main] cmd = /hpc2hdd/home/yli045/.conda/envs/ywj/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None main.py --image_size 8 --batch_size 1 --num_epochs 20 --timesteps 100 --lr 2e-4 --time_emb_dim 32 --mu1 4 --sigma1 1 --num1 900 --mu2 10 --sigma2 4 --num2 100 --samples_dir ./samples --checkpoints_dir ./checkpoints --fp16 --mode train --model_path  --num_images 1000 --simulation_distribution normal --use_different_noise --use_moe --num_experts 2 --moe_hidden_dim 2 --moe_tau 0.1
[2025-03-27 16:50:47,936] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-27 16:50:47,943] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-27 16:50:49,273] [INFO] [launch.py:146:main] WORLD INFO DICT: {'localhost': [0]}
[2025-03-27 16:50:49,274] [INFO] [launch.py:152:main] nnodes=1, num_local_procs=1, node_rank=0
[2025-03-27 16:50:49,274] [INFO] [launch.py:163:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2025-03-27 16:50:49,274] [INFO] [launch.py:164:main] dist_world_size=1
[2025-03-27 16:50:49,274] [INFO] [launch.py:168:main] Setting CUDA_VISIBLE_DEVICES=0
[2025-03-27 16:50:49,275] [INFO] [launch.py:256:main] process 492493 spawned with command: ['/hpc2hdd/home/yli045/.conda/envs/ywj/bin/python', '-u', 'main.py', '--local_rank=0', '--image_size', '8', '--batch_size', '1', '--num_epochs', '20', '--timesteps', '100', '--lr', '2e-4', '--time_emb_dim', '32', '--mu1', '4', '--sigma1', '1', '--num1', '900', '--mu2', '10', '--sigma2', '4', '--num2', '100', '--samples_dir', './samples', '--checkpoints_dir', './checkpoints', '--fp16', '--mode', 'train', '--model_path', '', '--num_images', '1000', '--simulation_distribution', 'normal', '--use_different_noise', '--use_moe', '--num_experts', '2', '--moe_hidden_dim', '2', '--moe_tau', '0.1']
[2025-03-27 16:50:57,689] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-03-27 16:51:29,270] [INFO] [logging.py:128:log_dist] [Rank -1] DeepSpeed info: version=0.16.4, git-hash=unknown, git-branch=unknown
[2025-03-27 16:51:29,270] [INFO] [comm.py:658:init_distributed] cdb=None
[2025-03-27 16:51:29,270] [INFO] [comm.py:689:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2025-03-27 16:51:29,273] [INFO] [config.py:734:__init__] Config mesh_device None world_size = 1
[2025-03-27 16:51:31,107] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
Using /hpc2hdd/home/yli045/.cache/torch_extensions/py312_cu124 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /hpc2hdd/home/yli045/.cache/torch_extensions/py312_cu124/fused_adam/build.ninja...
/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/utils/cpp_extension.py:2059: UserWarning: TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation. 
If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'].
  warnings.warn(
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 2.594646453857422 seconds
[2025-03-27 16:51:33,710] [INFO] [logging.py:128:log_dist] [Rank 0] Using DeepSpeed Optimizer param name adamw as basic optimizer
[2025-03-27 16:51:33,710] [INFO] [logging.py:128:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2025-03-27 16:51:33,711] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Basic Optimizer = FusedAdam
[2025-03-27 16:51:33,712] [INFO] [utils.py:59:is_zero_supported_optimizer] Checking ZeRO support for optimizer=FusedAdam type=<class 'deepspeed.ops.adam.fused_adam.FusedAdam'>
[2025-03-27 16:51:33,712] [INFO] [logging.py:128:log_dist] [Rank 0] Creating torch.float16 ZeRO stage 2 optimizer
[2025-03-27 16:51:33,712] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 500000000
[2025-03-27 16:51:33,712] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 500000000
[2025-03-27 16:51:33,713] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2025-03-27 16:51:33,713] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2025-03-27 16:51:33,989] [INFO] [utils.py:781:see_memory_usage] Before initializing optimizer states
[2025-03-27 16:51:33,989] [INFO] [utils.py:782:see_memory_usage] MA 0.0 GB         Max_MA 0.0 GB         CA 0.0 GB         Max_CA 0 GB 
[2025-03-27 16:51:33,990] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 207.48 GB, percent = 20.6%
[2025-03-27 16:51:34,105] [INFO] [utils.py:781:see_memory_usage] After initializing optimizer states
[2025-03-27 16:51:34,105] [INFO] [utils.py:782:see_memory_usage] MA 0.0 GB         Max_MA 0.0 GB         CA 0.0 GB         Max_CA 0 GB 
[2025-03-27 16:51:34,105] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 207.5 GB, percent = 20.6%
[2025-03-27 16:51:34,105] [INFO] [stage_1_and_2.py:550:__init__] optimizer state initialized
[2025-03-27 16:51:34,206] [INFO] [utils.py:781:see_memory_usage] After initializing ZeRO optimizer
[2025-03-27 16:51:34,207] [INFO] [utils.py:782:see_memory_usage] MA 0.0 GB         Max_MA 0.0 GB         CA 0.0 GB         Max_CA 0 GB 
[2025-03-27 16:51:34,207] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 207.49 GB, percent = 20.6%
[2025-03-27 16:51:34,208] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Final Optimizer = DeepSpeedZeroOptimizer
[2025-03-27 16:51:34,208] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed using configured LR scheduler = None
[2025-03-27 16:51:34,208] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2025-03-27 16:51:34,208] [INFO] [logging.py:128:log_dist] [Rank 0] step=0, skipped=0, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-27 16:51:34,208] [INFO] [config.py:1001:print] DeepSpeedEngine configuration:
[2025-03-27 16:51:34,209] [INFO] [config.py:1005:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2025-03-27 16:51:34,209] [INFO] [config.py:1005:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'intra_op_parallelism': 1, 'single_submit': False, 'overlap_events': True, 'use_gds': False}
[2025-03-27 16:51:34,209] [INFO] [config.py:1005:print]   amp_enabled .................. False
[2025-03-27 16:51:34,209] [INFO] [config.py:1005:print]   amp_params ................... False
[2025-03-27 16:51:34,209] [INFO] [config.py:1005:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2025-03-27 16:51:34,209] [INFO] [config.py:1005:print]   bfloat16_enabled ............. False
[2025-03-27 16:51:34,209] [INFO] [config.py:1005:print]   bfloat16_immediate_grad_update  False
[2025-03-27 16:51:34,209] [INFO] [config.py:1005:print]   checkpoint_parallel_write_pipeline  False
[2025-03-27 16:51:34,209] [INFO] [config.py:1005:print]   checkpoint_tag_validation_enabled  True
[2025-03-27 16:51:34,209] [INFO] [config.py:1005:print]   checkpoint_tag_validation_fail  False
[2025-03-27 16:51:34,209] [INFO] [config.py:1005:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f98b05624b0>
[2025-03-27 16:51:34,209] [INFO] [config.py:1005:print]   communication_data_type ...... None
[2025-03-27 16:51:34,209] [INFO] [config.py:1005:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2025-03-27 16:51:34,209] [INFO] [config.py:1005:print]   curriculum_enabled_legacy .... False
[2025-03-27 16:51:34,209] [INFO] [config.py:1005:print]   curriculum_params_legacy ..... False
[2025-03-27 16:51:34,209] [INFO] [config.py:1005:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2025-03-27 16:51:34,210] [INFO] [config.py:1005:print]   data_efficiency_enabled ...... False
[2025-03-27 16:51:34,210] [INFO] [config.py:1005:print]   dataloader_drop_last ......... False
[2025-03-27 16:51:34,210] [INFO] [config.py:1005:print]   disable_allgather ............ False
[2025-03-27 16:51:34,210] [INFO] [config.py:1005:print]   dump_state ................... False
[2025-03-27 16:51:34,210] [INFO] [config.py:1005:print]   dynamic_loss_scale_args ...... {'init_scale': 65536, 'scale_window': 1000, 'delayed_shift': 2, 'consecutive_hysteresis': False, 'min_scale': 1}
[2025-03-27 16:51:34,210] [INFO] [config.py:1005:print]   eigenvalue_enabled ........... False
[2025-03-27 16:51:34,210] [INFO] [config.py:1005:print]   eigenvalue_gas_boundary_resolution  1
[2025-03-27 16:51:34,210] [INFO] [config.py:1005:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2025-03-27 16:51:34,210] [INFO] [config.py:1005:print]   eigenvalue_layer_num ......... 0
[2025-03-27 16:51:34,210] [INFO] [config.py:1005:print]   eigenvalue_max_iter .......... 100
[2025-03-27 16:51:34,210] [INFO] [config.py:1005:print]   eigenvalue_stability ......... 1e-06
[2025-03-27 16:51:34,210] [INFO] [config.py:1005:print]   eigenvalue_tol ............... 0.01
[2025-03-27 16:51:34,210] [INFO] [config.py:1005:print]   eigenvalue_verbose ........... False
[2025-03-27 16:51:34,210] [INFO] [config.py:1005:print]   elasticity_enabled ........... False
[2025-03-27 16:51:34,210] [INFO] [config.py:1005:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2025-03-27 16:51:34,210] [INFO] [config.py:1005:print]   fp16_auto_cast ............... False
[2025-03-27 16:51:34,210] [INFO] [config.py:1005:print]   fp16_enabled ................. True
[2025-03-27 16:51:34,210] [INFO] [config.py:1005:print]   fp16_master_weights_and_gradients  False
[2025-03-27 16:51:34,210] [INFO] [config.py:1005:print]   global_rank .................. 0
[2025-03-27 16:51:34,210] [INFO] [config.py:1005:print]   grad_accum_dtype ............. None
[2025-03-27 16:51:34,210] [INFO] [config.py:1005:print]   gradient_accumulation_steps .. 1
[2025-03-27 16:51:34,210] [INFO] [config.py:1005:print]   gradient_clipping ............ 1.0
[2025-03-27 16:51:34,210] [INFO] [config.py:1005:print]   gradient_predivide_factor .... 1.0
[2025-03-27 16:51:34,210] [INFO] [config.py:1005:print]   graph_harvesting ............. False
[2025-03-27 16:51:34,210] [INFO] [config.py:1005:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2025-03-27 16:51:34,211] [INFO] [config.py:1005:print]   initial_dynamic_scale ........ 65536
[2025-03-27 16:51:34,211] [INFO] [config.py:1005:print]   load_universal_checkpoint .... False
[2025-03-27 16:51:34,211] [INFO] [config.py:1005:print]   loss_scale ................... 0
[2025-03-27 16:51:34,211] [INFO] [config.py:1005:print]   memory_breakdown ............. False
[2025-03-27 16:51:34,211] [INFO] [config.py:1005:print]   mics_hierarchial_params_gather  False
[2025-03-27 16:51:34,211] [INFO] [config.py:1005:print]   mics_shard_size .............. -1
[2025-03-27 16:51:34,211] [INFO] [config.py:1005:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') comet=CometConfig(enabled=False, samples_log_interval=100, project=None, workspace=None, api_key=None, experiment_name=None, experiment_key=None, online=None, mode=None) wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName')
[2025-03-27 16:51:34,211] [INFO] [config.py:1005:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2025-03-27 16:51:34,211] [INFO] [config.py:1005:print]   optimizer_legacy_fusion ...... False
[2025-03-27 16:51:34,211] [INFO] [config.py:1005:print]   optimizer_name ............... adamw
[2025-03-27 16:51:34,211] [INFO] [config.py:1005:print]   optimizer_params ............. {'lr': 0.0002, 'weight_decay': 0.01}
[2025-03-27 16:51:34,211] [INFO] [config.py:1005:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2025-03-27 16:51:34,211] [INFO] [config.py:1005:print]   pld_enabled .................. False
[2025-03-27 16:51:34,211] [INFO] [config.py:1005:print]   pld_params ................... False
[2025-03-27 16:51:34,211] [INFO] [config.py:1005:print]   prescale_gradients ........... False
[2025-03-27 16:51:34,211] [INFO] [config.py:1005:print]   scheduler_name ............... None
[2025-03-27 16:51:34,211] [INFO] [config.py:1005:print]   scheduler_params ............. None
[2025-03-27 16:51:34,211] [INFO] [config.py:1005:print]   seq_parallel_communication_data_type  torch.float32
[2025-03-27 16:51:34,211] [INFO] [config.py:1005:print]   sparse_attention ............. None
[2025-03-27 16:51:34,211] [INFO] [config.py:1005:print]   sparse_gradients_enabled ..... False
[2025-03-27 16:51:34,211] [INFO] [config.py:1005:print]   steps_per_print .............. 50
[2025-03-27 16:51:34,211] [INFO] [config.py:1005:print]   tensor_parallel_config ....... dtype=torch.float16 autotp_size=0 tensor_parallel=TPConfig(tp_size=1, tp_grain_size=1, mpu=None, tp_group=None) injection_policy_tuple=None keep_module_on_host=False replace_with_kernel_inject=False
[2025-03-27 16:51:34,211] [INFO] [config.py:1005:print]   timers_config ................ enabled=True synchronized=True
[2025-03-27 16:51:34,211] [INFO] [config.py:1005:print]   train_batch_size ............. 1
[2025-03-27 16:51:34,212] [INFO] [config.py:1005:print]   train_micro_batch_size_per_gpu  1
[2025-03-27 16:51:34,212] [INFO] [config.py:1005:print]   use_data_before_expert_parallel_  False
[2025-03-27 16:51:34,212] [INFO] [config.py:1005:print]   use_node_local_storage ....... False
[2025-03-27 16:51:34,212] [INFO] [config.py:1005:print]   wall_clock_breakdown ......... False
[2025-03-27 16:51:34,212] [INFO] [config.py:1005:print]   weight_quantization_config ... None
[2025-03-27 16:51:34,212] [INFO] [config.py:1005:print]   world_size ................... 1
[2025-03-27 16:51:34,212] [INFO] [config.py:1005:print]   zero_allow_untested_optimizer  False
[2025-03-27 16:51:34,212] [INFO] [config.py:1005:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=500000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50000000 param_persistence_threshold=100000 model_persistence_threshold=9223372036854775807 max_live_parameters=1000000000 max_reuse_distance=1000000000 gather_16bit_weights_on_model_save=False module_granularity_threshold=0 use_all_reduce_for_fetch_params=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False zeropp_loco_param=None mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True log_trace_cache_warnings=False
[2025-03-27 16:51:34,212] [INFO] [config.py:1005:print]   zero_enabled ................. True
[2025-03-27 16:51:34,212] [INFO] [config.py:1005:print]   zero_force_ds_cpu_optimizer .. True
[2025-03-27 16:51:34,212] [INFO] [config.py:1005:print]   zero_optimization_stage ...... 2
[2025-03-27 16:51:34,212] [INFO] [config.py:991:print_user_config]   json = {
    "train_batch_size": 1, 
    "gradient_accumulation_steps": 1, 
    "optimizer": {
        "type": "AdamW", 
        "params": {
            "lr": 0.0002, 
            "weight_decay": 0.01
        }
    }, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "loss_scale_window": 1000
    }, 
    "zero_optimization": {
        "stage": 2, 
        "contiguous_gradients": true, 
        "overlap_comm": true
    }, 
    "steps_per_print": 50, 
    "gradient_clipping": 1.0
}
****START TRAINING****
image_size: 8, batch_size: 1, timesteps: 100, time_emb_dim: 32
  0%|                                                                                                              | 0/111 [00:00<?, ?it/s]  0%|                                                                                                              | 0/111 [00:00<?, ?it/s]
[rank0]: Traceback (most recent call last):
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/main.py", line 9, in <module>
[rank0]:     train_deepspeed(cfg)
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/train.py", line 154, in train_deepspeed
[rank0]:     noisy_images, noise = model.forward_diffusion(
[rank0]:                           ^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]: TypeError: GaussianMoEDiffusion.forward_diffusion() got an unexpected keyword argument 'p'
[rank0]:[W327 16:51:35.991606299 ProcessGroupNCCL.cpp:1496] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[2025-03-27 16:51:36,340] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 492493
[2025-03-27 16:51:36,341] [ERROR] [launch.py:325:sigkill_handler] ['/hpc2hdd/home/yli045/.conda/envs/ywj/bin/python', '-u', 'main.py', '--local_rank=0', '--image_size', '8', '--batch_size', '1', '--num_epochs', '20', '--timesteps', '100', '--lr', '2e-4', '--time_emb_dim', '32', '--mu1', '4', '--sigma1', '1', '--num1', '900', '--mu2', '10', '--sigma2', '4', '--num2', '100', '--samples_dir', './samples', '--checkpoints_dir', './checkpoints', '--fp16', '--mode', 'train', '--model_path', '', '--num_images', '1000', '--simulation_distribution', 'normal', '--use_different_noise', '--use_moe', '--num_experts', '2', '--moe_hidden_dim', '2', '--moe_tau', '0.1'] exits with return code = 1
[?2004h(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ bash scripts/script_normal_dif_test.sh 
[?2004l[2025-03-27 16:52:26,744] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-27 16:52:26,752] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-27 16:52:36,084] [WARNING] [runner.py:215:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2025-03-27 16:52:36,086] [INFO] [runner.py:607:main] cmd = /hpc2hdd/home/yli045/.conda/envs/ywj/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None main.py --image_size 8 --batch_size 1 --num_epochs 20 --timesteps 100 --lr 2e-4 --time_emb_dim 32 --mu1 4 --sigma1 1 --num1 900 --mu2 10 --sigma2 4 --num2 100 --samples_dir ./samples --checkpoints_dir ./checkpoints --fp16 --mode train --model_path  --num_images 1000 --simulation_distribution normal --use_different_noise --use_moe --num_experts 2 --moe_hidden_dim 2 --moe_tau 0.1
[2025-03-27 16:52:44,628] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-27 16:52:44,636] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-27 16:52:47,495] [INFO] [launch.py:146:main] WORLD INFO DICT: {'localhost': [0]}
[2025-03-27 16:52:47,495] [INFO] [launch.py:152:main] nnodes=1, num_local_procs=1, node_rank=0
[2025-03-27 16:52:47,496] [INFO] [launch.py:163:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2025-03-27 16:52:47,496] [INFO] [launch.py:164:main] dist_world_size=1
[2025-03-27 16:52:47,496] [INFO] [launch.py:168:main] Setting CUDA_VISIBLE_DEVICES=0
[2025-03-27 16:52:47,497] [INFO] [launch.py:256:main] process 493215 spawned with command: ['/hpc2hdd/home/yli045/.conda/envs/ywj/bin/python', '-u', 'main.py', '--local_rank=0', '--image_size', '8', '--batch_size', '1', '--num_epochs', '20', '--timesteps', '100', '--lr', '2e-4', '--time_emb_dim', '32', '--mu1', '4', '--sigma1', '1', '--num1', '900', '--mu2', '10', '--sigma2', '4', '--num2', '100', '--samples_dir', './samples', '--checkpoints_dir', './checkpoints', '--fp16', '--mode', 'train', '--model_path', '', '--num_images', '1000', '--simulation_distribution', 'normal', '--use_different_noise', '--use_moe', '--num_experts', '2', '--moe_hidden_dim', '2', '--moe_tau', '0.1']
[2025-03-27 16:52:59,756] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-03-27 16:53:32,471] [INFO] [logging.py:128:log_dist] [Rank -1] DeepSpeed info: version=0.16.4, git-hash=unknown, git-branch=unknown
[2025-03-27 16:53:32,471] [INFO] [comm.py:658:init_distributed] cdb=None
[2025-03-27 16:53:32,471] [INFO] [comm.py:689:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2025-03-27 16:53:32,474] [INFO] [config.py:734:__init__] Config mesh_device None world_size = 1
[2025-03-27 16:53:33,338] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
Using /hpc2hdd/home/yli045/.cache/torch_extensions/py312_cu124 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /hpc2hdd/home/yli045/.cache/torch_extensions/py312_cu124/fused_adam/build.ninja...
/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/utils/cpp_extension.py:2059: UserWarning: TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation. 
If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'].
  warnings.warn(
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 3.250257968902588 seconds
[2025-03-27 16:53:36,593] [INFO] [logging.py:128:log_dist] [Rank 0] Using DeepSpeed Optimizer param name adamw as basic optimizer
[2025-03-27 16:53:36,594] [INFO] [logging.py:128:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2025-03-27 16:53:36,595] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Basic Optimizer = FusedAdam
[2025-03-27 16:53:36,595] [INFO] [utils.py:59:is_zero_supported_optimizer] Checking ZeRO support for optimizer=FusedAdam type=<class 'deepspeed.ops.adam.fused_adam.FusedAdam'>
[2025-03-27 16:53:36,596] [INFO] [logging.py:128:log_dist] [Rank 0] Creating torch.float16 ZeRO stage 2 optimizer
[2025-03-27 16:53:36,596] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 500000000
[2025-03-27 16:53:36,596] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 500000000
[2025-03-27 16:53:36,596] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2025-03-27 16:53:36,596] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2025-03-27 16:53:36,768] [INFO] [utils.py:781:see_memory_usage] Before initializing optimizer states
[2025-03-27 16:53:36,769] [INFO] [utils.py:782:see_memory_usage] MA 0.0 GB         Max_MA 0.0 GB         CA 0.0 GB         Max_CA 0 GB 
[2025-03-27 16:53:36,769] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 206.36 GB, percent = 20.5%
[2025-03-27 16:53:36,968] [INFO] [utils.py:781:see_memory_usage] After initializing optimizer states
[2025-03-27 16:53:36,969] [INFO] [utils.py:782:see_memory_usage] MA 0.0 GB         Max_MA 0.0 GB         CA 0.0 GB         Max_CA 0 GB 
[2025-03-27 16:53:36,969] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 206.45 GB, percent = 20.5%
[2025-03-27 16:53:36,969] [INFO] [stage_1_and_2.py:550:__init__] optimizer state initialized
[2025-03-27 16:53:37,085] [INFO] [utils.py:781:see_memory_usage] After initializing ZeRO optimizer
[2025-03-27 16:53:37,086] [INFO] [utils.py:782:see_memory_usage] MA 0.0 GB         Max_MA 0.0 GB         CA 0.0 GB         Max_CA 0 GB 
[2025-03-27 16:53:37,086] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 206.52 GB, percent = 20.5%
[2025-03-27 16:53:37,087] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Final Optimizer = DeepSpeedZeroOptimizer
[2025-03-27 16:53:37,087] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed using configured LR scheduler = None
[2025-03-27 16:53:37,087] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2025-03-27 16:53:37,087] [INFO] [logging.py:128:log_dist] [Rank 0] step=0, skipped=0, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-27 16:53:37,087] [INFO] [config.py:1001:print] DeepSpeedEngine configuration:
[2025-03-27 16:53:37,088] [INFO] [config.py:1005:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2025-03-27 16:53:37,088] [INFO] [config.py:1005:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'intra_op_parallelism': 1, 'single_submit': False, 'overlap_events': True, 'use_gds': False}
[2025-03-27 16:53:37,088] [INFO] [config.py:1005:print]   amp_enabled .................. False
[2025-03-27 16:53:37,088] [INFO] [config.py:1005:print]   amp_params ................... False
[2025-03-27 16:53:37,088] [INFO] [config.py:1005:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2025-03-27 16:53:37,088] [INFO] [config.py:1005:print]   bfloat16_enabled ............. False
[2025-03-27 16:53:37,088] [INFO] [config.py:1005:print]   bfloat16_immediate_grad_update  False
[2025-03-27 16:53:37,088] [INFO] [config.py:1005:print]   checkpoint_parallel_write_pipeline  False
[2025-03-27 16:53:37,088] [INFO] [config.py:1005:print]   checkpoint_tag_validation_enabled  True
[2025-03-27 16:53:37,088] [INFO] [config.py:1005:print]   checkpoint_tag_validation_fail  False
[2025-03-27 16:53:37,088] [INFO] [config.py:1005:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f36bc2c6180>
[2025-03-27 16:53:37,088] [INFO] [config.py:1005:print]   communication_data_type ...... None
[2025-03-27 16:53:37,088] [INFO] [config.py:1005:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2025-03-27 16:53:37,089] [INFO] [config.py:1005:print]   curriculum_enabled_legacy .... False
[2025-03-27 16:53:37,089] [INFO] [config.py:1005:print]   curriculum_params_legacy ..... False
[2025-03-27 16:53:37,089] [INFO] [config.py:1005:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2025-03-27 16:53:37,089] [INFO] [config.py:1005:print]   data_efficiency_enabled ...... False
[2025-03-27 16:53:37,089] [INFO] [config.py:1005:print]   dataloader_drop_last ......... False
[2025-03-27 16:53:37,089] [INFO] [config.py:1005:print]   disable_allgather ............ False
[2025-03-27 16:53:37,089] [INFO] [config.py:1005:print]   dump_state ................... False
[2025-03-27 16:53:37,089] [INFO] [config.py:1005:print]   dynamic_loss_scale_args ...... {'init_scale': 65536, 'scale_window': 1000, 'delayed_shift': 2, 'consecutive_hysteresis': False, 'min_scale': 1}
[2025-03-27 16:53:37,089] [INFO] [config.py:1005:print]   eigenvalue_enabled ........... False
[2025-03-27 16:53:37,089] [INFO] [config.py:1005:print]   eigenvalue_gas_boundary_resolution  1
[2025-03-27 16:53:37,089] [INFO] [config.py:1005:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2025-03-27 16:53:37,089] [INFO] [config.py:1005:print]   eigenvalue_layer_num ......... 0
[2025-03-27 16:53:37,089] [INFO] [config.py:1005:print]   eigenvalue_max_iter .......... 100
[2025-03-27 16:53:37,089] [INFO] [config.py:1005:print]   eigenvalue_stability ......... 1e-06
[2025-03-27 16:53:37,089] [INFO] [config.py:1005:print]   eigenvalue_tol ............... 0.01
[2025-03-27 16:53:37,089] [INFO] [config.py:1005:print]   eigenvalue_verbose ........... False
[2025-03-27 16:53:37,089] [INFO] [config.py:1005:print]   elasticity_enabled ........... False
[2025-03-27 16:53:37,089] [INFO] [config.py:1005:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2025-03-27 16:53:37,089] [INFO] [config.py:1005:print]   fp16_auto_cast ............... False
[2025-03-27 16:53:37,089] [INFO] [config.py:1005:print]   fp16_enabled ................. True
[2025-03-27 16:53:37,089] [INFO] [config.py:1005:print]   fp16_master_weights_and_gradients  False
[2025-03-27 16:53:37,089] [INFO] [config.py:1005:print]   global_rank .................. 0
[2025-03-27 16:53:37,089] [INFO] [config.py:1005:print]   grad_accum_dtype ............. None
[2025-03-27 16:53:37,089] [INFO] [config.py:1005:print]   gradient_accumulation_steps .. 1
[2025-03-27 16:53:37,089] [INFO] [config.py:1005:print]   gradient_clipping ............ 1.0
[2025-03-27 16:53:37,089] [INFO] [config.py:1005:print]   gradient_predivide_factor .... 1.0
[2025-03-27 16:53:37,090] [INFO] [config.py:1005:print]   graph_harvesting ............. False
[2025-03-27 16:53:37,090] [INFO] [config.py:1005:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2025-03-27 16:53:37,090] [INFO] [config.py:1005:print]   initial_dynamic_scale ........ 65536
[2025-03-27 16:53:37,090] [INFO] [config.py:1005:print]   load_universal_checkpoint .... False
[2025-03-27 16:53:37,090] [INFO] [config.py:1005:print]   loss_scale ................... 0
[2025-03-27 16:53:37,090] [INFO] [config.py:1005:print]   memory_breakdown ............. False
[2025-03-27 16:53:37,090] [INFO] [config.py:1005:print]   mics_hierarchial_params_gather  False
[2025-03-27 16:53:37,090] [INFO] [config.py:1005:print]   mics_shard_size .............. -1
[2025-03-27 16:53:37,090] [INFO] [config.py:1005:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') comet=CometConfig(enabled=False, samples_log_interval=100, project=None, workspace=None, api_key=None, experiment_name=None, experiment_key=None, online=None, mode=None) wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName')
[2025-03-27 16:53:37,090] [INFO] [config.py:1005:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2025-03-27 16:53:37,090] [INFO] [config.py:1005:print]   optimizer_legacy_fusion ...... False
[2025-03-27 16:53:37,090] [INFO] [config.py:1005:print]   optimizer_name ............... adamw
[2025-03-27 16:53:37,090] [INFO] [config.py:1005:print]   optimizer_params ............. {'lr': 0.0002, 'weight_decay': 0.01}
[2025-03-27 16:53:37,090] [INFO] [config.py:1005:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2025-03-27 16:53:37,090] [INFO] [config.py:1005:print]   pld_enabled .................. False
[2025-03-27 16:53:37,090] [INFO] [config.py:1005:print]   pld_params ................... False
[2025-03-27 16:53:37,090] [INFO] [config.py:1005:print]   prescale_gradients ........... False
[2025-03-27 16:53:37,090] [INFO] [config.py:1005:print]   scheduler_name ............... None
[2025-03-27 16:53:37,090] [INFO] [config.py:1005:print]   scheduler_params ............. None
[2025-03-27 16:53:37,090] [INFO] [config.py:1005:print]   seq_parallel_communication_data_type  torch.float32
[2025-03-27 16:53:37,090] [INFO] [config.py:1005:print]   sparse_attention ............. None
[2025-03-27 16:53:37,090] [INFO] [config.py:1005:print]   sparse_gradients_enabled ..... False
[2025-03-27 16:53:37,090] [INFO] [config.py:1005:print]   steps_per_print .............. 50
[2025-03-27 16:53:37,090] [INFO] [config.py:1005:print]   tensor_parallel_config ....... dtype=torch.float16 autotp_size=0 tensor_parallel=TPConfig(tp_size=1, tp_grain_size=1, mpu=None, tp_group=None) injection_policy_tuple=None keep_module_on_host=False replace_with_kernel_inject=False
[2025-03-27 16:53:37,091] [INFO] [config.py:1005:print]   timers_config ................ enabled=True synchronized=True
[2025-03-27 16:53:37,091] [INFO] [config.py:1005:print]   train_batch_size ............. 1
[2025-03-27 16:53:37,091] [INFO] [config.py:1005:print]   train_micro_batch_size_per_gpu  1
[2025-03-27 16:53:37,091] [INFO] [config.py:1005:print]   use_data_before_expert_parallel_  False
[2025-03-27 16:53:37,091] [INFO] [config.py:1005:print]   use_node_local_storage ....... False
[2025-03-27 16:53:37,091] [INFO] [config.py:1005:print]   wall_clock_breakdown ......... False
[2025-03-27 16:53:37,091] [INFO] [config.py:1005:print]   weight_quantization_config ... None
[2025-03-27 16:53:37,091] [INFO] [config.py:1005:print]   world_size ................... 1
[2025-03-27 16:53:37,091] [INFO] [config.py:1005:print]   zero_allow_untested_optimizer  False
[2025-03-27 16:53:37,091] [INFO] [config.py:1005:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=500000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50000000 param_persistence_threshold=100000 model_persistence_threshold=9223372036854775807 max_live_parameters=1000000000 max_reuse_distance=1000000000 gather_16bit_weights_on_model_save=False module_granularity_threshold=0 use_all_reduce_for_fetch_params=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False zeropp_loco_param=None mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True log_trace_cache_warnings=False
[2025-03-27 16:53:37,091] [INFO] [config.py:1005:print]   zero_enabled ................. True
[2025-03-27 16:53:37,091] [INFO] [config.py:1005:print]   zero_force_ds_cpu_optimizer .. True
[2025-03-27 16:53:37,091] [INFO] [config.py:1005:print]   zero_optimization_stage ...... 2
[2025-03-27 16:53:37,091] [INFO] [config.py:991:print_user_config]   json = {
    "train_batch_size": 1, 
    "gradient_accumulation_steps": 1, 
    "optimizer": {
        "type": "AdamW", 
        "params": {
            "lr": 0.0002, 
            "weight_decay": 0.01
        }
    }, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "loss_scale_window": 1000
    }, 
    "zero_optimization": {
        "stage": 2, 
        "contiguous_gradients": true, 
        "overlap_comm": true
    }, 
    "steps_per_print": 50, 
    "gradient_clipping": 1.0
}
****START TRAINING****
image_size: 8, batch_size: 1, timesteps: 100, time_emb_dim: 32
  0%|                                                                                                              | 0/111 [00:00<?, ?it/s]  0%|                                                                                                              | 0/111 [00:00<?, ?it/s]
[rank0]: Traceback (most recent call last):
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/main.py", line 9, in <module>
[rank0]:     train_deepspeed(cfg)
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/train.py", line 154, in train_deepspeed
[rank0]:     noisy_images, noise = model.forward_diffusion(
[rank0]:                           ^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/diffusion.py", line 43, in forward_diffusion
[rank0]:     dynamic_noise = self.noise_moe(x0_flat)  # 重参数化采样后的噪声
[rank0]:                     ^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/reparam_moe.py", line 54, in forward
[rank0]:     assert x.shape[-1] == self.input_dim, f"Input last dim must be {self.input_dim}, got {x.shape[-1]}"
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]: AssertionError: Input last dim must be 192, got 64
[rank0]:[W327 16:53:38.978499058 ProcessGroupNCCL.cpp:1496] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[2025-03-27 16:53:38,543] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 493215
[2025-03-27 16:53:38,544] [ERROR] [launch.py:325:sigkill_handler] ['/hpc2hdd/home/yli045/.conda/envs/ywj/bin/python', '-u', 'main.py', '--local_rank=0', '--image_size', '8', '--batch_size', '1', '--num_epochs', '20', '--timesteps', '100', '--lr', '2e-4', '--time_emb_dim', '32', '--mu1', '4', '--sigma1', '1', '--num1', '900', '--mu2', '10', '--sigma2', '4', '--num2', '100', '--samples_dir', './samples', '--checkpoints_dir', './checkpoints', '--fp16', '--mode', 'train', '--model_path', '', '--num_images', '1000', '--simulation_distribution', 'normal', '--use_different_noise', '--use_moe', '--num_experts', '2', '--moe_hidden_dim', '2', '--moe_tau', '0.1'] exits with return code = 1
[?2004h(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ bash scripts/script_normal_dif_test.sh 
[?2004l[2025-03-27 16:54:51,650] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-27 16:54:51,657] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-27 16:55:00,974] [WARNING] [runner.py:215:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2025-03-27 16:55:00,975] [INFO] [runner.py:607:main] cmd = /hpc2hdd/home/yli045/.conda/envs/ywj/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None main.py --image_size 8 --batch_size 1 --num_epochs 20 --timesteps 100 --lr 2e-4 --time_emb_dim 32 --mu1 4 --sigma1 1 --num1 900 --mu2 10 --sigma2 4 --num2 100 --samples_dir ./samples --checkpoints_dir ./checkpoints --fp16 --mode train --model_path  --num_images 1000 --simulation_distribution normal --use_different_noise --use_moe --num_experts 2 --moe_hidden_dim 2 --moe_tau 0.1
[2025-03-27 16:55:18,083] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-27 16:55:18,092] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-27 16:55:25,144] [INFO] [launch.py:146:main] WORLD INFO DICT: {'localhost': [0]}
[2025-03-27 16:55:25,144] [INFO] [launch.py:152:main] nnodes=1, num_local_procs=1, node_rank=0
[2025-03-27 16:55:25,144] [INFO] [launch.py:163:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2025-03-27 16:55:25,145] [INFO] [launch.py:164:main] dist_world_size=1
[2025-03-27 16:55:25,145] [INFO] [launch.py:168:main] Setting CUDA_VISIBLE_DEVICES=0
[2025-03-27 16:55:25,239] [INFO] [launch.py:256:main] process 493974 spawned with command: ['/hpc2hdd/home/yli045/.conda/envs/ywj/bin/python', '-u', 'main.py', '--local_rank=0', '--image_size', '8', '--batch_size', '1', '--num_epochs', '20', '--timesteps', '100', '--lr', '2e-4', '--time_emb_dim', '32', '--mu1', '4', '--sigma1', '1', '--num1', '900', '--mu2', '10', '--sigma2', '4', '--num2', '100', '--samples_dir', './samples', '--checkpoints_dir', './checkpoints', '--fp16', '--mode', 'train', '--model_path', '', '--num_images', '1000', '--simulation_distribution', 'normal', '--use_different_noise', '--use_moe', '--num_experts', '2', '--moe_hidden_dim', '2', '--moe_tau', '0.1']
[2025-03-27 16:55:36,641] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-03-27 16:55:56,073] [INFO] [logging.py:128:log_dist] [Rank -1] DeepSpeed info: version=0.16.4, git-hash=unknown, git-branch=unknown
[2025-03-27 16:55:56,074] [INFO] [comm.py:658:init_distributed] cdb=None
[2025-03-27 16:55:56,074] [INFO] [comm.py:689:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2025-03-27 16:55:56,080] [INFO] [config.py:734:__init__] Config mesh_device None world_size = 1
[2025-03-27 16:55:57,563] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
Using /hpc2hdd/home/yli045/.cache/torch_extensions/py312_cu124 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /hpc2hdd/home/yli045/.cache/torch_extensions/py312_cu124/fused_adam/build.ninja...
/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/utils/cpp_extension.py:2059: UserWarning: TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation. 
If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'].
  warnings.warn(
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 1.7944839000701904 seconds
[2025-03-27 16:55:59,364] [INFO] [logging.py:128:log_dist] [Rank 0] Using DeepSpeed Optimizer param name adamw as basic optimizer
[2025-03-27 16:55:59,365] [INFO] [logging.py:128:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2025-03-27 16:55:59,366] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Basic Optimizer = FusedAdam
[2025-03-27 16:55:59,366] [INFO] [utils.py:59:is_zero_supported_optimizer] Checking ZeRO support for optimizer=FusedAdam type=<class 'deepspeed.ops.adam.fused_adam.FusedAdam'>
[2025-03-27 16:55:59,367] [INFO] [logging.py:128:log_dist] [Rank 0] Creating torch.float16 ZeRO stage 2 optimizer
[2025-03-27 16:55:59,367] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 500000000
[2025-03-27 16:55:59,367] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 500000000
[2025-03-27 16:55:59,367] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2025-03-27 16:55:59,367] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2025-03-27 16:55:59,671] [INFO] [utils.py:781:see_memory_usage] Before initializing optimizer states
[2025-03-27 16:55:59,672] [INFO] [utils.py:782:see_memory_usage] MA 0.0 GB         Max_MA 0.0 GB         CA 0.0 GB         Max_CA 0 GB 
[2025-03-27 16:55:59,672] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 208.65 GB, percent = 20.7%
[2025-03-27 16:55:59,789] [INFO] [utils.py:781:see_memory_usage] After initializing optimizer states
[2025-03-27 16:55:59,790] [INFO] [utils.py:782:see_memory_usage] MA 0.0 GB         Max_MA 0.0 GB         CA 0.0 GB         Max_CA 0 GB 
[2025-03-27 16:55:59,790] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 208.74 GB, percent = 20.7%
[2025-03-27 16:55:59,790] [INFO] [stage_1_and_2.py:550:__init__] optimizer state initialized
[2025-03-27 16:55:59,902] [INFO] [utils.py:781:see_memory_usage] After initializing ZeRO optimizer
[2025-03-27 16:55:59,902] [INFO] [utils.py:782:see_memory_usage] MA 0.0 GB         Max_MA 0.0 GB         CA 0.0 GB         Max_CA 0 GB 
[2025-03-27 16:55:59,902] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 208.75 GB, percent = 20.7%
[2025-03-27 16:55:59,903] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Final Optimizer = DeepSpeedZeroOptimizer
[2025-03-27 16:55:59,904] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed using configured LR scheduler = None
[2025-03-27 16:55:59,904] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2025-03-27 16:55:59,904] [INFO] [logging.py:128:log_dist] [Rank 0] step=0, skipped=0, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-27 16:55:59,904] [INFO] [config.py:1001:print] DeepSpeedEngine configuration:
[2025-03-27 16:55:59,904] [INFO] [config.py:1005:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2025-03-27 16:55:59,904] [INFO] [config.py:1005:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'intra_op_parallelism': 1, 'single_submit': False, 'overlap_events': True, 'use_gds': False}
[2025-03-27 16:55:59,904] [INFO] [config.py:1005:print]   amp_enabled .................. False
[2025-03-27 16:55:59,904] [INFO] [config.py:1005:print]   amp_params ................... False
[2025-03-27 16:55:59,904] [INFO] [config.py:1005:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2025-03-27 16:55:59,905] [INFO] [config.py:1005:print]   bfloat16_enabled ............. False
[2025-03-27 16:55:59,905] [INFO] [config.py:1005:print]   bfloat16_immediate_grad_update  False
[2025-03-27 16:55:59,905] [INFO] [config.py:1005:print]   checkpoint_parallel_write_pipeline  False
[2025-03-27 16:55:59,905] [INFO] [config.py:1005:print]   checkpoint_tag_validation_enabled  True
[2025-03-27 16:55:59,905] [INFO] [config.py:1005:print]   checkpoint_tag_validation_fail  False
[2025-03-27 16:55:59,905] [INFO] [config.py:1005:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f25654268d0>
[2025-03-27 16:55:59,905] [INFO] [config.py:1005:print]   communication_data_type ...... None
[2025-03-27 16:55:59,905] [INFO] [config.py:1005:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2025-03-27 16:55:59,905] [INFO] [config.py:1005:print]   curriculum_enabled_legacy .... False
[2025-03-27 16:55:59,905] [INFO] [config.py:1005:print]   curriculum_params_legacy ..... False
[2025-03-27 16:55:59,905] [INFO] [config.py:1005:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2025-03-27 16:55:59,905] [INFO] [config.py:1005:print]   data_efficiency_enabled ...... False
[2025-03-27 16:55:59,905] [INFO] [config.py:1005:print]   dataloader_drop_last ......... False
[2025-03-27 16:55:59,905] [INFO] [config.py:1005:print]   disable_allgather ............ False
[2025-03-27 16:55:59,905] [INFO] [config.py:1005:print]   dump_state ................... False
[2025-03-27 16:55:59,905] [INFO] [config.py:1005:print]   dynamic_loss_scale_args ...... {'init_scale': 65536, 'scale_window': 1000, 'delayed_shift': 2, 'consecutive_hysteresis': False, 'min_scale': 1}
[2025-03-27 16:55:59,905] [INFO] [config.py:1005:print]   eigenvalue_enabled ........... False
[2025-03-27 16:55:59,905] [INFO] [config.py:1005:print]   eigenvalue_gas_boundary_resolution  1
[2025-03-27 16:55:59,905] [INFO] [config.py:1005:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2025-03-27 16:55:59,905] [INFO] [config.py:1005:print]   eigenvalue_layer_num ......... 0
[2025-03-27 16:55:59,905] [INFO] [config.py:1005:print]   eigenvalue_max_iter .......... 100
[2025-03-27 16:55:59,905] [INFO] [config.py:1005:print]   eigenvalue_stability ......... 1e-06
[2025-03-27 16:55:59,905] [INFO] [config.py:1005:print]   eigenvalue_tol ............... 0.01
[2025-03-27 16:55:59,905] [INFO] [config.py:1005:print]   eigenvalue_verbose ........... False
[2025-03-27 16:55:59,905] [INFO] [config.py:1005:print]   elasticity_enabled ........... False
[2025-03-27 16:55:59,906] [INFO] [config.py:1005:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2025-03-27 16:55:59,906] [INFO] [config.py:1005:print]   fp16_auto_cast ............... False
[2025-03-27 16:55:59,906] [INFO] [config.py:1005:print]   fp16_enabled ................. True
[2025-03-27 16:55:59,906] [INFO] [config.py:1005:print]   fp16_master_weights_and_gradients  False
[2025-03-27 16:55:59,906] [INFO] [config.py:1005:print]   global_rank .................. 0
[2025-03-27 16:55:59,906] [INFO] [config.py:1005:print]   grad_accum_dtype ............. None
[2025-03-27 16:55:59,906] [INFO] [config.py:1005:print]   gradient_accumulation_steps .. 1
[2025-03-27 16:55:59,906] [INFO] [config.py:1005:print]   gradient_clipping ............ 1.0
[2025-03-27 16:55:59,906] [INFO] [config.py:1005:print]   gradient_predivide_factor .... 1.0
[2025-03-27 16:55:59,906] [INFO] [config.py:1005:print]   graph_harvesting ............. False
[2025-03-27 16:55:59,906] [INFO] [config.py:1005:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2025-03-27 16:55:59,906] [INFO] [config.py:1005:print]   initial_dynamic_scale ........ 65536
[2025-03-27 16:55:59,906] [INFO] [config.py:1005:print]   load_universal_checkpoint .... False
[2025-03-27 16:55:59,906] [INFO] [config.py:1005:print]   loss_scale ................... 0
[2025-03-27 16:55:59,906] [INFO] [config.py:1005:print]   memory_breakdown ............. False
[2025-03-27 16:55:59,906] [INFO] [config.py:1005:print]   mics_hierarchial_params_gather  False
[2025-03-27 16:55:59,906] [INFO] [config.py:1005:print]   mics_shard_size .............. -1
[2025-03-27 16:55:59,906] [INFO] [config.py:1005:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') comet=CometConfig(enabled=False, samples_log_interval=100, project=None, workspace=None, api_key=None, experiment_name=None, experiment_key=None, online=None, mode=None) wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName')
[2025-03-27 16:55:59,906] [INFO] [config.py:1005:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2025-03-27 16:55:59,906] [INFO] [config.py:1005:print]   optimizer_legacy_fusion ...... False
[2025-03-27 16:55:59,906] [INFO] [config.py:1005:print]   optimizer_name ............... adamw
[2025-03-27 16:55:59,906] [INFO] [config.py:1005:print]   optimizer_params ............. {'lr': 0.0002, 'weight_decay': 0.01}
[2025-03-27 16:55:59,906] [INFO] [config.py:1005:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2025-03-27 16:55:59,906] [INFO] [config.py:1005:print]   pld_enabled .................. False
[2025-03-27 16:55:59,907] [INFO] [config.py:1005:print]   pld_params ................... False
[2025-03-27 16:55:59,907] [INFO] [config.py:1005:print]   prescale_gradients ........... False
[2025-03-27 16:55:59,907] [INFO] [config.py:1005:print]   scheduler_name ............... None
[2025-03-27 16:55:59,907] [INFO] [config.py:1005:print]   scheduler_params ............. None
[2025-03-27 16:55:59,907] [INFO] [config.py:1005:print]   seq_parallel_communication_data_type  torch.float32
[2025-03-27 16:55:59,907] [INFO] [config.py:1005:print]   sparse_attention ............. None
[2025-03-27 16:55:59,907] [INFO] [config.py:1005:print]   sparse_gradients_enabled ..... False
[2025-03-27 16:55:59,907] [INFO] [config.py:1005:print]   steps_per_print .............. 50
[2025-03-27 16:55:59,907] [INFO] [config.py:1005:print]   tensor_parallel_config ....... dtype=torch.float16 autotp_size=0 tensor_parallel=TPConfig(tp_size=1, tp_grain_size=1, mpu=None, tp_group=None) injection_policy_tuple=None keep_module_on_host=False replace_with_kernel_inject=False
[2025-03-27 16:55:59,907] [INFO] [config.py:1005:print]   timers_config ................ enabled=True synchronized=True
[2025-03-27 16:55:59,907] [INFO] [config.py:1005:print]   train_batch_size ............. 1
[2025-03-27 16:55:59,907] [INFO] [config.py:1005:print]   train_micro_batch_size_per_gpu  1
[2025-03-27 16:55:59,907] [INFO] [config.py:1005:print]   use_data_before_expert_parallel_  False
[2025-03-27 16:55:59,907] [INFO] [config.py:1005:print]   use_node_local_storage ....... False
[2025-03-27 16:55:59,907] [INFO] [config.py:1005:print]   wall_clock_breakdown ......... False
[2025-03-27 16:55:59,907] [INFO] [config.py:1005:print]   weight_quantization_config ... None
[2025-03-27 16:55:59,907] [INFO] [config.py:1005:print]   world_size ................... 1
[2025-03-27 16:55:59,907] [INFO] [config.py:1005:print]   zero_allow_untested_optimizer  False
[2025-03-27 16:55:59,907] [INFO] [config.py:1005:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=500000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50000000 param_persistence_threshold=100000 model_persistence_threshold=9223372036854775807 max_live_parameters=1000000000 max_reuse_distance=1000000000 gather_16bit_weights_on_model_save=False module_granularity_threshold=0 use_all_reduce_for_fetch_params=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False zeropp_loco_param=None mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True log_trace_cache_warnings=False
[2025-03-27 16:55:59,907] [INFO] [config.py:1005:print]   zero_enabled ................. True
[2025-03-27 16:55:59,907] [INFO] [config.py:1005:print]   zero_force_ds_cpu_optimizer .. True
[2025-03-27 16:55:59,907] [INFO] [config.py:1005:print]   zero_optimization_stage ...... 2
[2025-03-27 16:55:59,907] [INFO] [config.py:991:print_user_config]   json = {
    "train_batch_size": 1, 
    "gradient_accumulation_steps": 1, 
    "optimizer": {
        "type": "AdamW", 
        "params": {
            "lr": 0.0002, 
            "weight_decay": 0.01
        }
    }, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "loss_scale_window": 1000
    }, 
    "zero_optimization": {
        "stage": 2, 
        "contiguous_gradients": true, 
        "overlap_comm": true
    }, 
    "steps_per_print": 50, 
    "gradient_clipping": 1.0
}
****START TRAINING****
image_size: 8, batch_size: 1, timesteps: 100, time_emb_dim: 32
  0%|                                                                                                              | 0/111 [00:00<?, ?it/s]  0%|                                                                                                              | 0/111 [00:00<?, ?it/s]
[rank0]: Traceback (most recent call last):
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/main.py", line 9, in <module>
[rank0]:     train_deepspeed(cfg)
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/train.py", line 161, in train_deepspeed
[rank0]:     pred_noise = model_engine(noisy_images, t)
[rank0]:                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/deepspeed/utils/nvtx.py", line 18, in wrapped_fn
[rank0]:     ret_val = func(*args, **kwargs)
[rank0]:               ^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/deepspeed/runtime/engine.py", line 1987, in forward
[rank0]:     loss = self.module(*inputs, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 397, in _forward_unimplemented
[rank0]:     raise NotImplementedError(
[rank0]: NotImplementedError: Module [GaussianMoEDiffusion] is missing the required "forward" function
[rank0]:[W327 16:56:02.908073075 ProcessGroupNCCL.cpp:1496] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[2025-03-27 16:56:04,245] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 493974
[2025-03-27 16:56:04,245] [ERROR] [launch.py:325:sigkill_handler] ['/hpc2hdd/home/yli045/.conda/envs/ywj/bin/python', '-u', 'main.py', '--local_rank=0', '--image_size', '8', '--batch_size', '1', '--num_epochs', '20', '--timesteps', '100', '--lr', '2e-4', '--time_emb_dim', '32', '--mu1', '4', '--sigma1', '1', '--num1', '900', '--mu2', '10', '--sigma2', '4', '--num2', '100', '--samples_dir', './samples', '--checkpoints_dir', './checkpoints', '--fp16', '--mode', 'train', '--model_path', '', '--num_images', '1000', '--simulation_distribution', 'normal', '--use_different_noise', '--use_moe', '--num_experts', '2', '--moe_hidden_dim', '2', '--moe_tau', '0.1'] exits with return code = 1
[?2004h(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ bash scripts/script_normal_dif_test.sh 
[?2004l[2025-03-27 17:04:58,314] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-27 17:04:58,322] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-27 17:05:02,044] [WARNING] [runner.py:215:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2025-03-27 17:05:02,046] [INFO] [runner.py:607:main] cmd = /hpc2hdd/home/yli045/.conda/envs/ywj/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None main.py --image_size 8 --batch_size 1 --num_epochs 20 --timesteps 100 --lr 2e-4 --time_emb_dim 32 --mu1 4 --sigma1 1 --num1 900 --mu2 10 --sigma2 4 --num2 100 --samples_dir ./samples --checkpoints_dir ./checkpoints --fp16 --mode train --model_path  --num_images 1000 --simulation_distribution normal --use_different_noise --use_moe --num_experts 2 --moe_hidden_dim 2 --moe_tau 0.1
[2025-03-27 17:05:13,473] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-27 17:05:13,481] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-27 17:05:18,995] [INFO] [launch.py:146:main] WORLD INFO DICT: {'localhost': [0]}
[2025-03-27 17:05:18,996] [INFO] [launch.py:152:main] nnodes=1, num_local_procs=1, node_rank=0
[2025-03-27 17:05:18,996] [INFO] [launch.py:163:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2025-03-27 17:05:18,996] [INFO] [launch.py:164:main] dist_world_size=1
[2025-03-27 17:05:18,996] [INFO] [launch.py:168:main] Setting CUDA_VISIBLE_DEVICES=0
[2025-03-27 17:05:19,122] [INFO] [launch.py:256:main] process 495951 spawned with command: ['/hpc2hdd/home/yli045/.conda/envs/ywj/bin/python', '-u', 'main.py', '--local_rank=0', '--image_size', '8', '--batch_size', '1', '--num_epochs', '20', '--timesteps', '100', '--lr', '2e-4', '--time_emb_dim', '32', '--mu1', '4', '--sigma1', '1', '--num1', '900', '--mu2', '10', '--sigma2', '4', '--num2', '100', '--samples_dir', './samples', '--checkpoints_dir', './checkpoints', '--fp16', '--mode', 'train', '--model_path', '', '--num_images', '1000', '--simulation_distribution', 'normal', '--use_different_noise', '--use_moe', '--num_experts', '2', '--moe_hidden_dim', '2', '--moe_tau', '0.1']
[2025-03-27 17:05:31,972] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
Traceback (most recent call last):
  File "/hpc2hdd/home/yli045/diffusion_noise_agent/main.py", line 9, in <module>
    train_deepspeed(cfg)
  File "/hpc2hdd/home/yli045/diffusion_noise_agent/train.py", line 54, in train_deepspeed
    model = GaussianMoEDiffusion(config.image_size, num_experts=4)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/hpc2hdd/home/yli045/diffusion_noise_agent/moe_diffusion.py", line 24, in __init__
    self.denoise_model = UNet(image_size=image_size)
                         ^^^^
NameError: name 'UNet' is not defined
[2025-03-27 17:05:50,126] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 495951
[2025-03-27 17:05:50,127] [ERROR] [launch.py:325:sigkill_handler] ['/hpc2hdd/home/yli045/.conda/envs/ywj/bin/python', '-u', 'main.py', '--local_rank=0', '--image_size', '8', '--batch_size', '1', '--num_epochs', '20', '--timesteps', '100', '--lr', '2e-4', '--time_emb_dim', '32', '--mu1', '4', '--sigma1', '1', '--num1', '900', '--mu2', '10', '--sigma2', '4', '--num2', '100', '--samples_dir', './samples', '--checkpoints_dir', './checkpoints', '--fp16', '--mode', 'train', '--model_path', '', '--num_images', '1000', '--simulation_distribution', 'normal', '--use_different_noise', '--use_moe', '--num_experts', '2', '--moe_hidden_dim', '2', '--moe_tau', '0.1'] exits with return code = 1
[?2004h(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ bash scripts/script_normal_dif_test.sh 
[?2004l[2025-03-27 17:06:48,892] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-27 17:06:48,900] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-27 17:06:52,431] [WARNING] [runner.py:215:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2025-03-27 17:06:52,433] [INFO] [runner.py:607:main] cmd = /hpc2hdd/home/yli045/.conda/envs/ywj/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None main.py --image_size 8 --batch_size 1 --num_epochs 20 --timesteps 100 --lr 2e-4 --time_emb_dim 32 --mu1 4 --sigma1 1 --num1 900 --mu2 10 --sigma2 4 --num2 100 --samples_dir ./samples --checkpoints_dir ./checkpoints --fp16 --mode train --model_path  --num_images 1000 --simulation_distribution normal --use_different_noise --use_moe --num_experts 2 --moe_hidden_dim 2 --moe_tau 0.1
[2025-03-27 17:07:02,439] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-27 17:07:02,448] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-27 17:07:06,004] [INFO] [launch.py:146:main] WORLD INFO DICT: {'localhost': [0]}
[2025-03-27 17:07:06,005] [INFO] [launch.py:152:main] nnodes=1, num_local_procs=1, node_rank=0
[2025-03-27 17:07:06,005] [INFO] [launch.py:163:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2025-03-27 17:07:06,005] [INFO] [launch.py:164:main] dist_world_size=1
[2025-03-27 17:07:06,005] [INFO] [launch.py:168:main] Setting CUDA_VISIBLE_DEVICES=0
[2025-03-27 17:07:06,143] [INFO] [launch.py:256:main] process 496489 spawned with command: ['/hpc2hdd/home/yli045/.conda/envs/ywj/bin/python', '-u', 'main.py', '--local_rank=0', '--image_size', '8', '--batch_size', '1', '--num_epochs', '20', '--timesteps', '100', '--lr', '2e-4', '--time_emb_dim', '32', '--mu1', '4', '--sigma1', '1', '--num1', '900', '--mu2', '10', '--sigma2', '4', '--num2', '100', '--samples_dir', './samples', '--checkpoints_dir', './checkpoints', '--fp16', '--mode', 'train', '--model_path', '', '--num_images', '1000', '--simulation_distribution', 'normal', '--use_different_noise', '--use_moe', '--num_experts', '2', '--moe_hidden_dim', '2', '--moe_tau', '0.1']
[2025-03-27 17:07:20,275] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-03-27 17:07:52,379] [INFO] [logging.py:128:log_dist] [Rank -1] DeepSpeed info: version=0.16.4, git-hash=unknown, git-branch=unknown
[2025-03-27 17:07:52,379] [INFO] [comm.py:658:init_distributed] cdb=None
[2025-03-27 17:07:52,379] [INFO] [comm.py:689:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2025-03-27 17:07:52,384] [INFO] [config.py:734:__init__] Config mesh_device None world_size = 1
[2025-03-27 17:07:55,635] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
Using /hpc2hdd/home/yli045/.cache/torch_extensions/py312_cu124 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /hpc2hdd/home/yli045/.cache/torch_extensions/py312_cu124/fused_adam/build.ninja...
/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/utils/cpp_extension.py:2059: UserWarning: TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation. 
If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'].
  warnings.warn(
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 0.20952987670898438 seconds
[2025-03-27 17:07:55,850] [INFO] [logging.py:128:log_dist] [Rank 0] Using DeepSpeed Optimizer param name adamw as basic optimizer
[2025-03-27 17:07:55,850] [INFO] [logging.py:128:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2025-03-27 17:07:55,854] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Basic Optimizer = FusedAdam
[2025-03-27 17:07:55,854] [INFO] [utils.py:59:is_zero_supported_optimizer] Checking ZeRO support for optimizer=FusedAdam type=<class 'deepspeed.ops.adam.fused_adam.FusedAdam'>
[2025-03-27 17:07:55,855] [INFO] [logging.py:128:log_dist] [Rank 0] Creating torch.float16 ZeRO stage 2 optimizer
[2025-03-27 17:07:55,855] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 500000000
[2025-03-27 17:07:55,855] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 500000000
[2025-03-27 17:07:55,855] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2025-03-27 17:07:55,855] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2025-03-27 17:07:56,295] [INFO] [utils.py:781:see_memory_usage] Before initializing optimizer states
[2025-03-27 17:07:56,296] [INFO] [utils.py:782:see_memory_usage] MA 0.0 GB         Max_MA 0.0 GB         CA 0.02 GB         Max_CA 0 GB 
[2025-03-27 17:07:56,296] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 207.53 GB, percent = 20.6%
[2025-03-27 17:07:56,414] [INFO] [utils.py:781:see_memory_usage] After initializing optimizer states
[2025-03-27 17:07:56,414] [INFO] [utils.py:782:see_memory_usage] MA 0.0 GB         Max_MA 0.0 GB         CA 0.02 GB         Max_CA 0 GB 
[2025-03-27 17:07:56,414] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 207.74 GB, percent = 20.6%
[2025-03-27 17:07:56,414] [INFO] [stage_1_and_2.py:550:__init__] optimizer state initialized
[2025-03-27 17:07:56,536] [INFO] [utils.py:781:see_memory_usage] After initializing ZeRO optimizer
[2025-03-27 17:07:56,537] [INFO] [utils.py:782:see_memory_usage] MA 0.0 GB         Max_MA 0.0 GB         CA 0.02 GB         Max_CA 0 GB 
[2025-03-27 17:07:56,537] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 207.83 GB, percent = 20.6%
[2025-03-27 17:07:56,539] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Final Optimizer = DeepSpeedZeroOptimizer
[2025-03-27 17:07:56,539] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed using configured LR scheduler = None
[2025-03-27 17:07:56,539] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2025-03-27 17:07:56,539] [INFO] [logging.py:128:log_dist] [Rank 0] step=0, skipped=0, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-27 17:07:56,540] [INFO] [config.py:1001:print] DeepSpeedEngine configuration:
[2025-03-27 17:07:56,540] [INFO] [config.py:1005:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2025-03-27 17:07:56,540] [INFO] [config.py:1005:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'intra_op_parallelism': 1, 'single_submit': False, 'overlap_events': True, 'use_gds': False}
[2025-03-27 17:07:56,540] [INFO] [config.py:1005:print]   amp_enabled .................. False
[2025-03-27 17:07:56,540] [INFO] [config.py:1005:print]   amp_params ................... False
[2025-03-27 17:07:56,540] [INFO] [config.py:1005:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2025-03-27 17:07:56,540] [INFO] [config.py:1005:print]   bfloat16_enabled ............. False
[2025-03-27 17:07:56,540] [INFO] [config.py:1005:print]   bfloat16_immediate_grad_update  False
[2025-03-27 17:07:56,540] [INFO] [config.py:1005:print]   checkpoint_parallel_write_pipeline  False
[2025-03-27 17:07:56,541] [INFO] [config.py:1005:print]   checkpoint_tag_validation_enabled  True
[2025-03-27 17:07:56,541] [INFO] [config.py:1005:print]   checkpoint_tag_validation_fail  False
[2025-03-27 17:07:56,541] [INFO] [config.py:1005:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f3f605b3e60>
[2025-03-27 17:07:56,541] [INFO] [config.py:1005:print]   communication_data_type ...... None
[2025-03-27 17:07:56,541] [INFO] [config.py:1005:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2025-03-27 17:07:56,541] [INFO] [config.py:1005:print]   curriculum_enabled_legacy .... False
[2025-03-27 17:07:56,541] [INFO] [config.py:1005:print]   curriculum_params_legacy ..... False
[2025-03-27 17:07:56,541] [INFO] [config.py:1005:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2025-03-27 17:07:56,541] [INFO] [config.py:1005:print]   data_efficiency_enabled ...... False
[2025-03-27 17:07:56,541] [INFO] [config.py:1005:print]   dataloader_drop_last ......... False
[2025-03-27 17:07:56,541] [INFO] [config.py:1005:print]   disable_allgather ............ False
[2025-03-27 17:07:56,541] [INFO] [config.py:1005:print]   dump_state ................... False
[2025-03-27 17:07:56,541] [INFO] [config.py:1005:print]   dynamic_loss_scale_args ...... {'init_scale': 65536, 'scale_window': 1000, 'delayed_shift': 2, 'consecutive_hysteresis': False, 'min_scale': 1}
[2025-03-27 17:07:56,541] [INFO] [config.py:1005:print]   eigenvalue_enabled ........... False
[2025-03-27 17:07:56,541] [INFO] [config.py:1005:print]   eigenvalue_gas_boundary_resolution  1
[2025-03-27 17:07:56,541] [INFO] [config.py:1005:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2025-03-27 17:07:56,541] [INFO] [config.py:1005:print]   eigenvalue_layer_num ......... 0
[2025-03-27 17:07:56,541] [INFO] [config.py:1005:print]   eigenvalue_max_iter .......... 100
[2025-03-27 17:07:56,541] [INFO] [config.py:1005:print]   eigenvalue_stability ......... 1e-06
[2025-03-27 17:07:56,541] [INFO] [config.py:1005:print]   eigenvalue_tol ............... 0.01
[2025-03-27 17:07:56,541] [INFO] [config.py:1005:print]   eigenvalue_verbose ........... False
[2025-03-27 17:07:56,541] [INFO] [config.py:1005:print]   elasticity_enabled ........... False
[2025-03-27 17:07:56,541] [INFO] [config.py:1005:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2025-03-27 17:07:56,541] [INFO] [config.py:1005:print]   fp16_auto_cast ............... False
[2025-03-27 17:07:56,542] [INFO] [config.py:1005:print]   fp16_enabled ................. True
[2025-03-27 17:07:56,542] [INFO] [config.py:1005:print]   fp16_master_weights_and_gradients  False
[2025-03-27 17:07:56,542] [INFO] [config.py:1005:print]   global_rank .................. 0
[2025-03-27 17:07:56,542] [INFO] [config.py:1005:print]   grad_accum_dtype ............. None
[2025-03-27 17:07:56,542] [INFO] [config.py:1005:print]   gradient_accumulation_steps .. 1
[2025-03-27 17:07:56,542] [INFO] [config.py:1005:print]   gradient_clipping ............ 1.0
[2025-03-27 17:07:56,542] [INFO] [config.py:1005:print]   gradient_predivide_factor .... 1.0
[2025-03-27 17:07:56,542] [INFO] [config.py:1005:print]   graph_harvesting ............. False
[2025-03-27 17:07:56,542] [INFO] [config.py:1005:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2025-03-27 17:07:56,542] [INFO] [config.py:1005:print]   initial_dynamic_scale ........ 65536
[2025-03-27 17:07:56,542] [INFO] [config.py:1005:print]   load_universal_checkpoint .... False
[2025-03-27 17:07:56,542] [INFO] [config.py:1005:print]   loss_scale ................... 0
[2025-03-27 17:07:56,542] [INFO] [config.py:1005:print]   memory_breakdown ............. False
[2025-03-27 17:07:56,542] [INFO] [config.py:1005:print]   mics_hierarchial_params_gather  False
[2025-03-27 17:07:56,542] [INFO] [config.py:1005:print]   mics_shard_size .............. -1
[2025-03-27 17:07:56,542] [INFO] [config.py:1005:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') comet=CometConfig(enabled=False, samples_log_interval=100, project=None, workspace=None, api_key=None, experiment_name=None, experiment_key=None, online=None, mode=None) wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName')
[2025-03-27 17:07:56,542] [INFO] [config.py:1005:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2025-03-27 17:07:56,542] [INFO] [config.py:1005:print]   optimizer_legacy_fusion ...... False
[2025-03-27 17:07:56,542] [INFO] [config.py:1005:print]   optimizer_name ............... adamw
[2025-03-27 17:07:56,542] [INFO] [config.py:1005:print]   optimizer_params ............. {'lr': 0.0002, 'weight_decay': 0.01}
[2025-03-27 17:07:56,542] [INFO] [config.py:1005:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2025-03-27 17:07:56,542] [INFO] [config.py:1005:print]   pld_enabled .................. False
[2025-03-27 17:07:56,542] [INFO] [config.py:1005:print]   pld_params ................... False
[2025-03-27 17:07:56,542] [INFO] [config.py:1005:print]   prescale_gradients ........... False
[2025-03-27 17:07:56,543] [INFO] [config.py:1005:print]   scheduler_name ............... None
[2025-03-27 17:07:56,543] [INFO] [config.py:1005:print]   scheduler_params ............. None
[2025-03-27 17:07:56,543] [INFO] [config.py:1005:print]   seq_parallel_communication_data_type  torch.float32
[2025-03-27 17:07:56,543] [INFO] [config.py:1005:print]   sparse_attention ............. None
[2025-03-27 17:07:56,543] [INFO] [config.py:1005:print]   sparse_gradients_enabled ..... False
[2025-03-27 17:07:56,543] [INFO] [config.py:1005:print]   steps_per_print .............. 50
[2025-03-27 17:07:56,543] [INFO] [config.py:1005:print]   tensor_parallel_config ....... dtype=torch.float16 autotp_size=0 tensor_parallel=TPConfig(tp_size=1, tp_grain_size=1, mpu=None, tp_group=None) injection_policy_tuple=None keep_module_on_host=False replace_with_kernel_inject=False
[2025-03-27 17:07:56,543] [INFO] [config.py:1005:print]   timers_config ................ enabled=True synchronized=True
[2025-03-27 17:07:56,543] [INFO] [config.py:1005:print]   train_batch_size ............. 1
[2025-03-27 17:07:56,543] [INFO] [config.py:1005:print]   train_micro_batch_size_per_gpu  1
[2025-03-27 17:07:56,543] [INFO] [config.py:1005:print]   use_data_before_expert_parallel_  False
[2025-03-27 17:07:56,543] [INFO] [config.py:1005:print]   use_node_local_storage ....... False
[2025-03-27 17:07:56,543] [INFO] [config.py:1005:print]   wall_clock_breakdown ......... False
[2025-03-27 17:07:56,543] [INFO] [config.py:1005:print]   weight_quantization_config ... None
[2025-03-27 17:07:56,543] [INFO] [config.py:1005:print]   world_size ................... 1
[2025-03-27 17:07:56,543] [INFO] [config.py:1005:print]   zero_allow_untested_optimizer  False
[2025-03-27 17:07:56,543] [INFO] [config.py:1005:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=500000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50000000 param_persistence_threshold=100000 model_persistence_threshold=9223372036854775807 max_live_parameters=1000000000 max_reuse_distance=1000000000 gather_16bit_weights_on_model_save=False module_granularity_threshold=0 use_all_reduce_for_fetch_params=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False zeropp_loco_param=None mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True log_trace_cache_warnings=False
[2025-03-27 17:07:56,543] [INFO] [config.py:1005:print]   zero_enabled ................. True
[2025-03-27 17:07:56,543] [INFO] [config.py:1005:print]   zero_force_ds_cpu_optimizer .. True
[2025-03-27 17:07:56,543] [INFO] [config.py:1005:print]   zero_optimization_stage ...... 2
[2025-03-27 17:07:56,543] [INFO] [config.py:991:print_user_config]   json = {
    "train_batch_size": 1, 
    "gradient_accumulation_steps": 1, 
    "optimizer": {
        "type": "AdamW", 
        "params": {
            "lr": 0.0002, 
            "weight_decay": 0.01
        }
    }, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "loss_scale_window": 1000
    }, 
    "zero_optimization": {
        "stage": 2, 
        "contiguous_gradients": true, 
        "overlap_comm": true
    }, 
    "steps_per_print": 50, 
    "gradient_clipping": 1.0
}
****START TRAINING****
image_size: 8, batch_size: 1, timesteps: 100, time_emb_dim: 32
  0%|                                                                                                              | 0/111 [00:00<?, ?it/s]  0%|                                                                                                              | 0/111 [00:00<?, ?it/s]
[rank0]: Traceback (most recent call last):
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/main.py", line 9, in <module>
[rank0]:     train_deepspeed(cfg)
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/train.py", line 155, in train_deepspeed
[rank0]:     noisy_images, noise = model.forward_diffusion(
[rank0]:                           ^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/moe_diffusion.py", line 49, in forward_diffusion
[rank0]:     dynamic_noise = self.noise_moe(moe_input).view(B, C, H, W)
[rank0]:                     ^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/reparam_moe.py", line 54, in forward
[rank0]:     assert x.shape[-1] == self.input_dim, f"Input last dim must be {self.input_dim}, got {x.shape[-1]}"
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]: AssertionError: Input last dim must be 192, got 64
[rank0]:[W327 17:07:58.074638867 ProcessGroupNCCL.cpp:1496] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[2025-03-27 17:07:59,156] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 496489
[2025-03-27 17:07:59,157] [ERROR] [launch.py:325:sigkill_handler] ['/hpc2hdd/home/yli045/.conda/envs/ywj/bin/python', '-u', 'main.py', '--local_rank=0', '--image_size', '8', '--batch_size', '1', '--num_epochs', '20', '--timesteps', '100', '--lr', '2e-4', '--time_emb_dim', '32', '--mu1', '4', '--sigma1', '1', '--num1', '900', '--mu2', '10', '--sigma2', '4', '--num2', '100', '--samples_dir', './samples', '--checkpoints_dir', './checkpoints', '--fp16', '--mode', 'train', '--model_path', '', '--num_images', '1000', '--simulation_distribution', 'normal', '--use_different_noise', '--use_moe', '--num_experts', '2', '--moe_hidden_dim', '2', '--moe_tau', '0.1'] exits with return code = 1
[?2004h(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ bash scripts/script_normal_dif_test.sh 
[?2004l[2025-03-27 17:17:50,780] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-27 17:17:50,788] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-27 17:18:03,698] [WARNING] [runner.py:215:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2025-03-27 17:18:03,700] [INFO] [runner.py:607:main] cmd = /hpc2hdd/home/yli045/.conda/envs/ywj/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None main.py --image_size 8 --batch_size 1 --num_epochs 20 --timesteps 100 --lr 2e-4 --time_emb_dim 32 --mu1 4 --sigma1 1 --num1 900 --mu2 10 --sigma2 4 --num2 100 --samples_dir ./samples --checkpoints_dir ./checkpoints --fp16 --mode train --model_path  --num_images 1000 --simulation_distribution normal --use_different_noise --use_moe --num_experts 2 --moe_hidden_dim 2 --moe_tau 0.1
[2025-03-27 17:18:20,802] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-27 17:18:20,810] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-27 17:18:21,949] [INFO] [launch.py:146:main] WORLD INFO DICT: {'localhost': [0]}
[2025-03-27 17:18:21,949] [INFO] [launch.py:152:main] nnodes=1, num_local_procs=1, node_rank=0
[2025-03-27 17:18:21,949] [INFO] [launch.py:163:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2025-03-27 17:18:21,949] [INFO] [launch.py:164:main] dist_world_size=1
[2025-03-27 17:18:21,949] [INFO] [launch.py:168:main] Setting CUDA_VISIBLE_DEVICES=0
[2025-03-27 17:18:21,978] [INFO] [launch.py:256:main] process 498525 spawned with command: ['/hpc2hdd/home/yli045/.conda/envs/ywj/bin/python', '-u', 'main.py', '--local_rank=0', '--image_size', '8', '--batch_size', '1', '--num_epochs', '20', '--timesteps', '100', '--lr', '2e-4', '--time_emb_dim', '32', '--mu1', '4', '--sigma1', '1', '--num1', '900', '--mu2', '10', '--sigma2', '4', '--num2', '100', '--samples_dir', './samples', '--checkpoints_dir', './checkpoints', '--fp16', '--mode', 'train', '--model_path', '', '--num_images', '1000', '--simulation_distribution', 'normal', '--use_different_noise', '--use_moe', '--num_experts', '2', '--moe_hidden_dim', '2', '--moe_tau', '0.1']
[2025-03-27 17:18:38,639] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-03-27 17:18:58,658] [INFO] [logging.py:128:log_dist] [Rank -1] DeepSpeed info: version=0.16.4, git-hash=unknown, git-branch=unknown
[2025-03-27 17:18:58,658] [INFO] [comm.py:658:init_distributed] cdb=None
[2025-03-27 17:18:58,659] [INFO] [comm.py:689:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2025-03-27 17:18:58,663] [INFO] [config.py:734:__init__] Config mesh_device None world_size = 1
[2025-03-27 17:19:01,494] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
Using /hpc2hdd/home/yli045/.cache/torch_extensions/py312_cu124 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /hpc2hdd/home/yli045/.cache/torch_extensions/py312_cu124/fused_adam/build.ninja...
/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/utils/cpp_extension.py:2059: UserWarning: TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation. 
If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'].
  warnings.warn(
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 5.323638200759888 seconds
[2025-03-27 17:19:06,822] [INFO] [logging.py:128:log_dist] [Rank 0] Using DeepSpeed Optimizer param name adamw as basic optimizer
[2025-03-27 17:19:06,823] [INFO] [logging.py:128:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2025-03-27 17:19:06,828] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Basic Optimizer = FusedAdam
[2025-03-27 17:19:06,828] [INFO] [utils.py:59:is_zero_supported_optimizer] Checking ZeRO support for optimizer=FusedAdam type=<class 'deepspeed.ops.adam.fused_adam.FusedAdam'>
[2025-03-27 17:19:06,828] [INFO] [logging.py:128:log_dist] [Rank 0] Creating torch.float16 ZeRO stage 2 optimizer
[2025-03-27 17:19:06,829] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 500000000
[2025-03-27 17:19:06,829] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 500000000
[2025-03-27 17:19:06,829] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2025-03-27 17:19:06,829] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2025-03-27 17:19:07,502] [INFO] [utils.py:781:see_memory_usage] Before initializing optimizer states
[2025-03-27 17:19:07,503] [INFO] [utils.py:782:see_memory_usage] MA 0.0 GB         Max_MA 0.0 GB         CA 0.02 GB         Max_CA 0 GB 
[2025-03-27 17:19:07,503] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 210.69 GB, percent = 20.9%
[2025-03-27 17:19:07,617] [INFO] [utils.py:781:see_memory_usage] After initializing optimizer states
[2025-03-27 17:19:07,618] [INFO] [utils.py:782:see_memory_usage] MA 0.0 GB         Max_MA 0.0 GB         CA 0.02 GB         Max_CA 0 GB 
[2025-03-27 17:19:07,618] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 210.7 GB, percent = 20.9%
[2025-03-27 17:19:07,618] [INFO] [stage_1_and_2.py:550:__init__] optimizer state initialized
[2025-03-27 17:19:07,753] [INFO] [utils.py:781:see_memory_usage] After initializing ZeRO optimizer
[2025-03-27 17:19:07,753] [INFO] [utils.py:782:see_memory_usage] MA 0.0 GB         Max_MA 0.0 GB         CA 0.02 GB         Max_CA 0 GB 
[2025-03-27 17:19:07,753] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 210.87 GB, percent = 20.9%
[2025-03-27 17:19:07,755] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Final Optimizer = DeepSpeedZeroOptimizer
[2025-03-27 17:19:07,755] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed using configured LR scheduler = None
[2025-03-27 17:19:07,755] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2025-03-27 17:19:07,755] [INFO] [logging.py:128:log_dist] [Rank 0] step=0, skipped=0, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-27 17:19:07,756] [INFO] [config.py:1001:print] DeepSpeedEngine configuration:
[2025-03-27 17:19:07,756] [INFO] [config.py:1005:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2025-03-27 17:19:07,756] [INFO] [config.py:1005:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'intra_op_parallelism': 1, 'single_submit': False, 'overlap_events': True, 'use_gds': False}
[2025-03-27 17:19:07,756] [INFO] [config.py:1005:print]   amp_enabled .................. False
[2025-03-27 17:19:07,756] [INFO] [config.py:1005:print]   amp_params ................... False
[2025-03-27 17:19:07,756] [INFO] [config.py:1005:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2025-03-27 17:19:07,756] [INFO] [config.py:1005:print]   bfloat16_enabled ............. False
[2025-03-27 17:19:07,756] [INFO] [config.py:1005:print]   bfloat16_immediate_grad_update  False
[2025-03-27 17:19:07,757] [INFO] [config.py:1005:print]   checkpoint_parallel_write_pipeline  False
[2025-03-27 17:19:07,757] [INFO] [config.py:1005:print]   checkpoint_tag_validation_enabled  True
[2025-03-27 17:19:07,757] [INFO] [config.py:1005:print]   checkpoint_tag_validation_fail  False
[2025-03-27 17:19:07,757] [INFO] [config.py:1005:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f19c73543b0>
[2025-03-27 17:19:07,757] [INFO] [config.py:1005:print]   communication_data_type ...... None
[2025-03-27 17:19:07,757] [INFO] [config.py:1005:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2025-03-27 17:19:07,757] [INFO] [config.py:1005:print]   curriculum_enabled_legacy .... False
[2025-03-27 17:19:07,757] [INFO] [config.py:1005:print]   curriculum_params_legacy ..... False
[2025-03-27 17:19:07,757] [INFO] [config.py:1005:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2025-03-27 17:19:07,757] [INFO] [config.py:1005:print]   data_efficiency_enabled ...... False
[2025-03-27 17:19:07,757] [INFO] [config.py:1005:print]   dataloader_drop_last ......... False
[2025-03-27 17:19:07,757] [INFO] [config.py:1005:print]   disable_allgather ............ False
[2025-03-27 17:19:07,757] [INFO] [config.py:1005:print]   dump_state ................... False
[2025-03-27 17:19:07,757] [INFO] [config.py:1005:print]   dynamic_loss_scale_args ...... {'init_scale': 65536, 'scale_window': 1000, 'delayed_shift': 2, 'consecutive_hysteresis': False, 'min_scale': 1}
[2025-03-27 17:19:07,757] [INFO] [config.py:1005:print]   eigenvalue_enabled ........... False
[2025-03-27 17:19:07,757] [INFO] [config.py:1005:print]   eigenvalue_gas_boundary_resolution  1
[2025-03-27 17:19:07,757] [INFO] [config.py:1005:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2025-03-27 17:19:07,757] [INFO] [config.py:1005:print]   eigenvalue_layer_num ......... 0
[2025-03-27 17:19:07,757] [INFO] [config.py:1005:print]   eigenvalue_max_iter .......... 100
[2025-03-27 17:19:07,757] [INFO] [config.py:1005:print]   eigenvalue_stability ......... 1e-06
[2025-03-27 17:19:07,757] [INFO] [config.py:1005:print]   eigenvalue_tol ............... 0.01
[2025-03-27 17:19:07,757] [INFO] [config.py:1005:print]   eigenvalue_verbose ........... False
[2025-03-27 17:19:07,757] [INFO] [config.py:1005:print]   elasticity_enabled ........... False
[2025-03-27 17:19:07,757] [INFO] [config.py:1005:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2025-03-27 17:19:07,757] [INFO] [config.py:1005:print]   fp16_auto_cast ............... False
[2025-03-27 17:19:07,758] [INFO] [config.py:1005:print]   fp16_enabled ................. True
[2025-03-27 17:19:07,758] [INFO] [config.py:1005:print]   fp16_master_weights_and_gradients  False
[2025-03-27 17:19:07,758] [INFO] [config.py:1005:print]   global_rank .................. 0
[2025-03-27 17:19:07,758] [INFO] [config.py:1005:print]   grad_accum_dtype ............. None
[2025-03-27 17:19:07,758] [INFO] [config.py:1005:print]   gradient_accumulation_steps .. 1
[2025-03-27 17:19:07,758] [INFO] [config.py:1005:print]   gradient_clipping ............ 1.0
[2025-03-27 17:19:07,758] [INFO] [config.py:1005:print]   gradient_predivide_factor .... 1.0
[2025-03-27 17:19:07,758] [INFO] [config.py:1005:print]   graph_harvesting ............. False
[2025-03-27 17:19:07,758] [INFO] [config.py:1005:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2025-03-27 17:19:07,758] [INFO] [config.py:1005:print]   initial_dynamic_scale ........ 65536
[2025-03-27 17:19:07,758] [INFO] [config.py:1005:print]   load_universal_checkpoint .... False
[2025-03-27 17:19:07,758] [INFO] [config.py:1005:print]   loss_scale ................... 0
[2025-03-27 17:19:07,758] [INFO] [config.py:1005:print]   memory_breakdown ............. False
[2025-03-27 17:19:07,758] [INFO] [config.py:1005:print]   mics_hierarchial_params_gather  False
[2025-03-27 17:19:07,758] [INFO] [config.py:1005:print]   mics_shard_size .............. -1
[2025-03-27 17:19:07,758] [INFO] [config.py:1005:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') comet=CometConfig(enabled=False, samples_log_interval=100, project=None, workspace=None, api_key=None, experiment_name=None, experiment_key=None, online=None, mode=None) wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName')
[2025-03-27 17:19:07,758] [INFO] [config.py:1005:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2025-03-27 17:19:07,758] [INFO] [config.py:1005:print]   optimizer_legacy_fusion ...... False
[2025-03-27 17:19:07,758] [INFO] [config.py:1005:print]   optimizer_name ............... adamw
[2025-03-27 17:19:07,758] [INFO] [config.py:1005:print]   optimizer_params ............. {'lr': 0.0002, 'weight_decay': 0.01}
[2025-03-27 17:19:07,758] [INFO] [config.py:1005:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2025-03-27 17:19:07,758] [INFO] [config.py:1005:print]   pld_enabled .................. False
[2025-03-27 17:19:07,758] [INFO] [config.py:1005:print]   pld_params ................... False
[2025-03-27 17:19:07,758] [INFO] [config.py:1005:print]   prescale_gradients ........... False
[2025-03-27 17:19:07,758] [INFO] [config.py:1005:print]   scheduler_name ............... None
[2025-03-27 17:19:07,759] [INFO] [config.py:1005:print]   scheduler_params ............. None
[2025-03-27 17:19:07,759] [INFO] [config.py:1005:print]   seq_parallel_communication_data_type  torch.float32
[2025-03-27 17:19:07,759] [INFO] [config.py:1005:print]   sparse_attention ............. None
[2025-03-27 17:19:07,759] [INFO] [config.py:1005:print]   sparse_gradients_enabled ..... False
[2025-03-27 17:19:07,759] [INFO] [config.py:1005:print]   steps_per_print .............. 50
[2025-03-27 17:19:07,759] [INFO] [config.py:1005:print]   tensor_parallel_config ....... dtype=torch.float16 autotp_size=0 tensor_parallel=TPConfig(tp_size=1, tp_grain_size=1, mpu=None, tp_group=None) injection_policy_tuple=None keep_module_on_host=False replace_with_kernel_inject=False
[2025-03-27 17:19:07,759] [INFO] [config.py:1005:print]   timers_config ................ enabled=True synchronized=True
[2025-03-27 17:19:07,759] [INFO] [config.py:1005:print]   train_batch_size ............. 1
[2025-03-27 17:19:07,759] [INFO] [config.py:1005:print]   train_micro_batch_size_per_gpu  1
[2025-03-27 17:19:07,759] [INFO] [config.py:1005:print]   use_data_before_expert_parallel_  False
[2025-03-27 17:19:07,759] [INFO] [config.py:1005:print]   use_node_local_storage ....... False
[2025-03-27 17:19:07,759] [INFO] [config.py:1005:print]   wall_clock_breakdown ......... False
[2025-03-27 17:19:07,759] [INFO] [config.py:1005:print]   weight_quantization_config ... None
[2025-03-27 17:19:07,759] [INFO] [config.py:1005:print]   world_size ................... 1
[2025-03-27 17:19:07,759] [INFO] [config.py:1005:print]   zero_allow_untested_optimizer  False
[2025-03-27 17:19:07,759] [INFO] [config.py:1005:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=500000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50000000 param_persistence_threshold=100000 model_persistence_threshold=9223372036854775807 max_live_parameters=1000000000 max_reuse_distance=1000000000 gather_16bit_weights_on_model_save=False module_granularity_threshold=0 use_all_reduce_for_fetch_params=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False zeropp_loco_param=None mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True log_trace_cache_warnings=False
[2025-03-27 17:19:07,759] [INFO] [config.py:1005:print]   zero_enabled ................. True
[2025-03-27 17:19:07,759] [INFO] [config.py:1005:print]   zero_force_ds_cpu_optimizer .. True
[2025-03-27 17:19:07,759] [INFO] [config.py:1005:print]   zero_optimization_stage ...... 2
[2025-03-27 17:19:07,759] [INFO] [config.py:991:print_user_config]   json = {
    "train_batch_size": 1, 
    "gradient_accumulation_steps": 1, 
    "optimizer": {
        "type": "AdamW", 
        "params": {
            "lr": 0.0002, 
            "weight_decay": 0.01
        }
    }, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "loss_scale_window": 1000
    }, 
    "zero_optimization": {
        "stage": 2, 
        "contiguous_gradients": true, 
        "overlap_comm": true
    }, 
    "steps_per_print": 50, 
    "gradient_clipping": 1.0
}
****START TRAINING****
image_size: 8, batch_size: 1, timesteps: 100, time_emb_dim: 32
  0%|                                                                                                              | 0/111 [00:00<?, ?it/s]torch.Size([1, 1, 8, 8])
  0%|                                                                                                              | 0/111 [00:00<?, ?it/s]
[rank0]: Traceback (most recent call last):
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/main.py", line 9, in <module>
[rank0]:     train_deepspeed(cfg)
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/train.py", line 155, in train_deepspeed
[rank0]:     noisy_images, noise = model.forward_diffusion(
[rank0]:                           ^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/moe_diffusion.py", line 49, in forward_diffusion
[rank0]:     dynamic_noise = self.noise_moe(moe_input).view(B, C, H, W)
[rank0]:                     ^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/reparam_moe.py", line 54, in forward
[rank0]:     assert x.shape[-1] == self.input_dim, f"Input last dim must be {self.input_dim}, got {x.shape[-1]}"
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]: AssertionError: Input last dim must be 192, got 64
[rank0]:[W327 17:19:09.159777025 ProcessGroupNCCL.cpp:1496] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[2025-03-27 17:19:10,040] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 498525
[2025-03-27 17:19:10,041] [ERROR] [launch.py:325:sigkill_handler] ['/hpc2hdd/home/yli045/.conda/envs/ywj/bin/python', '-u', 'main.py', '--local_rank=0', '--image_size', '8', '--batch_size', '1', '--num_epochs', '20', '--timesteps', '100', '--lr', '2e-4', '--time_emb_dim', '32', '--mu1', '4', '--sigma1', '1', '--num1', '900', '--mu2', '10', '--sigma2', '4', '--num2', '100', '--samples_dir', './samples', '--checkpoints_dir', './checkpoints', '--fp16', '--mode', 'train', '--model_path', '', '--num_images', '1000', '--simulation_distribution', 'normal', '--use_different_noise', '--use_moe', '--num_experts', '2', '--moe_hidden_dim', '2', '--moe_tau', '0.1'] exits with return code = 1
[?2004h(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ bash scripts/script_normal_dif_test.sh 
[?2004l[2025-03-27 17:22:05,325] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-27 17:22:05,332] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-27 17:22:10,941] [WARNING] [runner.py:215:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2025-03-27 17:22:10,942] [INFO] [runner.py:607:main] cmd = /hpc2hdd/home/yli045/.conda/envs/ywj/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None main.py --image_size 64 --batch_size 1 --num_epochs 20 --timesteps 100 --lr 2e-4 --time_emb_dim 32 --mu1 4 --sigma1 1 --num1 900 --mu2 10 --sigma2 4 --num2 100 --samples_dir ./samples --checkpoints_dir ./checkpoints --fp16 --mode train --model_path  --num_images 1000 --simulation_distribution normal --use_different_noise --use_moe --num_experts 2 --moe_hidden_dim 2 --moe_tau 0.1
[2025-03-27 17:22:27,334] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-27 17:22:27,341] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-27 17:22:33,148] [INFO] [launch.py:146:main] WORLD INFO DICT: {'localhost': [0]}
[2025-03-27 17:22:33,148] [INFO] [launch.py:152:main] nnodes=1, num_local_procs=1, node_rank=0
[2025-03-27 17:22:33,148] [INFO] [launch.py:163:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2025-03-27 17:22:33,148] [INFO] [launch.py:164:main] dist_world_size=1
[2025-03-27 17:22:33,148] [INFO] [launch.py:168:main] Setting CUDA_VISIBLE_DEVICES=0
[2025-03-27 17:22:33,217] [INFO] [launch.py:256:main] process 499556 spawned with command: ['/hpc2hdd/home/yli045/.conda/envs/ywj/bin/python', '-u', 'main.py', '--local_rank=0', '--image_size', '64', '--batch_size', '1', '--num_epochs', '20', '--timesteps', '100', '--lr', '2e-4', '--time_emb_dim', '32', '--mu1', '4', '--sigma1', '1', '--num1', '900', '--mu2', '10', '--sigma2', '4', '--num2', '100', '--samples_dir', './samples', '--checkpoints_dir', './checkpoints', '--fp16', '--mode', 'train', '--model_path', '', '--num_images', '1000', '--simulation_distribution', 'normal', '--use_different_noise', '--use_moe', '--num_experts', '2', '--moe_hidden_dim', '2', '--moe_tau', '0.1']
[2025-03-27 17:22:44,154] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-03-27 17:23:17,381] [INFO] [logging.py:128:log_dist] [Rank -1] DeepSpeed info: version=0.16.4, git-hash=unknown, git-branch=unknown
[2025-03-27 17:23:17,382] [INFO] [comm.py:658:init_distributed] cdb=None
[2025-03-27 17:23:17,382] [INFO] [comm.py:689:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2025-03-27 17:23:17,385] [INFO] [config.py:734:__init__] Config mesh_device None world_size = 1
[2025-03-27 17:23:24,291] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
Using /hpc2hdd/home/yli045/.cache/torch_extensions/py312_cu124 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /hpc2hdd/home/yli045/.cache/torch_extensions/py312_cu124/fused_adam/build.ninja...
/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/utils/cpp_extension.py:2059: UserWarning: TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation. 
If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'].
  warnings.warn(
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 6.258700370788574 seconds
[2025-03-27 17:23:30,556] [INFO] [logging.py:128:log_dist] [Rank 0] Using DeepSpeed Optimizer param name adamw as basic optimizer
[2025-03-27 17:23:30,557] [INFO] [logging.py:128:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2025-03-27 17:23:30,561] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Basic Optimizer = FusedAdam
[2025-03-27 17:23:30,562] [INFO] [utils.py:59:is_zero_supported_optimizer] Checking ZeRO support for optimizer=FusedAdam type=<class 'deepspeed.ops.adam.fused_adam.FusedAdam'>
[2025-03-27 17:23:30,562] [INFO] [logging.py:128:log_dist] [Rank 0] Creating torch.float16 ZeRO stage 2 optimizer
[2025-03-27 17:23:30,562] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 500000000
[2025-03-27 17:23:30,563] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 500000000
[2025-03-27 17:23:30,563] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2025-03-27 17:23:30,563] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2025-03-27 17:23:36,781] [INFO] [utils.py:781:see_memory_usage] Before initializing optimizer states
[2025-03-27 17:23:36,782] [INFO] [utils.py:782:see_memory_usage] MA 0.11 GB         Max_MA 0.15 GB         CA 0.16 GB         Max_CA 0 GB 
[2025-03-27 17:23:36,782] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 211.07 GB, percent = 20.9%
[2025-03-27 17:23:36,902] [INFO] [utils.py:781:see_memory_usage] After initializing optimizer states
[2025-03-27 17:23:36,903] [INFO] [utils.py:782:see_memory_usage] MA 0.11 GB         Max_MA 0.19 GB         CA 0.23 GB         Max_CA 0 GB 
[2025-03-27 17:23:36,903] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 211.06 GB, percent = 20.9%
[2025-03-27 17:23:36,903] [INFO] [stage_1_and_2.py:550:__init__] optimizer state initialized
[2025-03-27 17:23:37,019] [INFO] [utils.py:781:see_memory_usage] After initializing ZeRO optimizer
[2025-03-27 17:23:37,020] [INFO] [utils.py:782:see_memory_usage] MA 0.11 GB         Max_MA 0.11 GB         CA 0.23 GB         Max_CA 0 GB 
[2025-03-27 17:23:37,020] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 210.59 GB, percent = 20.9%
[2025-03-27 17:23:37,022] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Final Optimizer = DeepSpeedZeroOptimizer
[2025-03-27 17:23:37,022] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed using configured LR scheduler = None
[2025-03-27 17:23:37,022] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2025-03-27 17:23:37,022] [INFO] [logging.py:128:log_dist] [Rank 0] step=0, skipped=0, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-27 17:23:37,022] [INFO] [config.py:1001:print] DeepSpeedEngine configuration:
[2025-03-27 17:23:37,023] [INFO] [config.py:1005:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2025-03-27 17:23:37,023] [INFO] [config.py:1005:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'intra_op_parallelism': 1, 'single_submit': False, 'overlap_events': True, 'use_gds': False}
[2025-03-27 17:23:37,023] [INFO] [config.py:1005:print]   amp_enabled .................. False
[2025-03-27 17:23:37,023] [INFO] [config.py:1005:print]   amp_params ................... False
[2025-03-27 17:23:37,023] [INFO] [config.py:1005:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2025-03-27 17:23:37,023] [INFO] [config.py:1005:print]   bfloat16_enabled ............. False
[2025-03-27 17:23:37,023] [INFO] [config.py:1005:print]   bfloat16_immediate_grad_update  False
[2025-03-27 17:23:37,023] [INFO] [config.py:1005:print]   checkpoint_parallel_write_pipeline  False
[2025-03-27 17:23:37,023] [INFO] [config.py:1005:print]   checkpoint_tag_validation_enabled  True
[2025-03-27 17:23:37,023] [INFO] [config.py:1005:print]   checkpoint_tag_validation_fail  False
[2025-03-27 17:23:37,023] [INFO] [config.py:1005:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fcd14901af0>
[2025-03-27 17:23:37,023] [INFO] [config.py:1005:print]   communication_data_type ...... None
[2025-03-27 17:23:37,023] [INFO] [config.py:1005:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2025-03-27 17:23:37,023] [INFO] [config.py:1005:print]   curriculum_enabled_legacy .... False
[2025-03-27 17:23:37,023] [INFO] [config.py:1005:print]   curriculum_params_legacy ..... False
[2025-03-27 17:23:37,023] [INFO] [config.py:1005:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2025-03-27 17:23:37,023] [INFO] [config.py:1005:print]   data_efficiency_enabled ...... False
[2025-03-27 17:23:37,023] [INFO] [config.py:1005:print]   dataloader_drop_last ......... False
[2025-03-27 17:23:37,024] [INFO] [config.py:1005:print]   disable_allgather ............ False
[2025-03-27 17:23:37,024] [INFO] [config.py:1005:print]   dump_state ................... False
[2025-03-27 17:23:37,024] [INFO] [config.py:1005:print]   dynamic_loss_scale_args ...... {'init_scale': 65536, 'scale_window': 1000, 'delayed_shift': 2, 'consecutive_hysteresis': False, 'min_scale': 1}
[2025-03-27 17:23:37,024] [INFO] [config.py:1005:print]   eigenvalue_enabled ........... False
[2025-03-27 17:23:37,024] [INFO] [config.py:1005:print]   eigenvalue_gas_boundary_resolution  1
[2025-03-27 17:23:37,024] [INFO] [config.py:1005:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2025-03-27 17:23:37,024] [INFO] [config.py:1005:print]   eigenvalue_layer_num ......... 0
[2025-03-27 17:23:37,024] [INFO] [config.py:1005:print]   eigenvalue_max_iter .......... 100
[2025-03-27 17:23:37,024] [INFO] [config.py:1005:print]   eigenvalue_stability ......... 1e-06
[2025-03-27 17:23:37,024] [INFO] [config.py:1005:print]   eigenvalue_tol ............... 0.01
[2025-03-27 17:23:37,024] [INFO] [config.py:1005:print]   eigenvalue_verbose ........... False
[2025-03-27 17:23:37,024] [INFO] [config.py:1005:print]   elasticity_enabled ........... False
[2025-03-27 17:23:37,024] [INFO] [config.py:1005:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2025-03-27 17:23:37,024] [INFO] [config.py:1005:print]   fp16_auto_cast ............... False
[2025-03-27 17:23:37,024] [INFO] [config.py:1005:print]   fp16_enabled ................. True
[2025-03-27 17:23:37,024] [INFO] [config.py:1005:print]   fp16_master_weights_and_gradients  False
[2025-03-27 17:23:37,024] [INFO] [config.py:1005:print]   global_rank .................. 0
[2025-03-27 17:23:37,024] [INFO] [config.py:1005:print]   grad_accum_dtype ............. None
[2025-03-27 17:23:37,024] [INFO] [config.py:1005:print]   gradient_accumulation_steps .. 1
[2025-03-27 17:23:37,024] [INFO] [config.py:1005:print]   gradient_clipping ............ 1.0
[2025-03-27 17:23:37,024] [INFO] [config.py:1005:print]   gradient_predivide_factor .... 1.0
[2025-03-27 17:23:37,024] [INFO] [config.py:1005:print]   graph_harvesting ............. False
[2025-03-27 17:23:37,024] [INFO] [config.py:1005:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2025-03-27 17:23:37,024] [INFO] [config.py:1005:print]   initial_dynamic_scale ........ 65536
[2025-03-27 17:23:37,024] [INFO] [config.py:1005:print]   load_universal_checkpoint .... False
[2025-03-27 17:23:37,024] [INFO] [config.py:1005:print]   loss_scale ................... 0
[2025-03-27 17:23:37,025] [INFO] [config.py:1005:print]   memory_breakdown ............. False
[2025-03-27 17:23:37,025] [INFO] [config.py:1005:print]   mics_hierarchial_params_gather  False
[2025-03-27 17:23:37,025] [INFO] [config.py:1005:print]   mics_shard_size .............. -1
[2025-03-27 17:23:37,025] [INFO] [config.py:1005:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') comet=CometConfig(enabled=False, samples_log_interval=100, project=None, workspace=None, api_key=None, experiment_name=None, experiment_key=None, online=None, mode=None) wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName')
[2025-03-27 17:23:37,025] [INFO] [config.py:1005:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2025-03-27 17:23:37,025] [INFO] [config.py:1005:print]   optimizer_legacy_fusion ...... False
[2025-03-27 17:23:37,025] [INFO] [config.py:1005:print]   optimizer_name ............... adamw
[2025-03-27 17:23:37,025] [INFO] [config.py:1005:print]   optimizer_params ............. {'lr': 0.0002, 'weight_decay': 0.01}
[2025-03-27 17:23:37,025] [INFO] [config.py:1005:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2025-03-27 17:23:37,025] [INFO] [config.py:1005:print]   pld_enabled .................. False
[2025-03-27 17:23:37,025] [INFO] [config.py:1005:print]   pld_params ................... False
[2025-03-27 17:23:37,025] [INFO] [config.py:1005:print]   prescale_gradients ........... False
[2025-03-27 17:23:37,025] [INFO] [config.py:1005:print]   scheduler_name ............... None
[2025-03-27 17:23:37,025] [INFO] [config.py:1005:print]   scheduler_params ............. None
[2025-03-27 17:23:37,025] [INFO] [config.py:1005:print]   seq_parallel_communication_data_type  torch.float32
[2025-03-27 17:23:37,025] [INFO] [config.py:1005:print]   sparse_attention ............. None
[2025-03-27 17:23:37,025] [INFO] [config.py:1005:print]   sparse_gradients_enabled ..... False
[2025-03-27 17:23:37,025] [INFO] [config.py:1005:print]   steps_per_print .............. 50
[2025-03-27 17:23:37,025] [INFO] [config.py:1005:print]   tensor_parallel_config ....... dtype=torch.float16 autotp_size=0 tensor_parallel=TPConfig(tp_size=1, tp_grain_size=1, mpu=None, tp_group=None) injection_policy_tuple=None keep_module_on_host=False replace_with_kernel_inject=False
[2025-03-27 17:23:37,025] [INFO] [config.py:1005:print]   timers_config ................ enabled=True synchronized=True
[2025-03-27 17:23:37,025] [INFO] [config.py:1005:print]   train_batch_size ............. 1
[2025-03-27 17:23:37,025] [INFO] [config.py:1005:print]   train_micro_batch_size_per_gpu  1
[2025-03-27 17:23:37,025] [INFO] [config.py:1005:print]   use_data_before_expert_parallel_  False
[2025-03-27 17:23:37,025] [INFO] [config.py:1005:print]   use_node_local_storage ....... False
[2025-03-27 17:23:37,026] [INFO] [config.py:1005:print]   wall_clock_breakdown ......... False
[2025-03-27 17:23:37,026] [INFO] [config.py:1005:print]   weight_quantization_config ... None
[2025-03-27 17:23:37,026] [INFO] [config.py:1005:print]   world_size ................... 1
[2025-03-27 17:23:37,026] [INFO] [config.py:1005:print]   zero_allow_untested_optimizer  False
[2025-03-27 17:23:37,026] [INFO] [config.py:1005:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=500000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50000000 param_persistence_threshold=100000 model_persistence_threshold=9223372036854775807 max_live_parameters=1000000000 max_reuse_distance=1000000000 gather_16bit_weights_on_model_save=False module_granularity_threshold=0 use_all_reduce_for_fetch_params=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False zeropp_loco_param=None mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True log_trace_cache_warnings=False
[2025-03-27 17:23:37,026] [INFO] [config.py:1005:print]   zero_enabled ................. True
[2025-03-27 17:23:37,026] [INFO] [config.py:1005:print]   zero_force_ds_cpu_optimizer .. True
[2025-03-27 17:23:37,026] [INFO] [config.py:1005:print]   zero_optimization_stage ...... 2
[2025-03-27 17:23:37,026] [INFO] [config.py:991:print_user_config]   json = {
    "train_batch_size": 1, 
    "gradient_accumulation_steps": 1, 
    "optimizer": {
        "type": "AdamW", 
        "params": {
            "lr": 0.0002, 
            "weight_decay": 0.01
        }
    }, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "loss_scale_window": 1000
    }, 
    "zero_optimization": {
        "stage": 2, 
        "contiguous_gradients": true, 
        "overlap_comm": true
    }, 
    "steps_per_print": 50, 
    "gradient_clipping": 1.0
}
****START TRAINING****
image_size: 64, batch_size: 1, timesteps: 100, time_emb_dim: 32
  0%|                                                                                                               | 0/13 [00:00<?, ?it/s]----****images_shape****---- torch.Size([1, 1, 64, 64])
  0%|                                                                                                               | 0/13 [00:01<?, ?it/s]
[rank0]: Traceback (most recent call last):
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/main.py", line 9, in <module>
[rank0]:     train_deepspeed(cfg)
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/train.py", line 155, in train_deepspeed
[rank0]:     noisy_images, noise = model.forward_diffusion(
[rank0]:                           ^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/moe_diffusion.py", line 46, in forward_diffusion
[rank0]:     moe_input = x0_flat + t_proj  # 简单相加，也可以选择拼接
[rank0]:                 ~~~~~~~~^~~~~~~~
[rank0]: RuntimeError: The size of tensor a (4096) must match the size of tensor b (64) at non-singleton dimension 1
[rank0]:[W327 17:23:39.342513360 ProcessGroupNCCL.cpp:1496] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[2025-03-27 17:23:40,343] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 499556
[2025-03-27 17:23:40,344] [ERROR] [launch.py:325:sigkill_handler] ['/hpc2hdd/home/yli045/.conda/envs/ywj/bin/python', '-u', 'main.py', '--local_rank=0', '--image_size', '64', '--batch_size', '1', '--num_epochs', '20', '--timesteps', '100', '--lr', '2e-4', '--time_emb_dim', '32', '--mu1', '4', '--sigma1', '1', '--num1', '900', '--mu2', '10', '--sigma2', '4', '--num2', '100', '--samples_dir', './samples', '--checkpoints_dir', './checkpoints', '--fp16', '--mode', 'train', '--model_path', '', '--num_images', '1000', '--simulation_distribution', 'normal', '--use_different_noise', '--use_moe', '--num_experts', '2', '--moe_hidden_dim', '2', '--moe_tau', '0.1'] exits with return code = 1
[?2004h(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ bash scripts/script_normal_dif_test.sh 
[?2004l[2025-03-27 17:27:16,245] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-27 17:27:16,252] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-27 17:27:20,890] [WARNING] [runner.py:215:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2025-03-27 17:27:20,892] [INFO] [runner.py:607:main] cmd = /hpc2hdd/home/yli045/.conda/envs/ywj/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None main.py --image_size 64 --batch_size 1 --num_epochs 20 --timesteps 100 --lr 2e-4 --time_emb_dim 32 --mu1 4 --sigma1 1 --num1 900 --mu2 10 --sigma2 4 --num2 100 --samples_dir ./samples --checkpoints_dir ./checkpoints --fp16 --mode train --model_path  --num_images 1000 --simulation_distribution normal --use_different_noise --use_moe --num_experts 2 --moe_hidden_dim 2 --moe_tau 0.1
[2025-03-27 17:27:33,905] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-27 17:27:33,913] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-27 17:27:35,070] [INFO] [launch.py:146:main] WORLD INFO DICT: {'localhost': [0]}
[2025-03-27 17:27:35,070] [INFO] [launch.py:152:main] nnodes=1, num_local_procs=1, node_rank=0
[2025-03-27 17:27:35,070] [INFO] [launch.py:163:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2025-03-27 17:27:35,070] [INFO] [launch.py:164:main] dist_world_size=1
[2025-03-27 17:27:35,070] [INFO] [launch.py:168:main] Setting CUDA_VISIBLE_DEVICES=0
[2025-03-27 17:27:35,071] [INFO] [launch.py:256:main] process 500717 spawned with command: ['/hpc2hdd/home/yli045/.conda/envs/ywj/bin/python', '-u', 'main.py', '--local_rank=0', '--image_size', '64', '--batch_size', '1', '--num_epochs', '20', '--timesteps', '100', '--lr', '2e-4', '--time_emb_dim', '32', '--mu1', '4', '--sigma1', '1', '--num1', '900', '--mu2', '10', '--sigma2', '4', '--num2', '100', '--samples_dir', './samples', '--checkpoints_dir', './checkpoints', '--fp16', '--mode', 'train', '--model_path', '', '--num_images', '1000', '--simulation_distribution', 'normal', '--use_different_noise', '--use_moe', '--num_experts', '2', '--moe_hidden_dim', '2', '--moe_tau', '0.1']
[2025-03-27 17:28:03,025] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-03-27 17:28:27,984] [INFO] [logging.py:128:log_dist] [Rank -1] DeepSpeed info: version=0.16.4, git-hash=unknown, git-branch=unknown
[2025-03-27 17:28:27,984] [INFO] [comm.py:658:init_distributed] cdb=None
[2025-03-27 17:28:27,985] [INFO] [comm.py:689:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2025-03-27 17:28:27,989] [INFO] [config.py:734:__init__] Config mesh_device None world_size = 1
[2025-03-27 17:28:36,365] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
Using /hpc2hdd/home/yli045/.cache/torch_extensions/py312_cu124 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /hpc2hdd/home/yli045/.cache/torch_extensions/py312_cu124/fused_adam/build.ninja...
/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/utils/cpp_extension.py:2059: UserWarning: TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation. 
If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'].
  warnings.warn(
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 0.20070862770080566 seconds
[2025-03-27 17:28:36,571] [INFO] [logging.py:128:log_dist] [Rank 0] Using DeepSpeed Optimizer param name adamw as basic optimizer
[2025-03-27 17:28:36,572] [INFO] [logging.py:128:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2025-03-27 17:28:36,577] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Basic Optimizer = FusedAdam
[2025-03-27 17:28:36,577] [INFO] [utils.py:59:is_zero_supported_optimizer] Checking ZeRO support for optimizer=FusedAdam type=<class 'deepspeed.ops.adam.fused_adam.FusedAdam'>
[2025-03-27 17:28:36,578] [INFO] [logging.py:128:log_dist] [Rank 0] Creating torch.float16 ZeRO stage 2 optimizer
[2025-03-27 17:28:36,578] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 500000000
[2025-03-27 17:28:36,578] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 500000000
[2025-03-27 17:28:36,578] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2025-03-27 17:28:36,578] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2025-03-27 17:28:42,891] [INFO] [utils.py:781:see_memory_usage] Before initializing optimizer states
[2025-03-27 17:28:42,891] [INFO] [utils.py:782:see_memory_usage] MA 0.11 GB         Max_MA 0.15 GB         CA 0.16 GB         Max_CA 0 GB 
[2025-03-27 17:28:42,892] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 212.39 GB, percent = 21.1%
[2025-03-27 17:28:43,017] [INFO] [utils.py:781:see_memory_usage] After initializing optimizer states
[2025-03-27 17:28:43,017] [INFO] [utils.py:782:see_memory_usage] MA 0.11 GB         Max_MA 0.19 GB         CA 0.23 GB         Max_CA 0 GB 
[2025-03-27 17:28:43,018] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 212.43 GB, percent = 21.1%
[2025-03-27 17:28:43,018] [INFO] [stage_1_and_2.py:550:__init__] optimizer state initialized
[2025-03-27 17:28:43,138] [INFO] [utils.py:781:see_memory_usage] After initializing ZeRO optimizer
[2025-03-27 17:28:43,139] [INFO] [utils.py:782:see_memory_usage] MA 0.11 GB         Max_MA 0.11 GB         CA 0.23 GB         Max_CA 0 GB 
[2025-03-27 17:28:43,139] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 212.55 GB, percent = 21.1%
[2025-03-27 17:28:43,141] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Final Optimizer = DeepSpeedZeroOptimizer
[2025-03-27 17:28:43,141] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed using configured LR scheduler = None
[2025-03-27 17:28:43,141] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2025-03-27 17:28:43,141] [INFO] [logging.py:128:log_dist] [Rank 0] step=0, skipped=0, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-27 17:28:43,142] [INFO] [config.py:1001:print] DeepSpeedEngine configuration:
[2025-03-27 17:28:43,142] [INFO] [config.py:1005:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2025-03-27 17:28:43,142] [INFO] [config.py:1005:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'intra_op_parallelism': 1, 'single_submit': False, 'overlap_events': True, 'use_gds': False}
[2025-03-27 17:28:43,142] [INFO] [config.py:1005:print]   amp_enabled .................. False
[2025-03-27 17:28:43,142] [INFO] [config.py:1005:print]   amp_params ................... False
[2025-03-27 17:28:43,142] [INFO] [config.py:1005:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2025-03-27 17:28:43,142] [INFO] [config.py:1005:print]   bfloat16_enabled ............. False
[2025-03-27 17:28:43,142] [INFO] [config.py:1005:print]   bfloat16_immediate_grad_update  False
[2025-03-27 17:28:43,142] [INFO] [config.py:1005:print]   checkpoint_parallel_write_pipeline  False
[2025-03-27 17:28:43,142] [INFO] [config.py:1005:print]   checkpoint_tag_validation_enabled  True
[2025-03-27 17:28:43,142] [INFO] [config.py:1005:print]   checkpoint_tag_validation_fail  False
[2025-03-27 17:28:43,142] [INFO] [config.py:1005:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fd2773e5cd0>
[2025-03-27 17:28:43,142] [INFO] [config.py:1005:print]   communication_data_type ...... None
[2025-03-27 17:28:43,143] [INFO] [config.py:1005:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2025-03-27 17:28:43,143] [INFO] [config.py:1005:print]   curriculum_enabled_legacy .... False
[2025-03-27 17:28:43,143] [INFO] [config.py:1005:print]   curriculum_params_legacy ..... False
[2025-03-27 17:28:43,143] [INFO] [config.py:1005:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2025-03-27 17:28:43,143] [INFO] [config.py:1005:print]   data_efficiency_enabled ...... False
[2025-03-27 17:28:43,143] [INFO] [config.py:1005:print]   dataloader_drop_last ......... False
[2025-03-27 17:28:43,143] [INFO] [config.py:1005:print]   disable_allgather ............ False
[2025-03-27 17:28:43,143] [INFO] [config.py:1005:print]   dump_state ................... False
[2025-03-27 17:28:43,143] [INFO] [config.py:1005:print]   dynamic_loss_scale_args ...... {'init_scale': 65536, 'scale_window': 1000, 'delayed_shift': 2, 'consecutive_hysteresis': False, 'min_scale': 1}
[2025-03-27 17:28:43,143] [INFO] [config.py:1005:print]   eigenvalue_enabled ........... False
[2025-03-27 17:28:43,143] [INFO] [config.py:1005:print]   eigenvalue_gas_boundary_resolution  1
[2025-03-27 17:28:43,143] [INFO] [config.py:1005:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2025-03-27 17:28:43,143] [INFO] [config.py:1005:print]   eigenvalue_layer_num ......... 0
[2025-03-27 17:28:43,143] [INFO] [config.py:1005:print]   eigenvalue_max_iter .......... 100
[2025-03-27 17:28:43,143] [INFO] [config.py:1005:print]   eigenvalue_stability ......... 1e-06
[2025-03-27 17:28:43,143] [INFO] [config.py:1005:print]   eigenvalue_tol ............... 0.01
[2025-03-27 17:28:43,143] [INFO] [config.py:1005:print]   eigenvalue_verbose ........... False
[2025-03-27 17:28:43,143] [INFO] [config.py:1005:print]   elasticity_enabled ........... False
[2025-03-27 17:28:43,143] [INFO] [config.py:1005:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2025-03-27 17:28:43,143] [INFO] [config.py:1005:print]   fp16_auto_cast ............... False
[2025-03-27 17:28:43,143] [INFO] [config.py:1005:print]   fp16_enabled ................. True
[2025-03-27 17:28:43,143] [INFO] [config.py:1005:print]   fp16_master_weights_and_gradients  False
[2025-03-27 17:28:43,143] [INFO] [config.py:1005:print]   global_rank .................. 0
[2025-03-27 17:28:43,143] [INFO] [config.py:1005:print]   grad_accum_dtype ............. None
[2025-03-27 17:28:43,143] [INFO] [config.py:1005:print]   gradient_accumulation_steps .. 1
[2025-03-27 17:28:43,144] [INFO] [config.py:1005:print]   gradient_clipping ............ 1.0
[2025-03-27 17:28:43,144] [INFO] [config.py:1005:print]   gradient_predivide_factor .... 1.0
[2025-03-27 17:28:43,144] [INFO] [config.py:1005:print]   graph_harvesting ............. False
[2025-03-27 17:28:43,144] [INFO] [config.py:1005:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2025-03-27 17:28:43,144] [INFO] [config.py:1005:print]   initial_dynamic_scale ........ 65536
[2025-03-27 17:28:43,144] [INFO] [config.py:1005:print]   load_universal_checkpoint .... False
[2025-03-27 17:28:43,144] [INFO] [config.py:1005:print]   loss_scale ................... 0
[2025-03-27 17:28:43,144] [INFO] [config.py:1005:print]   memory_breakdown ............. False
[2025-03-27 17:28:43,144] [INFO] [config.py:1005:print]   mics_hierarchial_params_gather  False
[2025-03-27 17:28:43,144] [INFO] [config.py:1005:print]   mics_shard_size .............. -1
[2025-03-27 17:28:43,144] [INFO] [config.py:1005:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') comet=CometConfig(enabled=False, samples_log_interval=100, project=None, workspace=None, api_key=None, experiment_name=None, experiment_key=None, online=None, mode=None) wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName')
[2025-03-27 17:28:43,144] [INFO] [config.py:1005:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2025-03-27 17:28:43,144] [INFO] [config.py:1005:print]   optimizer_legacy_fusion ...... False
[2025-03-27 17:28:43,144] [INFO] [config.py:1005:print]   optimizer_name ............... adamw
[2025-03-27 17:28:43,144] [INFO] [config.py:1005:print]   optimizer_params ............. {'lr': 0.0002, 'weight_decay': 0.01}
[2025-03-27 17:28:43,144] [INFO] [config.py:1005:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2025-03-27 17:28:43,144] [INFO] [config.py:1005:print]   pld_enabled .................. False
[2025-03-27 17:28:43,144] [INFO] [config.py:1005:print]   pld_params ................... False
[2025-03-27 17:28:43,144] [INFO] [config.py:1005:print]   prescale_gradients ........... False
[2025-03-27 17:28:43,144] [INFO] [config.py:1005:print]   scheduler_name ............... None
[2025-03-27 17:28:43,144] [INFO] [config.py:1005:print]   scheduler_params ............. None
[2025-03-27 17:28:43,144] [INFO] [config.py:1005:print]   seq_parallel_communication_data_type  torch.float32
[2025-03-27 17:28:43,144] [INFO] [config.py:1005:print]   sparse_attention ............. None
[2025-03-27 17:28:43,144] [INFO] [config.py:1005:print]   sparse_gradients_enabled ..... False
[2025-03-27 17:28:43,145] [INFO] [config.py:1005:print]   steps_per_print .............. 50
[2025-03-27 17:28:43,145] [INFO] [config.py:1005:print]   tensor_parallel_config ....... dtype=torch.float16 autotp_size=0 tensor_parallel=TPConfig(tp_size=1, tp_grain_size=1, mpu=None, tp_group=None) injection_policy_tuple=None keep_module_on_host=False replace_with_kernel_inject=False
[2025-03-27 17:28:43,145] [INFO] [config.py:1005:print]   timers_config ................ enabled=True synchronized=True
[2025-03-27 17:28:43,145] [INFO] [config.py:1005:print]   train_batch_size ............. 1
[2025-03-27 17:28:43,145] [INFO] [config.py:1005:print]   train_micro_batch_size_per_gpu  1
[2025-03-27 17:28:43,145] [INFO] [config.py:1005:print]   use_data_before_expert_parallel_  False
[2025-03-27 17:28:43,145] [INFO] [config.py:1005:print]   use_node_local_storage ....... False
[2025-03-27 17:28:43,145] [INFO] [config.py:1005:print]   wall_clock_breakdown ......... False
[2025-03-27 17:28:43,145] [INFO] [config.py:1005:print]   weight_quantization_config ... None
[2025-03-27 17:28:43,145] [INFO] [config.py:1005:print]   world_size ................... 1
[2025-03-27 17:28:43,145] [INFO] [config.py:1005:print]   zero_allow_untested_optimizer  False
[2025-03-27 17:28:43,145] [INFO] [config.py:1005:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=500000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50000000 param_persistence_threshold=100000 model_persistence_threshold=9223372036854775807 max_live_parameters=1000000000 max_reuse_distance=1000000000 gather_16bit_weights_on_model_save=False module_granularity_threshold=0 use_all_reduce_for_fetch_params=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False zeropp_loco_param=None mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True log_trace_cache_warnings=False
[2025-03-27 17:28:43,145] [INFO] [config.py:1005:print]   zero_enabled ................. True
[2025-03-27 17:28:43,145] [INFO] [config.py:1005:print]   zero_force_ds_cpu_optimizer .. True
[2025-03-27 17:28:43,145] [INFO] [config.py:1005:print]   zero_optimization_stage ...... 2
[2025-03-27 17:28:43,145] [INFO] [config.py:991:print_user_config]   json = {
    "train_batch_size": 1, 
    "gradient_accumulation_steps": 1, 
    "optimizer": {
        "type": "AdamW", 
        "params": {
            "lr": 0.0002, 
            "weight_decay": 0.01
        }
    }, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "loss_scale_window": 1000
    }, 
    "zero_optimization": {
        "stage": 2, 
        "contiguous_gradients": true, 
        "overlap_comm": true
    }, 
    "steps_per_print": 50, 
    "gradient_clipping": 1.0
}
****START TRAINING****
image_size: 64, batch_size: 1, timesteps: 100, time_emb_dim: 32
  0%|                                                                                                               | 0/13 [00:00<?, ?it/s]----****images_shape****---- torch.Size([1, 1, 64, 64])
  0%|                                                                                                               | 0/13 [00:00<?, ?it/s]
[rank0]: Traceback (most recent call last):
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/main.py", line 9, in <module>
[rank0]:     train_deepspeed(cfg)
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/train.py", line 155, in train_deepspeed
[rank0]:     noisy_images, noise = model.forward_diffusion(
[rank0]:                           ^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/moe_diffusion.py", line 50, in forward_diffusion
[rank0]:     t_proj.unsqueeze(1).expand(-1, C*H*W // self.hidden_dim, -1).reshape(B, -1)
[rank0]:                                             ^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1928, in __getattr__
[rank0]:     raise AttributeError(
[rank0]: AttributeError: 'GaussianMoEDiffusion' object has no attribute 'hidden_dim'
[rank0]:[W327 17:28:44.347425805 ProcessGroupNCCL.cpp:1496] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[2025-03-27 17:28:45,146] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 500717
[2025-03-27 17:28:45,147] [ERROR] [launch.py:325:sigkill_handler] ['/hpc2hdd/home/yli045/.conda/envs/ywj/bin/python', '-u', 'main.py', '--local_rank=0', '--image_size', '64', '--batch_size', '1', '--num_epochs', '20', '--timesteps', '100', '--lr', '2e-4', '--time_emb_dim', '32', '--mu1', '4', '--sigma1', '1', '--num1', '900', '--mu2', '10', '--sigma2', '4', '--num2', '100', '--samples_dir', './samples', '--checkpoints_dir', './checkpoints', '--fp16', '--mode', 'train', '--model_path', '', '--num_images', '1000', '--simulation_distribution', 'normal', '--use_different_noise', '--use_moe', '--num_experts', '2', '--moe_hidden_dim', '2', '--moe_tau', '0.1'] exits with return code = 1
[?2004h(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ bash scripts/script_normal_dif_test.sh 
[?2004l[2025-03-27 17:31:16,036] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-27 17:31:16,044] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-27 17:31:18,930] [WARNING] [runner.py:215:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2025-03-27 17:31:18,932] [INFO] [runner.py:607:main] cmd = /hpc2hdd/home/yli045/.conda/envs/ywj/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None main.py --image_size 64 --batch_size 1 --num_epochs 20 --timesteps 100 --lr 2e-4 --time_emb_dim 32 --mu1 4 --sigma1 1 --num1 900 --mu2 10 --sigma2 4 --num2 100 --samples_dir ./samples --checkpoints_dir ./checkpoints --fp16 --mode train --model_path  --num_images 1000 --simulation_distribution normal --use_different_noise --use_moe --num_experts 2 --moe_hidden_dim 2 --moe_tau 0.1
[2025-03-27 17:31:21,779] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-27 17:31:21,787] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-27 17:31:22,952] [INFO] [launch.py:146:main] WORLD INFO DICT: {'localhost': [0]}
[2025-03-27 17:31:22,952] [INFO] [launch.py:152:main] nnodes=1, num_local_procs=1, node_rank=0
[2025-03-27 17:31:22,952] [INFO] [launch.py:163:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2025-03-27 17:31:22,952] [INFO] [launch.py:164:main] dist_world_size=1
[2025-03-27 17:31:22,952] [INFO] [launch.py:168:main] Setting CUDA_VISIBLE_DEVICES=0
[2025-03-27 17:31:22,953] [INFO] [launch.py:256:main] process 501632 spawned with command: ['/hpc2hdd/home/yli045/.conda/envs/ywj/bin/python', '-u', 'main.py', '--local_rank=0', '--image_size', '64', '--batch_size', '1', '--num_epochs', '20', '--timesteps', '100', '--lr', '2e-4', '--time_emb_dim', '32', '--mu1', '4', '--sigma1', '1', '--num1', '900', '--mu2', '10', '--sigma2', '4', '--num2', '100', '--samples_dir', './samples', '--checkpoints_dir', './checkpoints', '--fp16', '--mode', 'train', '--model_path', '', '--num_images', '1000', '--simulation_distribution', 'normal', '--use_different_noise', '--use_moe', '--num_experts', '2', '--moe_hidden_dim', '2', '--moe_tau', '0.1']
[2025-03-27 17:31:46,019] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-03-27 17:32:36,474] [INFO] [logging.py:128:log_dist] [Rank -1] DeepSpeed info: version=0.16.4, git-hash=unknown, git-branch=unknown
[2025-03-27 17:32:36,475] [INFO] [comm.py:658:init_distributed] cdb=None
[2025-03-27 17:32:36,475] [INFO] [comm.py:689:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2025-03-27 17:32:36,480] [INFO] [config.py:734:__init__] Config mesh_device None world_size = 1
[2025-03-27 17:32:44,714] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
Using /hpc2hdd/home/yli045/.cache/torch_extensions/py312_cu124 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /hpc2hdd/home/yli045/.cache/torch_extensions/py312_cu124/fused_adam/build.ninja...
/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/utils/cpp_extension.py:2059: UserWarning: TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation. 
If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'].
  warnings.warn(
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 2.53647518157959 seconds
[2025-03-27 17:32:47,256] [INFO] [logging.py:128:log_dist] [Rank 0] Using DeepSpeed Optimizer param name adamw as basic optimizer
[2025-03-27 17:32:47,256] [INFO] [logging.py:128:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2025-03-27 17:32:47,261] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Basic Optimizer = FusedAdam
[2025-03-27 17:32:47,261] [INFO] [utils.py:59:is_zero_supported_optimizer] Checking ZeRO support for optimizer=FusedAdam type=<class 'deepspeed.ops.adam.fused_adam.FusedAdam'>
[2025-03-27 17:32:47,261] [INFO] [logging.py:128:log_dist] [Rank 0] Creating torch.float16 ZeRO stage 2 optimizer
[2025-03-27 17:32:47,262] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 500000000
[2025-03-27 17:32:47,262] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 500000000
[2025-03-27 17:32:47,262] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2025-03-27 17:32:47,262] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2025-03-27 17:32:52,957] [INFO] [utils.py:781:see_memory_usage] Before initializing optimizer states
[2025-03-27 17:32:52,958] [INFO] [utils.py:782:see_memory_usage] MA 0.11 GB         Max_MA 0.15 GB         CA 0.16 GB         Max_CA 0 GB 
[2025-03-27 17:32:52,958] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 211.25 GB, percent = 21.0%
[2025-03-27 17:32:53,288] [INFO] [utils.py:781:see_memory_usage] After initializing optimizer states
[2025-03-27 17:32:53,288] [INFO] [utils.py:782:see_memory_usage] MA 0.11 GB         Max_MA 0.19 GB         CA 0.23 GB         Max_CA 0 GB 
[2025-03-27 17:32:53,289] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 211.64 GB, percent = 21.0%
[2025-03-27 17:32:53,289] [INFO] [stage_1_and_2.py:550:__init__] optimizer state initialized
[2025-03-27 17:32:53,425] [INFO] [utils.py:781:see_memory_usage] After initializing ZeRO optimizer
[2025-03-27 17:32:53,426] [INFO] [utils.py:782:see_memory_usage] MA 0.11 GB         Max_MA 0.11 GB         CA 0.23 GB         Max_CA 0 GB 
[2025-03-27 17:32:53,426] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 211.37 GB, percent = 21.0%
[2025-03-27 17:32:53,428] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Final Optimizer = DeepSpeedZeroOptimizer
[2025-03-27 17:32:53,428] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed using configured LR scheduler = None
[2025-03-27 17:32:53,428] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2025-03-27 17:32:53,428] [INFO] [logging.py:128:log_dist] [Rank 0] step=0, skipped=0, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-27 17:32:53,428] [INFO] [config.py:1001:print] DeepSpeedEngine configuration:
[2025-03-27 17:32:53,429] [INFO] [config.py:1005:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2025-03-27 17:32:53,429] [INFO] [config.py:1005:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'intra_op_parallelism': 1, 'single_submit': False, 'overlap_events': True, 'use_gds': False}
[2025-03-27 17:32:53,429] [INFO] [config.py:1005:print]   amp_enabled .................. False
[2025-03-27 17:32:53,429] [INFO] [config.py:1005:print]   amp_params ................... False
[2025-03-27 17:32:53,429] [INFO] [config.py:1005:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2025-03-27 17:32:53,429] [INFO] [config.py:1005:print]   bfloat16_enabled ............. False
[2025-03-27 17:32:53,429] [INFO] [config.py:1005:print]   bfloat16_immediate_grad_update  False
[2025-03-27 17:32:53,429] [INFO] [config.py:1005:print]   checkpoint_parallel_write_pipeline  False
[2025-03-27 17:32:53,429] [INFO] [config.py:1005:print]   checkpoint_tag_validation_enabled  True
[2025-03-27 17:32:53,429] [INFO] [config.py:1005:print]   checkpoint_tag_validation_fail  False
[2025-03-27 17:32:53,429] [INFO] [config.py:1005:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fb7f279e360>
[2025-03-27 17:32:53,429] [INFO] [config.py:1005:print]   communication_data_type ...... None
[2025-03-27 17:32:53,429] [INFO] [config.py:1005:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2025-03-27 17:32:53,430] [INFO] [config.py:1005:print]   curriculum_enabled_legacy .... False
[2025-03-27 17:32:53,430] [INFO] [config.py:1005:print]   curriculum_params_legacy ..... False
[2025-03-27 17:32:53,430] [INFO] [config.py:1005:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2025-03-27 17:32:53,430] [INFO] [config.py:1005:print]   data_efficiency_enabled ...... False
[2025-03-27 17:32:53,430] [INFO] [config.py:1005:print]   dataloader_drop_last ......... False
[2025-03-27 17:32:53,430] [INFO] [config.py:1005:print]   disable_allgather ............ False
[2025-03-27 17:32:53,430] [INFO] [config.py:1005:print]   dump_state ................... False
[2025-03-27 17:32:53,430] [INFO] [config.py:1005:print]   dynamic_loss_scale_args ...... {'init_scale': 65536, 'scale_window': 1000, 'delayed_shift': 2, 'consecutive_hysteresis': False, 'min_scale': 1}
[2025-03-27 17:32:53,430] [INFO] [config.py:1005:print]   eigenvalue_enabled ........... False
[2025-03-27 17:32:53,430] [INFO] [config.py:1005:print]   eigenvalue_gas_boundary_resolution  1
[2025-03-27 17:32:53,430] [INFO] [config.py:1005:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2025-03-27 17:32:53,430] [INFO] [config.py:1005:print]   eigenvalue_layer_num ......... 0
[2025-03-27 17:32:53,430] [INFO] [config.py:1005:print]   eigenvalue_max_iter .......... 100
[2025-03-27 17:32:53,430] [INFO] [config.py:1005:print]   eigenvalue_stability ......... 1e-06
[2025-03-27 17:32:53,430] [INFO] [config.py:1005:print]   eigenvalue_tol ............... 0.01
[2025-03-27 17:32:53,430] [INFO] [config.py:1005:print]   eigenvalue_verbose ........... False
[2025-03-27 17:32:53,430] [INFO] [config.py:1005:print]   elasticity_enabled ........... False
[2025-03-27 17:32:53,430] [INFO] [config.py:1005:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2025-03-27 17:32:53,430] [INFO] [config.py:1005:print]   fp16_auto_cast ............... False
[2025-03-27 17:32:53,430] [INFO] [config.py:1005:print]   fp16_enabled ................. True
[2025-03-27 17:32:53,430] [INFO] [config.py:1005:print]   fp16_master_weights_and_gradients  False
[2025-03-27 17:32:53,430] [INFO] [config.py:1005:print]   global_rank .................. 0
[2025-03-27 17:32:53,430] [INFO] [config.py:1005:print]   grad_accum_dtype ............. None
[2025-03-27 17:32:53,430] [INFO] [config.py:1005:print]   gradient_accumulation_steps .. 1
[2025-03-27 17:32:53,430] [INFO] [config.py:1005:print]   gradient_clipping ............ 1.0
[2025-03-27 17:32:53,430] [INFO] [config.py:1005:print]   gradient_predivide_factor .... 1.0
[2025-03-27 17:32:53,431] [INFO] [config.py:1005:print]   graph_harvesting ............. False
[2025-03-27 17:32:53,431] [INFO] [config.py:1005:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2025-03-27 17:32:53,431] [INFO] [config.py:1005:print]   initial_dynamic_scale ........ 65536
[2025-03-27 17:32:53,431] [INFO] [config.py:1005:print]   load_universal_checkpoint .... False
[2025-03-27 17:32:53,431] [INFO] [config.py:1005:print]   loss_scale ................... 0
[2025-03-27 17:32:53,431] [INFO] [config.py:1005:print]   memory_breakdown ............. False
[2025-03-27 17:32:53,431] [INFO] [config.py:1005:print]   mics_hierarchial_params_gather  False
[2025-03-27 17:32:53,431] [INFO] [config.py:1005:print]   mics_shard_size .............. -1
[2025-03-27 17:32:53,431] [INFO] [config.py:1005:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') comet=CometConfig(enabled=False, samples_log_interval=100, project=None, workspace=None, api_key=None, experiment_name=None, experiment_key=None, online=None, mode=None) wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName')
[2025-03-27 17:32:53,431] [INFO] [config.py:1005:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2025-03-27 17:32:53,431] [INFO] [config.py:1005:print]   optimizer_legacy_fusion ...... False
[2025-03-27 17:32:53,431] [INFO] [config.py:1005:print]   optimizer_name ............... adamw
[2025-03-27 17:32:53,431] [INFO] [config.py:1005:print]   optimizer_params ............. {'lr': 0.0002, 'weight_decay': 0.01}
[2025-03-27 17:32:53,431] [INFO] [config.py:1005:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2025-03-27 17:32:53,431] [INFO] [config.py:1005:print]   pld_enabled .................. False
[2025-03-27 17:32:53,431] [INFO] [config.py:1005:print]   pld_params ................... False
[2025-03-27 17:32:53,431] [INFO] [config.py:1005:print]   prescale_gradients ........... False
[2025-03-27 17:32:53,431] [INFO] [config.py:1005:print]   scheduler_name ............... None
[2025-03-27 17:32:53,431] [INFO] [config.py:1005:print]   scheduler_params ............. None
[2025-03-27 17:32:53,431] [INFO] [config.py:1005:print]   seq_parallel_communication_data_type  torch.float32
[2025-03-27 17:32:53,431] [INFO] [config.py:1005:print]   sparse_attention ............. None
[2025-03-27 17:32:53,431] [INFO] [config.py:1005:print]   sparse_gradients_enabled ..... False
[2025-03-27 17:32:53,431] [INFO] [config.py:1005:print]   steps_per_print .............. 50
[2025-03-27 17:32:53,432] [INFO] [config.py:1005:print]   tensor_parallel_config ....... dtype=torch.float16 autotp_size=0 tensor_parallel=TPConfig(tp_size=1, tp_grain_size=1, mpu=None, tp_group=None) injection_policy_tuple=None keep_module_on_host=False replace_with_kernel_inject=False
[2025-03-27 17:32:53,432] [INFO] [config.py:1005:print]   timers_config ................ enabled=True synchronized=True
[2025-03-27 17:32:53,432] [INFO] [config.py:1005:print]   train_batch_size ............. 1
[2025-03-27 17:32:53,432] [INFO] [config.py:1005:print]   train_micro_batch_size_per_gpu  1
[2025-03-27 17:32:53,432] [INFO] [config.py:1005:print]   use_data_before_expert_parallel_  False
[2025-03-27 17:32:53,432] [INFO] [config.py:1005:print]   use_node_local_storage ....... False
[2025-03-27 17:32:53,432] [INFO] [config.py:1005:print]   wall_clock_breakdown ......... False
[2025-03-27 17:32:53,432] [INFO] [config.py:1005:print]   weight_quantization_config ... None
[2025-03-27 17:32:53,432] [INFO] [config.py:1005:print]   world_size ................... 1
[2025-03-27 17:32:53,432] [INFO] [config.py:1005:print]   zero_allow_untested_optimizer  False
[2025-03-27 17:32:53,432] [INFO] [config.py:1005:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=500000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50000000 param_persistence_threshold=100000 model_persistence_threshold=9223372036854775807 max_live_parameters=1000000000 max_reuse_distance=1000000000 gather_16bit_weights_on_model_save=False module_granularity_threshold=0 use_all_reduce_for_fetch_params=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False zeropp_loco_param=None mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True log_trace_cache_warnings=False
[2025-03-27 17:32:53,432] [INFO] [config.py:1005:print]   zero_enabled ................. True
[2025-03-27 17:32:53,432] [INFO] [config.py:1005:print]   zero_force_ds_cpu_optimizer .. True
[2025-03-27 17:32:53,432] [INFO] [config.py:1005:print]   zero_optimization_stage ...... 2
[2025-03-27 17:32:53,432] [INFO] [config.py:991:print_user_config]   json = {
    "train_batch_size": 1, 
    "gradient_accumulation_steps": 1, 
    "optimizer": {
        "type": "AdamW", 
        "params": {
            "lr": 0.0002, 
            "weight_decay": 0.01
        }
    }, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "loss_scale_window": 1000
    }, 
    "zero_optimization": {
        "stage": 2, 
        "contiguous_gradients": true, 
        "overlap_comm": true
    }, 
    "steps_per_print": 50, 
    "gradient_clipping": 1.0
}
****START TRAINING****
image_size: 64, batch_size: 1, timesteps: 100, time_emb_dim: 32
  0%|                                                                                                               | 0/13 [00:00<?, ?it/s]----****images_shape****---- torch.Size([1, 1, 64, 64])
  0%|                                                                                                               | 0/13 [00:00<?, ?it/s]
[rank0]: Traceback (most recent call last):
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/main.py", line 9, in <module>
[rank0]:     train_deepspeed(cfg)
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/train.py", line 155, in train_deepspeed
[rank0]:     noisy_images, noise = model.forward_diffusion(
[rank0]:                           ^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/moe_diffusion.py", line 59, in forward_diffusion
[rank0]:     dynamic_noise = self.noise_moe(moe_input).view(B, C, H, W)
[rank0]:                     ^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/reparam_moe.py", line 54, in forward
[rank0]:     assert x.shape[-1] == self.input_dim, f"Input last dim must be {self.input_dim}, got {x.shape[-1]}"
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]: AssertionError: Input last dim must be 12288, got 8192
[rank0]:[W327 17:32:54.515004768 ProcessGroupNCCL.cpp:1496] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[2025-03-27 17:32:56,140] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 501632
[2025-03-27 17:32:56,141] [ERROR] [launch.py:325:sigkill_handler] ['/hpc2hdd/home/yli045/.conda/envs/ywj/bin/python', '-u', 'main.py', '--local_rank=0', '--image_size', '64', '--batch_size', '1', '--num_epochs', '20', '--timesteps', '100', '--lr', '2e-4', '--time_emb_dim', '32', '--mu1', '4', '--sigma1', '1', '--num1', '900', '--mu2', '10', '--sigma2', '4', '--num2', '100', '--samples_dir', './samples', '--checkpoints_dir', './checkpoints', '--fp16', '--mode', 'train', '--model_path', '', '--num_images', '1000', '--simulation_distribution', 'normal', '--use_different_noise', '--use_moe', '--num_experts', '2', '--moe_hidden_dim', '2', '--moe_tau', '0.1'] exits with return code = 1
[?2004h(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ 产品。[K[K[Kcp ../diffusion_noise/test.py ./
[?2004lcp: cannot stat '../diffusion_noise/test.py': No such file or directory
[?2004h(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ cp ../diffusion_noise/test.py ./[1@a[1@r[6@chive/
[?2004lcp: cannot stat '../diffusion_noise/archive/test.py': No such file or directory
[?2004h(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ ../[K[K[Kcp ../df[Kiffusion_noise/archive/core_1/test.py ./
[?2004l[?2004h(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ cp ../df[Kiffusion_noise/train.py ./
[?2004l[?2004h(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ cp ../diffusion_noise/train.py ./[Kbash scripts/script_normal_dif_test.sh 
[?2004l[2025-03-28 00:20:28,983] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-28 00:20:28,991] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-28 00:20:37,685] [WARNING] [runner.py:215:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2025-03-28 00:20:37,687] [INFO] [runner.py:607:main] cmd = /hpc2hdd/home/yli045/.conda/envs/ywj/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None main.py --image_size 64 --batch_size 1 --num_epochs 20 --timesteps 100 --lr 2e-4 --time_emb_dim 32 --mu1 4 --sigma1 1 --num1 900 --mu2 10 --sigma2 4 --num2 100 --samples_dir ./samples --checkpoints_dir ./checkpoints --fp16 --mode train --model_path  --num_images 1000 --simulation_distribution normal --use_different_noise --use_moe --num_experts 2 --moe_hidden_dim 2 --moe_tau 0.1
[2025-03-28 00:20:53,934] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-28 00:20:53,942] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-28 00:20:58,640] [INFO] [launch.py:146:main] WORLD INFO DICT: {'localhost': [0]}
[2025-03-28 00:20:58,641] [INFO] [launch.py:152:main] nnodes=1, num_local_procs=1, node_rank=0
[2025-03-28 00:20:58,641] [INFO] [launch.py:163:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2025-03-28 00:20:58,641] [INFO] [launch.py:164:main] dist_world_size=1
[2025-03-28 00:20:58,641] [INFO] [launch.py:168:main] Setting CUDA_VISIBLE_DEVICES=0
[2025-03-28 00:20:58,685] [INFO] [launch.py:256:main] process 563541 spawned with command: ['/hpc2hdd/home/yli045/.conda/envs/ywj/bin/python', '-u', 'main.py', '--local_rank=0', '--image_size', '64', '--batch_size', '1', '--num_epochs', '20', '--timesteps', '100', '--lr', '2e-4', '--time_emb_dim', '32', '--mu1', '4', '--sigma1', '1', '--num1', '900', '--mu2', '10', '--sigma2', '4', '--num2', '100', '--samples_dir', './samples', '--checkpoints_dir', './checkpoints', '--fp16', '--mode', 'train', '--model_path', '', '--num_images', '1000', '--simulation_distribution', 'normal', '--use_different_noise', '--use_moe', '--num_experts', '2', '--moe_hidden_dim', '2', '--moe_tau', '0.1']
[2025-03-28 00:21:14,360] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-03-28 00:21:45,381] [INFO] [logging.py:128:log_dist] [Rank -1] DeepSpeed info: version=0.16.4, git-hash=unknown, git-branch=unknown
[2025-03-28 00:21:45,382] [INFO] [comm.py:658:init_distributed] cdb=None
[2025-03-28 00:21:45,382] [INFO] [comm.py:689:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2025-03-28 00:21:45,443] [INFO] [config.py:734:__init__] Config mesh_device None world_size = 1
[2025-03-28 00:21:50,282] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
Using /hpc2hdd/home/yli045/.cache/torch_extensions/py312_cu124 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /hpc2hdd/home/yli045/.cache/torch_extensions/py312_cu124/fused_adam/build.ninja...
/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/utils/cpp_extension.py:2059: UserWarning: TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation. 
If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'].
  warnings.warn(
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 0.3183774948120117 seconds
[2025-03-28 00:21:50,609] [INFO] [logging.py:128:log_dist] [Rank 0] Using DeepSpeed Optimizer param name adamw as basic optimizer
[2025-03-28 00:21:50,610] [INFO] [logging.py:128:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2025-03-28 00:21:50,612] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Basic Optimizer = FusedAdam
[2025-03-28 00:21:50,612] [INFO] [utils.py:59:is_zero_supported_optimizer] Checking ZeRO support for optimizer=FusedAdam type=<class 'deepspeed.ops.adam.fused_adam.FusedAdam'>
[2025-03-28 00:21:50,612] [INFO] [logging.py:128:log_dist] [Rank 0] Creating torch.float16 ZeRO stage 2 optimizer
[2025-03-28 00:21:50,613] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 500000000
[2025-03-28 00:21:50,613] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 500000000
[2025-03-28 00:21:50,613] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2025-03-28 00:21:50,613] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2025-03-28 00:21:52,953] [INFO] [utils.py:781:see_memory_usage] Before initializing optimizer states
[2025-03-28 00:21:52,954] [INFO] [utils.py:782:see_memory_usage] MA 0.04 GB         Max_MA 0.05 GB         CA 0.05 GB         Max_CA 0 GB 
[2025-03-28 00:21:52,954] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 136.56 GB, percent = 13.6%
[2025-03-28 00:21:53,063] [INFO] [utils.py:781:see_memory_usage] After initializing optimizer states
[2025-03-28 00:21:53,063] [INFO] [utils.py:782:see_memory_usage] MA 0.04 GB         Max_MA 0.06 GB         CA 0.08 GB         Max_CA 0 GB 
[2025-03-28 00:21:53,064] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 136.79 GB, percent = 13.6%
[2025-03-28 00:21:53,064] [INFO] [stage_1_and_2.py:550:__init__] optimizer state initialized
[2025-03-28 00:21:53,167] [INFO] [utils.py:781:see_memory_usage] After initializing ZeRO optimizer
[2025-03-28 00:21:53,168] [INFO] [utils.py:782:see_memory_usage] MA 0.04 GB         Max_MA 0.04 GB         CA 0.08 GB         Max_CA 0 GB 
[2025-03-28 00:21:53,168] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 136.86 GB, percent = 13.6%
[2025-03-28 00:21:53,169] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Final Optimizer = DeepSpeedZeroOptimizer
[2025-03-28 00:21:53,169] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed using configured LR scheduler = None
[2025-03-28 00:21:53,169] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2025-03-28 00:21:53,170] [INFO] [logging.py:128:log_dist] [Rank 0] step=0, skipped=0, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 00:21:53,170] [INFO] [config.py:1001:print] DeepSpeedEngine configuration:
[2025-03-28 00:21:53,170] [INFO] [config.py:1005:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2025-03-28 00:21:53,170] [INFO] [config.py:1005:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'intra_op_parallelism': 1, 'single_submit': False, 'overlap_events': True, 'use_gds': False}
[2025-03-28 00:21:53,170] [INFO] [config.py:1005:print]   amp_enabled .................. False
[2025-03-28 00:21:53,170] [INFO] [config.py:1005:print]   amp_params ................... False
[2025-03-28 00:21:53,170] [INFO] [config.py:1005:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2025-03-28 00:21:53,171] [INFO] [config.py:1005:print]   bfloat16_enabled ............. False
[2025-03-28 00:21:53,171] [INFO] [config.py:1005:print]   bfloat16_immediate_grad_update  False
[2025-03-28 00:21:53,171] [INFO] [config.py:1005:print]   checkpoint_parallel_write_pipeline  False
[2025-03-28 00:21:53,171] [INFO] [config.py:1005:print]   checkpoint_tag_validation_enabled  True
[2025-03-28 00:21:53,171] [INFO] [config.py:1005:print]   checkpoint_tag_validation_fail  False
[2025-03-28 00:21:53,171] [INFO] [config.py:1005:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7ff0fc585d60>
[2025-03-28 00:21:53,171] [INFO] [config.py:1005:print]   communication_data_type ...... None
[2025-03-28 00:21:53,171] [INFO] [config.py:1005:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2025-03-28 00:21:53,171] [INFO] [config.py:1005:print]   curriculum_enabled_legacy .... False
[2025-03-28 00:21:53,171] [INFO] [config.py:1005:print]   curriculum_params_legacy ..... False
[2025-03-28 00:21:53,171] [INFO] [config.py:1005:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2025-03-28 00:21:53,171] [INFO] [config.py:1005:print]   data_efficiency_enabled ...... False
[2025-03-28 00:21:53,171] [INFO] [config.py:1005:print]   dataloader_drop_last ......... False
[2025-03-28 00:21:53,171] [INFO] [config.py:1005:print]   disable_allgather ............ False
[2025-03-28 00:21:53,171] [INFO] [config.py:1005:print]   dump_state ................... False
[2025-03-28 00:21:53,171] [INFO] [config.py:1005:print]   dynamic_loss_scale_args ...... {'init_scale': 65536, 'scale_window': 1000, 'delayed_shift': 2, 'consecutive_hysteresis': False, 'min_scale': 1}
[2025-03-28 00:21:53,171] [INFO] [config.py:1005:print]   eigenvalue_enabled ........... False
[2025-03-28 00:21:53,171] [INFO] [config.py:1005:print]   eigenvalue_gas_boundary_resolution  1
[2025-03-28 00:21:53,171] [INFO] [config.py:1005:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2025-03-28 00:21:53,171] [INFO] [config.py:1005:print]   eigenvalue_layer_num ......... 0
[2025-03-28 00:21:53,171] [INFO] [config.py:1005:print]   eigenvalue_max_iter .......... 100
[2025-03-28 00:21:53,171] [INFO] [config.py:1005:print]   eigenvalue_stability ......... 1e-06
[2025-03-28 00:21:53,171] [INFO] [config.py:1005:print]   eigenvalue_tol ............... 0.01
[2025-03-28 00:21:53,171] [INFO] [config.py:1005:print]   eigenvalue_verbose ........... False
[2025-03-28 00:21:53,171] [INFO] [config.py:1005:print]   elasticity_enabled ........... False
[2025-03-28 00:21:53,172] [INFO] [config.py:1005:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2025-03-28 00:21:53,172] [INFO] [config.py:1005:print]   fp16_auto_cast ............... False
[2025-03-28 00:21:53,172] [INFO] [config.py:1005:print]   fp16_enabled ................. True
[2025-03-28 00:21:53,172] [INFO] [config.py:1005:print]   fp16_master_weights_and_gradients  False
[2025-03-28 00:21:53,172] [INFO] [config.py:1005:print]   global_rank .................. 0
[2025-03-28 00:21:53,172] [INFO] [config.py:1005:print]   grad_accum_dtype ............. None
[2025-03-28 00:21:53,172] [INFO] [config.py:1005:print]   gradient_accumulation_steps .. 1
[2025-03-28 00:21:53,172] [INFO] [config.py:1005:print]   gradient_clipping ............ 1.0
[2025-03-28 00:21:53,172] [INFO] [config.py:1005:print]   gradient_predivide_factor .... 1.0
[2025-03-28 00:21:53,172] [INFO] [config.py:1005:print]   graph_harvesting ............. False
[2025-03-28 00:21:53,172] [INFO] [config.py:1005:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2025-03-28 00:21:53,172] [INFO] [config.py:1005:print]   initial_dynamic_scale ........ 65536
[2025-03-28 00:21:53,172] [INFO] [config.py:1005:print]   load_universal_checkpoint .... False
[2025-03-28 00:21:53,172] [INFO] [config.py:1005:print]   loss_scale ................... 0
[2025-03-28 00:21:53,172] [INFO] [config.py:1005:print]   memory_breakdown ............. False
[2025-03-28 00:21:53,172] [INFO] [config.py:1005:print]   mics_hierarchial_params_gather  False
[2025-03-28 00:21:53,172] [INFO] [config.py:1005:print]   mics_shard_size .............. -1
[2025-03-28 00:21:53,172] [INFO] [config.py:1005:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') comet=CometConfig(enabled=False, samples_log_interval=100, project=None, workspace=None, api_key=None, experiment_name=None, experiment_key=None, online=None, mode=None) wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName')
[2025-03-28 00:21:53,172] [INFO] [config.py:1005:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2025-03-28 00:21:53,172] [INFO] [config.py:1005:print]   optimizer_legacy_fusion ...... False
[2025-03-28 00:21:53,172] [INFO] [config.py:1005:print]   optimizer_name ............... adamw
[2025-03-28 00:21:53,172] [INFO] [config.py:1005:print]   optimizer_params ............. {'lr': 0.0002, 'weight_decay': 0.01}
[2025-03-28 00:21:53,172] [INFO] [config.py:1005:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2025-03-28 00:21:53,173] [INFO] [config.py:1005:print]   pld_enabled .................. False
[2025-03-28 00:21:53,173] [INFO] [config.py:1005:print]   pld_params ................... False
[2025-03-28 00:21:53,173] [INFO] [config.py:1005:print]   prescale_gradients ........... False
[2025-03-28 00:21:53,173] [INFO] [config.py:1005:print]   scheduler_name ............... None
[2025-03-28 00:21:53,173] [INFO] [config.py:1005:print]   scheduler_params ............. None
[2025-03-28 00:21:53,173] [INFO] [config.py:1005:print]   seq_parallel_communication_data_type  torch.float32
[2025-03-28 00:21:53,173] [INFO] [config.py:1005:print]   sparse_attention ............. None
[2025-03-28 00:21:53,173] [INFO] [config.py:1005:print]   sparse_gradients_enabled ..... False
[2025-03-28 00:21:53,173] [INFO] [config.py:1005:print]   steps_per_print .............. 50
[2025-03-28 00:21:53,173] [INFO] [config.py:1005:print]   tensor_parallel_config ....... dtype=torch.float16 autotp_size=0 tensor_parallel=TPConfig(tp_size=1, tp_grain_size=1, mpu=None, tp_group=None) injection_policy_tuple=None keep_module_on_host=False replace_with_kernel_inject=False
[2025-03-28 00:21:53,173] [INFO] [config.py:1005:print]   timers_config ................ enabled=True synchronized=True
[2025-03-28 00:21:53,173] [INFO] [config.py:1005:print]   train_batch_size ............. 1
[2025-03-28 00:21:53,173] [INFO] [config.py:1005:print]   train_micro_batch_size_per_gpu  1
[2025-03-28 00:21:53,173] [INFO] [config.py:1005:print]   use_data_before_expert_parallel_  False
[2025-03-28 00:21:53,173] [INFO] [config.py:1005:print]   use_node_local_storage ....... False
[2025-03-28 00:21:53,173] [INFO] [config.py:1005:print]   wall_clock_breakdown ......... False
[2025-03-28 00:21:53,173] [INFO] [config.py:1005:print]   weight_quantization_config ... None
[2025-03-28 00:21:53,173] [INFO] [config.py:1005:print]   world_size ................... 1
[2025-03-28 00:21:53,173] [INFO] [config.py:1005:print]   zero_allow_untested_optimizer  False
[2025-03-28 00:21:53,173] [INFO] [config.py:1005:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=500000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50000000 param_persistence_threshold=100000 model_persistence_threshold=9223372036854775807 max_live_parameters=1000000000 max_reuse_distance=1000000000 gather_16bit_weights_on_model_save=False module_granularity_threshold=0 use_all_reduce_for_fetch_params=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False zeropp_loco_param=None mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True log_trace_cache_warnings=False
[2025-03-28 00:21:53,173] [INFO] [config.py:1005:print]   zero_enabled ................. True
[2025-03-28 00:21:53,173] [INFO] [config.py:1005:print]   zero_force_ds_cpu_optimizer .. True
[2025-03-28 00:21:53,173] [INFO] [config.py:1005:print]   zero_optimization_stage ...... 2
[2025-03-28 00:21:53,173] [INFO] [config.py:991:print_user_config]   json = {
    "train_batch_size": 1, 
    "gradient_accumulation_steps": 1, 
    "optimizer": {
        "type": "AdamW", 
        "params": {
            "lr": 0.0002, 
            "weight_decay": 0.01
        }
    }, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "loss_scale_window": 1000
    }, 
    "zero_optimization": {
        "stage": 2, 
        "contiguous_gradients": true, 
        "overlap_comm": true
    }, 
    "steps_per_print": 50, 
    "gradient_clipping": 1.0
}
****START TRAINING****
image_size: 64, batch_size: 1, timesteps: 100, time_emb_dim: 32
  0%|                                                                                                               | 0/13 [00:00<?, ?it/s][2025-03-28 00:21:58,589] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
  8%|███████▉                                                                                               | 1/13 [00:05<01:02,  5.23s/it][2025-03-28 00:21:58,630] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
 23%|███████████████████████▊                                                                               | 3/13 [00:05<00:14,  1.42s/it] 46%|███████████████████████████████████████████████▌                                                       | 6/13 [00:05<00:04,  1.74it/s] 69%|███████████████████████████████████████████████████████████████████████▎                               | 9/13 [00:05<00:01,  3.06it/s] 92%|██████████████████████████████████████████████████████████████████████████████████████████████▏       | 12/13 [00:05<00:00,  4.69it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:05<00:00,  2.21it/s]
/hpc2hdd/home/yli045/diffusion_noise_agent/train.py:189: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  df = pd.concat([df, pd.DataFrame([new_row])], ignore_index=True) # 使用 pd.concat 追加数据
  0%|                                                                                                               | 0/13 [00:00<?, ?it/s]  8%|███████▉                                                                                               | 1/13 [00:00<00:04,  2.96it/s] 23%|███████████████████████▊                                                                               | 3/13 [00:00<00:01,  7.95it/s] 46%|███████████████████████████████████████████████▌                                                       | 6/13 [00:00<00:00, 12.87it/s] 69%|███████████████████████████████████████████████████████████████████████▎                               | 9/13 [00:00<00:00, 16.12it/s] 92%|██████████████████████████████████████████████████████████████████████████████████████████████▏       | 12/13 [00:00<00:00, 18.11it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 13.80it/s]
  0%|                                                                                                               | 0/13 [00:00<?, ?it/s]  8%|███████▉                                                                                               | 1/13 [00:00<00:03,  3.61it/s] 31%|███████████████████████████████▋                                                                       | 4/13 [00:00<00:00, 10.74it/s] 54%|███████████████████████████████████████████████████████▍                                               | 7/13 [00:00<00:00, 14.76it/s] 77%|██████████████████████████████████████████████████████████████████████████████▍                       | 10/13 [00:00<00:00, 17.30it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 19.00it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 14.50it/s]
  0%|                                                                                                               | 0/13 [00:00<?, ?it/s]  8%|███████▉                                                                                               | 1/13 [00:00<00:02,  5.23it/s] 23%|███████████████████████▊                                                                               | 3/13 [00:00<00:00, 11.47it/s] 46%|███████████████████████████████████████████████▌                                                       | 6/13 [00:00<00:00, 16.70it/s] 69%|███████████████████████████████████████████████████████████████████████▎                               | 9/13 [00:00<00:00, 19.22it/s][2025-03-28 00:22:01,830] [INFO] [logging.py:128:log_dist] [Rank 0] step=50, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 00:22:01,831] [INFO] [timer.py:264:stop] epoch=0/micro_step=50/global_step=50, RunningAvgSamplesPerSec=17.454220107917507, CurrSamplesPerSec=24.84686072862086, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 92%|██████████████████████████████████████████████████████████████████████████████████████████████▏       | 12/13 [00:00<00:00, 20.99it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 16.56it/s]
  0%|                                                                                                               | 0/13 [00:00<?, ?it/s]  8%|███████▉                                                                                               | 1/13 [00:00<00:04,  2.79it/s] 31%|███████████████████████████████▋                                                                       | 4/13 [00:00<00:00,  9.32it/s] 54%|███████████████████████████████████████████████████████▍                                               | 7/13 [00:00<00:00, 13.45it/s] 69%|███████████████████████████████████████████████████████████████████████▎                               | 9/13 [00:00<00:00, 15.11it/s] 92%|██████████████████████████████████████████████████████████████████████████████████████████████▏       | 12/13 [00:00<00:00, 17.37it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 13.32it/s]
  0%|                                                                                                               | 0/13 [00:00<?, ?it/s]  8%|███████▉                                                                                               | 1/13 [00:00<00:02,  4.96it/s] 23%|███████████████████████▊                                                                               | 3/13 [00:00<00:00, 11.13it/s] 46%|███████████████████████████████████████████████▌                                                       | 6/13 [00:00<00:00, 15.92it/s] 69%|███████████████████████████████████████████████████████████████████████▎                               | 9/13 [00:00<00:00, 18.83it/s] 92%|██████████████████████████████████████████████████████████████████████████████████████████████▏       | 12/13 [00:00<00:00, 20.57it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 16.25it/s]
  0%|                                                                                                               | 0/13 [00:00<?, ?it/s]  8%|███████▉                                                                                               | 1/13 [00:00<00:02,  5.38it/s] 31%|███████████████████████████████▋                                                                       | 4/13 [00:00<00:00, 12.53it/s] 46%|███████████████████████████████████████████████▌                                                       | 6/13 [00:00<00:00, 14.67it/s] 69%|███████████████████████████████████████████████████████████████████████▎                               | 9/13 [00:00<00:00, 17.81it/s] 92%|██████████████████████████████████████████████████████████████████████████████████████████████▏       | 12/13 [00:00<00:00, 20.16it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 15.88it/s]
  0%|                                                                                                               | 0/13 [00:00<?, ?it/s]  8%|███████▉                                                                                               | 1/13 [00:00<00:04,  2.77it/s] 23%|███████████████████████▊                                                                               | 3/13 [00:00<00:01,  7.66it/s] 46%|███████████████████████████████████████████████▌                                                       | 6/13 [00:00<00:00, 12.75it/s][2025-03-28 00:22:05,464] [INFO] [logging.py:128:log_dist] [Rank 0] step=100, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 00:22:05,465] [INFO] [timer.py:264:stop] epoch=0/micro_step=100/global_step=100, RunningAvgSamplesPerSec=17.087766274432138, CurrSamplesPerSec=21.4091012297664, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 69%|███████████████████████████████████████████████████████████████████████▎                               | 9/13 [00:00<00:00, 15.98it/s] 92%|██████████████████████████████████████████████████████████████████████████████████████████████▏       | 12/13 [00:00<00:00, 17.99it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 13.34it/s]
  0%|                                                                                                               | 0/13 [00:00<?, ?it/s]  8%|███████▉                                                                                               | 1/13 [00:00<00:02,  5.74it/s] 31%|███████████████████████████████▋                                                                       | 4/13 [00:00<00:00, 14.33it/s] 54%|███████████████████████████████████████████████████████▍                                               | 7/13 [00:00<00:00, 17.71it/s] 77%|██████████████████████████████████████████████████████████████████████████████▍                       | 10/13 [00:00<00:00, 20.06it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 21.32it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 17.11it/s]
  0%|                                                                                                               | 0/13 [00:00<?, ?it/s]  8%|███████▉                                                                                               | 1/13 [00:00<00:02,  5.52it/s] 31%|███████████████████████████████▋                                                                       | 4/13 [00:00<00:00, 14.32it/s] 54%|███████████████████████████████████████████████████████▍                                               | 7/13 [00:00<00:00, 18.18it/s] 77%|██████████████████████████████████████████████████████████████████████████████▍                       | 10/13 [00:00<00:00, 19.94it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 20.66it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 16.88it/s]
  0%|                                                                                                               | 0/13 [00:00<?, ?it/s]  8%|███████▉                                                                                               | 1/13 [00:00<00:06,  1.98it/s] 31%|███████████████████████████████▋                                                                       | 4/13 [00:00<00:01,  7.48it/s] 54%|███████████████████████████████████████████████████████▍                                               | 7/13 [00:00<00:00, 11.43it/s] 77%|██████████████████████████████████████████████████████████████████████████████▍                       | 10/13 [00:00<00:00, 14.43it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:01<00:00, 16.89it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:01<00:00, 11.61it/s]
  0%|                                                                                                               | 0/13 [00:00<?, ?it/s]  8%|███████▉                                                                                               | 1/13 [00:00<00:02,  5.14it/s] 31%|███████████████████████████████▋                                                                       | 4/13 [00:00<00:00, 13.28it/s][2025-03-28 00:22:08,991] [INFO] [logging.py:128:log_dist] [Rank 0] step=150, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 00:22:08,992] [INFO] [timer.py:264:stop] epoch=0/micro_step=150/global_step=150, RunningAvgSamplesPerSec=17.163228608173917, CurrSamplesPerSec=20.88867610547518, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 54%|███████████████████████████████████████████████████████▍                                               | 7/13 [00:00<00:00, 16.63it/s] 77%|██████████████████████████████████████████████████████████████████████████████▍                       | 10/13 [00:00<00:00, 18.38it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 19.46it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 15.82it/s]
  0%|                                                                                                               | 0/13 [00:00<?, ?it/s]  8%|███████▉                                                                                               | 1/13 [00:00<00:03,  3.95it/s] 31%|███████████████████████████████▋                                                                       | 4/13 [00:00<00:00, 11.66it/s] 54%|███████████████████████████████████████████████████████▍                                               | 7/13 [00:00<00:00, 15.35it/s] 77%|██████████████████████████████████████████████████████████████████████████████▍                       | 10/13 [00:00<00:00, 17.64it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 19.09it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 14.99it/s]
  0%|                                                                                                               | 0/13 [00:00<?, ?it/s]  8%|███████▉                                                                                               | 1/13 [00:00<00:02,  4.33it/s] 23%|███████████████████████▊                                                                               | 3/13 [00:00<00:00, 10.25it/s] 46%|███████████████████████████████████████████████▌                                                       | 6/13 [00:00<00:00, 15.16it/s] 69%|███████████████████████████████████████████████████████████████████████▎                               | 9/13 [00:00<00:00, 17.78it/s] 92%|██████████████████████████████████████████████████████████████████████████████████████████████▏       | 12/13 [00:00<00:00, 19.15it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 14.62it/s]
  0%|                                                                                                               | 0/13 [00:00<?, ?it/s]  8%|███████▉                                                                                               | 1/13 [00:00<00:02,  4.53it/s] 23%|███████████████████████▊                                                                               | 3/13 [00:00<00:00, 10.55it/s] 46%|███████████████████████████████████████████████▌                                                       | 6/13 [00:00<00:00, 15.00it/s] 69%|███████████████████████████████████████████████████████████████████████▎                               | 9/13 [00:00<00:00, 17.19it/s] 92%|██████████████████████████████████████████████████████████████████████████████████████████████▏       | 12/13 [00:00<00:00, 18.86it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 15.22it/s]
  0%|                                                                                                               | 0/13 [00:00<?, ?it/s]  8%|███████▉                                                                                               | 1/13 [00:00<00:02,  5.36it/s] 31%|███████████████████████████████▋                                                                       | 4/13 [00:00<00:00, 13.81it/s][2025-03-28 00:22:12,472] [INFO] [logging.py:128:log_dist] [Rank 0] step=200, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 00:22:12,473] [INFO] [timer.py:264:stop] epoch=0/micro_step=200/global_step=200, RunningAvgSamplesPerSec=17.305907632412964, CurrSamplesPerSec=20.61172236147986, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 46%|███████████████████████████████████████████████▌                                                       | 6/13 [00:00<00:00, 15.89it/s] 69%|███████████████████████████████████████████████████████████████████████▎                               | 9/13 [00:00<00:00, 18.38it/s] 92%|██████████████████████████████████████████████████████████████████████████████████████████████▏       | 12/13 [00:00<00:00, 20.41it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 16.57it/s]
  0%|                                                                                                               | 0/13 [00:00<?, ?it/s]  8%|███████▉                                                                                               | 1/13 [00:00<00:02,  4.26it/s] 31%|███████████████████████████████▋                                                                       | 4/13 [00:00<00:00, 12.15it/s] 54%|███████████████████████████████████████████████████████▍                                               | 7/13 [00:00<00:00, 15.72it/s] 77%|██████████████████████████████████████████████████████████████████████████████▍                       | 10/13 [00:00<00:00, 17.75it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 19.09it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 15.27it/s]
  0%|                                                                                                               | 0/13 [00:00<?, ?it/s]  8%|███████▉                                                                                               | 1/13 [00:00<00:02,  4.36it/s] 31%|███████████████████████████████▋                                                                       | 4/13 [00:00<00:00, 12.21it/s] 54%|███████████████████████████████████████████████████████▍                                               | 7/13 [00:00<00:00, 15.89it/s] 77%|██████████████████████████████████████████████████████████████████████████████▍                       | 10/13 [00:00<00:00, 17.94it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 19.36it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 15.43it/s]
  0%|                                                                                                               | 0/13 [00:00<?, ?it/s]  8%|███████▉                                                                                               | 1/13 [00:00<00:02,  5.30it/s] 31%|███████████████████████████████▋                                                                       | 4/13 [00:00<00:00, 13.37it/s] 54%|███████████████████████████████████████████████████████▍                                               | 7/13 [00:00<00:00, 16.70it/s] 77%|██████████████████████████████████████████████████████████████████████████████▍                       | 10/13 [00:00<00:00, 18.75it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 20.39it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 16.31it/s]
  0%|                                                                                                               | 0/13 [00:00<?, ?it/s]  8%|███████▉                                                                                               | 1/13 [00:00<00:03,  3.15it/s][2025-03-28 00:22:15,943] [INFO] [logging.py:128:log_dist] [Rank 0] step=250, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 00:22:15,944] [INFO] [timer.py:264:stop] epoch=0/micro_step=250/global_step=250, RunningAvgSamplesPerSec=17.3511138867892, CurrSamplesPerSec=21.27822494029323, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 31%|███████████████████████████████▋                                                                       | 4/13 [00:00<00:00, 10.16it/s] 54%|███████████████████████████████████████████████████████▍                                               | 7/13 [00:00<00:00, 14.31it/s] 69%|███████████████████████████████████████████████████████████████████████▎                               | 9/13 [00:00<00:00, 15.38it/s] 92%|██████████████████████████████████████████████████████████████████████████████████████████████▏       | 12/13 [00:00<00:00, 17.28it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 13.67it/s]
[rank0]:[W328 00:22:25.744520068 ProcessGroupNCCL.cpp:1496] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[2025-03-28 00:22:27,745] [INFO] [launch.py:351:main] Process 563541 exits successfully.
[?2004h(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ bash scripts/script_normal_dif_test.sh 
[?2004l[2025-03-28 00:28:06,558] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-28 00:28:06,566] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-28 00:28:13,665] [WARNING] [runner.py:215:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2025-03-28 00:28:13,666] [INFO] [runner.py:607:main] cmd = /hpc2hdd/home/yli045/.conda/envs/ywj/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None main.py --image_size 64 --batch_size 1 --num_epochs 20 --timesteps 100 --lr 2e-4 --time_emb_dim 32 --mu1 4 --sigma1 1 --num1 900 --mu2 10 --sigma2 4 --num2 100 --samples_dir ./samples --checkpoints_dir ./checkpoints --fp16 --mode train --model_path  --num_images 1000 --simulation_distribution normal --use_different_noise --use_moe --num_experts 2 --moe_hidden_dim 2 --moe_tau 0.1
[2025-03-28 00:28:26,699] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-28 00:28:26,706] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-28 00:28:30,488] [INFO] [launch.py:146:main] WORLD INFO DICT: {'localhost': [0]}
[2025-03-28 00:28:30,488] [INFO] [launch.py:152:main] nnodes=1, num_local_procs=1, node_rank=0
[2025-03-28 00:28:30,488] [INFO] [launch.py:163:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2025-03-28 00:28:30,488] [INFO] [launch.py:164:main] dist_world_size=1
[2025-03-28 00:28:30,488] [INFO] [launch.py:168:main] Setting CUDA_VISIBLE_DEVICES=0
[2025-03-28 00:28:30,490] [INFO] [launch.py:256:main] process 565401 spawned with command: ['/hpc2hdd/home/yli045/.conda/envs/ywj/bin/python', '-u', 'main.py', '--local_rank=0', '--image_size', '64', '--batch_size', '1', '--num_epochs', '20', '--timesteps', '100', '--lr', '2e-4', '--time_emb_dim', '32', '--mu1', '4', '--sigma1', '1', '--num1', '900', '--mu2', '10', '--sigma2', '4', '--num2', '100', '--samples_dir', './samples', '--checkpoints_dir', './checkpoints', '--fp16', '--mode', 'train', '--model_path', '', '--num_images', '1000', '--simulation_distribution', 'normal', '--use_different_noise', '--use_moe', '--num_experts', '2', '--moe_hidden_dim', '2', '--moe_tau', '0.1']
[2025-03-28 00:28:41,739] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-03-28 00:29:16,870] [INFO] [logging.py:128:log_dist] [Rank -1] DeepSpeed info: version=0.16.4, git-hash=unknown, git-branch=unknown
[2025-03-28 00:29:16,871] [INFO] [comm.py:658:init_distributed] cdb=None
[2025-03-28 00:29:16,871] [INFO] [comm.py:689:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2025-03-28 00:29:16,877] [INFO] [config.py:734:__init__] Config mesh_device None world_size = 1
[2025-03-28 00:29:20,004] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
Using /hpc2hdd/home/yli045/.cache/torch_extensions/py312_cu124 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /hpc2hdd/home/yli045/.cache/torch_extensions/py312_cu124/fused_adam/build.ninja...
/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/utils/cpp_extension.py:2059: UserWarning: TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation. 
If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'].
  warnings.warn(
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 0.9483895301818848 seconds
[2025-03-28 00:29:20,957] [INFO] [logging.py:128:log_dist] [Rank 0] Using DeepSpeed Optimizer param name adamw as basic optimizer
[2025-03-28 00:29:20,958] [INFO] [logging.py:128:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2025-03-28 00:29:20,960] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Basic Optimizer = FusedAdam
[2025-03-28 00:29:20,960] [INFO] [utils.py:59:is_zero_supported_optimizer] Checking ZeRO support for optimizer=FusedAdam type=<class 'deepspeed.ops.adam.fused_adam.FusedAdam'>
[2025-03-28 00:29:20,961] [INFO] [logging.py:128:log_dist] [Rank 0] Creating torch.float16 ZeRO stage 2 optimizer
[2025-03-28 00:29:20,961] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 500000000
[2025-03-28 00:29:20,961] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 500000000
[2025-03-28 00:29:20,961] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2025-03-28 00:29:20,962] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2025-03-28 00:29:23,515] [INFO] [utils.py:781:see_memory_usage] Before initializing optimizer states
[2025-03-28 00:29:23,515] [INFO] [utils.py:782:see_memory_usage] MA 0.04 GB         Max_MA 0.05 GB         CA 0.05 GB         Max_CA 0 GB 
[2025-03-28 00:29:23,515] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 138.61 GB, percent = 13.8%
[2025-03-28 00:29:23,788] [INFO] [utils.py:781:see_memory_usage] After initializing optimizer states
[2025-03-28 00:29:23,789] [INFO] [utils.py:782:see_memory_usage] MA 0.04 GB         Max_MA 0.06 GB         CA 0.08 GB         Max_CA 0 GB 
[2025-03-28 00:29:23,789] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 138.6 GB, percent = 13.8%
[2025-03-28 00:29:23,789] [INFO] [stage_1_and_2.py:550:__init__] optimizer state initialized
[2025-03-28 00:29:23,907] [INFO] [utils.py:781:see_memory_usage] After initializing ZeRO optimizer
[2025-03-28 00:29:23,907] [INFO] [utils.py:782:see_memory_usage] MA 0.04 GB         Max_MA 0.04 GB         CA 0.08 GB         Max_CA 0 GB 
[2025-03-28 00:29:23,907] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 138.65 GB, percent = 13.8%
[2025-03-28 00:29:23,909] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Final Optimizer = DeepSpeedZeroOptimizer
[2025-03-28 00:29:23,909] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed using configured LR scheduler = None
[2025-03-28 00:29:23,909] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2025-03-28 00:29:23,909] [INFO] [logging.py:128:log_dist] [Rank 0] step=0, skipped=0, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 00:29:23,909] [INFO] [config.py:1001:print] DeepSpeedEngine configuration:
[2025-03-28 00:29:23,909] [INFO] [config.py:1005:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2025-03-28 00:29:23,909] [INFO] [config.py:1005:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'intra_op_parallelism': 1, 'single_submit': False, 'overlap_events': True, 'use_gds': False}
[2025-03-28 00:29:23,910] [INFO] [config.py:1005:print]   amp_enabled .................. False
[2025-03-28 00:29:23,910] [INFO] [config.py:1005:print]   amp_params ................... False
[2025-03-28 00:29:23,910] [INFO] [config.py:1005:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2025-03-28 00:29:23,910] [INFO] [config.py:1005:print]   bfloat16_enabled ............. False
[2025-03-28 00:29:23,910] [INFO] [config.py:1005:print]   bfloat16_immediate_grad_update  False
[2025-03-28 00:29:23,910] [INFO] [config.py:1005:print]   checkpoint_parallel_write_pipeline  False
[2025-03-28 00:29:23,910] [INFO] [config.py:1005:print]   checkpoint_tag_validation_enabled  True
[2025-03-28 00:29:23,910] [INFO] [config.py:1005:print]   checkpoint_tag_validation_fail  False
[2025-03-28 00:29:23,910] [INFO] [config.py:1005:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fd323f65ee0>
[2025-03-28 00:29:23,910] [INFO] [config.py:1005:print]   communication_data_type ...... None
[2025-03-28 00:29:23,910] [INFO] [config.py:1005:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2025-03-28 00:29:23,910] [INFO] [config.py:1005:print]   curriculum_enabled_legacy .... False
[2025-03-28 00:29:23,910] [INFO] [config.py:1005:print]   curriculum_params_legacy ..... False
[2025-03-28 00:29:23,910] [INFO] [config.py:1005:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2025-03-28 00:29:23,910] [INFO] [config.py:1005:print]   data_efficiency_enabled ...... False
[2025-03-28 00:29:23,910] [INFO] [config.py:1005:print]   dataloader_drop_last ......... False
[2025-03-28 00:29:23,910] [INFO] [config.py:1005:print]   disable_allgather ............ False
[2025-03-28 00:29:23,910] [INFO] [config.py:1005:print]   dump_state ................... False
[2025-03-28 00:29:23,910] [INFO] [config.py:1005:print]   dynamic_loss_scale_args ...... {'init_scale': 65536, 'scale_window': 1000, 'delayed_shift': 2, 'consecutive_hysteresis': False, 'min_scale': 1}
[2025-03-28 00:29:23,910] [INFO] [config.py:1005:print]   eigenvalue_enabled ........... False
[2025-03-28 00:29:23,911] [INFO] [config.py:1005:print]   eigenvalue_gas_boundary_resolution  1
[2025-03-28 00:29:23,911] [INFO] [config.py:1005:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2025-03-28 00:29:23,911] [INFO] [config.py:1005:print]   eigenvalue_layer_num ......... 0
[2025-03-28 00:29:23,911] [INFO] [config.py:1005:print]   eigenvalue_max_iter .......... 100
[2025-03-28 00:29:23,911] [INFO] [config.py:1005:print]   eigenvalue_stability ......... 1e-06
[2025-03-28 00:29:23,911] [INFO] [config.py:1005:print]   eigenvalue_tol ............... 0.01
[2025-03-28 00:29:23,911] [INFO] [config.py:1005:print]   eigenvalue_verbose ........... False
[2025-03-28 00:29:23,911] [INFO] [config.py:1005:print]   elasticity_enabled ........... False
[2025-03-28 00:29:23,911] [INFO] [config.py:1005:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2025-03-28 00:29:23,911] [INFO] [config.py:1005:print]   fp16_auto_cast ............... False
[2025-03-28 00:29:23,911] [INFO] [config.py:1005:print]   fp16_enabled ................. True
[2025-03-28 00:29:23,911] [INFO] [config.py:1005:print]   fp16_master_weights_and_gradients  False
[2025-03-28 00:29:23,911] [INFO] [config.py:1005:print]   global_rank .................. 0
[2025-03-28 00:29:23,911] [INFO] [config.py:1005:print]   grad_accum_dtype ............. None
[2025-03-28 00:29:23,911] [INFO] [config.py:1005:print]   gradient_accumulation_steps .. 1
[2025-03-28 00:29:23,911] [INFO] [config.py:1005:print]   gradient_clipping ............ 1.0
[2025-03-28 00:29:23,911] [INFO] [config.py:1005:print]   gradient_predivide_factor .... 1.0
[2025-03-28 00:29:23,911] [INFO] [config.py:1005:print]   graph_harvesting ............. False
[2025-03-28 00:29:23,911] [INFO] [config.py:1005:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2025-03-28 00:29:23,911] [INFO] [config.py:1005:print]   initial_dynamic_scale ........ 65536
[2025-03-28 00:29:23,911] [INFO] [config.py:1005:print]   load_universal_checkpoint .... False
[2025-03-28 00:29:23,911] [INFO] [config.py:1005:print]   loss_scale ................... 0
[2025-03-28 00:29:23,911] [INFO] [config.py:1005:print]   memory_breakdown ............. False
[2025-03-28 00:29:23,911] [INFO] [config.py:1005:print]   mics_hierarchial_params_gather  False
[2025-03-28 00:29:23,912] [INFO] [config.py:1005:print]   mics_shard_size .............. -1
[2025-03-28 00:29:23,912] [INFO] [config.py:1005:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') comet=CometConfig(enabled=False, samples_log_interval=100, project=None, workspace=None, api_key=None, experiment_name=None, experiment_key=None, online=None, mode=None) wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName')
[2025-03-28 00:29:23,912] [INFO] [config.py:1005:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2025-03-28 00:29:23,912] [INFO] [config.py:1005:print]   optimizer_legacy_fusion ...... False
[2025-03-28 00:29:23,912] [INFO] [config.py:1005:print]   optimizer_name ............... adamw
[2025-03-28 00:29:23,912] [INFO] [config.py:1005:print]   optimizer_params ............. {'lr': 0.0002, 'weight_decay': 0.01}
[2025-03-28 00:29:23,912] [INFO] [config.py:1005:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2025-03-28 00:29:23,912] [INFO] [config.py:1005:print]   pld_enabled .................. False
[2025-03-28 00:29:23,912] [INFO] [config.py:1005:print]   pld_params ................... False
[2025-03-28 00:29:23,912] [INFO] [config.py:1005:print]   prescale_gradients ........... False
[2025-03-28 00:29:23,912] [INFO] [config.py:1005:print]   scheduler_name ............... None
[2025-03-28 00:29:23,912] [INFO] [config.py:1005:print]   scheduler_params ............. None
[2025-03-28 00:29:23,912] [INFO] [config.py:1005:print]   seq_parallel_communication_data_type  torch.float32
[2025-03-28 00:29:23,912] [INFO] [config.py:1005:print]   sparse_attention ............. None
[2025-03-28 00:29:23,912] [INFO] [config.py:1005:print]   sparse_gradients_enabled ..... False
[2025-03-28 00:29:23,912] [INFO] [config.py:1005:print]   steps_per_print .............. 50
[2025-03-28 00:29:23,912] [INFO] [config.py:1005:print]   tensor_parallel_config ....... dtype=torch.float16 autotp_size=0 tensor_parallel=TPConfig(tp_size=1, tp_grain_size=1, mpu=None, tp_group=None) injection_policy_tuple=None keep_module_on_host=False replace_with_kernel_inject=False
[2025-03-28 00:29:23,912] [INFO] [config.py:1005:print]   timers_config ................ enabled=True synchronized=True
[2025-03-28 00:29:23,912] [INFO] [config.py:1005:print]   train_batch_size ............. 1
[2025-03-28 00:29:23,912] [INFO] [config.py:1005:print]   train_micro_batch_size_per_gpu  1
[2025-03-28 00:29:23,912] [INFO] [config.py:1005:print]   use_data_before_expert_parallel_  False
[2025-03-28 00:29:23,912] [INFO] [config.py:1005:print]   use_node_local_storage ....... False
[2025-03-28 00:29:23,912] [INFO] [config.py:1005:print]   wall_clock_breakdown ......... False
[2025-03-28 00:29:23,912] [INFO] [config.py:1005:print]   weight_quantization_config ... None
[2025-03-28 00:29:23,913] [INFO] [config.py:1005:print]   world_size ................... 1
[2025-03-28 00:29:23,913] [INFO] [config.py:1005:print]   zero_allow_untested_optimizer  False
[2025-03-28 00:29:23,913] [INFO] [config.py:1005:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=500000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50000000 param_persistence_threshold=100000 model_persistence_threshold=9223372036854775807 max_live_parameters=1000000000 max_reuse_distance=1000000000 gather_16bit_weights_on_model_save=False module_granularity_threshold=0 use_all_reduce_for_fetch_params=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False zeropp_loco_param=None mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True log_trace_cache_warnings=False
[2025-03-28 00:29:23,913] [INFO] [config.py:1005:print]   zero_enabled ................. True
[2025-03-28 00:29:23,913] [INFO] [config.py:1005:print]   zero_force_ds_cpu_optimizer .. True
[2025-03-28 00:29:23,913] [INFO] [config.py:1005:print]   zero_optimization_stage ...... 2
[2025-03-28 00:29:23,913] [INFO] [config.py:991:print_user_config]   json = {
    "train_batch_size": 1, 
    "gradient_accumulation_steps": 1, 
    "optimizer": {
        "type": "AdamW", 
        "params": {
            "lr": 0.0002, 
            "weight_decay": 0.01
        }
    }, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "loss_scale_window": 1000
    }, 
    "zero_optimization": {
        "stage": 2, 
        "contiguous_gradients": true, 
        "overlap_comm": true
    }, 
    "steps_per_print": 50, 
    "gradient_clipping": 1.0
}
****START TRAINING****
image_size: 64, batch_size: 1, timesteps: 100, time_emb_dim: 32
  0%|                                                                                                               | 0/13 [00:00<?, ?it/s][2025-03-28 00:29:25,942] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
  8%|███████▉                                                                                               | 1/13 [00:01<00:21,  1.82s/it][2025-03-28 00:29:25,984] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
 23%|███████████████████████▊                                                                               | 3/13 [00:02<00:06,  1.59it/s] 38%|███████████████████████████████████████▌                                                               | 5/13 [00:02<00:02,  2.98it/s] 62%|███████████████████████████████████████████████████████████████▍                                       | 8/13 [00:02<00:00,  5.42it/s] 85%|██████████████████████████████████████████████████████████████████████████████████████▎               | 11/13 [00:02<00:00,  8.06it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:02<00:00,  4.70it/s]
/hpc2hdd/home/yli045/diffusion_noise_agent/train.py:189: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  df = pd.concat([df, pd.DataFrame([new_row])], ignore_index=True) # 使用 pd.concat 追加数据
  0%|                                                                                                               | 0/13 [00:00<?, ?it/s]  8%|███████▉                                                                                               | 1/13 [00:00<00:04,  2.63it/s] 31%|███████████████████████████████▋                                                                       | 4/13 [00:00<00:00,  9.05it/s] 54%|███████████████████████████████████████████████████████▍                                               | 7/13 [00:00<00:00, 13.16it/s] 77%|██████████████████████████████████████████████████████████████████████████████▍                       | 10/13 [00:00<00:00, 15.96it/s] 92%|██████████████████████████████████████████████████████████████████████████████████████████████▏       | 12/13 [00:00<00:00, 16.93it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:01<00:00, 12.94it/s]
  0%|                                                                                                               | 0/13 [00:00<?, ?it/s]  8%|███████▉                                                                                               | 1/13 [00:00<00:02,  5.25it/s] 31%|███████████████████████████████▋                                                                       | 4/13 [00:00<00:00, 13.46it/s] 54%|███████████████████████████████████████████████████████▍                                               | 7/13 [00:00<00:00, 16.95it/s] 77%|██████████████████████████████████████████████████████████████████████████████▍                       | 10/13 [00:00<00:00, 18.84it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 20.03it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 16.12it/s]
  0%|                                                                                                               | 0/13 [00:00<?, ?it/s]  8%|███████▉                                                                                               | 1/13 [00:00<00:04,  2.77it/s] 23%|███████████████████████▊                                                                               | 3/13 [00:00<00:01,  7.61it/s] 46%|███████████████████████████████████████████████▌                                                       | 6/13 [00:00<00:00, 12.42it/s] 69%|███████████████████████████████████████████████████████████████████████▎                               | 9/13 [00:00<00:00, 15.58it/s][2025-03-28 00:29:29,656] [INFO] [logging.py:128:log_dist] [Rank 0] step=50, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 00:29:29,656] [INFO] [timer.py:264:stop] epoch=0/micro_step=50/global_step=50, RunningAvgSamplesPerSec=14.95956413305581, CurrSamplesPerSec=21.966354871371323, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 92%|██████████████████████████████████████████████████████████████████████████████████████████████▏       | 12/13 [00:00<00:00, 17.65it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 13.24it/s]
  0%|                                                                                                               | 0/13 [00:00<?, ?it/s]  8%|███████▉                                                                                               | 1/13 [00:00<00:02,  5.63it/s] 23%|███████████████████████▊                                                                               | 3/13 [00:00<00:00, 11.91it/s] 46%|███████████████████████████████████████████████▌                                                       | 6/13 [00:00<00:00, 16.15it/s] 69%|███████████████████████████████████████████████████████████████████████▎                               | 9/13 [00:00<00:00, 18.28it/s] 92%|██████████████████████████████████████████████████████████████████████████████████████████████▏       | 12/13 [00:00<00:00, 19.50it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 16.18it/s]
  0%|                                                                                                               | 0/13 [00:00<?, ?it/s]  8%|███████▉                                                                                               | 1/13 [00:00<00:02,  4.95it/s] 23%|███████████████████████▊                                                                               | 3/13 [00:00<00:00, 11.18it/s] 46%|███████████████████████████████████████████████▌                                                       | 6/13 [00:00<00:00, 15.84it/s] 69%|███████████████████████████████████████████████████████████████████████▎                               | 9/13 [00:00<00:00, 17.87it/s] 92%|██████████████████████████████████████████████████████████████████████████████████████████████▏       | 12/13 [00:00<00:00, 19.09it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 15.04it/s]
  0%|                                                                                                               | 0/13 [00:00<?, ?it/s]  8%|███████▉                                                                                               | 1/13 [00:00<00:03,  3.25it/s] 23%|███████████████████████▊                                                                               | 3/13 [00:00<00:01,  8.40it/s] 38%|███████████████████████████████████████▌                                                               | 5/13 [00:00<00:00, 11.68it/s] 54%|███████████████████████████████████████████████████████▍                                               | 7/13 [00:00<00:00, 14.09it/s] 69%|███████████████████████████████████████████████████████████████████████▎                               | 9/13 [00:00<00:00, 15.71it/s] 92%|██████████████████████████████████████████████████████████████████████████████████████████████▏       | 12/13 [00:00<00:00, 17.45it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 13.11it/s]
  0%|                                                                                                               | 0/13 [00:00<?, ?it/s]  8%|███████▉                                                                                               | 1/13 [00:00<00:02,  4.39it/s] 23%|███████████████████████▊                                                                               | 3/13 [00:00<00:01,  9.46it/s] 38%|███████████████████████████████████████▌                                                               | 5/13 [00:00<00:00, 12.70it/s] 54%|███████████████████████████████████████████████████████▍                                               | 7/13 [00:00<00:00, 14.86it/s][2025-03-28 00:29:33,282] [INFO] [logging.py:128:log_dist] [Rank 0] step=100, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 00:29:33,285] [INFO] [timer.py:264:stop] epoch=0/micro_step=100/global_step=100, RunningAvgSamplesPerSec=15.964652958295089, CurrSamplesPerSec=20.25801309763636, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 77%|██████████████████████████████████████████████████████████████████████████████▍                       | 10/13 [00:00<00:00, 17.10it/s] 92%|██████████████████████████████████████████████████████████████████████████████████████████████▏       | 12/13 [00:00<00:00, 17.87it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 14.05it/s]
  0%|                                                                                                               | 0/13 [00:00<?, ?it/s]  8%|███████▉                                                                                               | 1/13 [00:00<00:04,  2.71it/s] 23%|███████████████████████▊                                                                               | 3/13 [00:00<00:01,  7.50it/s] 38%|███████████████████████████████████████▌                                                               | 5/13 [00:00<00:00, 10.91it/s] 54%|███████████████████████████████████████████████████████▍                                               | 7/13 [00:00<00:00, 13.39it/s] 69%|███████████████████████████████████████████████████████████████████████▎                               | 9/13 [00:00<00:00, 15.14it/s] 92%|██████████████████████████████████████████████████████████████████████████████████████████████▏       | 12/13 [00:00<00:00, 17.59it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:01<00:00, 12.38it/s]
  0%|                                                                                                               | 0/13 [00:00<?, ?it/s]  8%|███████▉                                                                                               | 1/13 [00:00<00:02,  5.33it/s] 31%|███████████████████████████████▋                                                                       | 4/13 [00:00<00:00, 13.58it/s] 54%|███████████████████████████████████████████████████████▍                                               | 7/13 [00:00<00:00, 16.79it/s] 77%|██████████████████████████████████████████████████████████████████████████████▍                       | 10/13 [00:00<00:00, 18.61it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 19.67it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 16.14it/s]
  0%|                                                                                                               | 0/13 [00:00<?, ?it/s]  8%|███████▉                                                                                               | 1/13 [00:00<00:04,  2.63it/s] 23%|███████████████████████▊                                                                               | 3/13 [00:00<00:01,  7.31it/s] 46%|███████████████████████████████████████████████▌                                                       | 6/13 [00:00<00:00, 12.47it/s] 69%|███████████████████████████████████████████████████████████████████████▎                               | 9/13 [00:00<00:00, 15.53it/s] 92%|██████████████████████████████████████████████████████████████████████████████████████████████▏       | 12/13 [00:00<00:00, 17.68it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:01<00:00, 12.98it/s]
  0%|                                                                                                               | 0/13 [00:00<?, ?it/s]  8%|███████▉                                                                                               | 1/13 [00:00<00:02,  5.35it/s] 23%|███████████████████████▊                                                                               | 3/13 [00:00<00:00, 11.56it/s] 46%|███████████████████████████████████████████████▌                                                       | 6/13 [00:00<00:00, 15.73it/s][2025-03-28 00:29:37,034] [INFO] [logging.py:128:log_dist] [Rank 0] step=150, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 00:29:37,035] [INFO] [timer.py:264:stop] epoch=0/micro_step=150/global_step=150, RunningAvgSamplesPerSec=16.01642540426473, CurrSamplesPerSec=19.692844476170016, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 69%|███████████████████████████████████████████████████████████████████████▎                               | 9/13 [00:00<00:00, 17.67it/s] 92%|██████████████████████████████████████████████████████████████████████████████████████████████▏       | 12/13 [00:00<00:00, 19.01it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 15.61it/s]
  0%|                                                                                                               | 0/13 [00:00<?, ?it/s]  8%|███████▉                                                                                               | 1/13 [00:00<00:04,  2.47it/s] 23%|███████████████████████▊                                                                               | 3/13 [00:00<00:01,  6.94it/s] 38%|███████████████████████████████████████▌                                                               | 5/13 [00:00<00:00, 10.42it/s] 62%|███████████████████████████████████████████████████████████████▍                                       | 8/13 [00:00<00:00, 14.14it/s] 77%|██████████████████████████████████████████████████████████████████████████████▍                       | 10/13 [00:00<00:00, 15.21it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:01<00:00, 17.01it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:01<00:00, 12.23it/s]
  0%|                                                                                                               | 0/13 [00:00<?, ?it/s]  8%|███████▉                                                                                               | 1/13 [00:00<00:01,  6.07it/s] 31%|███████████████████████████████▋                                                                       | 4/13 [00:00<00:00, 14.28it/s] 54%|███████████████████████████████████████████████████████▍                                               | 7/13 [00:00<00:00, 17.93it/s] 77%|██████████████████████████████████████████████████████████████████████████████▍                       | 10/13 [00:00<00:00, 19.21it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 20.42it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 16.70it/s]
  0%|                                                                                                               | 0/13 [00:00<?, ?it/s]  8%|███████▉                                                                                               | 1/13 [00:00<00:02,  5.42it/s] 23%|███████████████████████▊                                                                               | 3/13 [00:00<00:00, 11.78it/s] 46%|███████████████████████████████████████████████▌                                                       | 6/13 [00:00<00:00, 16.42it/s] 69%|███████████████████████████████████████████████████████████████████████▎                               | 9/13 [00:00<00:00, 18.42it/s] 92%|██████████████████████████████████████████████████████████████████████████████████████████████▏       | 12/13 [00:00<00:00, 19.21it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 16.10it/s]
  0%|                                                                                                               | 0/13 [00:00<?, ?it/s]  8%|███████▉                                                                                               | 1/13 [00:00<00:02,  4.11it/s] 31%|███████████████████████████████▋                                                                       | 4/13 [00:00<00:00, 11.92it/s][2025-03-28 00:29:40,614] [INFO] [logging.py:128:log_dist] [Rank 0] step=200, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 00:29:40,615] [INFO] [timer.py:264:stop] epoch=0/micro_step=200/global_step=200, RunningAvgSamplesPerSec=16.22025155571679, CurrSamplesPerSec=20.901896378449393, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 54%|███████████████████████████████████████████████████████▍                                               | 7/13 [00:00<00:00, 15.56it/s] 77%|██████████████████████████████████████████████████████████████████████████████▍                       | 10/13 [00:00<00:00, 18.02it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 19.30it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 15.12it/s]
  0%|                                                                                                               | 0/13 [00:00<?, ?it/s]  8%|███████▉                                                                                               | 1/13 [00:00<00:02,  5.12it/s] 31%|███████████████████████████████▋                                                                       | 4/13 [00:00<00:00, 13.45it/s] 54%|███████████████████████████████████████████████████████▍                                               | 7/13 [00:00<00:00, 16.98it/s] 77%|██████████████████████████████████████████████████████████████████████████████▍                       | 10/13 [00:00<00:00, 18.77it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 20.01it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 16.09it/s]
  0%|                                                                                                               | 0/13 [00:00<?, ?it/s]  8%|███████▉                                                                                               | 1/13 [00:00<00:02,  5.38it/s] 23%|███████████████████████▊                                                                               | 3/13 [00:00<00:00, 11.39it/s] 38%|███████████████████████████████████████▌                                                               | 5/13 [00:00<00:00, 14.38it/s] 54%|███████████████████████████████████████████████████████▍                                               | 7/13 [00:00<00:00, 15.87it/s] 77%|██████████████████████████████████████████████████████████████████████████████▍                       | 10/13 [00:00<00:00, 17.90it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 19.45it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 15.41it/s]
  0%|                                                                                                               | 0/13 [00:00<?, ?it/s]  8%|███████▉                                                                                               | 1/13 [00:00<00:02,  4.43it/s] 31%|███████████████████████████████▋                                                                       | 4/13 [00:00<00:00, 12.20it/s] 54%|███████████████████████████████████████████████████████▍                                               | 7/13 [00:00<00:00, 16.55it/s] 77%|██████████████████████████████████████████████████████████████████████████████▍                       | 10/13 [00:00<00:00, 19.00it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 20.51it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 15.94it/s]
  0%|                                                                                                               | 0/13 [00:00<?, ?it/s]  8%|███████▉                                                                                               | 1/13 [00:00<00:02,  4.21it/s][2025-03-28 00:29:44,000] [INFO] [logging.py:128:log_dist] [Rank 0] step=250, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 00:29:44,001] [INFO] [timer.py:264:stop] epoch=0/micro_step=250/global_step=250, RunningAvgSamplesPerSec=16.583507525778444, CurrSamplesPerSec=20.88669970734169, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 31%|███████████████████████████████▋                                                                       | 4/13 [00:00<00:00, 12.05it/s] 54%|███████████████████████████████████████████████████████▍                                               | 7/13 [00:00<00:00, 16.12it/s] 77%|██████████████████████████████████████████████████████████████████████████████▍                       | 10/13 [00:00<00:00, 18.59it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 19.78it/s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 15.49it/s]
[rank0]:[W328 00:29:46.638216246 ProcessGroupNCCL.cpp:1496] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[2025-03-28 00:29:47,544] [INFO] [launch.py:351:main] Process 565401 exits successfully.
[?2004h(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ bash scripts/script_normal_dif_test.sh 
[?2004l^C^C^C^C^C^C^C^C^C^C^C^C^C^CTraceback (most recent call last):
  File "/hpc2hdd/home/yli045/.conda/envs/ywj/bin/deepspeed", line 3, in <module>
    from deepspeed.launcher.runner import main
  File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/deepspeed/__init__.py", line 10, in <module>
    import torch
  File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/__init__.py", line 405, in <module>
    from torch._C import *  # noqa: F403
    ^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 463, in _lock_unlock_module
KeyboardInterrupt
^C^C
[?2004h(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ bash scripts/script_normal_dif_test.sh 
[?2004l^C^C^C^CTraceback (most recent call last):
  File "/hpc2hdd/home/yli045/.conda/envs/ywj/bin/deepspeed", line 3, in <module>
    from deepspeed.launcher.runner import main
  File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/deepspeed/__init__.py", line 10, in <module>
    import torch
  File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/__init__.py", line 2108, in <module>
    from torch import _VF as _VF, functional as functional  # usort: skip
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/functional.py", line 7, in <module>
    import torch.nn.functional as F
  File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/__init__.py", line 8, in <module>
    from torch.nn.modules import *  # usort: skip # noqa: F403
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/__init__.py", line 2, in <module>
    from .linear import Bilinear, Identity, LazyLinear, Linear  # usort: skip
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 7, in <module>
    from torch.nn import functional as F, init
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 995, in exec_module
  File "<frozen importlib._bootstrap_external>", line 1091, in get_code
  File "<frozen importlib._bootstrap_external>", line 1191, in get_data
KeyboardInterrupt

[?2004h(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ bash scripts/script_normal_dif_test.sh 
[?2004l^CTraceback (most recent call last):
  File "/hpc2hdd/home/yli045/.conda/envs/ywj/bin/deepspeed", line 3, in <module>
    from deepspeed.launcher.runner import main
  File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/deepspeed/__init__.py", line 10, in <module>
    import torch
  File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/__init__.py", line 2108, in <module>
    from torch import _VF as _VF, functional as functional  # usort: skip
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/functional.py", line 7, in <module>
    import torch.nn.functional as F
  File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/__init__.py", line 8, in <module>
    from torch.nn.modules import *  # usort: skip # noqa: F403
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/__init__.py", line 2, in <module>
    from .linear import Bilinear, Identity, LazyLinear, Linear  # usort: skip
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 7, in <module>
    from torch.nn import functional as F, init
  File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/functional.py", line 4290, in <module>
    @_overload
     ^^^^^^^^^
  File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/_jit_internal.py", line 1026, in _overload
    _check_overload_body(func)
  File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/_jit_internal.py", line 995, in _check_overload_body
    parsed_def = parse_def(func)
                 ^^^^^^^^^^^^^^^
  File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/_sources.py", line 121, in parse_def
    sourcelines, file_lineno, filename = get_source_lines_and_file(
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/_sources.py", line 24, in get_source_lines_and_file
    sourcelines, file_lineno = inspect.getsourcelines(obj)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/inspect.py", line 1267, in getsourcelines
    lines, lnum = findsource(object)
                  ^^^^^^^^^^^^^^^^^^
  File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/inspect.py", line 1092, in findsource
    lines = linecache.getlines(file, module.__dict__)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/linecache.py", line 46, in getlines
    return updatecache(filename, module_globals)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/linecache.py", line 141, in updatecache
    with tokenize.open(fullname) as fp:
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/tokenize.py", line 445, in open
    encoding, lines = detect_encoding(buffer.readline)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/tokenize.py", line 414, in detect_encoding
    first = read_or_stop()
            ^^^^^^^^^^^^^^
  File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/tokenize.py", line 372, in read_or_stop
    return readline()
           ^^^^^^^^^^
KeyboardInterrupt

[?2004h(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ ^C[?2004l[?2004h[?2004l
[?2004h(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ bash scripts/script_normal_dif_test.sh 
[?2004l[2025-03-28 00:55:30,628] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-28 00:55:30,635] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-28 00:55:38,216] [WARNING] [runner.py:215:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2025-03-28 00:55:38,218] [INFO] [runner.py:607:main] cmd = /hpc2hdd/home/yli045/.conda/envs/ywj/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None main.py --image_size 8 --batch_size 256 --num_epochs 20 --timesteps 1000 --lr 2e-4 --time_emb_dim 32 --mu1 4 --sigma1 1 --num1 9000 --mu2 10 --sigma2 4 --num2 1000 --samples_dir ./samples --checkpoints_dir ./checkpoints --fp16 --mode train --model_path  --num_images 1000 --simulation_distribution normal --use_different_noise --use_moe --num_experts 2 --moe_hidden_dim 2 --moe_tau 0.1
[2025-03-28 00:55:41,090] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-28 00:55:41,097] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-28 00:55:42,202] [INFO] [launch.py:146:main] WORLD INFO DICT: {'localhost': [0]}
[2025-03-28 00:55:42,202] [INFO] [launch.py:152:main] nnodes=1, num_local_procs=1, node_rank=0
[2025-03-28 00:55:42,202] [INFO] [launch.py:163:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2025-03-28 00:55:42,202] [INFO] [launch.py:164:main] dist_world_size=1
[2025-03-28 00:55:42,202] [INFO] [launch.py:168:main] Setting CUDA_VISIBLE_DEVICES=0
[2025-03-28 00:55:42,203] [INFO] [launch.py:256:main] process 570535 spawned with command: ['/hpc2hdd/home/yli045/.conda/envs/ywj/bin/python', '-u', 'main.py', '--local_rank=0', '--image_size', '8', '--batch_size', '256', '--num_epochs', '20', '--timesteps', '1000', '--lr', '2e-4', '--time_emb_dim', '32', '--mu1', '4', '--sigma1', '1', '--num1', '9000', '--mu2', '10', '--sigma2', '4', '--num2', '1000', '--samples_dir', './samples', '--checkpoints_dir', './checkpoints', '--fp16', '--mode', 'train', '--model_path', '', '--num_images', '1000', '--simulation_distribution', 'normal', '--use_different_noise', '--use_moe', '--num_experts', '2', '--moe_hidden_dim', '2', '--moe_tau', '0.1']
[2025-03-28 00:55:50,527] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-03-28 00:56:14,854] [INFO] [logging.py:128:log_dist] [Rank -1] DeepSpeed info: version=0.16.4, git-hash=unknown, git-branch=unknown
[2025-03-28 00:56:14,855] [INFO] [comm.py:658:init_distributed] cdb=None
[2025-03-28 00:56:14,855] [INFO] [comm.py:689:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2025-03-28 00:56:14,863] [INFO] [config.py:734:__init__] Config mesh_device None world_size = 1
[2025-03-28 00:56:17,910] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
Using /hpc2hdd/home/yli045/.cache/torch_extensions/py312_cu124 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /hpc2hdd/home/yli045/.cache/torch_extensions/py312_cu124/fused_adam/build.ninja...
/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/utils/cpp_extension.py:2059: UserWarning: TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation. 
If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'].
  warnings.warn(
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 7.228164911270142 seconds
[2025-03-28 00:56:25,148] [INFO] [logging.py:128:log_dist] [Rank 0] Using DeepSpeed Optimizer param name adamw as basic optimizer
[2025-03-28 00:56:25,148] [INFO] [logging.py:128:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2025-03-28 00:56:25,150] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Basic Optimizer = FusedAdam
[2025-03-28 00:56:25,151] [INFO] [utils.py:59:is_zero_supported_optimizer] Checking ZeRO support for optimizer=FusedAdam type=<class 'deepspeed.ops.adam.fused_adam.FusedAdam'>
[2025-03-28 00:56:25,151] [INFO] [logging.py:128:log_dist] [Rank 0] Creating torch.float16 ZeRO stage 2 optimizer
[2025-03-28 00:56:25,152] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 500000000
[2025-03-28 00:56:25,152] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 500000000
[2025-03-28 00:56:25,152] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2025-03-28 00:56:25,152] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2025-03-28 00:56:25,749] [INFO] [utils.py:781:see_memory_usage] Before initializing optimizer states
[2025-03-28 00:56:25,749] [INFO] [utils.py:782:see_memory_usage] MA 0.0 GB         Max_MA 0.0 GB         CA 0.0 GB         Max_CA 0 GB 
[2025-03-28 00:56:25,749] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 132.21 GB, percent = 13.1%
[2025-03-28 00:56:25,877] [INFO] [utils.py:781:see_memory_usage] After initializing optimizer states
[2025-03-28 00:56:25,878] [INFO] [utils.py:782:see_memory_usage] MA 0.0 GB         Max_MA 0.0 GB         CA 0.0 GB         Max_CA 0 GB 
[2025-03-28 00:56:25,878] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 131.78 GB, percent = 13.1%
[2025-03-28 00:56:25,878] [INFO] [stage_1_and_2.py:550:__init__] optimizer state initialized
[2025-03-28 00:56:26,012] [INFO] [utils.py:781:see_memory_usage] After initializing ZeRO optimizer
[2025-03-28 00:56:26,012] [INFO] [utils.py:782:see_memory_usage] MA 0.0 GB         Max_MA 0.0 GB         CA 0.0 GB         Max_CA 0 GB 
[2025-03-28 00:56:26,012] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 131.41 GB, percent = 13.0%
[2025-03-28 00:56:26,014] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Final Optimizer = DeepSpeedZeroOptimizer
[2025-03-28 00:56:26,014] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed using configured LR scheduler = None
[2025-03-28 00:56:26,014] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2025-03-28 00:56:26,014] [INFO] [logging.py:128:log_dist] [Rank 0] step=0, skipped=0, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 00:56:26,014] [INFO] [config.py:1001:print] DeepSpeedEngine configuration:
[2025-03-28 00:56:26,014] [INFO] [config.py:1005:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2025-03-28 00:56:26,014] [INFO] [config.py:1005:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'intra_op_parallelism': 1, 'single_submit': False, 'overlap_events': True, 'use_gds': False}
[2025-03-28 00:56:26,014] [INFO] [config.py:1005:print]   amp_enabled .................. False
[2025-03-28 00:56:26,014] [INFO] [config.py:1005:print]   amp_params ................... False
[2025-03-28 00:56:26,015] [INFO] [config.py:1005:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2025-03-28 00:56:26,015] [INFO] [config.py:1005:print]   bfloat16_enabled ............. False
[2025-03-28 00:56:26,015] [INFO] [config.py:1005:print]   bfloat16_immediate_grad_update  False
[2025-03-28 00:56:26,015] [INFO] [config.py:1005:print]   checkpoint_parallel_write_pipeline  False
[2025-03-28 00:56:26,015] [INFO] [config.py:1005:print]   checkpoint_tag_validation_enabled  True
[2025-03-28 00:56:26,015] [INFO] [config.py:1005:print]   checkpoint_tag_validation_fail  False
[2025-03-28 00:56:26,015] [INFO] [config.py:1005:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fe0952692b0>
[2025-03-28 00:56:26,015] [INFO] [config.py:1005:print]   communication_data_type ...... None
[2025-03-28 00:56:26,015] [INFO] [config.py:1005:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2025-03-28 00:56:26,015] [INFO] [config.py:1005:print]   curriculum_enabled_legacy .... False
[2025-03-28 00:56:26,015] [INFO] [config.py:1005:print]   curriculum_params_legacy ..... False
[2025-03-28 00:56:26,015] [INFO] [config.py:1005:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2025-03-28 00:56:26,015] [INFO] [config.py:1005:print]   data_efficiency_enabled ...... False
[2025-03-28 00:56:26,015] [INFO] [config.py:1005:print]   dataloader_drop_last ......... False
[2025-03-28 00:56:26,015] [INFO] [config.py:1005:print]   disable_allgather ............ False
[2025-03-28 00:56:26,015] [INFO] [config.py:1005:print]   dump_state ................... False
[2025-03-28 00:56:26,015] [INFO] [config.py:1005:print]   dynamic_loss_scale_args ...... {'init_scale': 65536, 'scale_window': 1000, 'delayed_shift': 2, 'consecutive_hysteresis': False, 'min_scale': 1}
[2025-03-28 00:56:26,015] [INFO] [config.py:1005:print]   eigenvalue_enabled ........... False
[2025-03-28 00:56:26,015] [INFO] [config.py:1005:print]   eigenvalue_gas_boundary_resolution  1
[2025-03-28 00:56:26,015] [INFO] [config.py:1005:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2025-03-28 00:56:26,015] [INFO] [config.py:1005:print]   eigenvalue_layer_num ......... 0
[2025-03-28 00:56:26,015] [INFO] [config.py:1005:print]   eigenvalue_max_iter .......... 100
[2025-03-28 00:56:26,016] [INFO] [config.py:1005:print]   eigenvalue_stability ......... 1e-06
[2025-03-28 00:56:26,016] [INFO] [config.py:1005:print]   eigenvalue_tol ............... 0.01
[2025-03-28 00:56:26,016] [INFO] [config.py:1005:print]   eigenvalue_verbose ........... False
[2025-03-28 00:56:26,016] [INFO] [config.py:1005:print]   elasticity_enabled ........... False
[2025-03-28 00:56:26,016] [INFO] [config.py:1005:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2025-03-28 00:56:26,016] [INFO] [config.py:1005:print]   fp16_auto_cast ............... False
[2025-03-28 00:56:26,016] [INFO] [config.py:1005:print]   fp16_enabled ................. True
[2025-03-28 00:56:26,016] [INFO] [config.py:1005:print]   fp16_master_weights_and_gradients  False
[2025-03-28 00:56:26,016] [INFO] [config.py:1005:print]   global_rank .................. 0
[2025-03-28 00:56:26,016] [INFO] [config.py:1005:print]   grad_accum_dtype ............. None
[2025-03-28 00:56:26,016] [INFO] [config.py:1005:print]   gradient_accumulation_steps .. 1
[2025-03-28 00:56:26,016] [INFO] [config.py:1005:print]   gradient_clipping ............ 1.0
[2025-03-28 00:56:26,016] [INFO] [config.py:1005:print]   gradient_predivide_factor .... 1.0
[2025-03-28 00:56:26,016] [INFO] [config.py:1005:print]   graph_harvesting ............. False
[2025-03-28 00:56:26,016] [INFO] [config.py:1005:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2025-03-28 00:56:26,016] [INFO] [config.py:1005:print]   initial_dynamic_scale ........ 65536
[2025-03-28 00:56:26,016] [INFO] [config.py:1005:print]   load_universal_checkpoint .... False
[2025-03-28 00:56:26,016] [INFO] [config.py:1005:print]   loss_scale ................... 0
[2025-03-28 00:56:26,016] [INFO] [config.py:1005:print]   memory_breakdown ............. False
[2025-03-28 00:56:26,016] [INFO] [config.py:1005:print]   mics_hierarchial_params_gather  False
[2025-03-28 00:56:26,016] [INFO] [config.py:1005:print]   mics_shard_size .............. -1
[2025-03-28 00:56:26,016] [INFO] [config.py:1005:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') comet=CometConfig(enabled=False, samples_log_interval=100, project=None, workspace=None, api_key=None, experiment_name=None, experiment_key=None, online=None, mode=None) wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName')
[2025-03-28 00:56:26,016] [INFO] [config.py:1005:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2025-03-28 00:56:26,017] [INFO] [config.py:1005:print]   optimizer_legacy_fusion ...... False
[2025-03-28 00:56:26,017] [INFO] [config.py:1005:print]   optimizer_name ............... adamw
[2025-03-28 00:56:26,017] [INFO] [config.py:1005:print]   optimizer_params ............. {'lr': 0.0002, 'weight_decay': 0.01}
[2025-03-28 00:56:26,017] [INFO] [config.py:1005:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2025-03-28 00:56:26,017] [INFO] [config.py:1005:print]   pld_enabled .................. False
[2025-03-28 00:56:26,017] [INFO] [config.py:1005:print]   pld_params ................... False
[2025-03-28 00:56:26,017] [INFO] [config.py:1005:print]   prescale_gradients ........... False
[2025-03-28 00:56:26,017] [INFO] [config.py:1005:print]   scheduler_name ............... None
[2025-03-28 00:56:26,017] [INFO] [config.py:1005:print]   scheduler_params ............. None
[2025-03-28 00:56:26,017] [INFO] [config.py:1005:print]   seq_parallel_communication_data_type  torch.float32
[2025-03-28 00:56:26,017] [INFO] [config.py:1005:print]   sparse_attention ............. None
[2025-03-28 00:56:26,017] [INFO] [config.py:1005:print]   sparse_gradients_enabled ..... False
[2025-03-28 00:56:26,017] [INFO] [config.py:1005:print]   steps_per_print .............. 50
[2025-03-28 00:56:26,017] [INFO] [config.py:1005:print]   tensor_parallel_config ....... dtype=torch.float16 autotp_size=0 tensor_parallel=TPConfig(tp_size=1, tp_grain_size=1, mpu=None, tp_group=None) injection_policy_tuple=None keep_module_on_host=False replace_with_kernel_inject=False
[2025-03-28 00:56:26,017] [INFO] [config.py:1005:print]   timers_config ................ enabled=True synchronized=True
[2025-03-28 00:56:26,017] [INFO] [config.py:1005:print]   train_batch_size ............. 256
[2025-03-28 00:56:26,017] [INFO] [config.py:1005:print]   train_micro_batch_size_per_gpu  256
[2025-03-28 00:56:26,017] [INFO] [config.py:1005:print]   use_data_before_expert_parallel_  False
[2025-03-28 00:56:26,017] [INFO] [config.py:1005:print]   use_node_local_storage ....... False
[2025-03-28 00:56:26,017] [INFO] [config.py:1005:print]   wall_clock_breakdown ......... False
[2025-03-28 00:56:26,017] [INFO] [config.py:1005:print]   weight_quantization_config ... None
[2025-03-28 00:56:26,017] [INFO] [config.py:1005:print]   world_size ................... 1
[2025-03-28 00:56:26,017] [INFO] [config.py:1005:print]   zero_allow_untested_optimizer  False
[2025-03-28 00:56:26,017] [INFO] [config.py:1005:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=500000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50000000 param_persistence_threshold=100000 model_persistence_threshold=9223372036854775807 max_live_parameters=1000000000 max_reuse_distance=1000000000 gather_16bit_weights_on_model_save=False module_granularity_threshold=0 use_all_reduce_for_fetch_params=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False zeropp_loco_param=None mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True log_trace_cache_warnings=False
[2025-03-28 00:56:26,017] [INFO] [config.py:1005:print]   zero_enabled ................. True
[2025-03-28 00:56:26,017] [INFO] [config.py:1005:print]   zero_force_ds_cpu_optimizer .. True
[2025-03-28 00:56:26,018] [INFO] [config.py:1005:print]   zero_optimization_stage ...... 2
[2025-03-28 00:56:26,018] [INFO] [config.py:991:print_user_config]   json = {
    "train_batch_size": 256, 
    "gradient_accumulation_steps": 1, 
    "optimizer": {
        "type": "AdamW", 
        "params": {
            "lr": 0.0002, 
            "weight_decay": 0.01
        }
    }, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "loss_scale_window": 1000
    }, 
    "zero_optimization": {
        "stage": 2, 
        "contiguous_gradients": true, 
        "overlap_comm": true
    }, 
    "steps_per_print": 50, 
    "gradient_clipping": 1.0
}
****START TRAINING****
image_size: 8, batch_size: 256, timesteps: 1000, time_emb_dim: 32
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s][2025-03-28 00:56:30,689] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
 20%|█████████████████████                                                                                    | 1/5 [00:04<00:18,  4.61s/it][2025-03-28 00:56:30,736] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
 60%|███████████████████████████████████████████████████████████████                                          | 3/5 [00:04<00:02,  1.27s/it]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:04<00:00,  1.52it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:05<00:00,  1.00s/it]
/hpc2hdd/home/yli045/diffusion_noise_agent/train.py:189: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  df = pd.concat([df, pd.DataFrame([new_row])], ignore_index=True) # 使用 pd.concat 追加数据
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:01,  3.85it/s] 60%|███████████████████████████████████████████████████████████████                                          | 3/5 [00:00<00:00,  9.55it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 12.87it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  9.43it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:01,  3.99it/s] 60%|███████████████████████████████████████████████████████████████                                          | 3/5 [00:00<00:00,  9.77it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 12.91it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  9.55it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:01,  2.00it/s] 60%|███████████████████████████████████████████████████████████████                                          | 3/5 [00:00<00:00,  5.96it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  6.56it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:01,  3.62it/s] 60%|███████████████████████████████████████████████████████████████                                          | 3/5 [00:00<00:00,  9.12it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 12.56it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  9.18it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:02,  1.95it/s] 60%|███████████████████████████████████████████████████████████████                                          | 3/5 [00:00<00:00,  5.86it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  9.10it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  6.37it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:00,  4.33it/s] 60%|███████████████████████████████████████████████████████████████                                          | 3/5 [00:00<00:00, 10.16it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 13.51it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  9.95it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:02,  1.92it/s] 60%|███████████████████████████████████████████████████████████████                                          | 3/5 [00:00<00:00,  5.79it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  9.08it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  6.32it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:01,  3.80it/s] 60%|███████████████████████████████████████████████████████████████                                          | 3/5 [00:00<00:00,  9.50it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 12.94it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  9.52it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:00,  4.46it/s] 80%|████████████████████████████████████████████████████████████████████████████████████                     | 4/5 [00:00<00:00, 12.51it/s][2025-03-28 00:56:36,677] [INFO] [logging.py:128:log_dist] [Rank 0] step=50, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 00:56:36,680] [INFO] [timer.py:264:stop] epoch=0/micro_step=50/global_step=50, RunningAvgSamplesPerSec=2650.130335163312, CurrSamplesPerSec=5157.504307970042, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 10.60it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:01,  2.07it/s] 60%|███████████████████████████████████████████████████████████████                                          | 3/5 [00:00<00:00,  6.15it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  9.41it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  6.58it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:00,  4.53it/s] 80%|████████████████████████████████████████████████████████████████████████████████████                     | 4/5 [00:00<00:00, 12.27it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 10.30it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:02,  1.99it/s] 60%|███████████████████████████████████████████████████████████████                                          | 3/5 [00:00<00:00,  5.96it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  9.22it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  6.47it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:01,  3.85it/s] 80%|████████████████████████████████████████████████████████████████████████████████████                     | 4/5 [00:00<00:00, 11.81it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  9.01it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:01,  2.12it/s] 60%|███████████████████████████████████████████████████████████████                                          | 3/5 [00:00<00:00,  6.22it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  9.56it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  6.75it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:00,  4.14it/s] 60%|███████████████████████████████████████████████████████████████                                          | 3/5 [00:00<00:00,  9.87it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 13.17it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  9.73it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:01,  2.03it/s] 60%|███████████████████████████████████████████████████████████████                                          | 3/5 [00:00<00:00,  6.06it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  9.40it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  6.56it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:00,  4.24it/s] 80%|████████████████████████████████████████████████████████████████████████████████████                     | 4/5 [00:00<00:00, 12.31it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 10.98it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:02,  1.69it/s] 60%|███████████████████████████████████████████████████████████████                                          | 3/5 [00:00<00:00,  5.23it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  5.92it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:00,  4.68it/s] 80%|████████████████████████████████████████████████████████████████████████████████████                     | 4/5 [00:00<00:00, 12.98it/s][2025-03-28 00:56:43,251] [INFO] [logging.py:128:log_dist] [Rank 0] step=100, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 00:56:43,252] [INFO] [timer.py:264:stop] epoch=0/micro_step=100/global_step=100, RunningAvgSamplesPerSec=2621.6053002186018, CurrSamplesPerSec=5560.052940235575, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 10.89it/s]
[rank0]:[W328 00:56:51.837289301 ProcessGroupNCCL.cpp:1496] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[2025-03-28 00:56:53,243] [INFO] [launch.py:351:main] Process 570535 exits successfully.
[?2004h(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ bash scripts/script_normal_dif_test.sh 
[?2004l[2025-03-28 00:58:16,207] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-28 00:58:16,215] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-28 00:58:19,161] [WARNING] [runner.py:215:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2025-03-28 00:58:19,163] [INFO] [runner.py:607:main] cmd = /hpc2hdd/home/yli045/.conda/envs/ywj/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None main.py --image_size 8 --batch_size 256 --num_epochs 20 --timesteps 1000 --lr 2e-4 --time_emb_dim 32 --mu1 4 --sigma1 1 --num1 9000 --mu2 10 --sigma2 4 --num2 1000 --samples_dir ./samples --checkpoints_dir ./checkpoints --fp16 --mode train --model_path  --num_images 10000 --simulation_distribution normal --use_different_noise --use_moe --num_experts 2 --moe_hidden_dim 2 --moe_tau 0.1
[2025-03-28 00:58:21,910] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-28 00:58:21,918] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-28 00:58:23,148] [INFO] [launch.py:146:main] WORLD INFO DICT: {'localhost': [0]}
[2025-03-28 00:58:23,148] [INFO] [launch.py:152:main] nnodes=1, num_local_procs=1, node_rank=0
[2025-03-28 00:58:23,148] [INFO] [launch.py:163:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2025-03-28 00:58:23,148] [INFO] [launch.py:164:main] dist_world_size=1
[2025-03-28 00:58:23,148] [INFO] [launch.py:168:main] Setting CUDA_VISIBLE_DEVICES=0
[2025-03-28 00:58:23,149] [INFO] [launch.py:256:main] process 571585 spawned with command: ['/hpc2hdd/home/yli045/.conda/envs/ywj/bin/python', '-u', 'main.py', '--local_rank=0', '--image_size', '8', '--batch_size', '256', '--num_epochs', '20', '--timesteps', '1000', '--lr', '2e-4', '--time_emb_dim', '32', '--mu1', '4', '--sigma1', '1', '--num1', '9000', '--mu2', '10', '--sigma2', '4', '--num2', '1000', '--samples_dir', './samples', '--checkpoints_dir', './checkpoints', '--fp16', '--mode', 'train', '--model_path', '', '--num_images', '10000', '--simulation_distribution', 'normal', '--use_different_noise', '--use_moe', '--num_experts', '2', '--moe_hidden_dim', '2', '--moe_tau', '0.1']
[2025-03-28 00:58:27,159] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-03-28 00:58:34,295] [INFO] [logging.py:128:log_dist] [Rank -1] DeepSpeed info: version=0.16.4, git-hash=unknown, git-branch=unknown
[2025-03-28 00:58:34,296] [INFO] [comm.py:658:init_distributed] cdb=None
[2025-03-28 00:58:34,296] [INFO] [comm.py:689:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2025-03-28 00:58:34,299] [INFO] [config.py:734:__init__] Config mesh_device None world_size = 1
[2025-03-28 00:58:36,179] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
Using /hpc2hdd/home/yli045/.cache/torch_extensions/py312_cu124 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /hpc2hdd/home/yli045/.cache/torch_extensions/py312_cu124/fused_adam/build.ninja...
/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/utils/cpp_extension.py:2059: UserWarning: TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation. 
If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'].
  warnings.warn(
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 0.32532501220703125 seconds
[2025-03-28 00:58:36,514] [INFO] [logging.py:128:log_dist] [Rank 0] Using DeepSpeed Optimizer param name adamw as basic optimizer
[2025-03-28 00:58:36,514] [INFO] [logging.py:128:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2025-03-28 00:58:36,516] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Basic Optimizer = FusedAdam
[2025-03-28 00:58:36,517] [INFO] [utils.py:59:is_zero_supported_optimizer] Checking ZeRO support for optimizer=FusedAdam type=<class 'deepspeed.ops.adam.fused_adam.FusedAdam'>
[2025-03-28 00:58:36,517] [INFO] [logging.py:128:log_dist] [Rank 0] Creating torch.float16 ZeRO stage 2 optimizer
[2025-03-28 00:58:36,518] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 500000000
[2025-03-28 00:58:36,518] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 500000000
[2025-03-28 00:58:36,518] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2025-03-28 00:58:36,518] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2025-03-28 00:58:37,027] [INFO] [utils.py:781:see_memory_usage] Before initializing optimizer states
[2025-03-28 00:58:37,028] [INFO] [utils.py:782:see_memory_usage] MA 0.0 GB         Max_MA 0.0 GB         CA 0.0 GB         Max_CA 0 GB 
[2025-03-28 00:58:37,028] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 139.45 GB, percent = 13.8%
[2025-03-28 00:58:37,149] [INFO] [utils.py:781:see_memory_usage] After initializing optimizer states
[2025-03-28 00:58:37,150] [INFO] [utils.py:782:see_memory_usage] MA 0.0 GB         Max_MA 0.0 GB         CA 0.0 GB         Max_CA 0 GB 
[2025-03-28 00:58:37,150] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 139.18 GB, percent = 13.8%
[2025-03-28 00:58:37,150] [INFO] [stage_1_and_2.py:550:__init__] optimizer state initialized
[2025-03-28 00:58:37,267] [INFO] [utils.py:781:see_memory_usage] After initializing ZeRO optimizer
[2025-03-28 00:58:37,268] [INFO] [utils.py:782:see_memory_usage] MA 0.0 GB         Max_MA 0.0 GB         CA 0.0 GB         Max_CA 0 GB 
[2025-03-28 00:58:37,268] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 139.42 GB, percent = 13.8%
[2025-03-28 00:58:37,269] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Final Optimizer = DeepSpeedZeroOptimizer
[2025-03-28 00:58:37,269] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed using configured LR scheduler = None
[2025-03-28 00:58:37,269] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2025-03-28 00:58:37,269] [INFO] [logging.py:128:log_dist] [Rank 0] step=0, skipped=0, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 00:58:37,270] [INFO] [config.py:1001:print] DeepSpeedEngine configuration:
[2025-03-28 00:58:37,270] [INFO] [config.py:1005:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2025-03-28 00:58:37,270] [INFO] [config.py:1005:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'intra_op_parallelism': 1, 'single_submit': False, 'overlap_events': True, 'use_gds': False}
[2025-03-28 00:58:37,270] [INFO] [config.py:1005:print]   amp_enabled .................. False
[2025-03-28 00:58:37,270] [INFO] [config.py:1005:print]   amp_params ................... False
[2025-03-28 00:58:37,270] [INFO] [config.py:1005:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2025-03-28 00:58:37,270] [INFO] [config.py:1005:print]   bfloat16_enabled ............. False
[2025-03-28 00:58:37,270] [INFO] [config.py:1005:print]   bfloat16_immediate_grad_update  False
[2025-03-28 00:58:37,270] [INFO] [config.py:1005:print]   checkpoint_parallel_write_pipeline  False
[2025-03-28 00:58:37,270] [INFO] [config.py:1005:print]   checkpoint_tag_validation_enabled  True
[2025-03-28 00:58:37,270] [INFO] [config.py:1005:print]   checkpoint_tag_validation_fail  False
[2025-03-28 00:58:37,270] [INFO] [config.py:1005:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fd7840fe8d0>
[2025-03-28 00:58:37,270] [INFO] [config.py:1005:print]   communication_data_type ...... None
[2025-03-28 00:58:37,270] [INFO] [config.py:1005:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2025-03-28 00:58:37,271] [INFO] [config.py:1005:print]   curriculum_enabled_legacy .... False
[2025-03-28 00:58:37,271] [INFO] [config.py:1005:print]   curriculum_params_legacy ..... False
[2025-03-28 00:58:37,271] [INFO] [config.py:1005:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2025-03-28 00:58:37,271] [INFO] [config.py:1005:print]   data_efficiency_enabled ...... False
[2025-03-28 00:58:37,271] [INFO] [config.py:1005:print]   dataloader_drop_last ......... False
[2025-03-28 00:58:37,271] [INFO] [config.py:1005:print]   disable_allgather ............ False
[2025-03-28 00:58:37,271] [INFO] [config.py:1005:print]   dump_state ................... False
[2025-03-28 00:58:37,271] [INFO] [config.py:1005:print]   dynamic_loss_scale_args ...... {'init_scale': 65536, 'scale_window': 1000, 'delayed_shift': 2, 'consecutive_hysteresis': False, 'min_scale': 1}
[2025-03-28 00:58:37,271] [INFO] [config.py:1005:print]   eigenvalue_enabled ........... False
[2025-03-28 00:58:37,271] [INFO] [config.py:1005:print]   eigenvalue_gas_boundary_resolution  1
[2025-03-28 00:58:37,271] [INFO] [config.py:1005:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2025-03-28 00:58:37,271] [INFO] [config.py:1005:print]   eigenvalue_layer_num ......... 0
[2025-03-28 00:58:37,271] [INFO] [config.py:1005:print]   eigenvalue_max_iter .......... 100
[2025-03-28 00:58:37,271] [INFO] [config.py:1005:print]   eigenvalue_stability ......... 1e-06
[2025-03-28 00:58:37,271] [INFO] [config.py:1005:print]   eigenvalue_tol ............... 0.01
[2025-03-28 00:58:37,271] [INFO] [config.py:1005:print]   eigenvalue_verbose ........... False
[2025-03-28 00:58:37,271] [INFO] [config.py:1005:print]   elasticity_enabled ........... False
[2025-03-28 00:58:37,271] [INFO] [config.py:1005:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2025-03-28 00:58:37,271] [INFO] [config.py:1005:print]   fp16_auto_cast ............... False
[2025-03-28 00:58:37,271] [INFO] [config.py:1005:print]   fp16_enabled ................. True
[2025-03-28 00:58:37,271] [INFO] [config.py:1005:print]   fp16_master_weights_and_gradients  False
[2025-03-28 00:58:37,271] [INFO] [config.py:1005:print]   global_rank .................. 0
[2025-03-28 00:58:37,271] [INFO] [config.py:1005:print]   grad_accum_dtype ............. None
[2025-03-28 00:58:37,271] [INFO] [config.py:1005:print]   gradient_accumulation_steps .. 1
[2025-03-28 00:58:37,271] [INFO] [config.py:1005:print]   gradient_clipping ............ 1.0
[2025-03-28 00:58:37,272] [INFO] [config.py:1005:print]   gradient_predivide_factor .... 1.0
[2025-03-28 00:58:37,272] [INFO] [config.py:1005:print]   graph_harvesting ............. False
[2025-03-28 00:58:37,272] [INFO] [config.py:1005:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2025-03-28 00:58:37,272] [INFO] [config.py:1005:print]   initial_dynamic_scale ........ 65536
[2025-03-28 00:58:37,272] [INFO] [config.py:1005:print]   load_universal_checkpoint .... False
[2025-03-28 00:58:37,272] [INFO] [config.py:1005:print]   loss_scale ................... 0
[2025-03-28 00:58:37,272] [INFO] [config.py:1005:print]   memory_breakdown ............. False
[2025-03-28 00:58:37,272] [INFO] [config.py:1005:print]   mics_hierarchial_params_gather  False
[2025-03-28 00:58:37,272] [INFO] [config.py:1005:print]   mics_shard_size .............. -1
[2025-03-28 00:58:37,272] [INFO] [config.py:1005:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') comet=CometConfig(enabled=False, samples_log_interval=100, project=None, workspace=None, api_key=None, experiment_name=None, experiment_key=None, online=None, mode=None) wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName')
[2025-03-28 00:58:37,272] [INFO] [config.py:1005:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2025-03-28 00:58:37,272] [INFO] [config.py:1005:print]   optimizer_legacy_fusion ...... False
[2025-03-28 00:58:37,272] [INFO] [config.py:1005:print]   optimizer_name ............... adamw
[2025-03-28 00:58:37,272] [INFO] [config.py:1005:print]   optimizer_params ............. {'lr': 0.0002, 'weight_decay': 0.01}
[2025-03-28 00:58:37,272] [INFO] [config.py:1005:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2025-03-28 00:58:37,272] [INFO] [config.py:1005:print]   pld_enabled .................. False
[2025-03-28 00:58:37,272] [INFO] [config.py:1005:print]   pld_params ................... False
[2025-03-28 00:58:37,272] [INFO] [config.py:1005:print]   prescale_gradients ........... False
[2025-03-28 00:58:37,272] [INFO] [config.py:1005:print]   scheduler_name ............... None
[2025-03-28 00:58:37,272] [INFO] [config.py:1005:print]   scheduler_params ............. None
[2025-03-28 00:58:37,272] [INFO] [config.py:1005:print]   seq_parallel_communication_data_type  torch.float32
[2025-03-28 00:58:37,272] [INFO] [config.py:1005:print]   sparse_attention ............. None
[2025-03-28 00:58:37,272] [INFO] [config.py:1005:print]   sparse_gradients_enabled ..... False
[2025-03-28 00:58:37,273] [INFO] [config.py:1005:print]   steps_per_print .............. 50
[2025-03-28 00:58:37,273] [INFO] [config.py:1005:print]   tensor_parallel_config ....... dtype=torch.float16 autotp_size=0 tensor_parallel=TPConfig(tp_size=1, tp_grain_size=1, mpu=None, tp_group=None) injection_policy_tuple=None keep_module_on_host=False replace_with_kernel_inject=False
[2025-03-28 00:58:37,273] [INFO] [config.py:1005:print]   timers_config ................ enabled=True synchronized=True
[2025-03-28 00:58:37,273] [INFO] [config.py:1005:print]   train_batch_size ............. 256
[2025-03-28 00:58:37,273] [INFO] [config.py:1005:print]   train_micro_batch_size_per_gpu  256
[2025-03-28 00:58:37,273] [INFO] [config.py:1005:print]   use_data_before_expert_parallel_  False
[2025-03-28 00:58:37,273] [INFO] [config.py:1005:print]   use_node_local_storage ....... False
[2025-03-28 00:58:37,273] [INFO] [config.py:1005:print]   wall_clock_breakdown ......... False
[2025-03-28 00:58:37,273] [INFO] [config.py:1005:print]   weight_quantization_config ... None
[2025-03-28 00:58:37,273] [INFO] [config.py:1005:print]   world_size ................... 1
[2025-03-28 00:58:37,273] [INFO] [config.py:1005:print]   zero_allow_untested_optimizer  False
[2025-03-28 00:58:37,273] [INFO] [config.py:1005:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=500000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50000000 param_persistence_threshold=100000 model_persistence_threshold=9223372036854775807 max_live_parameters=1000000000 max_reuse_distance=1000000000 gather_16bit_weights_on_model_save=False module_granularity_threshold=0 use_all_reduce_for_fetch_params=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False zeropp_loco_param=None mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True log_trace_cache_warnings=False
[2025-03-28 00:58:37,273] [INFO] [config.py:1005:print]   zero_enabled ................. True
[2025-03-28 00:58:37,273] [INFO] [config.py:1005:print]   zero_force_ds_cpu_optimizer .. True
[2025-03-28 00:58:37,273] [INFO] [config.py:1005:print]   zero_optimization_stage ...... 2
[2025-03-28 00:58:37,273] [INFO] [config.py:991:print_user_config]   json = {
    "train_batch_size": 256, 
    "gradient_accumulation_steps": 1, 
    "optimizer": {
        "type": "AdamW", 
        "params": {
            "lr": 0.0002, 
            "weight_decay": 0.01
        }
    }, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "loss_scale_window": 1000
    }, 
    "zero_optimization": {
        "stage": 2, 
        "contiguous_gradients": true, 
        "overlap_comm": true
    }, 
    "steps_per_print": 50, 
    "gradient_clipping": 1.0
}
****START TRAINING****
image_size: 8, batch_size: 256, timesteps: 1000, time_emb_dim: 32
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s][2025-03-28 00:58:39,075] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
 20%|█████████████████████                                                                                    | 1/5 [00:01<00:07,  1.76s/it][2025-03-28 00:58:39,113] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
 60%|███████████████████████████████████████████████████████████████                                          | 3/5 [00:02<00:01,  1.71it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:02<00:00,  3.07it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:02<00:00,  2.16it/s]
/hpc2hdd/home/yli045/diffusion_noise_agent/train.py:189: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  df = pd.concat([df, pd.DataFrame([new_row])], ignore_index=True) # 使用 pd.concat 追加数据
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:01,  3.93it/s] 80%|████████████████████████████████████████████████████████████████████████████████████                     | 4/5 [00:00<00:00, 11.73it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  8.51it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:01,  4.00it/s] 60%|███████████████████████████████████████████████████████████████                                          | 3/5 [00:00<00:00,  9.63it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  9.60it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:01,  3.10it/s] 80%|████████████████████████████████████████████████████████████████████████████████████                     | 4/5 [00:00<00:00, 10.17it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  8.72it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:01,  3.82it/s] 80%|████████████████████████████████████████████████████████████████████████████████████                     | 4/5 [00:00<00:00, 11.17it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  9.50it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:00,  4.01it/s] 80%|████████████████████████████████████████████████████████████████████████████████████                     | 4/5 [00:00<00:00, 11.75it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  9.89it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:02,  1.88it/s] 80%|████████████████████████████████████████████████████████████████████████████████████                     | 4/5 [00:00<00:00,  7.21it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  6.39it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:00,  4.01it/s] 80%|████████████████████████████████████████████████████████████████████████████████████                     | 4/5 [00:00<00:00, 11.89it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 10.10it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:02,  1.99it/s] 80%|████████████████████████████████████████████████████████████████████████████████████                     | 4/5 [00:00<00:00,  7.59it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  6.69it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:00,  4.13it/s] 80%|████████████████████████████████████████████████████████████████████████████████████                     | 4/5 [00:00<00:00, 11.56it/s][2025-03-28 00:58:45,017] [INFO] [logging.py:128:log_dist] [Rank 0] step=50, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 00:58:45,018] [INFO] [timer.py:264:stop] epoch=0/micro_step=50/global_step=50, RunningAvgSamplesPerSec=2754.324001070315, CurrSamplesPerSec=5178.148234303074, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  9.80it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:02,  1.60it/s] 80%|████████████████████████████████████████████████████████████████████████████████████                     | 4/5 [00:00<00:00,  6.43it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  5.79it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:00,  4.03it/s] 80%|████████████████████████████████████████████████████████████████████████████████████                     | 4/5 [00:00<00:00, 11.93it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 10.11it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:01,  2.08it/s] 80%|████████████████████████████████████████████████████████████████████████████████████                     | 4/5 [00:00<00:00,  7.68it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  6.81it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:00,  4.34it/s] 80%|████████████████████████████████████████████████████████████████████████████████████                     | 4/5 [00:00<00:00, 12.45it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 10.75it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:01,  3.83it/s] 80%|████████████████████████████████████████████████████████████████████████████████████                     | 4/5 [00:00<00:00, 11.60it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 10.02it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:01,  2.98it/s] 80%|████████████████████████████████████████████████████████████████████████████████████                     | 4/5 [00:00<00:00,  9.92it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  8.57it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:01,  3.92it/s] 80%|████████████████████████████████████████████████████████████████████████████████████                     | 4/5 [00:00<00:00, 11.69it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  9.99it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:01,  3.19it/s] 80%|████████████████████████████████████████████████████████████████████████████████████                     | 4/5 [00:00<00:00, 10.42it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  8.91it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:01,  3.87it/s] 80%|████████████████████████████████████████████████████████████████████████████████████                     | 4/5 [00:00<00:00, 11.98it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 10.13it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:01,  3.90it/s] 80%|████████████████████████████████████████████████████████████████████████████████████                     | 4/5 [00:00<00:00, 11.55it/s][2025-03-28 00:58:50,950] [INFO] [logging.py:128:log_dist] [Rank 0] step=100, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 00:58:50,951] [INFO] [timer.py:264:stop] epoch=0/micro_step=100/global_step=100, RunningAvgSamplesPerSec=2813.3639475148793, CurrSamplesPerSec=5422.3307027474475, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  9.83it/s]
[rank0]: Traceback (most recent call last):
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/main.py", line 9, in <module>
[rank0]:     train_deepspeed(cfg)
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/train.py", line 209, in train_deepspeed
[rank0]:     generate_during_training(model_engine, sample_dir, config, epoch, num_images=config.num_images//config.image_size, p=p)
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/generate.py", line 233, in generate_during_training_simulation_dif
[rank0]:     pred_noise = model_engine(x, t_batch)
[rank0]:                  ^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/deepspeed/utils/nvtx.py", line 18, in wrapped_fn
[rank0]:     ret_val = func(*args, **kwargs)
[rank0]:               ^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/deepspeed/runtime/engine.py", line 1987, in forward
[rank0]:     loss = self.module(*inputs, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/unet.py", line 214, in forward
[rank0]:     x = self.up3(x, x1, t_embed)
[rank0]:         ^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/unet.py", line 70, in forward
[rank0]:     x = self.up(x)
[rank0]:         ^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/upsampling.py", line 172, in forward
[rank0]:     return F.interpolate(
[rank0]:            ^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/functional.py", line 4649, in interpolate
[rank0]:     return torch._C._nn.upsample_nearest2d(input, output_size, scale_factors)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]: torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 20.00 MiB. GPU 0 has a total capacity of 47.33 GiB of which 17.69 MiB is free. Process 3785418 has 294.00 MiB memory in use. Process 3794194 has 4.08 GiB memory in use. Process 3794200 has 9.98 GiB memory in use. Process 3794201 has 3.12 GiB memory in use. Process 3794198 has 4.08 GiB memory in use. Process 2464486 has 25.71 GiB memory in use. Of the allocated memory 24.21 GiB is allocated by PyTorch, and 868.45 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
[rank0]:[W328 00:59:11.497304453 ProcessGroupNCCL.cpp:1496] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[2025-03-28 00:59:13,155] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 571585
[2025-03-28 00:59:13,155] [ERROR] [launch.py:325:sigkill_handler] ['/hpc2hdd/home/yli045/.conda/envs/ywj/bin/python', '-u', 'main.py', '--local_rank=0', '--image_size', '8', '--batch_size', '256', '--num_epochs', '20', '--timesteps', '1000', '--lr', '2e-4', '--time_emb_dim', '32', '--mu1', '4', '--sigma1', '1', '--num1', '9000', '--mu2', '10', '--sigma2', '4', '--num2', '1000', '--samples_dir', './samples', '--checkpoints_dir', './checkpoints', '--fp16', '--mode', 'train', '--model_path', '', '--num_images', '10000', '--simulation_distribution', 'normal', '--use_different_noise', '--use_moe', '--num_experts', '2', '--moe_hidden_dim', '2', '--moe_tau', '0.1'] exits with return code = 1
[?2004h(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ bash scripts/script_normal_dif_test.sh [6Pcp ../diffusion_noise/train.py ./[14@archive/core_1/test[C[C[C[C[C[C[7P[C[C[C[C[C[C[C[C[C[C[8P[C[C[C[C[C[C[C[C[C[Cbash scripts/script_normal_dif_test.sh [7Pcp ../diffusion_noise/test.py ./[8@archive/[C[C[C[C[C[C[C[C[C[C[7@core_1/[C[C[C[C[C[C[C[C[C[C[14Ptrain[C[C[C[C[C[Cbash scripts/script_normal_dif_test.sh 
[?2004l[2025-03-28 00:59:54,064] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-28 00:59:54,072] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-28 00:59:59,637] [WARNING] [runner.py:215:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2025-03-28 00:59:59,638] [INFO] [runner.py:607:main] cmd = /hpc2hdd/home/yli045/.conda/envs/ywj/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None main.py --image_size 8 --batch_size 256 --num_epochs 20 --timesteps 1000 --lr 2e-4 --time_emb_dim 32 --mu1 4 --sigma1 1 --num1 9000 --mu2 10 --sigma2 4 --num2 1000 --samples_dir ./samples --checkpoints_dir ./checkpoints --fp16 --mode train --model_path  --num_images 1000 --simulation_distribution normal --use_different_noise --use_moe --num_experts 2 --moe_hidden_dim 2 --moe_tau 0.1
[2025-03-28 01:00:08,219] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-28 01:00:08,256] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-28 01:00:13,092] [INFO] [launch.py:146:main] WORLD INFO DICT: {'localhost': [0]}
[2025-03-28 01:00:13,092] [INFO] [launch.py:152:main] nnodes=1, num_local_procs=1, node_rank=0
[2025-03-28 01:00:13,092] [INFO] [launch.py:163:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2025-03-28 01:00:13,092] [INFO] [launch.py:164:main] dist_world_size=1
[2025-03-28 01:00:13,092] [INFO] [launch.py:168:main] Setting CUDA_VISIBLE_DEVICES=0
[2025-03-28 01:00:13,093] [INFO] [launch.py:256:main] process 572487 spawned with command: ['/hpc2hdd/home/yli045/.conda/envs/ywj/bin/python', '-u', 'main.py', '--local_rank=0', '--image_size', '8', '--batch_size', '256', '--num_epochs', '20', '--timesteps', '1000', '--lr', '2e-4', '--time_emb_dim', '32', '--mu1', '4', '--sigma1', '1', '--num1', '9000', '--mu2', '10', '--sigma2', '4', '--num2', '1000', '--samples_dir', './samples', '--checkpoints_dir', './checkpoints', '--fp16', '--mode', 'train', '--model_path', '', '--num_images', '1000', '--simulation_distribution', 'normal', '--use_different_noise', '--use_moe', '--num_experts', '2', '--moe_hidden_dim', '2', '--moe_tau', '0.1']
[2025-03-28 01:00:19,505] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-03-28 01:00:25,200] [INFO] [logging.py:128:log_dist] [Rank -1] DeepSpeed info: version=0.16.4, git-hash=unknown, git-branch=unknown
[2025-03-28 01:00:25,201] [INFO] [comm.py:658:init_distributed] cdb=None
[2025-03-28 01:00:25,201] [INFO] [comm.py:689:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2025-03-28 01:00:25,250] [INFO] [config.py:734:__init__] Config mesh_device None world_size = 1
[2025-03-28 01:00:26,262] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
Using /hpc2hdd/home/yli045/.cache/torch_extensions/py312_cu124 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /hpc2hdd/home/yli045/.cache/torch_extensions/py312_cu124/fused_adam/build.ninja...
/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/utils/cpp_extension.py:2059: UserWarning: TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation. 
If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'].
  warnings.warn(
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 0.15689659118652344 seconds
[2025-03-28 01:00:26,424] [INFO] [logging.py:128:log_dist] [Rank 0] Using DeepSpeed Optimizer param name adamw as basic optimizer
[2025-03-28 01:00:26,424] [INFO] [logging.py:128:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2025-03-28 01:00:26,426] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Basic Optimizer = FusedAdam
[2025-03-28 01:00:26,426] [INFO] [utils.py:59:is_zero_supported_optimizer] Checking ZeRO support for optimizer=FusedAdam type=<class 'deepspeed.ops.adam.fused_adam.FusedAdam'>
[2025-03-28 01:00:26,426] [INFO] [logging.py:128:log_dist] [Rank 0] Creating torch.float16 ZeRO stage 2 optimizer
[2025-03-28 01:00:26,426] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 500000000
[2025-03-28 01:00:26,426] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 500000000
[2025-03-28 01:00:26,426] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2025-03-28 01:00:26,427] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2025-03-28 01:00:26,820] [INFO] [utils.py:781:see_memory_usage] Before initializing optimizer states
[2025-03-28 01:00:26,821] [INFO] [utils.py:782:see_memory_usage] MA 0.0 GB         Max_MA 0.0 GB         CA 0.0 GB         Max_CA 0 GB 
[2025-03-28 01:00:26,821] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 159.86 GB, percent = 15.9%
[2025-03-28 01:00:26,962] [INFO] [utils.py:781:see_memory_usage] After initializing optimizer states
[2025-03-28 01:00:26,962] [INFO] [utils.py:782:see_memory_usage] MA 0.0 GB         Max_MA 0.0 GB         CA 0.0 GB         Max_CA 0 GB 
[2025-03-28 01:00:26,962] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 159.45 GB, percent = 15.8%
[2025-03-28 01:00:26,963] [INFO] [stage_1_and_2.py:550:__init__] optimizer state initialized
[2025-03-28 01:00:27,097] [INFO] [utils.py:781:see_memory_usage] After initializing ZeRO optimizer
[2025-03-28 01:00:27,097] [INFO] [utils.py:782:see_memory_usage] MA 0.0 GB         Max_MA 0.0 GB         CA 0.0 GB         Max_CA 0 GB 
[2025-03-28 01:00:27,098] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 159.33 GB, percent = 15.8%
[2025-03-28 01:00:27,099] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Final Optimizer = DeepSpeedZeroOptimizer
[2025-03-28 01:00:27,099] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed using configured LR scheduler = None
[2025-03-28 01:00:27,099] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2025-03-28 01:00:27,099] [INFO] [logging.py:128:log_dist] [Rank 0] step=0, skipped=0, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:00:27,099] [INFO] [config.py:1001:print] DeepSpeedEngine configuration:
[2025-03-28 01:00:27,100] [INFO] [config.py:1005:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2025-03-28 01:00:27,100] [INFO] [config.py:1005:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'intra_op_parallelism': 1, 'single_submit': False, 'overlap_events': True, 'use_gds': False}
[2025-03-28 01:00:27,100] [INFO] [config.py:1005:print]   amp_enabled .................. False
[2025-03-28 01:00:27,100] [INFO] [config.py:1005:print]   amp_params ................... False
[2025-03-28 01:00:27,100] [INFO] [config.py:1005:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2025-03-28 01:00:27,100] [INFO] [config.py:1005:print]   bfloat16_enabled ............. False
[2025-03-28 01:00:27,100] [INFO] [config.py:1005:print]   bfloat16_immediate_grad_update  False
[2025-03-28 01:00:27,100] [INFO] [config.py:1005:print]   checkpoint_parallel_write_pipeline  False
[2025-03-28 01:00:27,100] [INFO] [config.py:1005:print]   checkpoint_tag_validation_enabled  True
[2025-03-28 01:00:27,100] [INFO] [config.py:1005:print]   checkpoint_tag_validation_fail  False
[2025-03-28 01:00:27,100] [INFO] [config.py:1005:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f372b6930e0>
[2025-03-28 01:00:27,100] [INFO] [config.py:1005:print]   communication_data_type ...... None
[2025-03-28 01:00:27,100] [INFO] [config.py:1005:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2025-03-28 01:00:27,100] [INFO] [config.py:1005:print]   curriculum_enabled_legacy .... False
[2025-03-28 01:00:27,101] [INFO] [config.py:1005:print]   curriculum_params_legacy ..... False
[2025-03-28 01:00:27,101] [INFO] [config.py:1005:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2025-03-28 01:00:27,101] [INFO] [config.py:1005:print]   data_efficiency_enabled ...... False
[2025-03-28 01:00:27,101] [INFO] [config.py:1005:print]   dataloader_drop_last ......... False
[2025-03-28 01:00:27,101] [INFO] [config.py:1005:print]   disable_allgather ............ False
[2025-03-28 01:00:27,101] [INFO] [config.py:1005:print]   dump_state ................... False
[2025-03-28 01:00:27,101] [INFO] [config.py:1005:print]   dynamic_loss_scale_args ...... {'init_scale': 65536, 'scale_window': 1000, 'delayed_shift': 2, 'consecutive_hysteresis': False, 'min_scale': 1}
[2025-03-28 01:00:27,101] [INFO] [config.py:1005:print]   eigenvalue_enabled ........... False
[2025-03-28 01:00:27,101] [INFO] [config.py:1005:print]   eigenvalue_gas_boundary_resolution  1
[2025-03-28 01:00:27,101] [INFO] [config.py:1005:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2025-03-28 01:00:27,101] [INFO] [config.py:1005:print]   eigenvalue_layer_num ......... 0
[2025-03-28 01:00:27,101] [INFO] [config.py:1005:print]   eigenvalue_max_iter .......... 100
[2025-03-28 01:00:27,101] [INFO] [config.py:1005:print]   eigenvalue_stability ......... 1e-06
[2025-03-28 01:00:27,101] [INFO] [config.py:1005:print]   eigenvalue_tol ............... 0.01
[2025-03-28 01:00:27,101] [INFO] [config.py:1005:print]   eigenvalue_verbose ........... False
[2025-03-28 01:00:27,101] [INFO] [config.py:1005:print]   elasticity_enabled ........... False
[2025-03-28 01:00:27,101] [INFO] [config.py:1005:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2025-03-28 01:00:27,101] [INFO] [config.py:1005:print]   fp16_auto_cast ............... False
[2025-03-28 01:00:27,101] [INFO] [config.py:1005:print]   fp16_enabled ................. True
[2025-03-28 01:00:27,101] [INFO] [config.py:1005:print]   fp16_master_weights_and_gradients  False
[2025-03-28 01:00:27,101] [INFO] [config.py:1005:print]   global_rank .................. 0
[2025-03-28 01:00:27,101] [INFO] [config.py:1005:print]   grad_accum_dtype ............. None
[2025-03-28 01:00:27,101] [INFO] [config.py:1005:print]   gradient_accumulation_steps .. 1
[2025-03-28 01:00:27,101] [INFO] [config.py:1005:print]   gradient_clipping ............ 1.0
[2025-03-28 01:00:27,101] [INFO] [config.py:1005:print]   gradient_predivide_factor .... 1.0
[2025-03-28 01:00:27,101] [INFO] [config.py:1005:print]   graph_harvesting ............. False
[2025-03-28 01:00:27,102] [INFO] [config.py:1005:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2025-03-28 01:00:27,102] [INFO] [config.py:1005:print]   initial_dynamic_scale ........ 65536
[2025-03-28 01:00:27,102] [INFO] [config.py:1005:print]   load_universal_checkpoint .... False
[2025-03-28 01:00:27,102] [INFO] [config.py:1005:print]   loss_scale ................... 0
[2025-03-28 01:00:27,102] [INFO] [config.py:1005:print]   memory_breakdown ............. False
[2025-03-28 01:00:27,102] [INFO] [config.py:1005:print]   mics_hierarchial_params_gather  False
[2025-03-28 01:00:27,102] [INFO] [config.py:1005:print]   mics_shard_size .............. -1
[2025-03-28 01:00:27,102] [INFO] [config.py:1005:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') comet=CometConfig(enabled=False, samples_log_interval=100, project=None, workspace=None, api_key=None, experiment_name=None, experiment_key=None, online=None, mode=None) wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName')
[2025-03-28 01:00:27,102] [INFO] [config.py:1005:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2025-03-28 01:00:27,102] [INFO] [config.py:1005:print]   optimizer_legacy_fusion ...... False
[2025-03-28 01:00:27,102] [INFO] [config.py:1005:print]   optimizer_name ............... adamw
[2025-03-28 01:00:27,102] [INFO] [config.py:1005:print]   optimizer_params ............. {'lr': 0.0002, 'weight_decay': 0.01}
[2025-03-28 01:00:27,102] [INFO] [config.py:1005:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2025-03-28 01:00:27,102] [INFO] [config.py:1005:print]   pld_enabled .................. False
[2025-03-28 01:00:27,102] [INFO] [config.py:1005:print]   pld_params ................... False
[2025-03-28 01:00:27,102] [INFO] [config.py:1005:print]   prescale_gradients ........... False
[2025-03-28 01:00:27,102] [INFO] [config.py:1005:print]   scheduler_name ............... None
[2025-03-28 01:00:27,102] [INFO] [config.py:1005:print]   scheduler_params ............. None
[2025-03-28 01:00:27,102] [INFO] [config.py:1005:print]   seq_parallel_communication_data_type  torch.float32
[2025-03-28 01:00:27,102] [INFO] [config.py:1005:print]   sparse_attention ............. None
[2025-03-28 01:00:27,102] [INFO] [config.py:1005:print]   sparse_gradients_enabled ..... False
[2025-03-28 01:00:27,102] [INFO] [config.py:1005:print]   steps_per_print .............. 50
[2025-03-28 01:00:27,102] [INFO] [config.py:1005:print]   tensor_parallel_config ....... dtype=torch.float16 autotp_size=0 tensor_parallel=TPConfig(tp_size=1, tp_grain_size=1, mpu=None, tp_group=None) injection_policy_tuple=None keep_module_on_host=False replace_with_kernel_inject=False
[2025-03-28 01:00:27,103] [INFO] [config.py:1005:print]   timers_config ................ enabled=True synchronized=True
[2025-03-28 01:00:27,103] [INFO] [config.py:1005:print]   train_batch_size ............. 256
[2025-03-28 01:00:27,103] [INFO] [config.py:1005:print]   train_micro_batch_size_per_gpu  256
[2025-03-28 01:00:27,103] [INFO] [config.py:1005:print]   use_data_before_expert_parallel_  False
[2025-03-28 01:00:27,103] [INFO] [config.py:1005:print]   use_node_local_storage ....... False
[2025-03-28 01:00:27,103] [INFO] [config.py:1005:print]   wall_clock_breakdown ......... False
[2025-03-28 01:00:27,103] [INFO] [config.py:1005:print]   weight_quantization_config ... None
[2025-03-28 01:00:27,103] [INFO] [config.py:1005:print]   world_size ................... 1
[2025-03-28 01:00:27,103] [INFO] [config.py:1005:print]   zero_allow_untested_optimizer  False
[2025-03-28 01:00:27,103] [INFO] [config.py:1005:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=500000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50000000 param_persistence_threshold=100000 model_persistence_threshold=9223372036854775807 max_live_parameters=1000000000 max_reuse_distance=1000000000 gather_16bit_weights_on_model_save=False module_granularity_threshold=0 use_all_reduce_for_fetch_params=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False zeropp_loco_param=None mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True log_trace_cache_warnings=False
[2025-03-28 01:00:27,103] [INFO] [config.py:1005:print]   zero_enabled ................. True
[2025-03-28 01:00:27,103] [INFO] [config.py:1005:print]   zero_force_ds_cpu_optimizer .. True
[2025-03-28 01:00:27,103] [INFO] [config.py:1005:print]   zero_optimization_stage ...... 2
[2025-03-28 01:00:27,103] [INFO] [config.py:991:print_user_config]   json = {
    "train_batch_size": 256, 
    "gradient_accumulation_steps": 1, 
    "optimizer": {
        "type": "AdamW", 
        "params": {
            "lr": 0.0002, 
            "weight_decay": 0.01
        }
    }, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "loss_scale_window": 1000
    }, 
    "zero_optimization": {
        "stage": 2, 
        "contiguous_gradients": true, 
        "overlap_comm": true
    }, 
    "steps_per_print": 50, 
    "gradient_clipping": 1.0
}
****START TRAINING****
image_size: 8, batch_size: 256, timesteps: 1000, time_emb_dim: 32
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s][2025-03-28 01:00:28,658] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
 20%|█████████████████████                                                                                    | 1/5 [00:01<00:06,  1.51s/it][2025-03-28 01:00:28,694] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
 60%|███████████████████████████████████████████████████████████████                                          | 3/5 [00:01<00:00,  2.19it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:01<00:00,  3.84it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:01<00:00,  2.66it/s]
/hpc2hdd/home/yli045/diffusion_noise_agent/train.py:189: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  df = pd.concat([df, pd.DataFrame([new_row])], ignore_index=True) # 使用 pd.concat 追加数据
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:01,  2.72it/s] 80%|████████████████████████████████████████████████████████████████████████████████████                     | 4/5 [00:00<00:00,  9.37it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  8.51it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:01,  3.22it/s] 60%|███████████████████████████████████████████████████████████████                                          | 3/5 [00:00<00:00,  8.47it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  8.73it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:02,  1.95it/s] 60%|███████████████████████████████████████████████████████████████                                          | 3/5 [00:00<00:00,  5.86it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  9.18it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  6.39it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:01,  3.45it/s] 60%|███████████████████████████████████████████████████████████████                                          | 3/5 [00:00<00:00,  8.65it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 12.07it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  8.82it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:01,  2.36it/s] 60%|███████████████████████████████████████████████████████████████                                          | 3/5 [00:00<00:00,  6.75it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 10.23it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  7.27it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:01,  2.82it/s] 60%|███████████████████████████████████████████████████████████████                                          | 3/5 [00:00<00:00,  7.59it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 11.01it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  7.94it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:01,  2.47it/s] 60%|███████████████████████████████████████████████████████████████                                          | 3/5 [00:00<00:00,  6.84it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 10.24it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  7.34it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:01,  3.22it/s] 60%|███████████████████████████████████████████████████████████████                                          | 3/5 [00:00<00:00,  8.37it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 11.64it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  8.53it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:01,  2.26it/s] 60%|███████████████████████████████████████████████████████████████                                          | 3/5 [00:00<00:00,  6.57it/s][2025-03-28 01:00:34,982] [INFO] [logging.py:128:log_dist] [Rank 0] step=50, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:00:34,983] [INFO] [timer.py:264:stop] epoch=0/micro_step=50/global_step=50, RunningAvgSamplesPerSec=2497.523418312772, CurrSamplesPerSec=5455.223667507776, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  7.10it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:01,  3.53it/s] 60%|███████████████████████████████████████████████████████████████                                          | 3/5 [00:00<00:00,  9.04it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 12.30it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  9.02it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:01,  2.22it/s] 80%|████████████████████████████████████████████████████████████████████████████████████                     | 4/5 [00:00<00:00,  8.16it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  7.29it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:00,  4.35it/s] 80%|████████████████████████████████████████████████████████████████████████████████████                     | 4/5 [00:00<00:00, 12.20it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 10.43it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:02,  1.81it/s] 60%|███████████████████████████████████████████████████████████████                                          | 3/5 [00:00<00:00,  5.49it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  8.68it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  6.07it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:01,  3.06it/s] 60%|███████████████████████████████████████████████████████████████                                          | 3/5 [00:00<00:00,  8.10it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  9.00it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:01,  2.05it/s] 80%|████████████████████████████████████████████████████████████████████████████████████                     | 4/5 [00:00<00:00,  7.68it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  6.82it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:01,  3.65it/s] 60%|███████████████████████████████████████████████████████████████                                          | 3/5 [00:00<00:00,  9.12it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 12.37it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  9.10it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:01,  3.74it/s] 60%|███████████████████████████████████████████████████████████████                                          | 3/5 [00:00<00:00,  9.25it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  9.32it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:01,  3.52it/s] 60%|███████████████████████████████████████████████████████████████                                          | 3/5 [00:00<00:00,  9.03it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  9.31it/s]
  0%|                                                                                                                 | 0/5 [00:00<?, ?it/s] 20%|█████████████████████                                                                                    | 1/5 [00:00<00:01,  2.60it/s] 80%|████████████████████████████████████████████████████████████████████████████████████                     | 4/5 [00:00<00:00,  9.03it/s][2025-03-28 01:00:41,296] [INFO] [logging.py:128:log_dist] [Rank 0] step=100, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:00:41,297] [INFO] [timer.py:264:stop] epoch=0/micro_step=100/global_step=100, RunningAvgSamplesPerSec=2563.359418040936, CurrSamplesPerSec=5291.370598037321, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  7.83it/s]
[rank0]:[W328 01:00:51.055465756 ProcessGroupNCCL.cpp:1496] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[2025-03-28 01:00:53,143] [INFO] [launch.py:351:main] Process 572487 exits successfully.
[?2004h(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ bash scripts/script_normal_dif_test.sh 
[?2004l[2025-03-28 01:02:15,506] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-28 01:02:15,513] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-28 01:02:17,669] [WARNING] [runner.py:215:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2025-03-28 01:02:17,800] [INFO] [runner.py:607:main] cmd = /hpc2hdd/home/yli045/.conda/envs/ywj/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None main.py --image_size 16 --batch_size 256 --num_epochs 20 --timesteps 1000 --lr 2e-4 --time_emb_dim 32 --mu1 4 --sigma1 1 --num1 9000 --mu2 10 --sigma2 4 --num2 1000 --samples_dir ./samples --checkpoints_dir ./checkpoints --fp16 --mode train --model_path  --num_images 1000 --simulation_distribution normal --use_different_noise --use_moe --num_experts 2 --moe_hidden_dim 2 --moe_tau 0.1
[2025-03-28 01:02:24,273] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-28 01:02:24,281] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-28 01:02:27,772] [INFO] [launch.py:146:main] WORLD INFO DICT: {'localhost': [0]}
[2025-03-28 01:02:27,772] [INFO] [launch.py:152:main] nnodes=1, num_local_procs=1, node_rank=0
[2025-03-28 01:02:27,773] [INFO] [launch.py:163:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2025-03-28 01:02:27,773] [INFO] [launch.py:164:main] dist_world_size=1
[2025-03-28 01:02:27,773] [INFO] [launch.py:168:main] Setting CUDA_VISIBLE_DEVICES=0
[2025-03-28 01:02:27,783] [INFO] [launch.py:256:main] process 573457 spawned with command: ['/hpc2hdd/home/yli045/.conda/envs/ywj/bin/python', '-u', 'main.py', '--local_rank=0', '--image_size', '16', '--batch_size', '256', '--num_epochs', '20', '--timesteps', '1000', '--lr', '2e-4', '--time_emb_dim', '32', '--mu1', '4', '--sigma1', '1', '--num1', '9000', '--mu2', '10', '--sigma2', '4', '--num2', '1000', '--samples_dir', './samples', '--checkpoints_dir', './checkpoints', '--fp16', '--mode', 'train', '--model_path', '', '--num_images', '1000', '--simulation_distribution', 'normal', '--use_different_noise', '--use_moe', '--num_experts', '2', '--moe_hidden_dim', '2', '--moe_tau', '0.1']
[2025-03-28 01:02:32,443] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-03-28 01:02:45,698] [INFO] [logging.py:128:log_dist] [Rank -1] DeepSpeed info: version=0.16.4, git-hash=unknown, git-branch=unknown
[2025-03-28 01:02:45,699] [INFO] [comm.py:658:init_distributed] cdb=None
[2025-03-28 01:02:45,699] [INFO] [comm.py:689:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2025-03-28 01:02:45,705] [INFO] [config.py:734:__init__] Config mesh_device None world_size = 1
[2025-03-28 01:02:47,318] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
Using /hpc2hdd/home/yli045/.cache/torch_extensions/py312_cu124 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /hpc2hdd/home/yli045/.cache/torch_extensions/py312_cu124/fused_adam/build.ninja...
/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/utils/cpp_extension.py:2059: UserWarning: TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation. 
If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'].
  warnings.warn(
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 0.21222567558288574 seconds
[2025-03-28 01:02:47,536] [INFO] [logging.py:128:log_dist] [Rank 0] Using DeepSpeed Optimizer param name adamw as basic optimizer
[2025-03-28 01:02:47,536] [INFO] [logging.py:128:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2025-03-28 01:02:47,538] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Basic Optimizer = FusedAdam
[2025-03-28 01:02:47,538] [INFO] [utils.py:59:is_zero_supported_optimizer] Checking ZeRO support for optimizer=FusedAdam type=<class 'deepspeed.ops.adam.fused_adam.FusedAdam'>
[2025-03-28 01:02:47,539] [INFO] [logging.py:128:log_dist] [Rank 0] Creating torch.float16 ZeRO stage 2 optimizer
[2025-03-28 01:02:47,539] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 500000000
[2025-03-28 01:02:47,539] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 500000000
[2025-03-28 01:02:47,539] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2025-03-28 01:02:47,540] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2025-03-28 01:02:48,393] [INFO] [utils.py:781:see_memory_usage] Before initializing optimizer states
[2025-03-28 01:02:48,394] [INFO] [utils.py:782:see_memory_usage] MA 0.0 GB         Max_MA 0.0 GB         CA 0.02 GB         Max_CA 0 GB 
[2025-03-28 01:02:48,394] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 159.89 GB, percent = 15.9%
[2025-03-28 01:02:48,525] [INFO] [utils.py:781:see_memory_usage] After initializing optimizer states
[2025-03-28 01:02:48,526] [INFO] [utils.py:782:see_memory_usage] MA 0.0 GB         Max_MA 0.0 GB         CA 0.02 GB         Max_CA 0 GB 
[2025-03-28 01:02:48,526] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 160.16 GB, percent = 15.9%
[2025-03-28 01:02:48,526] [INFO] [stage_1_and_2.py:550:__init__] optimizer state initialized
[2025-03-28 01:02:48,658] [INFO] [utils.py:781:see_memory_usage] After initializing ZeRO optimizer
[2025-03-28 01:02:48,658] [INFO] [utils.py:782:see_memory_usage] MA 0.0 GB         Max_MA 0.0 GB         CA 0.02 GB         Max_CA 0 GB 
[2025-03-28 01:02:48,658] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 159.74 GB, percent = 15.9%
[2025-03-28 01:02:48,660] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Final Optimizer = DeepSpeedZeroOptimizer
[2025-03-28 01:02:48,660] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed using configured LR scheduler = None
[2025-03-28 01:02:48,660] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2025-03-28 01:02:48,660] [INFO] [logging.py:128:log_dist] [Rank 0] step=0, skipped=0, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:02:48,660] [INFO] [config.py:1001:print] DeepSpeedEngine configuration:
[2025-03-28 01:02:48,660] [INFO] [config.py:1005:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2025-03-28 01:02:48,660] [INFO] [config.py:1005:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'intra_op_parallelism': 1, 'single_submit': False, 'overlap_events': True, 'use_gds': False}
[2025-03-28 01:02:48,660] [INFO] [config.py:1005:print]   amp_enabled .................. False
[2025-03-28 01:02:48,661] [INFO] [config.py:1005:print]   amp_params ................... False
[2025-03-28 01:02:48,661] [INFO] [config.py:1005:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2025-03-28 01:02:48,661] [INFO] [config.py:1005:print]   bfloat16_enabled ............. False
[2025-03-28 01:02:48,661] [INFO] [config.py:1005:print]   bfloat16_immediate_grad_update  False
[2025-03-28 01:02:48,661] [INFO] [config.py:1005:print]   checkpoint_parallel_write_pipeline  False
[2025-03-28 01:02:48,661] [INFO] [config.py:1005:print]   checkpoint_tag_validation_enabled  True
[2025-03-28 01:02:48,661] [INFO] [config.py:1005:print]   checkpoint_tag_validation_fail  False
[2025-03-28 01:02:48,661] [INFO] [config.py:1005:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fb2aaa8c0b0>
[2025-03-28 01:02:48,661] [INFO] [config.py:1005:print]   communication_data_type ...... None
[2025-03-28 01:02:48,661] [INFO] [config.py:1005:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2025-03-28 01:02:48,661] [INFO] [config.py:1005:print]   curriculum_enabled_legacy .... False
[2025-03-28 01:02:48,661] [INFO] [config.py:1005:print]   curriculum_params_legacy ..... False
[2025-03-28 01:02:48,661] [INFO] [config.py:1005:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2025-03-28 01:02:48,661] [INFO] [config.py:1005:print]   data_efficiency_enabled ...... False
[2025-03-28 01:02:48,661] [INFO] [config.py:1005:print]   dataloader_drop_last ......... False
[2025-03-28 01:02:48,661] [INFO] [config.py:1005:print]   disable_allgather ............ False
[2025-03-28 01:02:48,661] [INFO] [config.py:1005:print]   dump_state ................... False
[2025-03-28 01:02:48,661] [INFO] [config.py:1005:print]   dynamic_loss_scale_args ...... {'init_scale': 65536, 'scale_window': 1000, 'delayed_shift': 2, 'consecutive_hysteresis': False, 'min_scale': 1}
[2025-03-28 01:02:48,661] [INFO] [config.py:1005:print]   eigenvalue_enabled ........... False
[2025-03-28 01:02:48,661] [INFO] [config.py:1005:print]   eigenvalue_gas_boundary_resolution  1
[2025-03-28 01:02:48,661] [INFO] [config.py:1005:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2025-03-28 01:02:48,661] [INFO] [config.py:1005:print]   eigenvalue_layer_num ......... 0
[2025-03-28 01:02:48,662] [INFO] [config.py:1005:print]   eigenvalue_max_iter .......... 100
[2025-03-28 01:02:48,662] [INFO] [config.py:1005:print]   eigenvalue_stability ......... 1e-06
[2025-03-28 01:02:48,662] [INFO] [config.py:1005:print]   eigenvalue_tol ............... 0.01
[2025-03-28 01:02:48,662] [INFO] [config.py:1005:print]   eigenvalue_verbose ........... False
[2025-03-28 01:02:48,662] [INFO] [config.py:1005:print]   elasticity_enabled ........... False
[2025-03-28 01:02:48,662] [INFO] [config.py:1005:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2025-03-28 01:02:48,662] [INFO] [config.py:1005:print]   fp16_auto_cast ............... False
[2025-03-28 01:02:48,662] [INFO] [config.py:1005:print]   fp16_enabled ................. True
[2025-03-28 01:02:48,662] [INFO] [config.py:1005:print]   fp16_master_weights_and_gradients  False
[2025-03-28 01:02:48,662] [INFO] [config.py:1005:print]   global_rank .................. 0
[2025-03-28 01:02:48,662] [INFO] [config.py:1005:print]   grad_accum_dtype ............. None
[2025-03-28 01:02:48,662] [INFO] [config.py:1005:print]   gradient_accumulation_steps .. 1
[2025-03-28 01:02:48,662] [INFO] [config.py:1005:print]   gradient_clipping ............ 1.0
[2025-03-28 01:02:48,662] [INFO] [config.py:1005:print]   gradient_predivide_factor .... 1.0
[2025-03-28 01:02:48,662] [INFO] [config.py:1005:print]   graph_harvesting ............. False
[2025-03-28 01:02:48,662] [INFO] [config.py:1005:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2025-03-28 01:02:48,662] [INFO] [config.py:1005:print]   initial_dynamic_scale ........ 65536
[2025-03-28 01:02:48,662] [INFO] [config.py:1005:print]   load_universal_checkpoint .... False
[2025-03-28 01:02:48,662] [INFO] [config.py:1005:print]   loss_scale ................... 0
[2025-03-28 01:02:48,662] [INFO] [config.py:1005:print]   memory_breakdown ............. False
[2025-03-28 01:02:48,662] [INFO] [config.py:1005:print]   mics_hierarchial_params_gather  False
[2025-03-28 01:02:48,662] [INFO] [config.py:1005:print]   mics_shard_size .............. -1
[2025-03-28 01:02:48,662] [INFO] [config.py:1005:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') comet=CometConfig(enabled=False, samples_log_interval=100, project=None, workspace=None, api_key=None, experiment_name=None, experiment_key=None, online=None, mode=None) wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName')
[2025-03-28 01:02:48,663] [INFO] [config.py:1005:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2025-03-28 01:02:48,663] [INFO] [config.py:1005:print]   optimizer_legacy_fusion ...... False
[2025-03-28 01:02:48,663] [INFO] [config.py:1005:print]   optimizer_name ............... adamw
[2025-03-28 01:02:48,663] [INFO] [config.py:1005:print]   optimizer_params ............. {'lr': 0.0002, 'weight_decay': 0.01}
[2025-03-28 01:02:48,663] [INFO] [config.py:1005:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2025-03-28 01:02:48,663] [INFO] [config.py:1005:print]   pld_enabled .................. False
[2025-03-28 01:02:48,663] [INFO] [config.py:1005:print]   pld_params ................... False
[2025-03-28 01:02:48,663] [INFO] [config.py:1005:print]   prescale_gradients ........... False
[2025-03-28 01:02:48,663] [INFO] [config.py:1005:print]   scheduler_name ............... None
[2025-03-28 01:02:48,663] [INFO] [config.py:1005:print]   scheduler_params ............. None
[2025-03-28 01:02:48,663] [INFO] [config.py:1005:print]   seq_parallel_communication_data_type  torch.float32
[2025-03-28 01:02:48,663] [INFO] [config.py:1005:print]   sparse_attention ............. None
[2025-03-28 01:02:48,663] [INFO] [config.py:1005:print]   sparse_gradients_enabled ..... False
[2025-03-28 01:02:48,663] [INFO] [config.py:1005:print]   steps_per_print .............. 50
[2025-03-28 01:02:48,663] [INFO] [config.py:1005:print]   tensor_parallel_config ....... dtype=torch.float16 autotp_size=0 tensor_parallel=TPConfig(tp_size=1, tp_grain_size=1, mpu=None, tp_group=None) injection_policy_tuple=None keep_module_on_host=False replace_with_kernel_inject=False
[2025-03-28 01:02:48,663] [INFO] [config.py:1005:print]   timers_config ................ enabled=True synchronized=True
[2025-03-28 01:02:48,663] [INFO] [config.py:1005:print]   train_batch_size ............. 256
[2025-03-28 01:02:48,663] [INFO] [config.py:1005:print]   train_micro_batch_size_per_gpu  256
[2025-03-28 01:02:48,663] [INFO] [config.py:1005:print]   use_data_before_expert_parallel_  False
[2025-03-28 01:02:48,663] [INFO] [config.py:1005:print]   use_node_local_storage ....... False
[2025-03-28 01:02:48,663] [INFO] [config.py:1005:print]   wall_clock_breakdown ......... False
[2025-03-28 01:02:48,663] [INFO] [config.py:1005:print]   weight_quantization_config ... None
[2025-03-28 01:02:48,663] [INFO] [config.py:1005:print]   world_size ................... 1
[2025-03-28 01:02:48,663] [INFO] [config.py:1005:print]   zero_allow_untested_optimizer  False
[2025-03-28 01:02:48,663] [INFO] [config.py:1005:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=500000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50000000 param_persistence_threshold=100000 model_persistence_threshold=9223372036854775807 max_live_parameters=1000000000 max_reuse_distance=1000000000 gather_16bit_weights_on_model_save=False module_granularity_threshold=0 use_all_reduce_for_fetch_params=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False zeropp_loco_param=None mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True log_trace_cache_warnings=False
[2025-03-28 01:02:48,664] [INFO] [config.py:1005:print]   zero_enabled ................. True
[2025-03-28 01:02:48,664] [INFO] [config.py:1005:print]   zero_force_ds_cpu_optimizer .. True
[2025-03-28 01:02:48,664] [INFO] [config.py:1005:print]   zero_optimization_stage ...... 2
[2025-03-28 01:02:48,664] [INFO] [config.py:991:print_user_config]   json = {
    "train_batch_size": 256, 
    "gradient_accumulation_steps": 1, 
    "optimizer": {
        "type": "AdamW", 
        "params": {
            "lr": 0.0002, 
            "weight_decay": 0.01
        }
    }, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "loss_scale_window": 1000
    }, 
    "zero_optimization": {
        "stage": 2, 
        "contiguous_gradients": true, 
        "overlap_comm": true
    }, 
    "steps_per_print": 50, 
    "gradient_clipping": 1.0
}
****START TRAINING****
image_size: 16, batch_size: 256, timesteps: 1000, time_emb_dim: 32
  0%|                                                                                                                 | 0/3 [00:00<?, ?it/s][2025-03-28 01:02:51,663] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
 33%|███████████████████████████████████                                                                      | 1/3 [00:02<00:05,  2.93s/it][2025-03-28 01:02:51,708] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:03<00:00,  1.16it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:03<00:00,  1.08s/it]
/hpc2hdd/home/yli045/diffusion_noise_agent/train.py:189: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  df = pd.concat([df, pd.DataFrame([new_row])], ignore_index=True) # 使用 pd.concat 追加数据
  0%|                                                                                                                 | 0/3 [00:00<?, ?it/s] 33%|███████████████████████████████████                                                                      | 1/3 [00:00<00:01,  1.69it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00,  4.07it/s]
  0%|                                                                                                                 | 0/3 [00:00<?, ?it/s] 33%|███████████████████████████████████                                                                      | 1/3 [00:00<00:00,  3.56it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00,  8.88it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00,  6.67it/s]
  0%|                                                                                                                 | 0/3 [00:00<?, ?it/s] 33%|███████████████████████████████████                                                                      | 1/3 [00:00<00:00,  2.92it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00,  7.79it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00,  5.86it/s]
  0%|                                                                                                                 | 0/3 [00:00<?, ?it/s] 33%|███████████████████████████████████                                                                      | 1/3 [00:00<00:01,  1.99it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00,  5.98it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00,  4.55it/s]
  0%|                                                                                                                 | 0/3 [00:00<?, ?it/s] 33%|███████████████████████████████████                                                                      | 1/3 [00:00<00:00,  3.63it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00,  9.11it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00,  6.83it/s]
  0%|                                                                                                                 | 0/3 [00:00<?, ?it/s] 33%|███████████████████████████████████                                                                      | 1/3 [00:00<00:00,  2.36it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00,  6.69it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00,  4.93it/s]
  0%|                                                                                                                 | 0/3 [00:00<?, ?it/s] 33%|███████████████████████████████████                                                                      | 1/3 [00:00<00:00,  3.84it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00,  7.26it/s]
  0%|                                                                                                                 | 0/3 [00:00<?, ?it/s] 33%|███████████████████████████████████                                                                      | 1/3 [00:00<00:00,  2.61it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00,  7.18it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00,  5.55it/s]
  0%|                                                                                                                 | 0/3 [00:00<?, ?it/s] 33%|███████████████████████████████████                                                                      | 1/3 [00:00<00:01,  1.87it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00,  5.61it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00,  4.26it/s]
  0%|                                                                                                                 | 0/3 [00:00<?, ?it/s] 33%|███████████████████████████████████                                                                      | 1/3 [00:00<00:00,  3.28it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00,  6.56it/s]
  0%|                                                                                                                 | 0/3 [00:00<?, ?it/s] 33%|███████████████████████████████████                                                                      | 1/3 [00:00<00:00,  3.57it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00,  9.01it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00,  6.95it/s]
  0%|                                                                                                                 | 0/3 [00:00<?, ?it/s] 33%|███████████████████████████████████                                                                      | 1/3 [00:00<00:00,  3.02it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00,  7.96it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00,  6.03it/s]
  0%|                                                                                                                 | 0/3 [00:00<?, ?it/s] 33%|███████████████████████████████████                                                                      | 1/3 [00:00<00:00,  3.49it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00,  6.75it/s]
  0%|                                                                                                                 | 0/3 [00:00<?, ?it/s] 33%|███████████████████████████████████                                                                      | 1/3 [00:00<00:01,  1.82it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00,  4.23it/s]
  0%|                                                                                                                 | 0/3 [00:00<?, ?it/s] 33%|███████████████████████████████████                                                                      | 1/3 [00:00<00:00,  3.69it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00,  9.07it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00,  6.87it/s]
  0%|                                                                                                                 | 0/3 [00:00<?, ?it/s] 33%|███████████████████████████████████                                                                      | 1/3 [00:00<00:00,  3.24it/s][2025-03-28 01:03:00,768] [INFO] [logging.py:128:log_dist] [Rank 0] step=50, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:03:00,771] [INFO] [timer.py:264:stop] epoch=0/micro_step=50/global_step=50, RunningAvgSamplesPerSec=1846.5071389862965, CurrSamplesPerSec=5030.479915658831, MemAllocated=0.02GB, MaxMemAllocated=1.93GB
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00,  8.45it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00,  6.43it/s]
  0%|                                                                                                                 | 0/3 [00:00<?, ?it/s] 33%|███████████████████████████████████                                                                      | 1/3 [00:00<00:00,  3.25it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00,  8.49it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00,  6.35it/s]
  0%|                                                                                                                 | 0/3 [00:00<?, ?it/s] 33%|███████████████████████████████████                                                                      | 1/3 [00:00<00:00,  3.18it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00,  6.52it/s]
  0%|                                                                                                                 | 0/3 [00:00<?, ?it/s] 33%|███████████████████████████████████                                                                      | 1/3 [00:00<00:00,  2.19it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00,  6.39it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00,  4.82it/s]
[rank0]:[W328 01:03:18.264551023 ProcessGroupNCCL.cpp:1496] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[2025-03-28 01:03:19,851] [INFO] [launch.py:351:main] Process 573457 exits successfully.
[?2004h(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ bash scripts/script_normal_dif_test.sh 
[?2004l[2025-03-28 01:03:58,088] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-28 01:03:58,096] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-28 01:03:59,997] [WARNING] [runner.py:215:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2025-03-28 01:03:59,998] [INFO] [runner.py:607:main] cmd = /hpc2hdd/home/yli045/.conda/envs/ywj/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None main.py --image_size 64 --batch_size 256 --num_epochs 20 --timesteps 1000 --lr 2e-4 --time_emb_dim 32 --mu1 4 --sigma1 1 --num1 9000 --mu2 10 --sigma2 4 --num2 1000 --samples_dir ./samples --checkpoints_dir ./checkpoints --fp16 --mode train --model_path  --num_images 1000 --simulation_distribution normal --use_different_noise --use_moe --num_experts 2 --moe_hidden_dim 2 --moe_tau 0.1
[2025-03-28 01:04:02,245] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-28 01:04:02,253] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-28 01:04:03,454] [INFO] [launch.py:146:main] WORLD INFO DICT: {'localhost': [0]}
[2025-03-28 01:04:03,454] [INFO] [launch.py:152:main] nnodes=1, num_local_procs=1, node_rank=0
[2025-03-28 01:04:03,454] [INFO] [launch.py:163:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2025-03-28 01:04:03,454] [INFO] [launch.py:164:main] dist_world_size=1
[2025-03-28 01:04:03,454] [INFO] [launch.py:168:main] Setting CUDA_VISIBLE_DEVICES=0
[2025-03-28 01:04:03,455] [INFO] [launch.py:256:main] process 574522 spawned with command: ['/hpc2hdd/home/yli045/.conda/envs/ywj/bin/python', '-u', 'main.py', '--local_rank=0', '--image_size', '64', '--batch_size', '256', '--num_epochs', '20', '--timesteps', '1000', '--lr', '2e-4', '--time_emb_dim', '32', '--mu1', '4', '--sigma1', '1', '--num1', '9000', '--mu2', '10', '--sigma2', '4', '--num2', '1000', '--samples_dir', './samples', '--checkpoints_dir', './checkpoints', '--fp16', '--mode', 'train', '--model_path', '', '--num_images', '1000', '--simulation_distribution', 'normal', '--use_different_noise', '--use_moe', '--num_experts', '2', '--moe_hidden_dim', '2', '--moe_tau', '0.1']
[2025-03-28 01:04:07,627] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-03-28 01:04:25,110] [INFO] [logging.py:128:log_dist] [Rank -1] DeepSpeed info: version=0.16.4, git-hash=unknown, git-branch=unknown
[2025-03-28 01:04:25,110] [INFO] [comm.py:658:init_distributed] cdb=None
[2025-03-28 01:04:25,110] [INFO] [comm.py:689:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2025-03-28 01:04:25,116] [INFO] [config.py:734:__init__] Config mesh_device None world_size = 1
[2025-03-28 01:04:28,196] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
Using /hpc2hdd/home/yli045/.cache/torch_extensions/py312_cu124 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /hpc2hdd/home/yli045/.cache/torch_extensions/py312_cu124/fused_adam/build.ninja...
/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/utils/cpp_extension.py:2059: UserWarning: TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation. 
If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'].
  warnings.warn(
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 0.15083909034729004 seconds
[2025-03-28 01:04:28,352] [INFO] [logging.py:128:log_dist] [Rank 0] Using DeepSpeed Optimizer param name adamw as basic optimizer
[2025-03-28 01:04:28,353] [INFO] [logging.py:128:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2025-03-28 01:04:28,355] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Basic Optimizer = FusedAdam
[2025-03-28 01:04:28,355] [INFO] [utils.py:59:is_zero_supported_optimizer] Checking ZeRO support for optimizer=FusedAdam type=<class 'deepspeed.ops.adam.fused_adam.FusedAdam'>
[2025-03-28 01:04:28,355] [INFO] [logging.py:128:log_dist] [Rank 0] Creating torch.float16 ZeRO stage 2 optimizer
[2025-03-28 01:04:28,356] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 500000000
[2025-03-28 01:04:28,356] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 500000000
[2025-03-28 01:04:28,356] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2025-03-28 01:04:28,356] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2025-03-28 01:04:30,482] [INFO] [utils.py:781:see_memory_usage] Before initializing optimizer states
[2025-03-28 01:04:30,482] [INFO] [utils.py:782:see_memory_usage] MA 0.04 GB         Max_MA 0.05 GB         CA 0.05 GB         Max_CA 0 GB 
[2025-03-28 01:04:30,483] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 159.91 GB, percent = 15.9%
[2025-03-28 01:04:30,617] [INFO] [utils.py:781:see_memory_usage] After initializing optimizer states
[2025-03-28 01:04:30,618] [INFO] [utils.py:782:see_memory_usage] MA 0.04 GB         Max_MA 0.06 GB         CA 0.08 GB         Max_CA 0 GB 
[2025-03-28 01:04:30,618] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 160.4 GB, percent = 15.9%
[2025-03-28 01:04:30,618] [INFO] [stage_1_and_2.py:550:__init__] optimizer state initialized
[2025-03-28 01:04:30,746] [INFO] [utils.py:781:see_memory_usage] After initializing ZeRO optimizer
[2025-03-28 01:04:30,747] [INFO] [utils.py:782:see_memory_usage] MA 0.04 GB         Max_MA 0.04 GB         CA 0.08 GB         Max_CA 0 GB 
[2025-03-28 01:04:30,747] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 160.28 GB, percent = 15.9%
[2025-03-28 01:04:30,748] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Final Optimizer = DeepSpeedZeroOptimizer
[2025-03-28 01:04:30,748] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed using configured LR scheduler = None
[2025-03-28 01:04:30,748] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2025-03-28 01:04:30,748] [INFO] [logging.py:128:log_dist] [Rank 0] step=0, skipped=0, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:04:30,749] [INFO] [config.py:1001:print] DeepSpeedEngine configuration:
[2025-03-28 01:04:30,749] [INFO] [config.py:1005:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2025-03-28 01:04:30,749] [INFO] [config.py:1005:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'intra_op_parallelism': 1, 'single_submit': False, 'overlap_events': True, 'use_gds': False}
[2025-03-28 01:04:30,749] [INFO] [config.py:1005:print]   amp_enabled .................. False
[2025-03-28 01:04:30,749] [INFO] [config.py:1005:print]   amp_params ................... False
[2025-03-28 01:04:30,749] [INFO] [config.py:1005:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2025-03-28 01:04:30,749] [INFO] [config.py:1005:print]   bfloat16_enabled ............. False
[2025-03-28 01:04:30,749] [INFO] [config.py:1005:print]   bfloat16_immediate_grad_update  False
[2025-03-28 01:04:30,750] [INFO] [config.py:1005:print]   checkpoint_parallel_write_pipeline  False
[2025-03-28 01:04:30,750] [INFO] [config.py:1005:print]   checkpoint_tag_validation_enabled  True
[2025-03-28 01:04:30,750] [INFO] [config.py:1005:print]   checkpoint_tag_validation_fail  False
[2025-03-28 01:04:30,750] [INFO] [config.py:1005:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f11098ec7d0>
[2025-03-28 01:04:30,750] [INFO] [config.py:1005:print]   communication_data_type ...... None
[2025-03-28 01:04:30,750] [INFO] [config.py:1005:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2025-03-28 01:04:30,750] [INFO] [config.py:1005:print]   curriculum_enabled_legacy .... False
[2025-03-28 01:04:30,750] [INFO] [config.py:1005:print]   curriculum_params_legacy ..... False
[2025-03-28 01:04:30,750] [INFO] [config.py:1005:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2025-03-28 01:04:30,750] [INFO] [config.py:1005:print]   data_efficiency_enabled ...... False
[2025-03-28 01:04:30,750] [INFO] [config.py:1005:print]   dataloader_drop_last ......... False
[2025-03-28 01:04:30,750] [INFO] [config.py:1005:print]   disable_allgather ............ False
[2025-03-28 01:04:30,750] [INFO] [config.py:1005:print]   dump_state ................... False
[2025-03-28 01:04:30,750] [INFO] [config.py:1005:print]   dynamic_loss_scale_args ...... {'init_scale': 65536, 'scale_window': 1000, 'delayed_shift': 2, 'consecutive_hysteresis': False, 'min_scale': 1}
[2025-03-28 01:04:30,750] [INFO] [config.py:1005:print]   eigenvalue_enabled ........... False
[2025-03-28 01:04:30,750] [INFO] [config.py:1005:print]   eigenvalue_gas_boundary_resolution  1
[2025-03-28 01:04:30,750] [INFO] [config.py:1005:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2025-03-28 01:04:30,750] [INFO] [config.py:1005:print]   eigenvalue_layer_num ......... 0
[2025-03-28 01:04:30,750] [INFO] [config.py:1005:print]   eigenvalue_max_iter .......... 100
[2025-03-28 01:04:30,750] [INFO] [config.py:1005:print]   eigenvalue_stability ......... 1e-06
[2025-03-28 01:04:30,750] [INFO] [config.py:1005:print]   eigenvalue_tol ............... 0.01
[2025-03-28 01:04:30,750] [INFO] [config.py:1005:print]   eigenvalue_verbose ........... False
[2025-03-28 01:04:30,750] [INFO] [config.py:1005:print]   elasticity_enabled ........... False
[2025-03-28 01:04:30,750] [INFO] [config.py:1005:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2025-03-28 01:04:30,750] [INFO] [config.py:1005:print]   fp16_auto_cast ............... False
[2025-03-28 01:04:30,751] [INFO] [config.py:1005:print]   fp16_enabled ................. True
[2025-03-28 01:04:30,751] [INFO] [config.py:1005:print]   fp16_master_weights_and_gradients  False
[2025-03-28 01:04:30,751] [INFO] [config.py:1005:print]   global_rank .................. 0
[2025-03-28 01:04:30,751] [INFO] [config.py:1005:print]   grad_accum_dtype ............. None
[2025-03-28 01:04:30,751] [INFO] [config.py:1005:print]   gradient_accumulation_steps .. 1
[2025-03-28 01:04:30,751] [INFO] [config.py:1005:print]   gradient_clipping ............ 1.0
[2025-03-28 01:04:30,751] [INFO] [config.py:1005:print]   gradient_predivide_factor .... 1.0
[2025-03-28 01:04:30,751] [INFO] [config.py:1005:print]   graph_harvesting ............. False
[2025-03-28 01:04:30,751] [INFO] [config.py:1005:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2025-03-28 01:04:30,751] [INFO] [config.py:1005:print]   initial_dynamic_scale ........ 65536
[2025-03-28 01:04:30,751] [INFO] [config.py:1005:print]   load_universal_checkpoint .... False
[2025-03-28 01:04:30,751] [INFO] [config.py:1005:print]   loss_scale ................... 0
[2025-03-28 01:04:30,751] [INFO] [config.py:1005:print]   memory_breakdown ............. False
[2025-03-28 01:04:30,751] [INFO] [config.py:1005:print]   mics_hierarchial_params_gather  False
[2025-03-28 01:04:30,751] [INFO] [config.py:1005:print]   mics_shard_size .............. -1
[2025-03-28 01:04:30,751] [INFO] [config.py:1005:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') comet=CometConfig(enabled=False, samples_log_interval=100, project=None, workspace=None, api_key=None, experiment_name=None, experiment_key=None, online=None, mode=None) wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName')
[2025-03-28 01:04:30,751] [INFO] [config.py:1005:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2025-03-28 01:04:30,751] [INFO] [config.py:1005:print]   optimizer_legacy_fusion ...... False
[2025-03-28 01:04:30,751] [INFO] [config.py:1005:print]   optimizer_name ............... adamw
[2025-03-28 01:04:30,751] [INFO] [config.py:1005:print]   optimizer_params ............. {'lr': 0.0002, 'weight_decay': 0.01}
[2025-03-28 01:04:30,751] [INFO] [config.py:1005:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2025-03-28 01:04:30,751] [INFO] [config.py:1005:print]   pld_enabled .................. False
[2025-03-28 01:04:30,751] [INFO] [config.py:1005:print]   pld_params ................... False
[2025-03-28 01:04:30,752] [INFO] [config.py:1005:print]   prescale_gradients ........... False
[2025-03-28 01:04:30,752] [INFO] [config.py:1005:print]   scheduler_name ............... None
[2025-03-28 01:04:30,752] [INFO] [config.py:1005:print]   scheduler_params ............. None
[2025-03-28 01:04:30,752] [INFO] [config.py:1005:print]   seq_parallel_communication_data_type  torch.float32
[2025-03-28 01:04:30,752] [INFO] [config.py:1005:print]   sparse_attention ............. None
[2025-03-28 01:04:30,752] [INFO] [config.py:1005:print]   sparse_gradients_enabled ..... False
[2025-03-28 01:04:30,752] [INFO] [config.py:1005:print]   steps_per_print .............. 50
[2025-03-28 01:04:30,752] [INFO] [config.py:1005:print]   tensor_parallel_config ....... dtype=torch.float16 autotp_size=0 tensor_parallel=TPConfig(tp_size=1, tp_grain_size=1, mpu=None, tp_group=None) injection_policy_tuple=None keep_module_on_host=False replace_with_kernel_inject=False
[2025-03-28 01:04:30,752] [INFO] [config.py:1005:print]   timers_config ................ enabled=True synchronized=True
[2025-03-28 01:04:30,752] [INFO] [config.py:1005:print]   train_batch_size ............. 256
[2025-03-28 01:04:30,752] [INFO] [config.py:1005:print]   train_micro_batch_size_per_gpu  256
[2025-03-28 01:04:30,752] [INFO] [config.py:1005:print]   use_data_before_expert_parallel_  False
[2025-03-28 01:04:30,752] [INFO] [config.py:1005:print]   use_node_local_storage ....... False
[2025-03-28 01:04:30,752] [INFO] [config.py:1005:print]   wall_clock_breakdown ......... False
[2025-03-28 01:04:30,752] [INFO] [config.py:1005:print]   weight_quantization_config ... None
[2025-03-28 01:04:30,752] [INFO] [config.py:1005:print]   world_size ................... 1
[2025-03-28 01:04:30,752] [INFO] [config.py:1005:print]   zero_allow_untested_optimizer  False
[2025-03-28 01:04:30,752] [INFO] [config.py:1005:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=500000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50000000 param_persistence_threshold=100000 model_persistence_threshold=9223372036854775807 max_live_parameters=1000000000 max_reuse_distance=1000000000 gather_16bit_weights_on_model_save=False module_granularity_threshold=0 use_all_reduce_for_fetch_params=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False zeropp_loco_param=None mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True log_trace_cache_warnings=False
[2025-03-28 01:04:30,752] [INFO] [config.py:1005:print]   zero_enabled ................. True
[2025-03-28 01:04:30,752] [INFO] [config.py:1005:print]   zero_force_ds_cpu_optimizer .. True
[2025-03-28 01:04:30,752] [INFO] [config.py:1005:print]   zero_optimization_stage ...... 2
[2025-03-28 01:04:30,752] [INFO] [config.py:991:print_user_config]   json = {
    "train_batch_size": 256, 
    "gradient_accumulation_steps": 1, 
    "optimizer": {
        "type": "AdamW", 
        "params": {
            "lr": 0.0002, 
            "weight_decay": 0.01
        }
    }, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "loss_scale_window": 1000
    }, 
    "zero_optimization": {
        "stage": 2, 
        "contiguous_gradients": true, 
        "overlap_comm": true
    }, 
    "steps_per_print": 50, 
    "gradient_clipping": 1.0
}
****START TRAINING****
image_size: 64, batch_size: 256, timesteps: 1000, time_emb_dim: 32
  0%|                                                                                                                 | 0/1 [00:00<?, ?it/s][2025-03-28 01:04:33,538] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:02<00:00,  2.42s/it]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:02<00:00,  2.45s/it]
/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:227: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn(
/hpc2hdd/home/yli045/diffusion_noise_agent/train.py:189: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  df = pd.concat([df, pd.DataFrame([new_row])], ignore_index=True) # 使用 pd.concat 追加数据
  0%|                                                                                                                 | 0/1 [00:00<?, ?it/s][2025-03-28 01:04:34,186] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.80it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.63it/s]
  0%|                                                                                                                 | 0/1 [00:00<?, ?it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  2.00it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.79it/s]
  0%|                                                                                                                 | 0/1 [00:00<?, ?it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  2.47it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  2.21it/s]
  0%|                                                                                                                 | 0/1 [00:00<?, ?it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.58it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.44it/s]
  0%|                                                                                                                 | 0/1 [00:00<?, ?it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  2.17it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.93it/s]
  0%|                                                                                                                 | 0/1 [00:00<?, ?it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.52it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.40it/s]
  0%|                                                                                                                 | 0/1 [00:00<?, ?it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  2.46it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  2.17it/s]
  0%|                                                                                                                 | 0/1 [00:00<?, ?it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.26it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.17it/s]
  0%|                                                                                                                 | 0/1 [00:00<?, ?it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  2.26it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.99it/s]
  0%|                                                                                                                 | 0/1 [00:00<?, ?it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  2.27it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.99it/s]
  0%|                                                                                                                 | 0/1 [00:00<?, ?it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.86it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.67it/s]
  0%|                                                                                                                 | 0/1 [00:00<?, ?it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.80it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.61it/s]
  0%|                                                                                                                 | 0/1 [00:00<?, ?it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  2.56it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  2.21it/s]
  0%|                                                                                                                 | 0/1 [00:00<?, ?it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.45it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.33it/s]
  0%|                                                                                                                 | 0/1 [00:00<?, ?it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  2.34it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  2.05it/s]
  0%|                                                                                                                 | 0/1 [00:00<?, ?it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  2.25it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.97it/s]
  0%|                                                                                                                 | 0/1 [00:00<?, ?it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.79it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.61it/s]
  0%|                                                                                                                 | 0/1 [00:00<?, ?it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  2.12it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.88it/s]
  0%|                                                                                                                 | 0/1 [00:00<?, ?it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.73it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.59it/s]
[rank0]: Traceback (most recent call last):
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/main.py", line 9, in <module>
[rank0]:     train_deepspeed(cfg)
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/train.py", line 209, in train_deepspeed
[rank0]:     generate_during_training(model_engine, sample_dir, config, epoch, num_images=config.num_images//config.image_size, p=p)
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/generate.py", line 233, in generate_during_training_simulation_dif
[rank0]:     pred_noise = model_engine(x, t_batch)
[rank0]:                  ^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/deepspeed/utils/nvtx.py", line 18, in wrapped_fn
[rank0]:     ret_val = func(*args, **kwargs)
[rank0]:               ^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/deepspeed/runtime/engine.py", line 1987, in forward
[rank0]:     loss = self.module(*inputs, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/unet.py", line 212, in forward
[rank0]:     x = self.up1(x, x3, t_embed)
[rank0]:         ^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/unet.py", line 71, in forward
[rank0]:     x = torch.cat([x, skip], dim=1)
[rank0]:         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]: torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 20.00 MiB. GPU 0 has a total capacity of 47.33 GiB of which 19.69 MiB is free. Process 3785418 has 294.00 MiB memory in use. Process 3794194 has 4.08 GiB memory in use. Process 3794200 has 3.13 GiB memory in use. Process 3794201 has 3.12 GiB memory in use. Process 3794198 has 4.08 GiB memory in use. Process 2495628 has 32.56 GiB memory in use. Of the allocated memory 31.08 GiB is allocated by PyTorch, and 851.55 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
[rank0]:[W328 01:04:51.856321519 ProcessGroupNCCL.cpp:1496] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[2025-03-28 01:04:53,547] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 574522
[2025-03-28 01:04:53,548] [ERROR] [launch.py:325:sigkill_handler] ['/hpc2hdd/home/yli045/.conda/envs/ywj/bin/python', '-u', 'main.py', '--local_rank=0', '--image_size', '64', '--batch_size', '256', '--num_epochs', '20', '--timesteps', '1000', '--lr', '2e-4', '--time_emb_dim', '32', '--mu1', '4', '--sigma1', '1', '--num1', '9000', '--mu2', '10', '--sigma2', '4', '--num2', '1000', '--samples_dir', './samples', '--checkpoints_dir', './checkpoints', '--fp16', '--mode', 'train', '--model_path', '', '--num_images', '1000', '--simulation_distribution', 'normal', '--use_different_noise', '--use_moe', '--num_experts', '2', '--moe_hidden_dim', '2', '--moe_tau', '0.1'] exits with return code = 1
[?2004h(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ bash scripts/script_normal_dif_test.sh 
[?2004l[2025-03-28 01:05:30,658] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-28 01:05:30,666] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-28 01:05:32,226] [WARNING] [runner.py:215:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2025-03-28 01:05:32,227] [INFO] [runner.py:607:main] cmd = /hpc2hdd/home/yli045/.conda/envs/ywj/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None main.py --image_size 16 --batch_size 4 --num_epochs 20 --timesteps 1000 --lr 2e-4 --time_emb_dim 32 --mu1 4 --sigma1 1 --num1 9000 --mu2 10 --sigma2 4 --num2 1000 --samples_dir ./samples --checkpoints_dir ./checkpoints --fp16 --mode train --model_path  --num_images 1000 --simulation_distribution normal --use_different_noise --use_moe --num_experts 2 --moe_hidden_dim 2 --moe_tau 0.1
[2025-03-28 01:05:34,789] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-28 01:05:34,797] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-28 01:05:35,963] [INFO] [launch.py:146:main] WORLD INFO DICT: {'localhost': [0]}
[2025-03-28 01:05:35,963] [INFO] [launch.py:152:main] nnodes=1, num_local_procs=1, node_rank=0
[2025-03-28 01:05:35,963] [INFO] [launch.py:163:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2025-03-28 01:05:35,963] [INFO] [launch.py:164:main] dist_world_size=1
[2025-03-28 01:05:35,963] [INFO] [launch.py:168:main] Setting CUDA_VISIBLE_DEVICES=0
[2025-03-28 01:05:35,975] [INFO] [launch.py:256:main] process 575242 spawned with command: ['/hpc2hdd/home/yli045/.conda/envs/ywj/bin/python', '-u', 'main.py', '--local_rank=0', '--image_size', '16', '--batch_size', '4', '--num_epochs', '20', '--timesteps', '1000', '--lr', '2e-4', '--time_emb_dim', '32', '--mu1', '4', '--sigma1', '1', '--num1', '9000', '--mu2', '10', '--sigma2', '4', '--num2', '1000', '--samples_dir', './samples', '--checkpoints_dir', './checkpoints', '--fp16', '--mode', 'train', '--model_path', '', '--num_images', '1000', '--simulation_distribution', 'normal', '--use_different_noise', '--use_moe', '--num_experts', '2', '--moe_hidden_dim', '2', '--moe_tau', '0.1']
[2025-03-28 01:05:39,912] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-03-28 01:05:51,391] [INFO] [logging.py:128:log_dist] [Rank -1] DeepSpeed info: version=0.16.4, git-hash=unknown, git-branch=unknown
[2025-03-28 01:05:51,391] [INFO] [comm.py:658:init_distributed] cdb=None
[2025-03-28 01:05:51,391] [INFO] [comm.py:689:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2025-03-28 01:05:51,440] [INFO] [config.py:734:__init__] Config mesh_device None world_size = 1
[2025-03-28 01:05:53,097] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
Using /hpc2hdd/home/yli045/.cache/torch_extensions/py312_cu124 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /hpc2hdd/home/yli045/.cache/torch_extensions/py312_cu124/fused_adam/build.ninja...
/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/utils/cpp_extension.py:2059: UserWarning: TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation. 
If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'].
  warnings.warn(
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 0.15544438362121582 seconds
[2025-03-28 01:05:53,258] [INFO] [logging.py:128:log_dist] [Rank 0] Using DeepSpeed Optimizer param name adamw as basic optimizer
[2025-03-28 01:05:53,259] [INFO] [logging.py:128:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2025-03-28 01:05:53,261] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Basic Optimizer = FusedAdam
[2025-03-28 01:05:53,261] [INFO] [utils.py:59:is_zero_supported_optimizer] Checking ZeRO support for optimizer=FusedAdam type=<class 'deepspeed.ops.adam.fused_adam.FusedAdam'>
[2025-03-28 01:05:53,261] [INFO] [logging.py:128:log_dist] [Rank 0] Creating torch.float16 ZeRO stage 2 optimizer
[2025-03-28 01:05:53,262] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 500000000
[2025-03-28 01:05:53,262] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 500000000
[2025-03-28 01:05:53,262] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2025-03-28 01:05:53,262] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2025-03-28 01:05:54,234] [INFO] [utils.py:781:see_memory_usage] Before initializing optimizer states
[2025-03-28 01:05:54,235] [INFO] [utils.py:782:see_memory_usage] MA 0.0 GB         Max_MA 0.0 GB         CA 0.02 GB         Max_CA 0 GB 
[2025-03-28 01:05:54,235] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 148.57 GB, percent = 14.7%
[2025-03-28 01:05:54,365] [INFO] [utils.py:781:see_memory_usage] After initializing optimizer states
[2025-03-28 01:05:54,365] [INFO] [utils.py:782:see_memory_usage] MA 0.0 GB         Max_MA 0.0 GB         CA 0.02 GB         Max_CA 0 GB 
[2025-03-28 01:05:54,366] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 148.65 GB, percent = 14.8%
[2025-03-28 01:05:54,366] [INFO] [stage_1_and_2.py:550:__init__] optimizer state initialized
[2025-03-28 01:05:54,491] [INFO] [utils.py:781:see_memory_usage] After initializing ZeRO optimizer
[2025-03-28 01:05:54,492] [INFO] [utils.py:782:see_memory_usage] MA 0.0 GB         Max_MA 0.0 GB         CA 0.02 GB         Max_CA 0 GB 
[2025-03-28 01:05:54,492] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 148.44 GB, percent = 14.7%
[2025-03-28 01:05:54,493] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Final Optimizer = DeepSpeedZeroOptimizer
[2025-03-28 01:05:54,493] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed using configured LR scheduler = None
[2025-03-28 01:05:54,493] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2025-03-28 01:05:54,493] [INFO] [logging.py:128:log_dist] [Rank 0] step=0, skipped=0, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:05:54,493] [INFO] [config.py:1001:print] DeepSpeedEngine configuration:
[2025-03-28 01:05:54,494] [INFO] [config.py:1005:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2025-03-28 01:05:54,494] [INFO] [config.py:1005:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'intra_op_parallelism': 1, 'single_submit': False, 'overlap_events': True, 'use_gds': False}
[2025-03-28 01:05:54,494] [INFO] [config.py:1005:print]   amp_enabled .................. False
[2025-03-28 01:05:54,494] [INFO] [config.py:1005:print]   amp_params ................... False
[2025-03-28 01:05:54,494] [INFO] [config.py:1005:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2025-03-28 01:05:54,494] [INFO] [config.py:1005:print]   bfloat16_enabled ............. False
[2025-03-28 01:05:54,494] [INFO] [config.py:1005:print]   bfloat16_immediate_grad_update  False
[2025-03-28 01:05:54,494] [INFO] [config.py:1005:print]   checkpoint_parallel_write_pipeline  False
[2025-03-28 01:05:54,494] [INFO] [config.py:1005:print]   checkpoint_tag_validation_enabled  True
[2025-03-28 01:05:54,494] [INFO] [config.py:1005:print]   checkpoint_tag_validation_fail  False
[2025-03-28 01:05:54,494] [INFO] [config.py:1005:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7ff65c1f7200>
[2025-03-28 01:05:54,494] [INFO] [config.py:1005:print]   communication_data_type ...... None
[2025-03-28 01:05:54,494] [INFO] [config.py:1005:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2025-03-28 01:05:54,494] [INFO] [config.py:1005:print]   curriculum_enabled_legacy .... False
[2025-03-28 01:05:54,495] [INFO] [config.py:1005:print]   curriculum_params_legacy ..... False
[2025-03-28 01:05:54,495] [INFO] [config.py:1005:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2025-03-28 01:05:54,495] [INFO] [config.py:1005:print]   data_efficiency_enabled ...... False
[2025-03-28 01:05:54,495] [INFO] [config.py:1005:print]   dataloader_drop_last ......... False
[2025-03-28 01:05:54,495] [INFO] [config.py:1005:print]   disable_allgather ............ False
[2025-03-28 01:05:54,495] [INFO] [config.py:1005:print]   dump_state ................... False
[2025-03-28 01:05:54,495] [INFO] [config.py:1005:print]   dynamic_loss_scale_args ...... {'init_scale': 65536, 'scale_window': 1000, 'delayed_shift': 2, 'consecutive_hysteresis': False, 'min_scale': 1}
[2025-03-28 01:05:54,495] [INFO] [config.py:1005:print]   eigenvalue_enabled ........... False
[2025-03-28 01:05:54,495] [INFO] [config.py:1005:print]   eigenvalue_gas_boundary_resolution  1
[2025-03-28 01:05:54,495] [INFO] [config.py:1005:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2025-03-28 01:05:54,495] [INFO] [config.py:1005:print]   eigenvalue_layer_num ......... 0
[2025-03-28 01:05:54,495] [INFO] [config.py:1005:print]   eigenvalue_max_iter .......... 100
[2025-03-28 01:05:54,495] [INFO] [config.py:1005:print]   eigenvalue_stability ......... 1e-06
[2025-03-28 01:05:54,495] [INFO] [config.py:1005:print]   eigenvalue_tol ............... 0.01
[2025-03-28 01:05:54,495] [INFO] [config.py:1005:print]   eigenvalue_verbose ........... False
[2025-03-28 01:05:54,495] [INFO] [config.py:1005:print]   elasticity_enabled ........... False
[2025-03-28 01:05:54,495] [INFO] [config.py:1005:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2025-03-28 01:05:54,495] [INFO] [config.py:1005:print]   fp16_auto_cast ............... False
[2025-03-28 01:05:54,495] [INFO] [config.py:1005:print]   fp16_enabled ................. True
[2025-03-28 01:05:54,495] [INFO] [config.py:1005:print]   fp16_master_weights_and_gradients  False
[2025-03-28 01:05:54,495] [INFO] [config.py:1005:print]   global_rank .................. 0
[2025-03-28 01:05:54,495] [INFO] [config.py:1005:print]   grad_accum_dtype ............. None
[2025-03-28 01:05:54,495] [INFO] [config.py:1005:print]   gradient_accumulation_steps .. 1
[2025-03-28 01:05:54,495] [INFO] [config.py:1005:print]   gradient_clipping ............ 1.0
[2025-03-28 01:05:54,495] [INFO] [config.py:1005:print]   gradient_predivide_factor .... 1.0
[2025-03-28 01:05:54,495] [INFO] [config.py:1005:print]   graph_harvesting ............. False
[2025-03-28 01:05:54,496] [INFO] [config.py:1005:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2025-03-28 01:05:54,496] [INFO] [config.py:1005:print]   initial_dynamic_scale ........ 65536
[2025-03-28 01:05:54,496] [INFO] [config.py:1005:print]   load_universal_checkpoint .... False
[2025-03-28 01:05:54,496] [INFO] [config.py:1005:print]   loss_scale ................... 0
[2025-03-28 01:05:54,496] [INFO] [config.py:1005:print]   memory_breakdown ............. False
[2025-03-28 01:05:54,496] [INFO] [config.py:1005:print]   mics_hierarchial_params_gather  False
[2025-03-28 01:05:54,496] [INFO] [config.py:1005:print]   mics_shard_size .............. -1
[2025-03-28 01:05:54,496] [INFO] [config.py:1005:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') comet=CometConfig(enabled=False, samples_log_interval=100, project=None, workspace=None, api_key=None, experiment_name=None, experiment_key=None, online=None, mode=None) wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName')
[2025-03-28 01:05:54,496] [INFO] [config.py:1005:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2025-03-28 01:05:54,496] [INFO] [config.py:1005:print]   optimizer_legacy_fusion ...... False
[2025-03-28 01:05:54,496] [INFO] [config.py:1005:print]   optimizer_name ............... adamw
[2025-03-28 01:05:54,496] [INFO] [config.py:1005:print]   optimizer_params ............. {'lr': 0.0002, 'weight_decay': 0.01}
[2025-03-28 01:05:54,496] [INFO] [config.py:1005:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2025-03-28 01:05:54,496] [INFO] [config.py:1005:print]   pld_enabled .................. False
[2025-03-28 01:05:54,496] [INFO] [config.py:1005:print]   pld_params ................... False
[2025-03-28 01:05:54,496] [INFO] [config.py:1005:print]   prescale_gradients ........... False
[2025-03-28 01:05:54,496] [INFO] [config.py:1005:print]   scheduler_name ............... None
[2025-03-28 01:05:54,496] [INFO] [config.py:1005:print]   scheduler_params ............. None
[2025-03-28 01:05:54,496] [INFO] [config.py:1005:print]   seq_parallel_communication_data_type  torch.float32
[2025-03-28 01:05:54,496] [INFO] [config.py:1005:print]   sparse_attention ............. None
[2025-03-28 01:05:54,496] [INFO] [config.py:1005:print]   sparse_gradients_enabled ..... False
[2025-03-28 01:05:54,496] [INFO] [config.py:1005:print]   steps_per_print .............. 50
[2025-03-28 01:05:54,496] [INFO] [config.py:1005:print]   tensor_parallel_config ....... dtype=torch.float16 autotp_size=0 tensor_parallel=TPConfig(tp_size=1, tp_grain_size=1, mpu=None, tp_group=None) injection_policy_tuple=None keep_module_on_host=False replace_with_kernel_inject=False
[2025-03-28 01:05:54,497] [INFO] [config.py:1005:print]   timers_config ................ enabled=True synchronized=True
[2025-03-28 01:05:54,497] [INFO] [config.py:1005:print]   train_batch_size ............. 4
[2025-03-28 01:05:54,497] [INFO] [config.py:1005:print]   train_micro_batch_size_per_gpu  4
[2025-03-28 01:05:54,497] [INFO] [config.py:1005:print]   use_data_before_expert_parallel_  False
[2025-03-28 01:05:54,497] [INFO] [config.py:1005:print]   use_node_local_storage ....... False
[2025-03-28 01:05:54,497] [INFO] [config.py:1005:print]   wall_clock_breakdown ......... False
[2025-03-28 01:05:54,497] [INFO] [config.py:1005:print]   weight_quantization_config ... None
[2025-03-28 01:05:54,497] [INFO] [config.py:1005:print]   world_size ................... 1
[2025-03-28 01:05:54,497] [INFO] [config.py:1005:print]   zero_allow_untested_optimizer  False
[2025-03-28 01:05:54,497] [INFO] [config.py:1005:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=500000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50000000 param_persistence_threshold=100000 model_persistence_threshold=9223372036854775807 max_live_parameters=1000000000 max_reuse_distance=1000000000 gather_16bit_weights_on_model_save=False module_granularity_threshold=0 use_all_reduce_for_fetch_params=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False zeropp_loco_param=None mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True log_trace_cache_warnings=False
[2025-03-28 01:05:54,497] [INFO] [config.py:1005:print]   zero_enabled ................. True
[2025-03-28 01:05:54,497] [INFO] [config.py:1005:print]   zero_force_ds_cpu_optimizer .. True
[2025-03-28 01:05:54,497] [INFO] [config.py:1005:print]   zero_optimization_stage ...... 2
[2025-03-28 01:05:54,497] [INFO] [config.py:991:print_user_config]   json = {
    "train_batch_size": 4, 
    "gradient_accumulation_steps": 1, 
    "optimizer": {
        "type": "AdamW", 
        "params": {
            "lr": 0.0002, 
            "weight_decay": 0.01
        }
    }, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "loss_scale_window": 1000
    }, 
    "zero_optimization": {
        "stage": 2, 
        "contiguous_gradients": true, 
        "overlap_comm": true
    }, 
    "steps_per_print": 50, 
    "gradient_clipping": 1.0
}
****START TRAINING****
image_size: 16, batch_size: 4, timesteps: 1000, time_emb_dim: 32
  0%|                                                                                                               | 0/141 [00:00<?, ?it/s][2025-03-28 01:05:56,786] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
  1%|▋                                                                                                      | 1/141 [00:02<05:13,  2.24s/it][2025-03-28 01:05:56,826] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
  2%|██▏                                                                                                    | 3/141 [00:02<01:28,  1.55it/s]  4%|████▍                                                                                                  | 6/141 [00:02<00:37,  3.63it/s]  6%|██████▌                                                                                                | 9/141 [00:02<00:22,  5.92it/s]  9%|████████▋                                                                                             | 12/141 [00:02<00:15,  8.32it/s] 11%|██████████▊                                                                                           | 15/141 [00:02<00:12, 10.46it/s] 13%|█████████████                                                                                         | 18/141 [00:03<00:09, 12.63it/s] 15%|███████████████▏                                                                                      | 21/141 [00:03<00:08, 14.61it/s] 17%|█████████████████▎                                                                                    | 24/141 [00:03<00:07, 16.32it/s] 19%|███████████████████▌                                                                                  | 27/141 [00:03<00:06, 17.98it/s] 21%|█████████████████████▋                                                                                | 30/141 [00:03<00:05, 19.30it/s] 23%|███████████████████████▊                                                                              | 33/141 [00:03<00:05, 20.10it/s] 26%|██████████████████████████                                                                            | 36/141 [00:03<00:05, 20.68it/s] 28%|████████████████████████████▏                                                                         | 39/141 [00:04<00:04, 21.08it/s] 30%|██████████████████████████████▍                                                                       | 42/141 [00:04<00:04, 21.18it/s] 32%|████████████████████████████████▌                                                                     | 45/141 [00:04<00:04, 21.50it/s] 34%|██████████████████████████████████▋                                                                   | 48/141 [00:04<00:04, 22.25it/s][2025-03-28 01:05:59,097] [INFO] [logging.py:128:log_dist] [Rank 0] step=50, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:05:59,098] [INFO] [timer.py:264:stop] epoch=0/micro_step=50/global_step=50, RunningAvgSamplesPerSec=84.7424911464633, CurrSamplesPerSec=89.10391892607143, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 36%|████████████████████████████████████▉                                                                 | 51/141 [00:04<00:04, 22.27it/s] 38%|███████████████████████████████████████                                                               | 54/141 [00:04<00:03, 22.20it/s] 40%|█████████████████████████████████████████▏                                                            | 57/141 [00:04<00:03, 22.20it/s] 43%|███████████████████████████████████████████▍                                                          | 60/141 [00:05<00:03, 22.20it/s] 45%|█████████████████████████████████████████████▌                                                        | 63/141 [00:05<00:03, 22.08it/s] 47%|███████████████████████████████████████████████▋                                                      | 66/141 [00:05<00:03, 21.99it/s] 49%|█████████████████████████████████████████████████▉                                                    | 69/141 [00:05<00:03, 21.98it/s] 51%|████████████████████████████████████████████████████                                                  | 72/141 [00:05<00:03, 22.00it/s] 53%|██████████████████████████████████████████████████████▎                                               | 75/141 [00:05<00:03, 21.94it/s] 55%|████████████████████████████████████████████████████████▍                                             | 78/141 [00:05<00:02, 21.55it/s] 57%|██████████████████████████████████████████████████████████▌                                           | 81/141 [00:05<00:02, 21.32it/s] 60%|████████████████████████████████████████████████████████████▊                                         | 84/141 [00:06<00:02, 20.69it/s] 62%|██████████████████████████████████████████████████████████████▉                                       | 87/141 [00:06<00:02, 20.08it/s] 64%|█████████████████████████████████████████████████████████████████                                     | 90/141 [00:06<00:02, 20.35it/s] 66%|███████████████████████████████████████████████████████████████████▎                                  | 93/141 [00:06<00:02, 20.54it/s] 68%|█████████████████████████████████████████████████████████████████████▍                                | 96/141 [00:06<00:02, 20.43it/s] 70%|███████████████████████████████████████████████████████████████████████▌                              | 99/141 [00:06<00:02, 20.53it/s][2025-03-28 01:06:01,465] [INFO] [logging.py:128:log_dist] [Rank 0] step=100, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:06:01,466] [INFO] [timer.py:264:stop] epoch=0/micro_step=100/global_step=100, RunningAvgSamplesPerSec=84.71804142321938, CurrSamplesPerSec=89.35829518367747, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 72%|█████████████████████████████████████████████████████████████████████████                            | 102/141 [00:07<00:01, 20.95it/s] 74%|███████████████████████████████████████████████████████████████████████████▏                         | 105/141 [00:07<00:01, 21.28it/s] 77%|█████████████████████████████████████████████████████████████████████████████▎                       | 108/141 [00:07<00:01, 21.49it/s] 79%|███████████████████████████████████████████████████████████████████████████████▌                     | 111/141 [00:07<00:01, 21.53it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▋                   | 114/141 [00:07<00:01, 21.85it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▊                 | 117/141 [00:07<00:01, 21.79it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▉               | 120/141 [00:07<00:00, 21.67it/s] 87%|████████████████████████████████████████████████████████████████████████████████████████             | 123/141 [00:07<00:00, 22.13it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████▎          | 126/141 [00:08<00:00, 22.08it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████████▍        | 129/141 [00:08<00:00, 22.03it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▌      | 132/141 [00:08<00:00, 21.89it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▋    | 135/141 [00:08<00:00, 21.34it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▊  | 138/141 [00:08<00:00, 21.20it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 141/141 [00:09<00:00, 10.25it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 141/141 [00:09<00:00, 15.07it/s]
/hpc2hdd/home/yli045/diffusion_noise_agent/train.py:189: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  df = pd.concat([df, pd.DataFrame([new_row])], ignore_index=True) # 使用 pd.concat 追加数据
  0%|                                                                                                               | 0/141 [00:00<?, ?it/s]  1%|▋                                                                                                      | 1/141 [00:00<00:29,  4.69it/s]  3%|██▉                                                                                                    | 4/141 [00:00<00:10, 12.50it/s]  5%|█████                                                                                                  | 7/141 [00:00<00:08, 16.11it/s][2025-03-28 01:06:04,523] [INFO] [logging.py:128:log_dist] [Rank 0] step=150, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:06:04,524] [INFO] [timer.py:264:stop] epoch=0/micro_step=150/global_step=150, RunningAvgSamplesPerSec=78.46587474434097, CurrSamplesPerSec=85.95493169906116, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
  7%|███████▏                                                                                              | 10/141 [00:00<00:07, 18.10it/s]  9%|█████████▍                                                                                            | 13/141 [00:00<00:06, 19.47it/s] 11%|███████████▌                                                                                          | 16/141 [00:00<00:06, 20.33it/s] 13%|█████████████▋                                                                                        | 19/141 [00:01<00:05, 20.84it/s] 16%|███████████████▉                                                                                      | 22/141 [00:01<00:05, 21.12it/s] 18%|██████████████████                                                                                    | 25/141 [00:01<00:05, 21.27it/s] 20%|████████████████████▎                                                                                 | 28/141 [00:01<00:05, 21.35it/s] 22%|██████████████████████▍                                                                               | 31/141 [00:01<00:05, 20.59it/s] 24%|████████████████████████▌                                                                             | 34/141 [00:01<00:05, 20.77it/s] 26%|██████████████████████████▊                                                                           | 37/141 [00:01<00:04, 21.00it/s] 28%|████████████████████████████▉                                                                         | 40/141 [00:02<00:04, 21.27it/s] 30%|███████████████████████████████                                                                       | 43/141 [00:02<00:04, 21.51it/s] 33%|█████████████████████████████████▎                                                                    | 46/141 [00:02<00:04, 21.63it/s] 35%|███████████████████████████████████▍                                                                  | 49/141 [00:02<00:04, 21.75it/s] 37%|█████████████████████████████████████▌                                                                | 52/141 [00:02<00:04, 21.91it/s] 39%|███████████████████████████████████████▊                                                              | 55/141 [00:02<00:03, 21.78it/s] 41%|█████████████████████████████████████████▉                                                            | 58/141 [00:02<00:03, 21.48it/s][2025-03-28 01:06:06,842] [INFO] [logging.py:128:log_dist] [Rank 0] step=200, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:06:06,843] [INFO] [timer.py:264:stop] epoch=0/micro_step=200/global_step=200, RunningAvgSamplesPerSec=80.34979424853749, CurrSamplesPerSec=88.46913773059688, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 43%|████████████████████████████████████████████▏                                                         | 61/141 [00:03<00:03, 21.70it/s] 45%|██████████████████████████████████████████████▎                                                       | 64/141 [00:03<00:03, 21.86it/s] 48%|████████████████████████████████████████████████▍                                                     | 67/141 [00:03<00:03, 22.00it/s] 50%|██████████████████████████████████████████████████▋                                                   | 70/141 [00:03<00:03, 21.83it/s] 52%|████████████████████████████████████████████████████▊                                                 | 73/141 [00:03<00:03, 21.87it/s] 54%|██████████████████████████████████████████████████████▉                                               | 76/141 [00:03<00:02, 22.10it/s] 56%|█████████████████████████████████████████████████████████▏                                            | 79/141 [00:03<00:02, 22.17it/s] 58%|███████████████████████████████████████████████████████████▎                                          | 82/141 [00:03<00:02, 21.45it/s] 60%|█████████████████████████████████████████████████████████████▍                                        | 85/141 [00:04<00:02, 21.72it/s] 62%|███████████████████████████████████████████████████████████████▋                                      | 88/141 [00:04<00:02, 21.48it/s] 65%|█████████████████████████████████████████████████████████████████▊                                    | 91/141 [00:04<00:02, 21.96it/s] 67%|████████████████████████████████████████████████████████████████████                                  | 94/141 [00:04<00:02, 22.39it/s] 69%|██████████████████████████████████████████████████████████████████████▏                               | 97/141 [00:04<00:01, 22.08it/s] 71%|███████████████████████████████████████████████████████████████████████▋                             | 100/141 [00:04<00:01, 22.19it/s] 73%|█████████████████████████████████████████████████████████████████████████▊                           | 103/141 [00:04<00:01, 21.77it/s] 75%|███████████████████████████████████████████████████████████████████████████▉                         | 106/141 [00:05<00:01, 21.86it/s][2025-03-28 01:06:09,120] [INFO] [logging.py:128:log_dist] [Rank 0] step=250, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:06:09,120] [INFO] [timer.py:264:stop] epoch=0/micro_step=250/global_step=250, RunningAvgSamplesPerSec=81.79058059022385, CurrSamplesPerSec=85.40709743053452, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 77%|██████████████████████████████████████████████████████████████████████████████                       | 109/141 [00:05<00:01, 21.86it/s] 79%|████████████████████████████████████████████████████████████████████████████████▏                    | 112/141 [00:05<00:01, 20.90it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▍                  | 115/141 [00:05<00:01, 20.77it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▌                | 118/141 [00:05<00:01, 20.47it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▋              | 121/141 [00:05<00:01, 19.85it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▊            | 124/141 [00:05<00:00, 19.81it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▉          | 127/141 [00:06<00:00, 20.15it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████        | 130/141 [00:06<00:00, 20.09it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▎     | 133/141 [00:06<00:00, 19.84it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▋    | 135/141 [00:06<00:00, 19.72it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▊  | 138/141 [00:06<00:00, 20.01it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 141/141 [00:06<00:00, 19.98it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 141/141 [00:06<00:00, 20.52it/s]
  0%|                                                                                                               | 0/141 [00:00<?, ?it/s]  1%|▋                                                                                                      | 1/141 [00:00<00:27,  5.16it/s]  3%|██▉                                                                                                    | 4/141 [00:00<00:10, 12.86it/s]  4%|████▍                                                                                                  | 6/141 [00:00<00:09, 14.95it/s]  6%|██████▌                                                                                                | 9/141 [00:00<00:07, 17.17it/s]  8%|███████▉                                                                                              | 11/141 [00:00<00:07, 17.95it/s] 10%|██████████▏                                                                                           | 14/141 [00:00<00:06, 19.42it/s] 12%|████████████▎                                                                                         | 17/141 [00:00<00:06, 20.03it/s][2025-03-28 01:06:11,847] [INFO] [logging.py:128:log_dist] [Rank 0] step=300, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:06:11,848] [INFO] [timer.py:264:stop] epoch=0/micro_step=300/global_step=300, RunningAvgSamplesPerSec=81.07335555381252, CurrSamplesPerSec=89.75219635789844, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 14%|██████████████▍                                                                                       | 20/141 [00:01<00:06, 19.94it/s] 16%|████████████████▋                                                                                     | 23/141 [00:01<00:06, 18.60it/s] 18%|██████████████████                                                                                    | 25/141 [00:01<00:06, 18.85it/s] 19%|███████████████████▌                                                                                  | 27/141 [00:01<00:06, 18.79it/s] 21%|████████████████████▉                                                                                 | 29/141 [00:01<00:06, 18.57it/s] 22%|██████████████████████▍                                                                               | 31/141 [00:01<00:05, 18.40it/s] 23%|███████████████████████▊                                                                              | 33/141 [00:01<00:05, 18.45it/s] 25%|█████████████████████████▎                                                                            | 35/141 [00:01<00:05, 18.55it/s] 26%|██████████████████████████▊                                                                           | 37/141 [00:02<00:05, 18.68it/s] 28%|████████████████████████████▏                                                                         | 39/141 [00:02<00:05, 18.92it/s] 29%|█████████████████████████████▋                                                                        | 41/141 [00:02<00:05, 18.99it/s] 30%|███████████████████████████████                                                                       | 43/141 [00:02<00:05, 18.68it/s] 32%|████████████████████████████████▌                                                                     | 45/141 [00:02<00:05, 18.45it/s] 33%|██████████████████████████████████                                                                    | 47/141 [00:02<00:05, 18.47it/s] 35%|████████████████████████████████████▏                                                                 | 50/141 [00:02<00:04, 19.76it/s] 37%|█████████████████████████████████████▌                                                                | 52/141 [00:02<00:04, 19.23it/s] 38%|███████████████████████████████████████                                                               | 54/141 [00:02<00:04, 18.86it/s] 40%|████████████████████████████████████████▌                                                             | 56/141 [00:03<00:04, 18.61it/s] 41%|█████████████████████████████████████████▉                                                            | 58/141 [00:03<00:04, 18.68it/s] 43%|████████████████████████████████████████████▏                                                         | 61/141 [00:03<00:04, 19.21it/s] 45%|█████████████████████████████████████████████▌                                                        | 63/141 [00:03<00:04, 19.18it/s] 46%|███████████████████████████████████████████████                                                       | 65/141 [00:03<00:04, 18.65it/s] 48%|████████████████████████████████████████████████▍                                                     | 67/141 [00:03<00:04, 18.45it/s][2025-03-28 01:06:14,535] [INFO] [logging.py:128:log_dist] [Rank 0] step=350, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:06:14,539] [INFO] [timer.py:264:stop] epoch=0/micro_step=350/global_step=350, RunningAvgSamplesPerSec=80.06088590162867, CurrSamplesPerSec=70.85326212868792, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 49%|█████████████████████████████████████████████████▉                                                    | 69/141 [00:03<00:03, 18.27it/s] 50%|███████████████████████████████████████████████████▎                                                  | 71/141 [00:03<00:03, 18.00it/s] 52%|████████████████████████████████████████████████████▊                                                 | 73/141 [00:03<00:03, 18.17it/s] 53%|██████████████████████████████████████████████████████▎                                               | 75/141 [00:04<00:03, 18.36it/s] 55%|████████████████████████████████████████████████████████▍                                             | 78/141 [00:04<00:03, 18.95it/s] 57%|█████████████████████████████████████████████████████████▊                                            | 80/141 [00:04<00:03, 18.88it/s] 59%|████████████████████████████████████████████████████████████                                          | 83/141 [00:04<00:02, 19.85it/s] 61%|██████████████████████████████████████████████████████████████▏                                       | 86/141 [00:04<00:02, 20.43it/s] 63%|████████████████████████████████████████████████████████████████▍                                     | 89/141 [00:04<00:02, 20.91it/s] 65%|██████████████████████████████████████████████████████████████████▌                                   | 92/141 [00:04<00:02, 20.06it/s] 67%|████████████████████████████████████████████████████████████████████▋                                 | 95/141 [00:05<00:02, 19.38it/s] 69%|██████████████████████████████████████████████████████████████████████▏                               | 97/141 [00:05<00:02, 19.05it/s] 70%|███████████████████████████████████████████████████████████████████████▌                              | 99/141 [00:05<00:02, 18.78it/s] 72%|████████████████████████████████████████████████████████████████████████▎                            | 101/141 [00:05<00:02, 18.56it/s] 73%|█████████████████████████████████████████████████████████████████████████▊                           | 103/141 [00:05<00:02, 18.41it/s] 74%|███████████████████████████████████████████████████████████████████████████▏                         | 105/141 [00:05<00:01, 18.30it/s] 76%|████████████████████████████████████████████████████████████████████████████▋                        | 107/141 [00:05<00:01, 18.21it/s] 77%|██████████████████████████████████████████████████████████████████████████████                       | 109/141 [00:05<00:01, 18.61it/s] 79%|████████████████████████████████████████████████████████████████████████████████▏                    | 112/141 [00:05<00:01, 19.80it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▍                  | 115/141 [00:06<00:01, 20.28it/s][2025-03-28 01:06:17,096] [INFO] [logging.py:128:log_dist] [Rank 0] step=400, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:06:17,097] [INFO] [timer.py:264:stop] epoch=0/micro_step=400/global_step=400, RunningAvgSamplesPerSec=79.84381150646733, CurrSamplesPerSec=104.46897911678123, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 84%|████████████████████████████████████████████████████████████████████████████████████▌                | 118/141 [00:06<00:01, 21.15it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▋              | 121/141 [00:06<00:00, 22.12it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▊            | 124/141 [00:06<00:00, 22.66it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▉          | 127/141 [00:06<00:00, 22.73it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████        | 130/141 [00:06<00:00, 22.51it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▎     | 133/141 [00:06<00:00, 22.43it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████▍   | 136/141 [00:07<00:00, 21.69it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▌ | 139/141 [00:07<00:00, 20.26it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 141/141 [00:07<00:00, 19.03it/s]
  0%|                                                                                                               | 0/141 [00:00<?, ?it/s]  1%|▋                                                                                                      | 1/141 [00:00<00:39,  3.51it/s]  2%|██▏                                                                                                    | 3/141 [00:00<00:15,  8.69it/s]  4%|███▋                                                                                                   | 5/141 [00:00<00:11, 11.84it/s]  5%|█████                                                                                                  | 7/141 [00:00<00:09, 14.16it/s]  7%|███████▏                                                                                              | 10/141 [00:00<00:07, 16.89it/s]  9%|█████████▍                                                                                            | 13/141 [00:00<00:06, 18.64it/s] 11%|██████████▊                                                                                           | 15/141 [00:00<00:06, 18.94it/s] 13%|█████████████                                                                                         | 18/141 [00:01<00:06, 19.47it/s] 14%|██████████████▍                                                                                       | 20/141 [00:01<00:06, 18.73it/s] 16%|███████████████▉                                                                                      | 22/141 [00:01<00:06, 18.52it/s] 17%|█████████████████▎                                                                                    | 24/141 [00:01<00:06, 18.19it/s] 18%|██████████████████▊                                                                                   | 26/141 [00:01<00:06, 18.13it/s][2025-03-28 01:06:19,889] [INFO] [logging.py:128:log_dist] [Rank 0] step=450, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:06:19,893] [INFO] [timer.py:264:stop] epoch=0/micro_step=450/global_step=450, RunningAvgSamplesPerSec=79.33884577796906, CurrSamplesPerSec=99.94219647958501, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 21%|████████████████████▉                                                                                 | 29/141 [00:01<00:05, 18.92it/s] 22%|██████████████████████▍                                                                               | 31/141 [00:01<00:05, 18.67it/s] 23%|███████████████████████▊                                                                              | 33/141 [00:01<00:05, 18.49it/s] 25%|█████████████████████████▎                                                                            | 35/141 [00:02<00:05, 18.35it/s] 26%|██████████████████████████▊                                                                           | 37/141 [00:02<00:05, 18.25it/s] 28%|████████████████████████████▏                                                                         | 39/141 [00:02<00:05, 18.57it/s] 30%|██████████████████████████████▍                                                                       | 42/141 [00:02<00:04, 20.23it/s] 32%|████████████████████████████████▌                                                                     | 45/141 [00:02<00:04, 21.32it/s] 34%|██████████████████████████████████▋                                                                   | 48/141 [00:02<00:04, 22.03it/s] 36%|████████████████████████████████████▉                                                                 | 51/141 [00:02<00:03, 22.66it/s] 38%|███████████████████████████████████████                                                               | 54/141 [00:02<00:03, 23.04it/s] 40%|█████████████████████████████████████████▏                                                            | 57/141 [00:03<00:03, 23.10it/s] 43%|███████████████████████████████████████████▍                                                          | 60/141 [00:03<00:03, 22.41it/s] 45%|█████████████████████████████████████████████▌                                                        | 63/141 [00:03<00:03, 20.85it/s] 47%|███████████████████████████████████████████████▋                                                      | 66/141 [00:03<00:03, 19.89it/s] 49%|█████████████████████████████████████████████████▉                                                    | 69/141 [00:03<00:03, 18.85it/s] 50%|███████████████████████████████████████████████████▎                                                  | 71/141 [00:03<00:03, 18.66it/s] 52%|████████████████████████████████████████████████████▊                                                 | 73/141 [00:03<00:03, 18.35it/s] 53%|██████████████████████████████████████████████████████▎                                               | 75/141 [00:04<00:03, 18.27it/s][2025-03-28 01:06:22,406] [INFO] [logging.py:128:log_dist] [Rank 0] step=500, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:06:22,409] [INFO] [timer.py:264:stop] epoch=0/micro_step=500/global_step=500, RunningAvgSamplesPerSec=79.36983215815279, CurrSamplesPerSec=72.25728382777986, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 55%|███████████████████████████████████████████████████████▋                                              | 77/141 [00:04<00:03, 18.19it/s] 56%|█████████████████████████████████████████████████████████▏                                            | 79/141 [00:04<00:03, 18.51it/s] 58%|███████████████████████████████████████████████████████████▎                                          | 82/141 [00:04<00:02, 19.71it/s] 60%|█████████████████████████████████████████████████████████████▍                                        | 85/141 [00:04<00:02, 20.26it/s] 62%|███████████████████████████████████████████████████████████████▋                                      | 88/141 [00:04<00:02, 19.88it/s] 65%|█████████████████████████████████████████████████████████████████▊                                    | 91/141 [00:04<00:02, 20.45it/s] 67%|████████████████████████████████████████████████████████████████████                                  | 94/141 [00:04<00:02, 20.73it/s] 69%|██████████████████████████████████████████████████████████████████████▏                               | 97/141 [00:05<00:02, 21.18it/s] 71%|███████████████████████████████████████████████████████████████████████▋                             | 100/141 [00:05<00:01, 21.49it/s] 73%|█████████████████████████████████████████████████████████████████████████▊                           | 103/141 [00:05<00:01, 21.56it/s] 75%|███████████████████████████████████████████████████████████████████████████▉                         | 106/141 [00:05<00:01, 20.83it/s] 77%|██████████████████████████████████████████████████████████████████████████████                       | 109/141 [00:05<00:01, 19.89it/s] 79%|████████████████████████████████████████████████████████████████████████████████▏                    | 112/141 [00:05<00:01, 19.28it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▋                   | 114/141 [00:05<00:01, 18.98it/s] 82%|███████████████████████████████████████████████████████████████████████████████████                  | 116/141 [00:06<00:01, 18.72it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▌                | 118/141 [00:06<00:01, 18.53it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▉               | 120/141 [00:06<00:01, 18.38it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▍             | 122/141 [00:06<00:01, 18.29it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▊            | 124/141 [00:06<00:00, 18.42it/s][2025-03-28 01:06:24,909] [INFO] [logging.py:128:log_dist] [Rank 0] step=550, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:06:24,910] [INFO] [timer.py:264:stop] epoch=0/micro_step=550/global_step=550, RunningAvgSamplesPerSec=79.44437472810635, CurrSamplesPerSec=92.89082647299655, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 90%|██████████████████████████████████████████████████████████████████████████████████████████▉          | 127/141 [00:06<00:00, 20.06it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████        | 130/141 [00:06<00:00, 21.14it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▎     | 133/141 [00:06<00:00, 21.84it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████▍   | 136/141 [00:07<00:00, 21.79it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▌ | 139/141 [00:07<00:00, 22.02it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 141/141 [00:07<00:00, 19.26it/s]
  0%|                                                                                                               | 0/141 [00:00<?, ?it/s]  1%|▋                                                                                                      | 1/141 [00:00<00:31,  4.46it/s]  2%|██▏                                                                                                    | 3/141 [00:00<00:13, 10.23it/s]  4%|███▋                                                                                                   | 5/141 [00:00<00:10, 13.15it/s]  5%|█████                                                                                                  | 7/141 [00:00<00:09, 14.84it/s]  6%|██████▌                                                                                                | 9/141 [00:00<00:08, 16.08it/s]  8%|███████▉                                                                                              | 11/141 [00:00<00:07, 16.71it/s]  9%|█████████▍                                                                                            | 13/141 [00:00<00:07, 17.12it/s] 11%|██████████▊                                                                                           | 15/141 [00:00<00:07, 17.40it/s] 12%|████████████▎                                                                                         | 17/141 [00:01<00:07, 17.60it/s] 13%|█████████████▋                                                                                        | 19/141 [00:01<00:06, 17.55it/s] 15%|███████████████▏                                                                                      | 21/141 [00:01<00:06, 17.52it/s] 16%|████████████████▋                                                                                     | 23/141 [00:01<00:06, 17.92it/s] 18%|██████████████████▊                                                                                   | 26/141 [00:01<00:05, 19.26it/s] 20%|████████████████████▎                                                                                 | 28/141 [00:01<00:05, 19.35it/s] 22%|██████████████████████▍                                                                               | 31/141 [00:01<00:05, 19.93it/s] 23%|███████████████████████▊                                                                              | 33/141 [00:01<00:05, 19.47it/s][2025-03-28 01:06:27,681] [INFO] [logging.py:128:log_dist] [Rank 0] step=600, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:06:27,683] [INFO] [timer.py:264:stop] epoch=0/micro_step=600/global_step=600, RunningAvgSamplesPerSec=79.17609846277104, CurrSamplesPerSec=87.28532206852252, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 26%|██████████████████████████                                                                            | 36/141 [00:02<00:05, 19.88it/s] 28%|████████████████████████████▏                                                                         | 39/141 [00:02<00:04, 20.81it/s] 30%|██████████████████████████████▍                                                                       | 42/141 [00:02<00:04, 21.17it/s] 32%|████████████████████████████████▌                                                                     | 45/141 [00:02<00:04, 21.59it/s] 34%|██████████████████████████████████▋                                                                   | 48/141 [00:02<00:04, 22.01it/s] 36%|████████████████████████████████████▉                                                                 | 51/141 [00:02<00:04, 21.90it/s] 38%|███████████████████████████████████████                                                               | 54/141 [00:02<00:03, 21.80it/s] 40%|█████████████████████████████████████████▏                                                            | 57/141 [00:03<00:03, 21.74it/s] 43%|███████████████████████████████████████████▍                                                          | 60/141 [00:03<00:03, 20.38it/s] 45%|█████████████████████████████████████████████▌                                                        | 63/141 [00:03<00:03, 19.61it/s] 46%|███████████████████████████████████████████████                                                       | 65/141 [00:03<00:03, 19.23it/s] 48%|████████████████████████████████████████████████▍                                                     | 67/141 [00:03<00:03, 18.92it/s] 49%|█████████████████████████████████████████████████▉                                                    | 69/141 [00:03<00:03, 18.68it/s] 50%|███████████████████████████████████████████████████▎                                                  | 71/141 [00:03<00:03, 18.50it/s] 52%|████████████████████████████████████████████████████▊                                                 | 73/141 [00:03<00:03, 18.37it/s] 53%|██████████████████████████████████████████████████████▎                                               | 75/141 [00:04<00:03, 18.27it/s] 55%|███████████████████████████████████████████████████████▋                                              | 77/141 [00:04<00:03, 18.20it/s] 57%|█████████████████████████████████████████████████████████▊                                            | 80/141 [00:04<00:03, 19.22it/s] 59%|████████████████████████████████████████████████████████████                                          | 83/141 [00:04<00:02, 20.11it/s][2025-03-28 01:06:30,160] [INFO] [logging.py:128:log_dist] [Rank 0] step=650, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:06:30,161] [INFO] [timer.py:264:stop] epoch=0/micro_step=650/global_step=650, RunningAvgSamplesPerSec=79.30776279461902, CurrSamplesPerSec=86.6743082919273, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 61%|██████████████████████████████████████████████████████████████▏                                       | 86/141 [00:04<00:02, 20.53it/s] 63%|████████████████████████████████████████████████████████████████▍                                     | 89/141 [00:04<00:02, 20.73it/s] 65%|██████████████████████████████████████████████████████████████████▌                                   | 92/141 [00:04<00:02, 21.02it/s] 67%|████████████████████████████████████████████████████████████████████▋                                 | 95/141 [00:04<00:02, 21.24it/s] 70%|██████████████████████████████████████████████████████████████████████▉                               | 98/141 [00:05<00:02, 21.23it/s] 72%|████████████████████████████████████████████████████████████████████████▎                            | 101/141 [00:05<00:01, 20.55it/s] 74%|██████████████████████████████████████████████████████████████████████████▍                          | 104/141 [00:05<00:01, 20.92it/s] 76%|████████████████████████████████████████████████████████████████████████████▋                        | 107/141 [00:05<00:01, 21.23it/s] 78%|██████████████████████████████████████████████████████████████████████████████▊                      | 110/141 [00:05<00:01, 21.73it/s] 80%|████████████████████████████████████████████████████████████████████████████████▉                    | 113/141 [00:05<00:01, 22.21it/s] 82%|███████████████████████████████████████████████████████████████████████████████████                  | 116/141 [00:05<00:01, 22.19it/s] 84%|█████████████████████████████████████████████████████████████████████████████████████▏               | 119/141 [00:06<00:00, 22.28it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▍             | 122/141 [00:06<00:00, 22.06it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▌           | 125/141 [00:06<00:00, 22.11it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▋         | 128/141 [00:06<00:00, 22.21it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▊       | 131/141 [00:06<00:00, 22.62it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▉     | 134/141 [00:06<00:00, 21.73it/s][2025-03-28 01:06:32,472] [INFO] [logging.py:128:log_dist] [Rank 0] step=700, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:06:32,476] [INFO] [timer.py:264:stop] epoch=0/micro_step=700/global_step=700, RunningAvgSamplesPerSec=79.78956594341504, CurrSamplesPerSec=71.81160668548964, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 97%|██████████████████████████████████████████████████████████████████████████████████████████████████▏  | 137/141 [00:06<00:00, 20.43it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████▎| 140/141 [00:07<00:00, 19.60it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 141/141 [00:07<00:00, 19.59it/s]
  0%|                                                                                                               | 0/141 [00:00<?, ?it/s]  1%|▋                                                                                                      | 1/141 [00:00<01:11,  1.96it/s]  3%|██▉                                                                                                    | 4/141 [00:00<00:18,  7.44it/s]  5%|█████                                                                                                  | 7/141 [00:00<00:11, 11.46it/s]  7%|███████▏                                                                                              | 10/141 [00:00<00:09, 14.30it/s]  9%|█████████▍                                                                                            | 13/141 [00:01<00:07, 16.55it/s] 11%|███████████▌                                                                                          | 16/141 [00:01<00:06, 18.17it/s] 13%|█████████████▋                                                                                        | 19/141 [00:01<00:06, 18.56it/s] 16%|███████████████▉                                                                                      | 22/141 [00:01<00:06, 19.36it/s] 18%|██████████████████                                                                                    | 25/141 [00:01<00:05, 19.88it/s] 20%|████████████████████▎                                                                                 | 28/141 [00:01<00:05, 20.21it/s] 22%|██████████████████████▍                                                                               | 31/141 [00:01<00:05, 20.73it/s] 24%|████████████████████████▌                                                                             | 34/141 [00:02<00:05, 21.10it/s] 26%|██████████████████████████▊                                                                           | 37/141 [00:02<00:04, 21.26it/s] 28%|████████████████████████████▉                                                                         | 40/141 [00:02<00:04, 21.33it/s] 30%|███████████████████████████████                                                                       | 43/141 [00:02<00:04, 20.57it/s][2025-03-28 01:06:35,408] [INFO] [logging.py:128:log_dist] [Rank 0] step=750, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:06:35,409] [INFO] [timer.py:264:stop] epoch=0/micro_step=750/global_step=750, RunningAvgSamplesPerSec=79.17726314366634, CurrSamplesPerSec=87.04440154467142, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 33%|█████████████████████████████████▎                                                                    | 46/141 [00:02<00:04, 21.01it/s] 35%|███████████████████████████████████▍                                                                  | 49/141 [00:02<00:04, 21.28it/s] 37%|█████████████████████████████████████▌                                                                | 52/141 [00:02<00:04, 21.65it/s] 39%|███████████████████████████████████████▊                                                              | 55/141 [00:03<00:03, 21.76it/s] 41%|█████████████████████████████████████████▉                                                            | 58/141 [00:03<00:03, 21.86it/s] 43%|████████████████████████████████████████████▏                                                         | 61/141 [00:03<00:03, 21.48it/s] 45%|██████████████████████████████████████████████▎                                                       | 64/141 [00:03<00:03, 20.30it/s] 48%|████████████████████████████████████████████████▍                                                     | 67/141 [00:03<00:03, 19.40it/s] 49%|█████████████████████████████████████████████████▉                                                    | 69/141 [00:03<00:03, 19.06it/s] 50%|███████████████████████████████████████████████████▎                                                  | 71/141 [00:03<00:03, 18.79it/s] 52%|████████████████████████████████████████████████████▊                                                 | 73/141 [00:03<00:03, 18.56it/s] 53%|██████████████████████████████████████████████████████▎                                               | 75/141 [00:04<00:03, 18.42it/s] 55%|███████████████████████████████████████████████████████▋                                              | 77/141 [00:04<00:03, 17.95it/s] 56%|█████████████████████████████████████████████████████████▏                                            | 79/141 [00:04<00:03, 17.95it/s] 58%|███████████████████████████████████████████████████████████▎                                          | 82/141 [00:04<00:03, 19.42it/s] 60%|█████████████████████████████████████████████████████████████▍                                        | 85/141 [00:04<00:02, 20.70it/s] 62%|███████████████████████████████████████████████████████████████▋                                      | 88/141 [00:04<00:02, 21.61it/s] 65%|█████████████████████████████████████████████████████████████████▊                                    | 91/141 [00:04<00:02, 22.09it/s] 67%|████████████████████████████████████████████████████████████████████                                  | 94/141 [00:04<00:02, 22.04it/s][2025-03-28 01:06:37,854] [INFO] [logging.py:128:log_dist] [Rank 0] step=800, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:06:37,854] [INFO] [timer.py:264:stop] epoch=0/micro_step=800/global_step=800, RunningAvgSamplesPerSec=79.34792742421627, CurrSamplesPerSec=85.67445092869391, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 69%|██████████████████████████████████████████████████████████████████████▏                               | 97/141 [00:05<00:02, 21.94it/s] 71%|███████████████████████████████████████████████████████████████████████▋                             | 100/141 [00:05<00:01, 21.90it/s] 73%|█████████████████████████████████████████████████████████████████████████▊                           | 103/141 [00:05<00:01, 21.81it/s] 75%|███████████████████████████████████████████████████████████████████████████▉                         | 106/141 [00:05<00:01, 21.81it/s] 77%|██████████████████████████████████████████████████████████████████████████████                       | 109/141 [00:05<00:01, 21.80it/s] 79%|████████████████████████████████████████████████████████████████████████████████▏                    | 112/141 [00:05<00:01, 21.80it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▍                  | 115/141 [00:05<00:01, 21.60it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▌                | 118/141 [00:06<00:01, 22.01it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▋              | 121/141 [00:06<00:00, 21.86it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▊            | 124/141 [00:06<00:00, 21.89it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▉          | 127/141 [00:06<00:00, 21.81it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████        | 130/141 [00:06<00:00, 21.95it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▎     | 133/141 [00:06<00:00, 21.94it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████▍   | 136/141 [00:06<00:00, 21.74it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▌ | 139/141 [00:07<00:00, 21.76it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 141/141 [00:07<00:00, 19.53it/s]
  0%|                                                                                                               | 0/141 [00:00<?, ?it/s]  1%|▋                                                                                                      | 1/141 [00:00<00:34,  4.02it/s][2025-03-28 01:06:40,460] [INFO] [logging.py:128:log_dist] [Rank 0] step=850, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:06:40,461] [INFO] [timer.py:264:stop] epoch=0/micro_step=850/global_step=850, RunningAvgSamplesPerSec=79.519152134595, CurrSamplesPerSec=88.27595761009151, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
  3%|██▉                                                                                                    | 4/141 [00:00<00:11, 11.73it/s]  5%|█████                                                                                                  | 7/141 [00:00<00:08, 15.68it/s]  7%|███████▏                                                                                              | 10/141 [00:00<00:07, 17.78it/s]  9%|█████████▍                                                                                            | 13/141 [00:00<00:06, 19.14it/s] 11%|███████████▌                                                                                          | 16/141 [00:00<00:06, 20.21it/s] 13%|█████████████▋                                                                                        | 19/141 [00:01<00:05, 20.67it/s] 16%|███████████████▉                                                                                      | 22/141 [00:01<00:05, 20.90it/s] 18%|██████████████████                                                                                    | 25/141 [00:01<00:05, 21.01it/s] 20%|████████████████████▎                                                                                 | 28/141 [00:01<00:05, 21.39it/s] 22%|██████████████████████▍                                                                               | 31/141 [00:01<00:05, 21.48it/s] 24%|████████████████████████▌                                                                             | 34/141 [00:01<00:04, 21.73it/s] 26%|██████████████████████████▊                                                                           | 37/141 [00:01<00:04, 21.83it/s] 28%|████████████████████████████▉                                                                         | 40/141 [00:02<00:04, 21.83it/s] 30%|███████████████████████████████                                                                       | 43/141 [00:02<00:04, 20.81it/s] 33%|█████████████████████████████████▎                                                                    | 46/141 [00:02<00:04, 19.88it/s] 35%|███████████████████████████████████▍                                                                  | 49/141 [00:02<00:04, 19.27it/s] 36%|████████████████████████████████████▉                                                                 | 51/141 [00:02<00:04, 18.97it/s] 38%|██████████████████████████████████████▎                                                               | 53/141 [00:02<00:04, 18.73it/s][2025-03-28 01:06:42,875] [INFO] [logging.py:128:log_dist] [Rank 0] step=900, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:06:42,878] [INFO] [timer.py:264:stop] epoch=0/micro_step=900/global_step=900, RunningAvgSamplesPerSec=79.70234588014573, CurrSamplesPerSec=72.4279136892016, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 39%|███████████████████████████████████████▊                                                              | 55/141 [00:02<00:04, 18.55it/s] 40%|█████████████████████████████████████████▏                                                            | 57/141 [00:02<00:04, 18.58it/s] 42%|██████████████████████████████████████████▋                                                           | 59/141 [00:03<00:04, 18.42it/s] 43%|████████████████████████████████████████████▏                                                         | 61/141 [00:03<00:04, 18.63it/s] 45%|██████████████████████████████████████████████▎                                                       | 64/141 [00:03<00:03, 19.66it/s] 48%|████████████████████████████████████████████████▍                                                     | 67/141 [00:03<00:03, 20.14it/s] 50%|██████████████████████████████████████████████████▋                                                   | 70/141 [00:03<00:03, 20.44it/s] 52%|████████████████████████████████████████████████████▊                                                 | 73/141 [00:03<00:03, 20.66it/s] 54%|██████████████████████████████████████████████████████▉                                               | 76/141 [00:03<00:03, 20.77it/s] 56%|█████████████████████████████████████████████████████████▏                                            | 79/141 [00:04<00:02, 20.94it/s] 58%|███████████████████████████████████████████████████████████▎                                          | 82/141 [00:04<00:02, 21.35it/s] 60%|█████████████████████████████████████████████████████████████▍                                        | 85/141 [00:04<00:02, 21.74it/s] 62%|███████████████████████████████████████████████████████████████▋                                      | 88/141 [00:04<00:02, 21.78it/s] 65%|█████████████████████████████████████████████████████████████████▊                                    | 91/141 [00:04<00:02, 21.67it/s] 67%|████████████████████████████████████████████████████████████████████                                  | 94/141 [00:04<00:02, 21.81it/s] 69%|██████████████████████████████████████████████████████████████████████▏                               | 97/141 [00:04<00:02, 21.89it/s] 71%|███████████████████████████████████████████████████████████████████████▋                             | 100/141 [00:04<00:01, 22.05it/s] 73%|█████████████████████████████████████████████████████████████████████████▊                           | 103/141 [00:05<00:01, 22.17it/s][2025-03-28 01:06:45,233] [INFO] [logging.py:128:log_dist] [Rank 0] step=950, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:06:45,234] [INFO] [timer.py:264:stop] epoch=0/micro_step=950/global_step=950, RunningAvgSamplesPerSec=79.97114811990579, CurrSamplesPerSec=86.51206983153001, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 75%|███████████████████████████████████████████████████████████████████████████▉                         | 106/141 [00:05<00:01, 22.07it/s] 77%|██████████████████████████████████████████████████████████████████████████████                       | 109/141 [00:05<00:01, 21.84it/s] 79%|████████████████████████████████████████████████████████████████████████████████▏                    | 112/141 [00:05<00:01, 21.96it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▍                  | 115/141 [00:05<00:01, 21.41it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▌                | 118/141 [00:05<00:01, 21.11it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▋              | 121/141 [00:05<00:00, 21.37it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▊            | 124/141 [00:06<00:00, 21.31it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▉          | 127/141 [00:06<00:00, 20.96it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████        | 130/141 [00:06<00:00, 20.33it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▎     | 133/141 [00:06<00:00, 20.40it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████▍   | 136/141 [00:06<00:00, 20.82it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▌ | 139/141 [00:06<00:00, 21.17it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 141/141 [00:06<00:00, 20.20it/s]
  0%|                                                                                                               | 0/141 [00:00<?, ?it/s]  1%|▋                                                                                                      | 1/141 [00:00<00:33,  4.14it/s]  2%|██▏                                                                                                    | 3/141 [00:00<00:13,  9.93it/s]  4%|████▍                                                                                                  | 6/141 [00:00<00:09, 14.58it/s]  6%|██████▌                                                                                                | 9/141 [00:00<00:07, 16.94it/s]  9%|████████▋                                                                                             | 12/141 [00:00<00:06, 18.68it/s][2025-03-28 01:06:47,890] [INFO] [logging.py:128:log_dist] [Rank 0] step=1000, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:06:47,891] [INFO] [timer.py:264:stop] epoch=0/micro_step=1000/global_step=1000, RunningAvgSamplesPerSec=79.97377151172078, CurrSamplesPerSec=87.10043700796228, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 11%|██████████▊                                                                                           | 15/141 [00:00<00:06, 19.68it/s][2025-03-28 01:06:48,025] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2025-03-28 01:06:48,070] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
 13%|█████████████                                                                                         | 18/141 [00:01<00:06, 20.31it/s] 15%|███████████████▏                                                                                      | 21/141 [00:01<00:05, 20.45it/s] 17%|█████████████████▎                                                                                    | 24/141 [00:01<00:05, 20.88it/s] 19%|███████████████████▌                                                                                  | 27/141 [00:01<00:05, 20.91it/s] 21%|█████████████████████▋                                                                                | 30/141 [00:01<00:05, 20.85it/s] 23%|███████████████████████▊                                                                              | 33/141 [00:01<00:05, 21.12it/s] 26%|██████████████████████████                                                                            | 36/141 [00:01<00:04, 21.07it/s] 28%|████████████████████████████▏                                                                         | 39/141 [00:02<00:04, 21.02it/s] 30%|██████████████████████████████▍                                                                       | 42/141 [00:02<00:04, 21.12it/s] 32%|████████████████████████████████▌                                                                     | 45/141 [00:02<00:04, 20.84it/s] 34%|██████████████████████████████████▋                                                                   | 48/141 [00:02<00:04, 20.98it/s] 36%|████████████████████████████████████▉                                                                 | 51/141 [00:02<00:04, 21.11it/s] 38%|███████████████████████████████████████                                                               | 54/141 [00:02<00:04, 21.03it/s] 40%|█████████████████████████████████████████▏                                                            | 57/141 [00:02<00:04, 20.78it/s] 43%|███████████████████████████████████████████▍                                                          | 60/141 [00:03<00:03, 20.46it/s][2025-03-28 01:06:50,278] [INFO] [logging.py:128:log_dist] [Rank 0] step=1050, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:06:50,280] [INFO] [timer.py:264:stop] epoch=0/micro_step=1050/global_step=1050, RunningAvgSamplesPerSec=80.15262575884258, CurrSamplesPerSec=78.22815284525208, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 45%|█████████████████████████████████████████████▌                                                        | 63/141 [00:03<00:03, 20.28it/s] 47%|███████████████████████████████████████████████▋                                                      | 66/141 [00:03<00:03, 20.14it/s] 49%|█████████████████████████████████████████████████▉                                                    | 69/141 [00:03<00:03, 19.82it/s] 51%|████████████████████████████████████████████████████                                                  | 72/141 [00:03<00:03, 19.88it/s] 52%|█████████████████████████████████████████████████████▌                                                | 74/141 [00:03<00:03, 19.82it/s] 54%|██████████████████████████████████████████████████████▉                                               | 76/141 [00:03<00:03, 19.75it/s] 55%|████████████████████████████████████████████████████████▍                                             | 78/141 [00:03<00:03, 19.66it/s] 57%|█████████████████████████████████████████████████████████▊                                            | 80/141 [00:04<00:03, 19.68it/s] 58%|███████████████████████████████████████████████████████████▎                                          | 82/141 [00:04<00:03, 19.55it/s] 60%|████████████████████████████████████████████████████████████▊                                         | 84/141 [00:04<00:02, 19.18it/s] 61%|██████████████████████████████████████████████████████████████▏                                       | 86/141 [00:04<00:02, 19.08it/s] 62%|███████████████████████████████████████████████████████████████▋                                      | 88/141 [00:04<00:02, 18.96it/s] 64%|█████████████████████████████████████████████████████████████████                                     | 90/141 [00:04<00:02, 18.76it/s] 65%|██████████████████████████████████████████████████████████████████▌                                   | 92/141 [00:04<00:02, 18.71it/s] 67%|████████████████████████████████████████████████████████████████████                                  | 94/141 [00:04<00:02, 18.73it/s] 68%|█████████████████████████████████████████████████████████████████████▍                                | 96/141 [00:04<00:02, 18.58it/s] 70%|██████████████████████████████████████████████████████████████████████▉                               | 98/141 [00:05<00:02, 18.63it/s] 71%|███████████████████████████████████████████████████████████████████████▋                             | 100/141 [00:05<00:02, 18.73it/s] 72%|█████████████████████████████████████████████████████████████████████████                            | 102/141 [00:05<00:02, 18.45it/s] 74%|██████████████████████████████████████████████████████████████████████████▍                          | 104/141 [00:05<00:01, 18.65it/s] 75%|███████████████████████████████████████████████████████████████████████████▉                         | 106/141 [00:05<00:01, 18.67it/s] 77%|█████████████████████████████████████████████████████████████████████████████▎                       | 108/141 [00:05<00:01, 18.60it/s] 78%|██████████████████████████████████████████████████████████████████████████████▊                      | 110/141 [00:05<00:01, 18.62it/s] 79%|████████████████████████████████████████████████████████████████████████████████▏                    | 112/141 [00:05<00:01, 18.52it/s][2025-03-28 01:06:52,920] [INFO] [logging.py:128:log_dist] [Rank 0] step=1100, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:06:52,923] [INFO] [timer.py:264:stop] epoch=0/micro_step=1100/global_step=1100, RunningAvgSamplesPerSec=79.94680528951538, CurrSamplesPerSec=73.0809853206962, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 81%|█████████████████████████████████████████████████████████████████████████████████▋                   | 114/141 [00:05<00:01, 18.36it/s] 82%|███████████████████████████████████████████████████████████████████████████████████                  | 116/141 [00:06<00:01, 18.48it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▌                | 118/141 [00:06<00:01, 18.61it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▉               | 120/141 [00:06<00:01, 18.62it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▍             | 122/141 [00:06<00:01, 18.99it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▊            | 124/141 [00:06<00:00, 19.16it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████▎          | 126/141 [00:06<00:00, 18.43it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▋         | 128/141 [00:06<00:00, 18.36it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████        | 130/141 [00:06<00:00, 18.36it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▌      | 132/141 [00:06<00:00, 18.36it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▉     | 134/141 [00:06<00:00, 17.79it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████▍   | 136/141 [00:07<00:00, 17.78it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▊  | 138/141 [00:07<00:00, 17.93it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████▎| 140/141 [00:07<00:00, 18.30it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 141/141 [00:07<00:00, 18.98it/s]
  0%|                                                                                                               | 0/141 [00:00<?, ?it/s]  1%|▋                                                                                                      | 1/141 [00:00<00:28,  4.99it/s]  2%|██▏                                                                                                    | 3/141 [00:00<00:12, 10.79it/s]  4%|███▋                                                                                                   | 5/141 [00:00<00:09, 13.92it/s]  6%|█████▊                                                                                                 | 8/141 [00:00<00:07, 17.15it/s]  8%|███████▉                                                                                              | 11/141 [00:00<00:06, 18.81it/s] 10%|██████████▏                                                                                           | 14/141 [00:00<00:06, 19.75it/s] 12%|████████████▎                                                                                         | 17/141 [00:00<00:06, 20.27it/s] 14%|██████████████▍                                                                                       | 20/141 [00:01<00:05, 20.71it/s][2025-03-28 01:06:55,726] [INFO] [logging.py:128:log_dist] [Rank 0] step=1150, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:06:55,727] [INFO] [timer.py:264:stop] epoch=0/micro_step=1150/global_step=1150, RunningAvgSamplesPerSec=79.73959072033036, CurrSamplesPerSec=90.75378447070382, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 16%|████████████████▋                                                                                     | 23/141 [00:01<00:05, 21.22it/s] 18%|██████████████████▊                                                                                   | 26/141 [00:01<00:05, 21.47it/s] 21%|████████████████████▉                                                                                 | 29/141 [00:01<00:05, 20.68it/s] 23%|███████████████████████▏                                                                              | 32/141 [00:01<00:05, 21.51it/s] 25%|█████████████████████████▎                                                                            | 35/141 [00:01<00:04, 21.70it/s] 27%|███████████████████████████▍                                                                          | 38/141 [00:01<00:04, 22.16it/s] 29%|█████████████████████████████▋                                                                        | 41/141 [00:02<00:04, 22.61it/s] 31%|███████████████████████████████▊                                                                      | 44/141 [00:02<00:04, 22.96it/s] 33%|██████████████████████████████████                                                                    | 47/141 [00:02<00:04, 23.16it/s] 35%|████████████████████████████████████▏                                                                 | 50/141 [00:02<00:04, 21.92it/s] 38%|██████████████████████████████████████▎                                                               | 53/141 [00:02<00:03, 22.10it/s] 40%|████████████████████████████████████████▌                                                             | 56/141 [00:02<00:03, 22.04it/s] 42%|██████████████████████████████████████████▋                                                           | 59/141 [00:02<00:03, 21.94it/s] 44%|████████████████████████████████████████████▊                                                         | 62/141 [00:03<00:03, 21.71it/s] 46%|███████████████████████████████████████████████                                                       | 65/141 [00:03<00:03, 21.93it/s] 48%|█████████████████████████████████████████████████▏                                                    | 68/141 [00:03<00:03, 21.83it/s] 50%|███████████████████████████████████████████████████▎                                                  | 71/141 [00:03<00:03, 21.90it/s][2025-03-28 01:06:57,996] [INFO] [logging.py:128:log_dist] [Rank 0] step=1200, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:06:57,997] [INFO] [timer.py:264:stop] epoch=0/micro_step=1200/global_step=1200, RunningAvgSamplesPerSec=80.06464718698656, CurrSamplesPerSec=83.49108604972488, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 52%|█████████████████████████████████████████████████████▌                                                | 74/141 [00:03<00:03, 21.71it/s] 55%|███████████████████████████████████████████████████████▋                                              | 77/141 [00:03<00:03, 21.10it/s] 57%|█████████████████████████████████████████████████████████▊                                            | 80/141 [00:03<00:02, 21.14it/s] 59%|████████████████████████████████████████████████████████████                                          | 83/141 [00:03<00:02, 21.41it/s] 61%|██████████████████████████████████████████████████████████████▏                                       | 86/141 [00:04<00:02, 21.42it/s] 63%|████████████████████████████████████████████████████████████████▍                                     | 89/141 [00:04<00:02, 21.48it/s] 65%|██████████████████████████████████████████████████████████████████▌                                   | 92/141 [00:04<00:02, 21.49it/s] 67%|████████████████████████████████████████████████████████████████████▋                                 | 95/141 [00:04<00:02, 21.37it/s] 70%|██████████████████████████████████████████████████████████████████████▉                               | 98/141 [00:04<00:02, 21.40it/s] 72%|████████████████████████████████████████████████████████████████████████▎                            | 101/141 [00:04<00:01, 20.87it/s] 74%|██████████████████████████████████████████████████████████████████████████▍                          | 104/141 [00:04<00:01, 20.64it/s] 76%|████████████████████████████████████████████████████████████████████████████▋                        | 107/141 [00:05<00:01, 20.55it/s] 78%|██████████████████████████████████████████████████████████████████████████████▊                      | 110/141 [00:05<00:01, 20.97it/s] 80%|████████████████████████████████████████████████████████████████████████████████▉                    | 113/141 [00:05<00:01, 21.34it/s] 82%|███████████████████████████████████████████████████████████████████████████████████                  | 116/141 [00:05<00:01, 21.47it/s] 84%|█████████████████████████████████████████████████████████████████████████████████████▏               | 119/141 [00:05<00:01, 21.70it/s][2025-03-28 01:07:00,347] [INFO] [logging.py:128:log_dist] [Rank 0] step=1250, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:07:00,348] [INFO] [timer.py:264:stop] epoch=0/micro_step=1250/global_step=1250, RunningAvgSamplesPerSec=80.26203096108527, CurrSamplesPerSec=86.92984403479632, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 87%|███████████████████████████████████████████████████████████████████████████████████████▍             | 122/141 [00:05<00:00, 21.73it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▌           | 125/141 [00:05<00:00, 21.85it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▋         | 128/141 [00:06<00:00, 21.89it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▊       | 131/141 [00:06<00:00, 21.88it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▉     | 134/141 [00:06<00:00, 21.88it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████████▏  | 137/141 [00:06<00:00, 21.72it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████▎| 140/141 [00:06<00:00, 21.72it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 141/141 [00:06<00:00, 20.88it/s]
  0%|                                                                                                               | 0/141 [00:00<?, ?it/s]  1%|▋                                                                                                      | 1/141 [00:00<00:30,  4.55it/s]  3%|██▉                                                                                                    | 4/141 [00:00<00:09, 13.93it/s]  5%|█████                                                                                                  | 7/141 [00:00<00:07, 17.55it/s]  7%|███████▏                                                                                              | 10/141 [00:00<00:06, 19.46it/s]  9%|█████████▍                                                                                            | 13/141 [00:00<00:06, 20.29it/s] 11%|███████████▌                                                                                          | 16/141 [00:00<00:05, 20.84it/s] 13%|█████████████▋                                                                                        | 19/141 [00:01<00:05, 21.10it/s] 16%|███████████████▉                                                                                      | 22/141 [00:01<00:05, 21.44it/s] 18%|██████████████████                                                                                    | 25/141 [00:01<00:05, 21.47it/s] 20%|████████████████████▎                                                                                 | 28/141 [00:01<00:05, 21.94it/s][2025-03-28 01:07:02,847] [INFO] [logging.py:128:log_dist] [Rank 0] step=1300, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:07:02,848] [INFO] [timer.py:264:stop] epoch=0/micro_step=1300/global_step=1300, RunningAvgSamplesPerSec=80.43998428421335, CurrSamplesPerSec=92.04838073481704, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 22%|██████████████████████▍                                                                               | 31/141 [00:01<00:04, 22.34it/s] 24%|████████████████████████▌                                                                             | 34/141 [00:01<00:04, 22.31it/s] 26%|██████████████████████████▊                                                                           | 37/141 [00:01<00:04, 22.33it/s] 28%|████████████████████████████▉                                                                         | 40/141 [00:01<00:04, 22.19it/s] 30%|███████████████████████████████                                                                       | 43/141 [00:02<00:04, 21.64it/s] 33%|█████████████████████████████████▎                                                                    | 46/141 [00:02<00:04, 20.91it/s] 35%|███████████████████████████████████▍                                                                  | 49/141 [00:02<00:04, 21.00it/s] 37%|█████████████████████████████████████▌                                                                | 52/141 [00:02<00:04, 21.17it/s] 39%|███████████████████████████████████████▊                                                              | 55/141 [00:02<00:04, 21.30it/s] 41%|█████████████████████████████████████████▉                                                            | 58/141 [00:02<00:03, 21.32it/s] 43%|████████████████████████████████████████████▏                                                         | 61/141 [00:02<00:03, 21.47it/s] 45%|██████████████████████████████████████████████▎                                                       | 64/141 [00:03<00:03, 21.60it/s] 48%|████████████████████████████████████████████████▍                                                     | 67/141 [00:03<00:03, 21.70it/s] 50%|██████████████████████████████████████████████████▋                                                   | 70/141 [00:03<00:03, 21.75it/s] 52%|████████████████████████████████████████████████████▊                                                 | 73/141 [00:03<00:03, 21.97it/s] 54%|██████████████████████████████████████████████████████▉                                               | 76/141 [00:03<00:02, 22.14it/s] 56%|█████████████████████████████████████████████████████████▏                                            | 79/141 [00:03<00:02, 22.24it/s][2025-03-28 01:07:05,158] [INFO] [logging.py:128:log_dist] [Rank 0] step=1350, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:07:05,159] [INFO] [timer.py:264:stop] epoch=0/micro_step=1350/global_step=1350, RunningAvgSamplesPerSec=80.65892652197557, CurrSamplesPerSec=83.93342083977745, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 58%|███████████████████████████████████████████████████████████▎                                          | 82/141 [00:03<00:02, 21.95it/s] 60%|█████████████████████████████████████████████████████████████▍                                        | 85/141 [00:04<00:02, 22.10it/s] 62%|███████████████████████████████████████████████████████████████▋                                      | 88/141 [00:04<00:02, 22.06it/s] 65%|█████████████████████████████████████████████████████████████████▊                                    | 91/141 [00:04<00:02, 21.97it/s] 67%|████████████████████████████████████████████████████████████████████                                  | 94/141 [00:04<00:02, 21.22it/s] 69%|██████████████████████████████████████████████████████████████████████▏                               | 97/141 [00:04<00:02, 21.26it/s] 71%|███████████████████████████████████████████████████████████████████████▋                             | 100/141 [00:04<00:01, 21.44it/s] 73%|█████████████████████████████████████████████████████████████████████████▊                           | 103/141 [00:04<00:01, 21.32it/s] 75%|███████████████████████████████████████████████████████████████████████████▉                         | 106/141 [00:05<00:01, 21.42it/s] 77%|██████████████████████████████████████████████████████████████████████████████                       | 109/141 [00:05<00:01, 21.10it/s] 79%|████████████████████████████████████████████████████████████████████████████████▏                    | 112/141 [00:05<00:01, 21.29it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▍                  | 115/141 [00:05<00:01, 21.48it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▌                | 118/141 [00:05<00:01, 21.63it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▋              | 121/141 [00:05<00:00, 21.54it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▊            | 124/141 [00:05<00:00, 21.53it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▉          | 127/141 [00:05<00:00, 21.50it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████        | 130/141 [00:06<00:00, 21.44it/s][2025-03-28 01:07:07,491] [INFO] [logging.py:128:log_dist] [Rank 0] step=1400, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:07:07,492] [INFO] [timer.py:264:stop] epoch=0/micro_step=1400/global_step=1400, RunningAvgSamplesPerSec=80.83708860698373, CurrSamplesPerSec=82.26980966241635, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 94%|███████████████████████████████████████████████████████████████████████████████████████████████▎     | 133/141 [00:06<00:00, 21.31it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████▍   | 136/141 [00:06<00:00, 21.41it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▌ | 139/141 [00:06<00:00, 20.78it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 141/141 [00:06<00:00, 20.99it/s]
  0%|                                                                                                               | 0/141 [00:00<?, ?it/s]  1%|▋                                                                                                      | 1/141 [00:00<00:31,  4.47it/s]  3%|██▉                                                                                                    | 4/141 [00:00<00:10, 12.46it/s]  5%|█████                                                                                                  | 7/141 [00:00<00:08, 16.36it/s]  7%|███████▏                                                                                              | 10/141 [00:00<00:06, 18.90it/s]  9%|█████████▍                                                                                            | 13/141 [00:00<00:06, 20.27it/s] 11%|███████████▌                                                                                          | 16/141 [00:00<00:05, 21.68it/s] 13%|█████████████▋                                                                                        | 19/141 [00:00<00:05, 23.38it/s] 16%|███████████████▉                                                                                      | 22/141 [00:01<00:05, 23.09it/s] 18%|██████████████████                                                                                    | 25/141 [00:01<00:05, 23.16it/s] 20%|████████████████████▎                                                                                 | 28/141 [00:01<00:04, 23.23it/s] 22%|██████████████████████▍                                                                               | 31/141 [00:01<00:04, 23.47it/s] 24%|████████████████████████▌                                                                             | 34/141 [00:01<00:04, 23.51it/s] 26%|██████████████████████████▊                                                                           | 37/141 [00:01<00:04, 23.18it/s][2025-03-28 01:07:09,939] [INFO] [logging.py:128:log_dist] [Rank 0] step=1450, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:07:09,940] [INFO] [timer.py:264:stop] epoch=0/micro_step=1450/global_step=1450, RunningAvgSamplesPerSec=81.03003673514439, CurrSamplesPerSec=92.65996175784421, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 28%|████████████████████████████▉                                                                         | 40/141 [00:01<00:04, 23.02it/s] 30%|███████████████████████████████                                                                       | 43/141 [00:02<00:04, 22.80it/s] 33%|█████████████████████████████████▎                                                                    | 46/141 [00:02<00:04, 22.56it/s] 35%|███████████████████████████████████▍                                                                  | 49/141 [00:02<00:04, 22.20it/s] 37%|█████████████████████████████████████▌                                                                | 52/141 [00:02<00:03, 22.31it/s] 39%|███████████████████████████████████████▊                                                              | 55/141 [00:02<00:03, 22.70it/s] 41%|█████████████████████████████████████████▉                                                            | 58/141 [00:02<00:03, 22.96it/s] 43%|████████████████████████████████████████████▏                                                         | 61/141 [00:02<00:03, 23.00it/s] 45%|██████████████████████████████████████████████▎                                                       | 64/141 [00:02<00:03, 21.88it/s] 48%|████████████████████████████████████████████████▍                                                     | 67/141 [00:03<00:03, 21.99it/s] 50%|██████████████████████████████████████████████████▋                                                   | 70/141 [00:03<00:03, 21.89it/s] 52%|████████████████████████████████████████████████████▊                                                 | 73/141 [00:03<00:03, 21.98it/s] 54%|██████████████████████████████████████████████████████▉                                               | 76/141 [00:03<00:02, 22.01it/s] 56%|█████████████████████████████████████████████████████████▏                                            | 79/141 [00:03<00:02, 22.44it/s] 58%|███████████████████████████████████████████████████████████▎                                          | 82/141 [00:03<00:02, 22.52it/s] 60%|█████████████████████████████████████████████████████████████▍                                        | 85/141 [00:03<00:02, 22.15it/s] 62%|███████████████████████████████████████████████████████████████▋                                      | 88/141 [00:04<00:02, 22.00it/s][2025-03-28 01:07:12,196] [INFO] [logging.py:128:log_dist] [Rank 0] step=1500, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:07:12,197] [INFO] [timer.py:264:stop] epoch=0/micro_step=1500/global_step=1500, RunningAvgSamplesPerSec=81.26911599794654, CurrSamplesPerSec=88.26109682204815, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 65%|█████████████████████████████████████████████████████████████████▊                                    | 91/141 [00:04<00:02, 21.95it/s] 67%|████████████████████████████████████████████████████████████████████                                  | 94/141 [00:04<00:02, 22.30it/s] 69%|██████████████████████████████████████████████████████████████████████▏                               | 97/141 [00:04<00:01, 22.53it/s] 71%|███████████████████████████████████████████████████████████████████████▋                             | 100/141 [00:04<00:01, 22.82it/s] 73%|█████████████████████████████████████████████████████████████████████████▊                           | 103/141 [00:04<00:01, 22.31it/s] 75%|███████████████████████████████████████████████████████████████████████████▉                         | 106/141 [00:04<00:01, 22.37it/s] 77%|██████████████████████████████████████████████████████████████████████████████                       | 109/141 [00:04<00:01, 22.26it/s] 79%|████████████████████████████████████████████████████████████████████████████████▏                    | 112/141 [00:05<00:01, 22.11it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▍                  | 115/141 [00:05<00:01, 22.19it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▌                | 118/141 [00:05<00:01, 22.22it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▋              | 121/141 [00:05<00:00, 21.97it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▊            | 124/141 [00:05<00:00, 21.96it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▉          | 127/141 [00:05<00:00, 22.02it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████        | 130/141 [00:05<00:00, 22.00it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▎     | 133/141 [00:06<00:00, 21.96it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████▍   | 136/141 [00:06<00:00, 21.93it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▌ | 139/141 [00:06<00:00, 21.94it/s][2025-03-28 01:07:14,448] [INFO] [logging.py:128:log_dist] [Rank 0] step=1550, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:07:14,449] [INFO] [timer.py:264:stop] epoch=0/micro_step=1550/global_step=1550, RunningAvgSamplesPerSec=81.49881696922436, CurrSamplesPerSec=93.54080311695552, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 141/141 [00:06<00:00, 21.67it/s]
  0%|                                                                                                               | 0/141 [00:00<?, ?it/s]  1%|▋                                                                                                      | 1/141 [00:00<00:25,  5.45it/s]  3%|██▉                                                                                                    | 4/141 [00:00<00:10, 13.60it/s]  5%|█████                                                                                                  | 7/141 [00:00<00:07, 16.98it/s]  7%|███████▏                                                                                              | 10/141 [00:00<00:06, 18.81it/s]  9%|█████████▍                                                                                            | 13/141 [00:00<00:06, 19.92it/s] 11%|███████████▌                                                                                          | 16/141 [00:00<00:05, 21.01it/s] 13%|█████████████▋                                                                                        | 19/141 [00:01<00:05, 21.32it/s] 16%|███████████████▉                                                                                      | 22/141 [00:01<00:05, 20.74it/s] 18%|██████████████████                                                                                    | 25/141 [00:01<00:05, 20.62it/s] 20%|████████████████████▎                                                                                 | 28/141 [00:01<00:05, 20.88it/s] 22%|██████████████████████▍                                                                               | 31/141 [00:01<00:05, 21.35it/s] 24%|████████████████████████▌                                                                             | 34/141 [00:01<00:04, 22.05it/s] 26%|██████████████████████████▊                                                                           | 37/141 [00:01<00:04, 22.64it/s] 28%|████████████████████████████▉                                                                         | 40/141 [00:01<00:04, 22.27it/s] 30%|███████████████████████████████                                                                       | 43/141 [00:02<00:04, 21.80it/s] 33%|█████████████████████████████████▎                                                                    | 46/141 [00:02<00:04, 21.97it/s][2025-03-28 01:07:16,973] [INFO] [logging.py:128:log_dist] [Rank 0] step=1600, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:07:16,974] [INFO] [timer.py:264:stop] epoch=0/micro_step=1600/global_step=1600, RunningAvgSamplesPerSec=81.5852674766572, CurrSamplesPerSec=71.24833700462098, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 35%|███████████████████████████████████▍                                                                  | 49/141 [00:02<00:04, 21.40it/s] 37%|█████████████████████████████████████▌                                                                | 52/141 [00:02<00:04, 20.32it/s] 39%|███████████████████████████████████████▊                                                              | 55/141 [00:02<00:04, 20.39it/s] 41%|█████████████████████████████████████████▉                                                            | 58/141 [00:02<00:04, 20.33it/s] 43%|████████████████████████████████████████████▏                                                         | 61/141 [00:03<00:03, 20.22it/s] 45%|██████████████████████████████████████████████▎                                                       | 64/141 [00:03<00:03, 19.65it/s] 47%|███████████████████████████████████████████████▋                                                      | 66/141 [00:03<00:03, 19.54it/s] 49%|█████████████████████████████████████████████████▉                                                    | 69/141 [00:03<00:03, 20.02it/s] 51%|████████████████████████████████████████████████████                                                  | 72/141 [00:03<00:03, 19.54it/s] 53%|██████████████████████████████████████████████████████▎                                               | 75/141 [00:03<00:03, 19.81it/s] 55%|████████████████████████████████████████████████████████▍                                             | 78/141 [00:03<00:03, 20.34it/s] 57%|██████████████████████████████████████████████████████████▌                                           | 81/141 [00:03<00:02, 20.71it/s] 60%|████████████████████████████████████████████████████████████▊                                         | 84/141 [00:04<00:02, 21.03it/s] 62%|██████████████████████████████████████████████████████████████▉                                       | 87/141 [00:04<00:02, 21.39it/s] 64%|█████████████████████████████████████████████████████████████████                                     | 90/141 [00:04<00:02, 21.75it/s] 66%|███████████████████████████████████████████████████████████████████▎                                  | 93/141 [00:04<00:02, 21.93it/s] 68%|█████████████████████████████████████████████████████████████████████▍                                | 96/141 [00:04<00:02, 22.02it/s][2025-03-28 01:07:19,391] [INFO] [logging.py:128:log_dist] [Rank 0] step=1650, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:07:19,392] [INFO] [timer.py:264:stop] epoch=0/micro_step=1650/global_step=1650, RunningAvgSamplesPerSec=81.62541774501445, CurrSamplesPerSec=88.78844789052229, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 70%|███████████████████████████████████████████████████████████████████████▌                              | 99/141 [00:04<00:01, 21.86it/s] 72%|█████████████████████████████████████████████████████████████████████████                            | 102/141 [00:04<00:01, 22.14it/s] 74%|███████████████████████████████████████████████████████████████████████████▏                         | 105/141 [00:05<00:01, 21.82it/s] 77%|█████████████████████████████████████████████████████████████████████████████▎                       | 108/141 [00:05<00:01, 21.91it/s] 79%|███████████████████████████████████████████████████████████████████████████████▌                     | 111/141 [00:05<00:01, 21.20it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▋                   | 114/141 [00:05<00:01, 21.83it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▊                 | 117/141 [00:05<00:01, 21.68it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▉               | 120/141 [00:05<00:00, 21.57it/s] 87%|████████████████████████████████████████████████████████████████████████████████████████             | 123/141 [00:05<00:00, 21.44it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████▎          | 126/141 [00:06<00:00, 21.48it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████████▍        | 129/141 [00:06<00:00, 21.63it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▌      | 132/141 [00:06<00:00, 21.61it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▋    | 135/141 [00:06<00:00, 21.52it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▊  | 138/141 [00:06<00:00, 22.04it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 141/141 [00:06<00:00, 22.62it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 141/141 [00:06<00:00, 20.76it/s]
  0%|                                                                                                               | 0/141 [00:00<?, ?it/s]  1%|▋                                                                                                      | 1/141 [00:00<00:28,  4.86it/s]  2%|██▏                                                                                                    | 3/141 [00:00<00:12, 10.84it/s]  4%|███▋                                                                                                   | 5/141 [00:00<00:09, 14.02it/s][2025-03-28 01:07:21,948] [INFO] [logging.py:128:log_dist] [Rank 0] step=1700, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:07:21,951] [INFO] [timer.py:264:stop] epoch=0/micro_step=1700/global_step=1700, RunningAvgSamplesPerSec=81.66654280392122, CurrSamplesPerSec=81.31364387808546, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
  6%|█████▊                                                                                                 | 8/141 [00:00<00:07, 17.10it/s]  8%|███████▉                                                                                              | 11/141 [00:00<00:06, 18.73it/s] 10%|██████████▏                                                                                           | 14/141 [00:00<00:06, 20.12it/s] 12%|████████████▎                                                                                         | 17/141 [00:00<00:06, 20.57it/s] 14%|██████████████▍                                                                                       | 20/141 [00:01<00:05, 20.88it/s] 16%|████████████████▋                                                                                     | 23/141 [00:01<00:09, 12.17it/s] 18%|██████████████████                                                                                    | 25/141 [00:03<00:27,  4.18it/s] 19%|███████████████████▌                                                                                  | 27/141 [00:03<00:29,  3.86it/s] 21%|█████████████████████▋                                                                                | 30/141 [00:03<00:20,  5.42it/s] 23%|███████████████████████▊                                                                              | 33/141 [00:03<00:14,  7.26it/s] 26%|██████████████████████████                                                                            | 36/141 [00:04<00:11,  9.28it/s] 28%|████████████████████████████▏                                                                         | 39/141 [00:04<00:08, 11.40it/s] 29%|█████████████████████████████▋                                                                        | 41/141 [00:04<00:07, 12.66it/s] 31%|███████████████████████████████▊                                                                      | 44/141 [00:04<00:06, 14.66it/s] 33%|██████████████████████████████████                                                                    | 47/141 [00:04<00:05, 16.09it/s] 35%|████████████████████████████████████▏                                                                 | 50/141 [00:04<00:05, 17.42it/s] 38%|██████████████████████████████████████▎                                                               | 53/141 [00:04<00:04, 18.69it/s] 40%|████████████████████████████████████████▌                                                             | 56/141 [00:05<00:04, 19.32it/s][2025-03-28 01:07:26,527] [INFO] [logging.py:128:log_dist] [Rank 0] step=1750, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:07:26,527] [INFO] [timer.py:264:stop] epoch=0/micro_step=1750/global_step=1750, RunningAvgSamplesPerSec=79.69201377671502, CurrSamplesPerSec=94.80570951646334, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 42%|██████████████████████████████████████████▋                                                           | 59/141 [00:05<00:03, 20.55it/s] 44%|████████████████████████████████████████████▊                                                         | 62/141 [00:05<00:03, 21.44it/s] 46%|███████████████████████████████████████████████                                                       | 65/141 [00:05<00:03, 22.07it/s] 48%|█████████████████████████████████████████████████▏                                                    | 68/141 [00:05<00:03, 22.50it/s] 50%|███████████████████████████████████████████████████▎                                                  | 71/141 [00:05<00:03, 22.93it/s] 52%|█████████████████████████████████████████████████████▌                                                | 74/141 [00:05<00:02, 22.48it/s] 55%|███████████████████████████████████████████████████████▋                                              | 77/141 [00:05<00:02, 21.98it/s] 57%|█████████████████████████████████████████████████████████▊                                            | 80/141 [00:06<00:02, 21.71it/s] 59%|████████████████████████████████████████████████████████████                                          | 83/141 [00:06<00:02, 21.58it/s] 61%|██████████████████████████████████████████████████████████████▏                                       | 86/141 [00:06<00:02, 21.67it/s] 63%|████████████████████████████████████████████████████████████████▍                                     | 89/141 [00:06<00:02, 21.74it/s] 65%|██████████████████████████████████████████████████████████████████▌                                   | 92/141 [00:06<00:02, 22.42it/s] 67%|████████████████████████████████████████████████████████████████████▋                                 | 95/141 [00:06<00:02, 22.67it/s] 70%|██████████████████████████████████████████████████████████████████████▉                               | 98/141 [00:06<00:01, 22.45it/s] 72%|████████████████████████████████████████████████████████████████████████▎                            | 101/141 [00:07<00:01, 22.33it/s] 74%|██████████████████████████████████████████████████████████████████████████▍                          | 104/141 [00:07<00:01, 22.20it/s] 76%|████████████████████████████████████████████████████████████████████████████▋                        | 107/141 [00:07<00:01, 21.78it/s][2025-03-28 01:07:28,767] [INFO] [logging.py:128:log_dist] [Rank 0] step=1800, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:07:28,768] [INFO] [timer.py:264:stop] epoch=0/micro_step=1800/global_step=1800, RunningAvgSamplesPerSec=79.93543749683221, CurrSamplesPerSec=83.38692822251971, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 78%|██████████████████████████████████████████████████████████████████████████████▊                      | 110/141 [00:07<00:01, 21.63it/s] 80%|████████████████████████████████████████████████████████████████████████████████▉                    | 113/141 [00:07<00:01, 21.84it/s] 82%|███████████████████████████████████████████████████████████████████████████████████                  | 116/141 [00:07<00:01, 21.81it/s] 84%|█████████████████████████████████████████████████████████████████████████████████████▏               | 119/141 [00:07<00:01, 21.64it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▍             | 122/141 [00:08<00:00, 21.72it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▌           | 125/141 [00:08<00:00, 22.16it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▋         | 128/141 [00:08<00:00, 22.75it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▊       | 131/141 [00:08<00:00, 22.49it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▉     | 134/141 [00:08<00:00, 22.39it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████████▏  | 137/141 [00:08<00:00, 22.24it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████▎| 140/141 [00:08<00:00, 22.45it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 141/141 [00:08<00:00, 15.81it/s]
  0%|                                                                                                               | 0/141 [00:00<?, ?it/s]  1%|▋                                                                                                      | 1/141 [00:00<00:45,  3.10it/s]  2%|██▏                                                                                                    | 3/141 [00:00<00:16,  8.12it/s]  4%|███▋                                                                                                   | 5/141 [00:00<00:11, 11.61it/s]  6%|█████▊                                                                                                 | 8/141 [00:00<00:08, 15.22it/s]  8%|███████▉                                                                                              | 11/141 [00:00<00:07, 17.54it/s] 10%|██████████▏                                                                                           | 14/141 [00:00<00:06, 18.98it/s][2025-03-28 01:07:31,419] [INFO] [logging.py:128:log_dist] [Rank 0] step=1850, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:07:31,420] [INFO] [timer.py:264:stop] epoch=0/micro_step=1850/global_step=1850, RunningAvgSamplesPerSec=79.9419871957279, CurrSamplesPerSec=84.24657348729454, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 12%|████████████▎                                                                                         | 17/141 [00:01<00:06, 19.93it/s] 14%|██████████████▍                                                                                       | 20/141 [00:01<00:05, 20.75it/s] 16%|████████████████▋                                                                                     | 23/141 [00:01<00:05, 20.99it/s] 18%|██████████████████▊                                                                                   | 26/141 [00:01<00:05, 21.45it/s] 21%|████████████████████▉                                                                                 | 29/141 [00:01<00:05, 21.63it/s] 23%|███████████████████████▏                                                                              | 32/141 [00:01<00:04, 22.14it/s] 25%|█████████████████████████▎                                                                            | 35/141 [00:01<00:04, 21.98it/s] 27%|███████████████████████████▍                                                                          | 38/141 [00:02<00:04, 21.93it/s] 29%|█████████████████████████████▋                                                                        | 41/141 [00:02<00:04, 21.33it/s] 31%|███████████████████████████████▊                                                                      | 44/141 [00:02<00:04, 21.51it/s] 33%|██████████████████████████████████                                                                    | 47/141 [00:02<00:04, 21.69it/s] 35%|████████████████████████████████████▏                                                                 | 50/141 [00:02<00:04, 22.16it/s] 38%|██████████████████████████████████████▎                                                               | 53/141 [00:02<00:03, 22.63it/s] 40%|████████████████████████████████████████▌                                                             | 56/141 [00:02<00:03, 22.87it/s] 42%|██████████████████████████████████████████▋                                                           | 59/141 [00:02<00:03, 22.70it/s] 44%|████████████████████████████████████████████▊                                                         | 62/141 [00:03<00:03, 22.55it/s] 46%|███████████████████████████████████████████████                                                       | 65/141 [00:03<00:03, 22.37it/s][2025-03-28 01:07:33,664] [INFO] [logging.py:128:log_dist] [Rank 0] step=1900, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:07:33,665] [INFO] [timer.py:264:stop] epoch=0/micro_step=1900/global_step=1900, RunningAvgSamplesPerSec=80.16400021532374, CurrSamplesPerSec=91.72780055396574, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 48%|█████████████████████████████████████████████████▏                                                    | 68/141 [00:03<00:03, 22.46it/s] 50%|███████████████████████████████████████████████████▎                                                  | 71/141 [00:03<00:03, 21.33it/s] 52%|█████████████████████████████████████████████████████▌                                                | 74/141 [00:03<00:03, 21.41it/s] 55%|███████████████████████████████████████████████████████▋                                              | 77/141 [00:03<00:02, 21.60it/s] 57%|█████████████████████████████████████████████████████████▊                                            | 80/141 [00:03<00:02, 21.47it/s] 59%|████████████████████████████████████████████████████████████                                          | 83/141 [00:04<00:02, 21.34it/s] 61%|██████████████████████████████████████████████████████████████▏                                       | 86/141 [00:04<00:02, 21.28it/s] 63%|████████████████████████████████████████████████████████████████▍                                     | 89/141 [00:04<00:02, 21.50it/s] 65%|██████████████████████████████████████████████████████████████████▌                                   | 92/141 [00:04<00:02, 21.01it/s] 67%|████████████████████████████████████████████████████████████████████▋                                 | 95/141 [00:04<00:02, 20.95it/s] 70%|██████████████████████████████████████████████████████████████████████▉                               | 98/141 [00:04<00:02, 20.61it/s] 72%|████████████████████████████████████████████████████████████████████████▎                            | 101/141 [00:04<00:01, 20.19it/s] 74%|██████████████████████████████████████████████████████████████████████████▍                          | 104/141 [00:05<00:01, 20.58it/s] 76%|████████████████████████████████████████████████████████████████████████████▋                        | 107/141 [00:05<00:01, 21.07it/s] 78%|██████████████████████████████████████████████████████████████████████████████▊                      | 110/141 [00:05<00:01, 21.27it/s] 80%|████████████████████████████████████████████████████████████████████████████████▉                    | 113/141 [00:05<00:01, 21.53it/s] 82%|███████████████████████████████████████████████████████████████████████████████████                  | 116/141 [00:05<00:01, 21.85it/s][2025-03-28 01:07:36,031] [INFO] [logging.py:128:log_dist] [Rank 0] step=1950, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:07:36,032] [INFO] [timer.py:264:stop] epoch=0/micro_step=1950/global_step=1950, RunningAvgSamplesPerSec=80.27476752248158, CurrSamplesPerSec=84.52458109283535, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 84%|█████████████████████████████████████████████████████████████████████████████████████▏               | 119/141 [00:05<00:01, 21.40it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▍             | 122/141 [00:05<00:00, 20.96it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▌           | 125/141 [00:06<00:00, 21.04it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▋         | 128/141 [00:06<00:00, 21.75it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▊       | 131/141 [00:06<00:00, 22.30it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▉     | 134/141 [00:06<00:00, 22.02it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████████▏  | 137/141 [00:06<00:00, 21.94it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████▎| 140/141 [00:06<00:00, 22.34it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 141/141 [00:06<00:00, 20.58it/s]
  0%|                                                                                                               | 0/141 [00:00<?, ?it/s]  1%|▋                                                                                                      | 1/141 [00:00<00:57,  2.45it/s]  3%|██▉                                                                                                    | 4/141 [00:00<00:16,  8.47it/s]  5%|█████                                                                                                  | 7/141 [00:00<00:10, 12.43it/s]  7%|███████▏                                                                                              | 10/141 [00:00<00:08, 15.44it/s]  9%|█████████▍                                                                                            | 13/141 [00:00<00:07, 17.96it/s] 11%|███████████▌                                                                                          | 16/141 [00:01<00:06, 19.58it/s] 13%|█████████████▋                                                                                        | 19/141 [00:01<00:05, 20.82it/s] 16%|███████████████▉                                                                                      | 22/141 [00:01<00:05, 21.73it/s] 18%|██████████████████                                                                                    | 25/141 [00:01<00:05, 22.27it/s][2025-03-28 01:07:38,735] [INFO] [logging.py:128:log_dist] [Rank 0] step=2000, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:07:38,736] [INFO] [timer.py:264:stop] epoch=0/micro_step=2000/global_step=2000, RunningAvgSamplesPerSec=80.22836619101929, CurrSamplesPerSec=71.55982979585767, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 20%|████████████████████▎                                                                                 | 28/141 [00:01<00:05, 21.16it/s][2025-03-28 01:07:38,965] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
 22%|██████████████████████▍                                                                               | 31/141 [00:01<00:05, 21.76it/s][2025-03-28 01:07:39,009] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
 24%|████████████████████████▌                                                                             | 34/141 [00:01<00:05, 21.24it/s] 26%|██████████████████████████▊                                                                           | 37/141 [00:02<00:04, 20.81it/s] 28%|████████████████████████████▉                                                                         | 40/141 [00:02<00:04, 21.14it/s] 30%|███████████████████████████████                                                                       | 43/141 [00:02<00:04, 21.57it/s] 33%|█████████████████████████████████▎                                                                    | 46/141 [00:02<00:04, 21.75it/s] 35%|███████████████████████████████████▍                                                                  | 49/141 [00:02<00:04, 21.93it/s] 37%|█████████████████████████████████████▌                                                                | 52/141 [00:02<00:04, 20.84it/s] 39%|███████████████████████████████████████▊                                                              | 55/141 [00:02<00:04, 21.02it/s] 41%|█████████████████████████████████████████▉                                                            | 58/141 [00:03<00:03, 21.24it/s] 43%|████████████████████████████████████████████▏                                                         | 61/141 [00:03<00:03, 21.45it/s] 45%|██████████████████████████████████████████████▎                                                       | 64/141 [00:03<00:03, 21.58it/s] 48%|████████████████████████████████████████████████▍                                                     | 67/141 [00:03<00:03, 21.63it/s] 50%|██████████████████████████████████████████████████▋                                                   | 70/141 [00:03<00:03, 21.02it/s] 52%|████████████████████████████████████████████████████▊                                                 | 73/141 [00:03<00:03, 21.30it/s][2025-03-28 01:07:41,069] [INFO] [logging.py:128:log_dist] [Rank 0] step=2050, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:07:41,070] [INFO] [timer.py:264:stop] epoch=0/micro_step=2050/global_step=2050, RunningAvgSamplesPerSec=80.35839924382077, CurrSamplesPerSec=92.69579864765039, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 54%|██████████████████████████████████████████████████████▉                                               | 76/141 [00:03<00:02, 21.93it/s] 56%|█████████████████████████████████████████████████████████▏                                            | 79/141 [00:03<00:02, 22.42it/s] 58%|███████████████████████████████████████████████████████████▎                                          | 82/141 [00:04<00:02, 22.86it/s] 60%|█████████████████████████████████████████████████████████████▍                                        | 85/141 [00:04<00:02, 22.55it/s] 62%|███████████████████████████████████████████████████████████████▋                                      | 88/141 [00:04<00:02, 22.36it/s] 65%|█████████████████████████████████████████████████████████████████▊                                    | 91/141 [00:04<00:02, 21.88it/s] 67%|████████████████████████████████████████████████████████████████████                                  | 94/141 [00:04<00:02, 22.07it/s] 69%|██████████████████████████████████████████████████████████████████████▏                               | 97/141 [00:04<00:02, 21.98it/s] 71%|███████████████████████████████████████████████████████████████████████▋                             | 100/141 [00:04<00:01, 22.13it/s] 73%|█████████████████████████████████████████████████████████████████████████▊                           | 103/141 [00:05<00:01, 22.13it/s] 75%|███████████████████████████████████████████████████████████████████████████▉                         | 106/141 [00:05<00:01, 22.00it/s] 77%|██████████████████████████████████████████████████████████████████████████████                       | 109/141 [00:05<00:01, 21.03it/s] 79%|████████████████████████████████████████████████████████████████████████████████▏                    | 112/141 [00:05<00:01, 21.08it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▍                  | 115/141 [00:05<00:01, 21.48it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▌                | 118/141 [00:05<00:01, 21.15it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▋              | 121/141 [00:05<00:00, 20.65it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▊            | 124/141 [00:06<00:00, 20.60it/s][2025-03-28 01:07:43,394] [INFO] [logging.py:128:log_dist] [Rank 0] step=2100, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:07:43,395] [INFO] [timer.py:264:stop] epoch=0/micro_step=2100/global_step=2100, RunningAvgSamplesPerSec=80.48893662519964, CurrSamplesPerSec=84.485847437113, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 90%|██████████████████████████████████████████████████████████████████████████████████████████▉          | 127/141 [00:06<00:00, 20.52it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████        | 130/141 [00:06<00:00, 20.12it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▎     | 133/141 [00:06<00:00, 20.05it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████▍   | 136/141 [00:06<00:00, 20.11it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▌ | 139/141 [00:06<00:00, 20.45it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 141/141 [00:06<00:00, 20.18it/s]
  0%|                                                                                                               | 0/141 [00:00<?, ?it/s]  1%|▋                                                                                                      | 1/141 [00:00<00:28,  4.96it/s]  3%|██▉                                                                                                    | 4/141 [00:00<00:10, 13.02it/s]  4%|████▍                                                                                                  | 6/141 [00:00<00:08, 15.31it/s]  6%|█████▊                                                                                                 | 8/141 [00:00<00:08, 16.30it/s]  8%|███████▉                                                                                              | 11/141 [00:00<00:07, 18.00it/s] 10%|██████████▏                                                                                           | 14/141 [00:00<00:06, 18.64it/s] 11%|███████████▌                                                                                          | 16/141 [00:00<00:06, 18.96it/s] 13%|█████████████                                                                                         | 18/141 [00:01<00:06, 18.70it/s] 14%|██████████████▍                                                                                       | 20/141 [00:01<00:06, 18.45it/s] 16%|███████████████▉                                                                                      | 22/141 [00:01<00:06, 18.28it/s] 17%|█████████████████▎                                                                                    | 24/141 [00:01<00:06, 18.34it/s] 18%|██████████████████▊                                                                                   | 26/141 [00:01<00:06, 18.50it/s] 20%|████████████████████▎                                                                                 | 28/141 [00:01<00:06, 18.78it/s] 21%|█████████████████████▋                                                                                | 30/141 [00:01<00:05, 18.85it/s] 23%|███████████████████████▏                                                                              | 32/141 [00:01<00:05, 18.76it/s] 24%|████████████████████████▌                                                                             | 34/141 [00:01<00:05, 18.52it/s][2025-03-28 01:07:46,208] [INFO] [logging.py:128:log_dist] [Rank 0] step=2150, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:07:46,211] [INFO] [timer.py:264:stop] epoch=0/micro_step=2150/global_step=2150, RunningAvgSamplesPerSec=80.35430838306041, CurrSamplesPerSec=70.74033484930376, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 26%|██████████████████████████                                                                            | 36/141 [00:02<00:05, 18.31it/s] 27%|███████████████████████████▍                                                                          | 38/141 [00:02<00:05, 18.19it/s] 28%|████████████████████████████▉                                                                         | 40/141 [00:02<00:05, 18.12it/s] 30%|██████████████████████████████▍                                                                       | 42/141 [00:02<00:05, 18.32it/s] 32%|████████████████████████████████▌                                                                     | 45/141 [00:02<00:05, 18.97it/s] 33%|██████████████████████████████████                                                                    | 47/141 [00:02<00:04, 19.03it/s] 35%|███████████████████████████████████▍                                                                  | 49/141 [00:02<00:04, 18.71it/s] 36%|████████████████████████████████████▉                                                                 | 51/141 [00:02<00:04, 18.48it/s] 38%|██████████████████████████████████████▎                                                               | 53/141 [00:02<00:04, 18.53it/s] 39%|███████████████████████████████████████▊                                                              | 55/141 [00:03<00:04, 18.62it/s] 41%|█████████████████████████████████████████▉                                                            | 58/141 [00:03<00:04, 19.00it/s] 43%|███████████████████████████████████████████▍                                                          | 60/141 [00:03<00:04, 18.88it/s] 44%|████████████████████████████████████████████▊                                                         | 62/141 [00:03<00:04, 18.79it/s] 46%|███████████████████████████████████████████████                                                       | 65/141 [00:03<00:03, 19.70it/s] 48%|█████████████████████████████████████████████████▏                                                    | 68/141 [00:03<00:03, 20.92it/s] 50%|███████████████████████████████████████████████████▎                                                  | 71/141 [00:03<00:03, 21.95it/s] 52%|█████████████████████████████████████████████████████▌                                                | 74/141 [00:03<00:03, 20.80it/s] 55%|███████████████████████████████████████████████████████▋                                              | 77/141 [00:04<00:03, 21.23it/s] 57%|█████████████████████████████████████████████████████████▊                                            | 80/141 [00:04<00:02, 20.60it/s] 59%|████████████████████████████████████████████████████████████                                          | 83/141 [00:04<00:02, 19.73it/s][2025-03-28 01:07:48,769] [INFO] [logging.py:128:log_dist] [Rank 0] step=2200, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:07:48,772] [INFO] [timer.py:264:stop] epoch=0/micro_step=2200/global_step=2200, RunningAvgSamplesPerSec=80.30565528210992, CurrSamplesPerSec=71.9122593866308, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 60%|█████████████████████████████████████████████████████████████▍                                        | 85/141 [00:04<00:02, 19.29it/s] 62%|██████████████████████████████████████████████████████████████▉                                       | 87/141 [00:04<00:02, 18.96it/s] 63%|████████████████████████████████████████████████████████████████▍                                     | 89/141 [00:04<00:02, 18.70it/s] 65%|█████████████████████████████████████████████████████████████████▊                                    | 91/141 [00:04<00:02, 18.50it/s] 66%|███████████████████████████████████████████████████████████████████▎                                  | 93/141 [00:04<00:02, 18.35it/s] 68%|█████████████████████████████████████████████████████████████████████▍                                | 96/141 [00:05<00:02, 19.63it/s] 70%|███████████████████████████████████████████████████████████████████████▌                              | 99/141 [00:05<00:02, 20.97it/s] 72%|█████████████████████████████████████████████████████████████████████████                            | 102/141 [00:05<00:01, 21.71it/s] 74%|███████████████████████████████████████████████████████████████████████████▏                         | 105/141 [00:05<00:01, 20.80it/s] 77%|█████████████████████████████████████████████████████████████████████████████▎                       | 108/141 [00:05<00:01, 19.83it/s] 79%|███████████████████████████████████████████████████████████████████████████████▌                     | 111/141 [00:05<00:01, 19.23it/s] 80%|████████████████████████████████████████████████████████████████████████████████▉                    | 113/141 [00:05<00:01, 18.93it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▍                  | 115/141 [00:06<00:01, 18.35it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▊                 | 117/141 [00:06<00:01, 18.08it/s] 84%|█████████████████████████████████████████████████████████████████████████████████████▏               | 119/141 [00:06<00:01, 18.04it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▋              | 121/141 [00:06<00:01, 18.01it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▊            | 124/141 [00:06<00:00, 19.19it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▉          | 127/141 [00:06<00:00, 20.33it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████        | 130/141 [00:06<00:00, 20.63it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▎     | 133/141 [00:06<00:00, 20.74it/s][2025-03-28 01:07:51,329] [INFO] [logging.py:128:log_dist] [Rank 0] step=2250, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:07:51,332] [INFO] [timer.py:264:stop] epoch=0/micro_step=2250/global_step=2250, RunningAvgSamplesPerSec=80.25996990547586, CurrSamplesPerSec=67.36290452032345, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 96%|█████████████████████████████████████████████████████████████████████████████████████████████████▍   | 136/141 [00:07<00:00, 19.69it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▊  | 138/141 [00:07<00:00, 19.27it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████▎| 140/141 [00:07<00:00, 18.92it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 141/141 [00:07<00:00, 18.80it/s]
  0%|                                                                                                               | 0/141 [00:00<?, ?it/s]  1%|▋                                                                                                      | 1/141 [00:00<00:28,  4.89it/s]  2%|██▏                                                                                                    | 3/141 [00:00<00:13, 10.60it/s]  4%|███▋                                                                                                   | 5/141 [00:00<00:10, 13.44it/s]  5%|█████                                                                                                  | 7/141 [00:00<00:08, 15.29it/s]  7%|███████▏                                                                                              | 10/141 [00:00<00:07, 17.67it/s]  9%|█████████▍                                                                                            | 13/141 [00:00<00:06, 19.37it/s] 11%|███████████▌                                                                                          | 16/141 [00:00<00:06, 20.57it/s] 13%|█████████████▋                                                                                        | 19/141 [00:01<00:06, 19.58it/s] 15%|███████████████▏                                                                                      | 21/141 [00:01<00:06, 19.14it/s] 16%|████████████████▋                                                                                     | 23/141 [00:01<00:06, 18.81it/s] 18%|██████████████████                                                                                    | 25/141 [00:01<00:06, 18.56it/s] 19%|███████████████████▌                                                                                  | 27/141 [00:01<00:06, 18.38it/s] 21%|████████████████████▉                                                                                 | 29/141 [00:01<00:06, 18.25it/s] 22%|██████████████████████▍                                                                               | 31/141 [00:01<00:06, 18.16it/s] 23%|███████████████████████▊                                                                              | 33/141 [00:01<00:05, 18.10it/s] 25%|█████████████████████████▎                                                                            | 35/141 [00:01<00:05, 18.07it/s] 26%|██████████████████████████▊                                                                           | 37/141 [00:02<00:05, 18.05it/s] 28%|████████████████████████████▉                                                                         | 40/141 [00:02<00:05, 19.47it/s] 30%|███████████████████████████████                                                                       | 43/141 [00:02<00:04, 20.87it/s][2025-03-28 01:07:54,158] [INFO] [logging.py:128:log_dist] [Rank 0] step=2300, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:07:54,159] [INFO] [timer.py:264:stop] epoch=0/micro_step=2300/global_step=2300, RunningAvgSamplesPerSec=80.1293436908921, CurrSamplesPerSec=91.78701727402505, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 33%|█████████████████████████████████▎                                                                    | 46/141 [00:02<00:04, 21.37it/s] 35%|███████████████████████████████████▍                                                                  | 49/141 [00:02<00:04, 21.73it/s] 37%|█████████████████████████████████████▌                                                                | 52/141 [00:02<00:04, 21.87it/s] 39%|███████████████████████████████████████▊                                                              | 55/141 [00:02<00:03, 21.74it/s] 41%|█████████████████████████████████████████▉                                                            | 58/141 [00:03<00:04, 20.57it/s] 43%|████████████████████████████████████████████▏                                                         | 61/141 [00:03<00:04, 19.69it/s] 45%|█████████████████████████████████████████████▌                                                        | 63/141 [00:03<00:04, 19.27it/s] 46%|███████████████████████████████████████████████                                                       | 65/141 [00:03<00:04, 18.94it/s] 48%|████████████████████████████████████████████████▍                                                     | 67/141 [00:03<00:03, 18.68it/s] 49%|█████████████████████████████████████████████████▉                                                    | 69/141 [00:03<00:03, 18.51it/s] 50%|███████████████████████████████████████████████████▎                                                  | 71/141 [00:03<00:03, 18.37it/s] 52%|████████████████████████████████████████████████████▊                                                 | 73/141 [00:03<00:03, 18.26it/s] 53%|██████████████████████████████████████████████████████▎                                               | 75/141 [00:04<00:03, 18.41it/s] 55%|████████████████████████████████████████████████████████▍                                             | 78/141 [00:04<00:03, 19.71it/s] 57%|██████████████████████████████████████████████████████████▌                                           | 81/141 [00:04<00:02, 20.48it/s] 60%|████████████████████████████████████████████████████████████▊                                         | 84/141 [00:04<00:02, 21.50it/s] 62%|██████████████████████████████████████████████████████████████▉                                       | 87/141 [00:04<00:02, 22.32it/s] 64%|█████████████████████████████████████████████████████████████████                                     | 90/141 [00:04<00:02, 22.57it/s] 66%|███████████████████████████████████████████████████████████████████▎                                  | 93/141 [00:04<00:02, 23.12it/s][2025-03-28 01:07:56,578] [INFO] [logging.py:128:log_dist] [Rank 0] step=2350, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:07:56,579] [INFO] [timer.py:264:stop] epoch=0/micro_step=2350/global_step=2350, RunningAvgSamplesPerSec=80.18552159351555, CurrSamplesPerSec=89.23472257800813, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 68%|█████████████████████████████████████████████████████████████████████▍                                | 96/141 [00:04<00:01, 22.99it/s] 70%|███████████████████████████████████████████████████████████████████████▌                              | 99/141 [00:05<00:01, 22.70it/s] 72%|█████████████████████████████████████████████████████████████████████████                            | 102/141 [00:05<00:01, 21.00it/s] 74%|███████████████████████████████████████████████████████████████████████████▏                         | 105/141 [00:05<00:01, 19.97it/s] 77%|█████████████████████████████████████████████████████████████████████████████▎                       | 108/141 [00:05<00:01, 19.02it/s] 78%|██████████████████████████████████████████████████████████████████████████████▊                      | 110/141 [00:05<00:01, 18.76it/s] 79%|████████████████████████████████████████████████████████████████████████████████▏                    | 112/141 [00:05<00:01, 18.55it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▋                   | 114/141 [00:05<00:01, 18.40it/s] 82%|███████████████████████████████████████████████████████████████████████████████████                  | 116/141 [00:06<00:01, 18.28it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▌                | 118/141 [00:06<00:01, 18.51it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▋              | 121/141 [00:06<00:01, 19.71it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▊            | 124/141 [00:06<00:00, 20.45it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▉          | 127/141 [00:06<00:00, 21.05it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████        | 130/141 [00:06<00:00, 22.01it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▎     | 133/141 [00:06<00:00, 22.50it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████▍   | 136/141 [00:06<00:00, 22.34it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▌ | 139/141 [00:07<00:00, 22.63it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 141/141 [00:07<00:00, 19.63it/s]
  0%|                                                                                                               | 0/141 [00:00<?, ?it/s]  1%|▋                                                                                                      | 1/141 [00:00<00:36,  3.80it/s][2025-03-28 01:07:59,330] [INFO] [logging.py:128:log_dist] [Rank 0] step=2400, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:07:59,333] [INFO] [timer.py:264:stop] epoch=0/micro_step=2400/global_step=2400, RunningAvgSamplesPerSec=80.11679717929867, CurrSamplesPerSec=71.9631546276474, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
  2%|██▏                                                                                                    | 3/141 [00:00<00:15,  9.12it/s]  4%|███▋                                                                                                   | 5/141 [00:00<00:11, 12.29it/s]  5%|█████                                                                                                  | 7/141 [00:00<00:09, 14.21it/s]  6%|██████▌                                                                                                | 9/141 [00:00<00:08, 15.44it/s]  8%|███████▉                                                                                              | 11/141 [00:00<00:08, 16.25it/s]  9%|█████████▍                                                                                            | 13/141 [00:00<00:07, 17.08it/s] 11%|███████████▌                                                                                          | 16/141 [00:01<00:06, 19.04it/s] 13%|█████████████                                                                                         | 18/141 [00:01<00:06, 18.54it/s] 14%|██████████████▍                                                                                       | 20/141 [00:01<00:06, 18.68it/s] 16%|████████████████▋                                                                                     | 23/141 [00:01<00:06, 19.50it/s] 18%|██████████████████▊                                                                                   | 26/141 [00:01<00:05, 20.52it/s] 21%|████████████████████▉                                                                                 | 29/141 [00:01<00:05, 20.91it/s] 23%|███████████████████████▏                                                                              | 32/141 [00:01<00:05, 20.34it/s] 25%|█████████████████████████▎                                                                            | 35/141 [00:02<00:05, 19.53it/s] 26%|██████████████████████████▊                                                                           | 37/141 [00:02<00:05, 18.83it/s] 28%|████████████████████████████▏                                                                         | 39/141 [00:02<00:05, 18.61it/s] 29%|█████████████████████████████▋                                                                        | 41/141 [00:02<00:05, 18.44it/s] 30%|███████████████████████████████                                                                       | 43/141 [00:02<00:05, 18.31it/s] 32%|████████████████████████████████▌                                                                     | 45/141 [00:02<00:05, 18.21it/s] 33%|██████████████████████████████████                                                                    | 47/141 [00:02<00:05, 18.16it/s] 35%|███████████████████████████████████▍                                                                  | 49/141 [00:02<00:05, 17.94it/s] 37%|█████████████████████████████████████▌                                                                | 52/141 [00:02<00:04, 19.31it/s][2025-03-28 01:08:01,942] [INFO] [logging.py:128:log_dist] [Rank 0] step=2450, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:08:01,943] [INFO] [timer.py:264:stop] epoch=0/micro_step=2450/global_step=2450, RunningAvgSamplesPerSec=80.04688912106529, CurrSamplesPerSec=84.50074079512484, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 39%|███████████████████████████████████████▊                                                              | 55/141 [00:03<00:04, 20.23it/s] 41%|█████████████████████████████████████████▉                                                            | 58/141 [00:03<00:04, 19.86it/s] 43%|████████████████████████████████████████████▏                                                         | 61/141 [00:03<00:03, 20.44it/s] 45%|██████████████████████████████████████████████▎                                                       | 64/141 [00:03<00:03, 20.80it/s] 48%|████████████████████████████████████████████████▍                                                     | 67/141 [00:03<00:03, 21.14it/s] 50%|██████████████████████████████████████████████████▋                                                   | 70/141 [00:03<00:03, 21.38it/s] 52%|████████████████████████████████████████████████████▊                                                 | 73/141 [00:03<00:03, 21.38it/s] 54%|██████████████████████████████████████████████████████▉                                               | 76/141 [00:04<00:03, 21.57it/s] 56%|█████████████████████████████████████████████████████████▏                                            | 79/141 [00:04<00:02, 21.69it/s] 58%|███████████████████████████████████████████████████████████▎                                          | 82/141 [00:04<00:02, 21.72it/s] 60%|█████████████████████████████████████████████████████████████▍                                        | 85/141 [00:04<00:02, 21.14it/s] 62%|███████████████████████████████████████████████████████████████▋                                      | 88/141 [00:04<00:02, 20.08it/s] 65%|█████████████████████████████████████████████████████████████████▊                                    | 91/141 [00:04<00:02, 19.39it/s] 66%|███████████████████████████████████████████████████████████████████▎                                  | 93/141 [00:04<00:02, 19.05it/s] 67%|████████████████████████████████████████████████████████████████████▋                                 | 95/141 [00:05<00:02, 18.77it/s] 69%|██████████████████████████████████████████████████████████████████████▏                               | 97/141 [00:05<00:02, 18.56it/s] 70%|███████████████████████████████████████████████████████████████████████▌                              | 99/141 [00:05<00:02, 18.40it/s] 72%|████████████████████████████████████████████████████████████████████████▎                            | 101/141 [00:05<00:02, 18.31it/s][2025-03-28 01:08:04,437] [INFO] [logging.py:128:log_dist] [Rank 0] step=2500, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:08:04,440] [INFO] [timer.py:264:stop] epoch=0/micro_step=2500/global_step=2500, RunningAvgSamplesPerSec=80.05162540927923, CurrSamplesPerSec=71.96593280371383, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 73%|█████████████████████████████████████████████████████████████████████████▊                           | 103/141 [00:05<00:02, 18.19it/s] 75%|███████████████████████████████████████████████████████████████████████████▉                         | 106/141 [00:05<00:01, 19.59it/s] 77%|██████████████████████████████████████████████████████████████████████████████                       | 109/141 [00:05<00:01, 20.61it/s] 79%|████████████████████████████████████████████████████████████████████████████████▏                    | 112/141 [00:05<00:01, 20.80it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▍                  | 115/141 [00:06<00:01, 21.04it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▌                | 118/141 [00:06<00:01, 20.78it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▋              | 121/141 [00:06<00:00, 21.01it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▊            | 124/141 [00:06<00:00, 21.79it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▉          | 127/141 [00:06<00:00, 21.09it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████        | 130/141 [00:06<00:00, 21.35it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▎     | 133/141 [00:06<00:00, 21.49it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████▍   | 136/141 [00:07<00:00, 21.39it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▌ | 139/141 [00:07<00:00, 21.45it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 141/141 [00:07<00:00, 19.34it/s]
  0%|                                                                                                               | 0/141 [00:00<?, ?it/s]  1%|▋                                                                                                      | 1/141 [00:00<00:26,  5.32it/s]  2%|██▏                                                                                                    | 3/141 [00:00<00:12, 10.95it/s]  4%|███▋                                                                                                   | 5/141 [00:00<00:09, 13.70it/s]  5%|█████                                                                                                  | 7/141 [00:00<00:08, 15.24it/s]  6%|██████▌                                                                                                | 9/141 [00:00<00:08, 16.16it/s]  8%|███████▉                                                                                              | 11/141 [00:00<00:07, 16.76it/s][2025-03-28 01:08:07,073] [INFO] [logging.py:128:log_dist] [Rank 0] step=2550, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:08:07,076] [INFO] [timer.py:264:stop] epoch=0/micro_step=2550/global_step=2550, RunningAvgSamplesPerSec=80.05578444415711, CurrSamplesPerSec=72.2678662695055, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
  9%|█████████▍                                                                                            | 13/141 [00:00<00:07, 17.16it/s] 11%|██████████▊                                                                                           | 15/141 [00:00<00:07, 17.43it/s] 12%|████████████▎                                                                                         | 17/141 [00:01<00:06, 17.85it/s] 14%|██████████████▍                                                                                       | 20/141 [00:01<00:06, 20.01it/s] 16%|████████████████▋                                                                                     | 23/141 [00:01<00:05, 21.09it/s] 18%|██████████████████▊                                                                                   | 26/141 [00:01<00:05, 22.03it/s] 21%|████████████████████▉                                                                                 | 29/141 [00:01<00:04, 22.51it/s] 23%|███████████████████████▏                                                                              | 32/141 [00:01<00:04, 22.40it/s] 25%|█████████████████████████▎                                                                            | 35/141 [00:01<00:04, 22.23it/s] 27%|███████████████████████████▍                                                                          | 38/141 [00:01<00:04, 22.34it/s] 29%|█████████████████████████████▋                                                                        | 41/141 [00:02<00:04, 22.25it/s] 31%|███████████████████████████████▊                                                                      | 44/141 [00:02<00:04, 22.15it/s] 33%|██████████████████████████████████                                                                    | 47/141 [00:02<00:04, 22.36it/s] 35%|████████████████████████████████████▏                                                                 | 50/141 [00:02<00:04, 22.28it/s] 38%|██████████████████████████████████████▎                                                               | 53/141 [00:02<00:03, 22.18it/s] 40%|████████████████████████████████████████▌                                                             | 56/141 [00:02<00:03, 22.22it/s] 42%|██████████████████████████████████████████▋                                                           | 59/141 [00:02<00:03, 22.25it/s][2025-03-28 01:08:09,328] [INFO] [logging.py:128:log_dist] [Rank 0] step=2600, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:08:09,329] [INFO] [timer.py:264:stop] epoch=0/micro_step=2600/global_step=2600, RunningAvgSamplesPerSec=80.21059836496256, CurrSamplesPerSec=95.98762679417663, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 44%|████████████████████████████████████████████▊                                                         | 62/141 [00:03<00:03, 22.66it/s] 46%|███████████████████████████████████████████████                                                       | 65/141 [00:03<00:03, 23.15it/s] 48%|█████████████████████████████████████████████████▏                                                    | 68/141 [00:03<00:03, 23.25it/s] 50%|███████████████████████████████████████████████████▎                                                  | 71/141 [00:03<00:03, 21.42it/s] 52%|█████████████████████████████████████████████████████▌                                                | 74/141 [00:03<00:03, 20.26it/s] 55%|███████████████████████████████████████████████████████▋                                              | 77/141 [00:03<00:03, 19.54it/s] 56%|█████████████████████████████████████████████████████████▏                                            | 79/141 [00:03<00:03, 19.18it/s] 58%|███████████████████████████████████████████████████████████▎                                          | 82/141 [00:04<00:02, 20.24it/s] 60%|█████████████████████████████████████████████████████████████▍                                        | 85/141 [00:04<00:02, 20.28it/s] 62%|███████████████████████████████████████████████████████████████▋                                      | 88/141 [00:04<00:02, 20.84it/s] 65%|█████████████████████████████████████████████████████████████████▊                                    | 91/141 [00:04<00:02, 21.16it/s] 67%|████████████████████████████████████████████████████████████████████                                  | 94/141 [00:04<00:02, 21.36it/s] 69%|██████████████████████████████████████████████████████████████████████▏                               | 97/141 [00:04<00:02, 21.38it/s] 71%|███████████████████████████████████████████████████████████████████████▋                             | 100/141 [00:04<00:01, 21.49it/s] 73%|█████████████████████████████████████████████████████████████████████████▊                           | 103/141 [00:05<00:01, 21.38it/s] 75%|███████████████████████████████████████████████████████████████████████████▉                         | 106/141 [00:05<00:01, 21.48it/s] 77%|██████████████████████████████████████████████████████████████████████████████                       | 109/141 [00:05<00:01, 21.52it/s][2025-03-28 01:08:11,705] [INFO] [logging.py:128:log_dist] [Rank 0] step=2650, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:08:11,706] [INFO] [timer.py:264:stop] epoch=0/micro_step=2650/global_step=2650, RunningAvgSamplesPerSec=80.2849808640627, CurrSamplesPerSec=89.41878014962474, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 79%|████████████████████████████████████████████████████████████████████████████████▏                    | 112/141 [00:05<00:01, 21.88it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▍                  | 115/141 [00:05<00:01, 21.83it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▌                | 118/141 [00:05<00:01, 21.95it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▋              | 121/141 [00:05<00:00, 22.10it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▊            | 124/141 [00:05<00:00, 21.82it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▉          | 127/141 [00:06<00:00, 21.83it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████        | 130/141 [00:06<00:00, 21.87it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▎     | 133/141 [00:06<00:00, 21.52it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████▍   | 136/141 [00:06<00:00, 21.55it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▌ | 139/141 [00:06<00:00, 20.97it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 141/141 [00:06<00:00, 20.58it/s]
  0%|                                                                                                               | 0/141 [00:00<?, ?it/s]  1%|▋                                                                                                      | 1/141 [00:00<00:27,  5.12it/s]  3%|██▉                                                                                                    | 4/141 [00:00<00:10, 13.10it/s]  5%|█████                                                                                                  | 7/141 [00:00<00:07, 17.08it/s]  7%|███████▏                                                                                              | 10/141 [00:00<00:06, 19.13it/s]  9%|█████████▍                                                                                            | 13/141 [00:00<00:06, 20.15it/s] 11%|███████████▌                                                                                          | 16/141 [00:00<00:06, 20.79it/s] 13%|█████████████▋                                                                                        | 19/141 [00:01<00:05, 21.11it/s][2025-03-28 01:08:14,248] [INFO] [logging.py:128:log_dist] [Rank 0] step=2700, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:08:14,249] [INFO] [timer.py:264:stop] epoch=0/micro_step=2700/global_step=2700, RunningAvgSamplesPerSec=80.3498287906917, CurrSamplesPerSec=93.25120824903694, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 16%|███████████████▉                                                                                      | 22/141 [00:01<00:05, 21.70it/s] 18%|██████████████████                                                                                    | 25/141 [00:01<00:05, 21.85it/s] 20%|████████████████████▎                                                                                 | 28/141 [00:01<00:05, 22.04it/s] 22%|██████████████████████▍                                                                               | 31/141 [00:01<00:04, 22.25it/s] 24%|████████████████████████▌                                                                             | 34/141 [00:01<00:04, 22.19it/s] 26%|██████████████████████████▊                                                                           | 37/141 [00:01<00:04, 22.14it/s] 28%|████████████████████████████▉                                                                         | 40/141 [00:01<00:04, 22.12it/s] 30%|███████████████████████████████                                                                       | 43/141 [00:02<00:04, 22.13it/s] 33%|█████████████████████████████████▎                                                                    | 46/141 [00:02<00:04, 21.99it/s] 35%|███████████████████████████████████▍                                                                  | 49/141 [00:02<00:04, 21.94it/s] 37%|█████████████████████████████████████▌                                                                | 52/141 [00:02<00:04, 21.71it/s] 39%|███████████████████████████████████████▊                                                              | 55/141 [00:02<00:04, 21.50it/s] 41%|█████████████████████████████████████████▉                                                            | 58/141 [00:02<00:04, 20.67it/s] 43%|████████████████████████████████████████████▏                                                         | 61/141 [00:02<00:03, 21.07it/s] 45%|██████████████████████████████████████████████▎                                                       | 64/141 [00:03<00:03, 21.30it/s] 48%|████████████████████████████████████████████████▍                                                     | 67/141 [00:03<00:03, 21.53it/s] 50%|██████████████████████████████████████████████████▋                                                   | 70/141 [00:03<00:03, 21.81it/s][2025-03-28 01:08:16,539] [INFO] [logging.py:128:log_dist] [Rank 0] step=2750, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:08:16,540] [INFO] [timer.py:264:stop] epoch=0/micro_step=2750/global_step=2750, RunningAvgSamplesPerSec=80.46994194218341, CurrSamplesPerSec=93.85739887179986, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 52%|████████████████████████████████████████████████████▊                                                 | 73/141 [00:03<00:03, 22.07it/s] 54%|██████████████████████████████████████████████████████▉                                               | 76/141 [00:03<00:02, 22.20it/s] 56%|█████████████████████████████████████████████████████████▏                                            | 79/141 [00:03<00:02, 22.09it/s] 58%|███████████████████████████████████████████████████████████▎                                          | 82/141 [00:03<00:02, 22.20it/s] 60%|█████████████████████████████████████████████████████████████▍                                        | 85/141 [00:04<00:02, 21.98it/s] 62%|███████████████████████████████████████████████████████████████▋                                      | 88/141 [00:04<00:02, 22.09it/s] 65%|█████████████████████████████████████████████████████████████████▊                                    | 91/141 [00:04<00:02, 22.04it/s] 67%|████████████████████████████████████████████████████████████████████                                  | 94/141 [00:04<00:02, 21.18it/s] 69%|██████████████████████████████████████████████████████████████████████▏                               | 97/141 [00:04<00:02, 21.45it/s] 71%|███████████████████████████████████████████████████████████████████████▋                             | 100/141 [00:04<00:01, 21.70it/s] 73%|█████████████████████████████████████████████████████████████████████████▊                           | 103/141 [00:04<00:01, 20.97it/s] 75%|███████████████████████████████████████████████████████████████████████████▉                         | 106/141 [00:05<00:01, 20.36it/s] 77%|██████████████████████████████████████████████████████████████████████████████                       | 109/141 [00:05<00:01, 20.38it/s] 79%|████████████████████████████████████████████████████████████████████████████████▏                    | 112/141 [00:05<00:01, 20.87it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▍                  | 115/141 [00:05<00:01, 21.15it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▌                | 118/141 [00:05<00:01, 21.39it/s][2025-03-28 01:08:18,880] [INFO] [logging.py:128:log_dist] [Rank 0] step=2800, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:08:18,881] [INFO] [timer.py:264:stop] epoch=0/micro_step=2800/global_step=2800, RunningAvgSamplesPerSec=80.557166100145, CurrSamplesPerSec=83.372839176488, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 86%|██████████████████████████████████████████████████████████████████████████████████████▋              | 121/141 [00:05<00:00, 21.19it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▊            | 124/141 [00:05<00:00, 21.20it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▉          | 127/141 [00:06<00:00, 21.39it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████        | 130/141 [00:06<00:00, 21.43it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▎     | 133/141 [00:06<00:00, 21.62it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████▍   | 136/141 [00:06<00:00, 21.65it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▌ | 139/141 [00:06<00:00, 23.35it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 141/141 [00:06<00:00, 21.14it/s]
[rank0]:[W328 01:08:35.128920598 ProcessGroupNCCL.cpp:1496] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[2025-03-28 01:08:37,240] [INFO] [launch.py:351:main] Process 575242 exits successfully.
[?2004h(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ bash scripts/script_normal_dif_test.sh 
[?2004l[2025-03-28 01:11:05,516] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-28 01:11:05,530] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-28 01:11:07,754] [WARNING] [runner.py:215:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2025-03-28 01:11:07,756] [INFO] [runner.py:607:main] cmd = /hpc2hdd/home/yli045/.conda/envs/ywj/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None main.py --image_size 64 --batch_size 4 --num_epochs 20 --timesteps 1000 --lr 2e-4 --time_emb_dim 32 --mu1 4 --sigma1 1 --num1 9000 --mu2 10 --sigma2 4 --num2 1000 --samples_dir ./samples --checkpoints_dir ./checkpoints --fp16 --mode train --model_path  --num_images 1000 --simulation_distribution normal --use_different_noise --use_moe --num_experts 2 --moe_hidden_dim 2 --moe_tau 0.1
[2025-03-28 01:11:09,827] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-28 01:11:09,834] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-28 01:11:10,983] [INFO] [launch.py:146:main] WORLD INFO DICT: {'localhost': [0]}
[2025-03-28 01:11:10,983] [INFO] [launch.py:152:main] nnodes=1, num_local_procs=1, node_rank=0
[2025-03-28 01:11:10,983] [INFO] [launch.py:163:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2025-03-28 01:11:10,983] [INFO] [launch.py:164:main] dist_world_size=1
[2025-03-28 01:11:10,983] [INFO] [launch.py:168:main] Setting CUDA_VISIBLE_DEVICES=0
[2025-03-28 01:11:10,992] [INFO] [launch.py:256:main] process 577394 spawned with command: ['/hpc2hdd/home/yli045/.conda/envs/ywj/bin/python', '-u', 'main.py', '--local_rank=0', '--image_size', '64', '--batch_size', '4', '--num_epochs', '20', '--timesteps', '1000', '--lr', '2e-4', '--time_emb_dim', '32', '--mu1', '4', '--sigma1', '1', '--num1', '9000', '--mu2', '10', '--sigma2', '4', '--num2', '1000', '--samples_dir', './samples', '--checkpoints_dir', './checkpoints', '--fp16', '--mode', 'train', '--model_path', '', '--num_images', '1000', '--simulation_distribution', 'normal', '--use_different_noise', '--use_moe', '--num_experts', '2', '--moe_hidden_dim', '2', '--moe_tau', '0.1']
[2025-03-28 01:11:15,222] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-03-28 01:11:34,110] [INFO] [logging.py:128:log_dist] [Rank -1] DeepSpeed info: version=0.16.4, git-hash=unknown, git-branch=unknown
[2025-03-28 01:11:34,111] [INFO] [comm.py:658:init_distributed] cdb=None
[2025-03-28 01:11:34,111] [INFO] [comm.py:689:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2025-03-28 01:11:34,120] [INFO] [config.py:734:__init__] Config mesh_device None world_size = 1
[2025-03-28 01:11:36,619] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
Using /hpc2hdd/home/yli045/.cache/torch_extensions/py312_cu124 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /hpc2hdd/home/yli045/.cache/torch_extensions/py312_cu124/fused_adam/build.ninja...
/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/utils/cpp_extension.py:2059: UserWarning: TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation. 
If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'].
  warnings.warn(
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 0.1821744441986084 seconds
[2025-03-28 01:11:36,807] [INFO] [logging.py:128:log_dist] [Rank 0] Using DeepSpeed Optimizer param name adamw as basic optimizer
[2025-03-28 01:11:36,808] [INFO] [logging.py:128:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2025-03-28 01:11:36,810] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Basic Optimizer = FusedAdam
[2025-03-28 01:11:36,810] [INFO] [utils.py:59:is_zero_supported_optimizer] Checking ZeRO support for optimizer=FusedAdam type=<class 'deepspeed.ops.adam.fused_adam.FusedAdam'>
[2025-03-28 01:11:36,810] [INFO] [logging.py:128:log_dist] [Rank 0] Creating torch.float16 ZeRO stage 2 optimizer
[2025-03-28 01:11:36,813] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 500000000
[2025-03-28 01:11:36,813] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 500000000
[2025-03-28 01:11:36,813] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2025-03-28 01:11:36,813] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2025-03-28 01:11:38,772] [INFO] [utils.py:781:see_memory_usage] Before initializing optimizer states
[2025-03-28 01:11:38,772] [INFO] [utils.py:782:see_memory_usage] MA 0.04 GB         Max_MA 0.05 GB         CA 0.05 GB         Max_CA 0 GB 
[2025-03-28 01:11:38,772] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 150.94 GB, percent = 15.0%
[2025-03-28 01:11:38,995] [INFO] [utils.py:781:see_memory_usage] After initializing optimizer states
[2025-03-28 01:11:38,996] [INFO] [utils.py:782:see_memory_usage] MA 0.04 GB         Max_MA 0.06 GB         CA 0.08 GB         Max_CA 0 GB 
[2025-03-28 01:11:38,996] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 151.09 GB, percent = 15.0%
[2025-03-28 01:11:38,996] [INFO] [stage_1_and_2.py:550:__init__] optimizer state initialized
[2025-03-28 01:11:39,125] [INFO] [utils.py:781:see_memory_usage] After initializing ZeRO optimizer
[2025-03-28 01:11:39,126] [INFO] [utils.py:782:see_memory_usage] MA 0.04 GB         Max_MA 0.04 GB         CA 0.08 GB         Max_CA 0 GB 
[2025-03-28 01:11:39,126] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 150.03 GB, percent = 14.9%
[2025-03-28 01:11:39,127] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Final Optimizer = DeepSpeedZeroOptimizer
[2025-03-28 01:11:39,128] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed using configured LR scheduler = None
[2025-03-28 01:11:39,128] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2025-03-28 01:11:39,128] [INFO] [logging.py:128:log_dist] [Rank 0] step=0, skipped=0, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:11:39,128] [INFO] [config.py:1001:print] DeepSpeedEngine configuration:
[2025-03-28 01:11:39,128] [INFO] [config.py:1005:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2025-03-28 01:11:39,128] [INFO] [config.py:1005:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'intra_op_parallelism': 1, 'single_submit': False, 'overlap_events': True, 'use_gds': False}
[2025-03-28 01:11:39,128] [INFO] [config.py:1005:print]   amp_enabled .................. False
[2025-03-28 01:11:39,128] [INFO] [config.py:1005:print]   amp_params ................... False
[2025-03-28 01:11:39,129] [INFO] [config.py:1005:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2025-03-28 01:11:39,129] [INFO] [config.py:1005:print]   bfloat16_enabled ............. False
[2025-03-28 01:11:39,129] [INFO] [config.py:1005:print]   bfloat16_immediate_grad_update  False
[2025-03-28 01:11:39,129] [INFO] [config.py:1005:print]   checkpoint_parallel_write_pipeline  False
[2025-03-28 01:11:39,129] [INFO] [config.py:1005:print]   checkpoint_tag_validation_enabled  True
[2025-03-28 01:11:39,129] [INFO] [config.py:1005:print]   checkpoint_tag_validation_fail  False
[2025-03-28 01:11:39,129] [INFO] [config.py:1005:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f9c69244b60>
[2025-03-28 01:11:39,129] [INFO] [config.py:1005:print]   communication_data_type ...... None
[2025-03-28 01:11:39,129] [INFO] [config.py:1005:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2025-03-28 01:11:39,129] [INFO] [config.py:1005:print]   curriculum_enabled_legacy .... False
[2025-03-28 01:11:39,129] [INFO] [config.py:1005:print]   curriculum_params_legacy ..... False
[2025-03-28 01:11:39,129] [INFO] [config.py:1005:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2025-03-28 01:11:39,129] [INFO] [config.py:1005:print]   data_efficiency_enabled ...... False
[2025-03-28 01:11:39,129] [INFO] [config.py:1005:print]   dataloader_drop_last ......... False
[2025-03-28 01:11:39,129] [INFO] [config.py:1005:print]   disable_allgather ............ False
[2025-03-28 01:11:39,129] [INFO] [config.py:1005:print]   dump_state ................... False
[2025-03-28 01:11:39,129] [INFO] [config.py:1005:print]   dynamic_loss_scale_args ...... {'init_scale': 65536, 'scale_window': 1000, 'delayed_shift': 2, 'consecutive_hysteresis': False, 'min_scale': 1}
[2025-03-28 01:11:39,129] [INFO] [config.py:1005:print]   eigenvalue_enabled ........... False
[2025-03-28 01:11:39,129] [INFO] [config.py:1005:print]   eigenvalue_gas_boundary_resolution  1
[2025-03-28 01:11:39,129] [INFO] [config.py:1005:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2025-03-28 01:11:39,129] [INFO] [config.py:1005:print]   eigenvalue_layer_num ......... 0
[2025-03-28 01:11:39,129] [INFO] [config.py:1005:print]   eigenvalue_max_iter .......... 100
[2025-03-28 01:11:39,129] [INFO] [config.py:1005:print]   eigenvalue_stability ......... 1e-06
[2025-03-28 01:11:39,129] [INFO] [config.py:1005:print]   eigenvalue_tol ............... 0.01
[2025-03-28 01:11:39,130] [INFO] [config.py:1005:print]   eigenvalue_verbose ........... False
[2025-03-28 01:11:39,130] [INFO] [config.py:1005:print]   elasticity_enabled ........... False
[2025-03-28 01:11:39,130] [INFO] [config.py:1005:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2025-03-28 01:11:39,130] [INFO] [config.py:1005:print]   fp16_auto_cast ............... False
[2025-03-28 01:11:39,130] [INFO] [config.py:1005:print]   fp16_enabled ................. True
[2025-03-28 01:11:39,130] [INFO] [config.py:1005:print]   fp16_master_weights_and_gradients  False
[2025-03-28 01:11:39,130] [INFO] [config.py:1005:print]   global_rank .................. 0
[2025-03-28 01:11:39,130] [INFO] [config.py:1005:print]   grad_accum_dtype ............. None
[2025-03-28 01:11:39,130] [INFO] [config.py:1005:print]   gradient_accumulation_steps .. 1
[2025-03-28 01:11:39,130] [INFO] [config.py:1005:print]   gradient_clipping ............ 1.0
[2025-03-28 01:11:39,130] [INFO] [config.py:1005:print]   gradient_predivide_factor .... 1.0
[2025-03-28 01:11:39,130] [INFO] [config.py:1005:print]   graph_harvesting ............. False
[2025-03-28 01:11:39,130] [INFO] [config.py:1005:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2025-03-28 01:11:39,130] [INFO] [config.py:1005:print]   initial_dynamic_scale ........ 65536
[2025-03-28 01:11:39,130] [INFO] [config.py:1005:print]   load_universal_checkpoint .... False
[2025-03-28 01:11:39,130] [INFO] [config.py:1005:print]   loss_scale ................... 0
[2025-03-28 01:11:39,130] [INFO] [config.py:1005:print]   memory_breakdown ............. False
[2025-03-28 01:11:39,130] [INFO] [config.py:1005:print]   mics_hierarchial_params_gather  False
[2025-03-28 01:11:39,130] [INFO] [config.py:1005:print]   mics_shard_size .............. -1
[2025-03-28 01:11:39,130] [INFO] [config.py:1005:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') comet=CometConfig(enabled=False, samples_log_interval=100, project=None, workspace=None, api_key=None, experiment_name=None, experiment_key=None, online=None, mode=None) wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName')
[2025-03-28 01:11:39,130] [INFO] [config.py:1005:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2025-03-28 01:11:39,130] [INFO] [config.py:1005:print]   optimizer_legacy_fusion ...... False
[2025-03-28 01:11:39,131] [INFO] [config.py:1005:print]   optimizer_name ............... adamw
[2025-03-28 01:11:39,131] [INFO] [config.py:1005:print]   optimizer_params ............. {'lr': 0.0002, 'weight_decay': 0.01}
[2025-03-28 01:11:39,131] [INFO] [config.py:1005:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2025-03-28 01:11:39,131] [INFO] [config.py:1005:print]   pld_enabled .................. False
[2025-03-28 01:11:39,131] [INFO] [config.py:1005:print]   pld_params ................... False
[2025-03-28 01:11:39,131] [INFO] [config.py:1005:print]   prescale_gradients ........... False
[2025-03-28 01:11:39,131] [INFO] [config.py:1005:print]   scheduler_name ............... None
[2025-03-28 01:11:39,131] [INFO] [config.py:1005:print]   scheduler_params ............. None
[2025-03-28 01:11:39,131] [INFO] [config.py:1005:print]   seq_parallel_communication_data_type  torch.float32
[2025-03-28 01:11:39,131] [INFO] [config.py:1005:print]   sparse_attention ............. None
[2025-03-28 01:11:39,131] [INFO] [config.py:1005:print]   sparse_gradients_enabled ..... False
[2025-03-28 01:11:39,131] [INFO] [config.py:1005:print]   steps_per_print .............. 50
[2025-03-28 01:11:39,131] [INFO] [config.py:1005:print]   tensor_parallel_config ....... dtype=torch.float16 autotp_size=0 tensor_parallel=TPConfig(tp_size=1, tp_grain_size=1, mpu=None, tp_group=None) injection_policy_tuple=None keep_module_on_host=False replace_with_kernel_inject=False
[2025-03-28 01:11:39,131] [INFO] [config.py:1005:print]   timers_config ................ enabled=True synchronized=True
[2025-03-28 01:11:39,131] [INFO] [config.py:1005:print]   train_batch_size ............. 4
[2025-03-28 01:11:39,131] [INFO] [config.py:1005:print]   train_micro_batch_size_per_gpu  4
[2025-03-28 01:11:39,131] [INFO] [config.py:1005:print]   use_data_before_expert_parallel_  False
[2025-03-28 01:11:39,131] [INFO] [config.py:1005:print]   use_node_local_storage ....... False
[2025-03-28 01:11:39,131] [INFO] [config.py:1005:print]   wall_clock_breakdown ......... False
[2025-03-28 01:11:39,131] [INFO] [config.py:1005:print]   weight_quantization_config ... None
[2025-03-28 01:11:39,131] [INFO] [config.py:1005:print]   world_size ................... 1
[2025-03-28 01:11:39,131] [INFO] [config.py:1005:print]   zero_allow_untested_optimizer  False
[2025-03-28 01:11:39,131] [INFO] [config.py:1005:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=500000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50000000 param_persistence_threshold=100000 model_persistence_threshold=9223372036854775807 max_live_parameters=1000000000 max_reuse_distance=1000000000 gather_16bit_weights_on_model_save=False module_granularity_threshold=0 use_all_reduce_for_fetch_params=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False zeropp_loco_param=None mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True log_trace_cache_warnings=False
[2025-03-28 01:11:39,131] [INFO] [config.py:1005:print]   zero_enabled ................. True
[2025-03-28 01:11:39,131] [INFO] [config.py:1005:print]   zero_force_ds_cpu_optimizer .. True
[2025-03-28 01:11:39,131] [INFO] [config.py:1005:print]   zero_optimization_stage ...... 2
[2025-03-28 01:11:39,132] [INFO] [config.py:991:print_user_config]   json = {
    "train_batch_size": 4, 
    "gradient_accumulation_steps": 1, 
    "optimizer": {
        "type": "AdamW", 
        "params": {
            "lr": 0.0002, 
            "weight_decay": 0.01
        }
    }, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "loss_scale_window": 1000
    }, 
    "zero_optimization": {
        "stage": 2, 
        "contiguous_gradients": true, 
        "overlap_comm": true
    }, 
    "steps_per_print": 50, 
    "gradient_clipping": 1.0
}
****START TRAINING****
image_size: 64, batch_size: 4, timesteps: 1000, time_emb_dim: 32
  0%|                                                                                                                | 0/35 [00:00<?, ?it/s][2025-03-28 01:11:41,897] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
  3%|██▉                                                                                                     | 1/35 [00:02<01:29,  2.63s/it][2025-03-28 01:11:41,935] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
  9%|████████▉                                                                                               | 3/35 [00:02<00:23,  1.34it/s] 17%|█████████████████▊                                                                                      | 6/35 [00:02<00:09,  3.17it/s] 26%|██████████████████████████▋                                                                             | 9/35 [00:03<00:05,  5.18it/s] 31%|████████████████████████████████▎                                                                      | 11/35 [00:03<00:03,  6.66it/s] 40%|█████████████████████████████████████████▏                                                             | 14/35 [00:03<00:02,  9.28it/s] 49%|██████████████████████████████████████████████████                                                     | 17/35 [00:03<00:01, 12.04it/s] 57%|██████████████████████████████████████████████████████████▊                                            | 20/35 [00:03<00:01, 14.25it/s] 66%|███████████████████████████████████████████████████████████████████▋                                   | 23/35 [00:03<00:00, 15.81it/s] 74%|████████████████████████████████████████████████████████████████████████████▌                          | 26/35 [00:03<00:00, 17.27it/s] 83%|█████████████████████████████████████████████████████████████████████████████████████▎                 | 29/35 [00:04<00:00, 18.35it/s] 91%|██████████████████████████████████████████████████████████████████████████████████████████████▏        | 32/35 [00:04<00:00, 19.32it/s]100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:04<00:00, 17.80it/s]100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:04<00:00,  7.97it/s]
/hpc2hdd/home/yli045/diffusion_noise_agent/train.py:189: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  df = pd.concat([df, pd.DataFrame([new_row])], ignore_index=True) # 使用 pd.concat 追加数据
  0%|                                                                                                                | 0/35 [00:00<?, ?it/s]  3%|██▉                                                                                                     | 1/35 [00:00<00:13,  2.51it/s] 11%|███████████▉                                                                                            | 4/35 [00:00<00:03,  8.79it/s] 20%|████████████████████▊                                                                                   | 7/35 [00:00<00:02, 12.85it/s] 29%|█████████████████████████████▍                                                                         | 10/35 [00:00<00:01, 15.88it/s] 37%|██████████████████████████████████████▎                                                                | 13/35 [00:00<00:01, 17.73it/s][2025-03-28 01:11:44,762] [INFO] [logging.py:128:log_dist] [Rank 0] step=50, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:11:44,763] [INFO] [timer.py:264:stop] epoch=0/micro_step=50/global_step=50, RunningAvgSamplesPerSec=71.85332722083736, CurrSamplesPerSec=80.17088337670678, MemAllocated=0.12GB, MaxMemAllocated=2.02GB
 46%|███████████████████████████████████████████████                                                        | 16/35 [00:01<00:01, 18.24it/s] 54%|███████████████████████████████████████████████████████▉                                               | 19/35 [00:01<00:00, 19.20it/s] 63%|████████████████████████████████████████████████████████████████▋                                      | 22/35 [00:01<00:00, 19.93it/s] 71%|█████████████████████████████████████████████████████████████████████████▌                             | 25/35 [00:01<00:00, 20.11it/s] 80%|██████████████████████████████████████████████████████████████████████████████████▍                    | 28/35 [00:01<00:00, 20.54it/s] 89%|███████████████████████████████████████████████████████████████████████████████████████████▏           | 31/35 [00:01<00:00, 20.88it/s] 97%|████████████████████████████████████████████████████████████████████████████████████████████████████   | 34/35 [00:01<00:00, 21.15it/s]100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:02<00:00, 17.03it/s]
  0%|                                                                                                                | 0/35 [00:00<?, ?it/s]  3%|██▉                                                                                                     | 1/35 [00:00<00:08,  4.17it/s] 11%|███████████▉                                                                                            | 4/35 [00:00<00:02, 11.48it/s] 20%|████████████████████▊                                                                                   | 7/35 [00:00<00:01, 15.23it/s] 26%|██████████████████████████▋                                                                             | 9/35 [00:00<00:01, 16.39it/s] 34%|███████████████████████████████████▎                                                                   | 12/35 [00:00<00:01, 18.29it/s] 43%|████████████████████████████████████████████▏                                                          | 15/35 [00:00<00:01, 19.10it/s] 51%|████████████████████████████████████████████████████▉                                                  | 18/35 [00:01<00:00, 19.75it/s] 60%|█████████████████████████████████████████████████████████████▊                                         | 21/35 [00:01<00:00, 20.13it/s] 69%|██████████████████████████████████████████████████████████████████████▋                                | 24/35 [00:01<00:00, 20.70it/s] 77%|███████████████████████████████████████████████████████████████████████████████▍                       | 27/35 [00:01<00:00, 20.96it/s][2025-03-28 01:11:47,430] [INFO] [logging.py:128:log_dist] [Rank 0] step=100, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:11:47,431] [INFO] [timer.py:264:stop] epoch=0/micro_step=100/global_step=100, RunningAvgSamplesPerSec=76.09068272689424, CurrSamplesPerSec=87.0791892714086, MemAllocated=0.12GB, MaxMemAllocated=2.02GB
 86%|████████████████████████████████████████████████████████████████████████████████████████▎              | 30/35 [00:01<00:00, 21.31it/s] 94%|█████████████████████████████████████████████████████████████████████████████████████████████████      | 33/35 [00:01<00:00, 21.41it/s]100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:01<00:00, 18.41it/s]
  0%|                                                                                                                | 0/35 [00:00<?, ?it/s]  3%|██▉                                                                                                     | 1/35 [00:00<00:19,  1.77it/s]  9%|████████▉                                                                                               | 3/35 [00:00<00:05,  5.44it/s] 17%|█████████████████▊                                                                                      | 6/35 [00:00<00:02,  9.97it/s] 26%|██████████████████████████▋                                                                             | 9/35 [00:00<00:01, 13.59it/s] 31%|████████████████████████████████▎                                                                      | 11/35 [00:01<00:01, 14.80it/s] 37%|██████████████████████████████████████▎                                                                | 13/35 [00:01<00:01, 16.05it/s] 46%|███████████████████████████████████████████████                                                        | 16/35 [00:01<00:01, 17.67it/s] 54%|███████████████████████████████████████████████████████▉                                               | 19/35 [00:01<00:00, 19.09it/s] 63%|████████████████████████████████████████████████████████████████▋                                      | 22/35 [00:01<00:00, 19.11it/s] 71%|█████████████████████████████████████████████████████████████████████████▌                             | 25/35 [00:01<00:00, 19.91it/s] 80%|██████████████████████████████████████████████████████████████████████████████████▍                    | 28/35 [00:01<00:00, 20.42it/s] 89%|███████████████████████████████████████████████████████████████████████████████████████████▏           | 31/35 [00:01<00:00, 20.67it/s] 97%|████████████████████████████████████████████████████████████████████████████████████████████████████   | 34/35 [00:02<00:00, 21.05it/s]100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:02<00:00, 15.60it/s]
  0%|                                                                                                                | 0/35 [00:00<?, ?it/s]  3%|██▉                                                                                                     | 1/35 [00:00<00:07,  4.54it/s] 11%|███████████▉                                                                                            | 4/35 [00:00<00:02, 12.44it/s] 20%|████████████████████▊                                                                                   | 7/35 [00:00<00:01, 16.29it/s][2025-03-28 01:11:50,683] [INFO] [logging.py:128:log_dist] [Rank 0] step=150, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:11:50,684] [INFO] [timer.py:264:stop] epoch=0/micro_step=150/global_step=150, RunningAvgSamplesPerSec=73.24122076843953, CurrSamplesPerSec=88.15767446947449, MemAllocated=0.12GB, MaxMemAllocated=2.02GB
 29%|█████████████████████████████▍                                                                         | 10/35 [00:00<00:01, 18.02it/s] 37%|██████████████████████████████████████▎                                                                | 13/35 [00:00<00:01, 18.99it/s] 46%|███████████████████████████████████████████████                                                        | 16/35 [00:00<00:00, 20.23it/s] 54%|███████████████████████████████████████████████████████▉                                               | 19/35 [00:01<00:00, 20.82it/s] 63%|████████████████████████████████████████████████████████████████▋                                      | 22/35 [00:01<00:00, 20.84it/s] 71%|█████████████████████████████████████████████████████████████████████████▌                             | 25/35 [00:01<00:00, 21.01it/s] 80%|██████████████████████████████████████████████████████████████████████████████████▍                    | 28/35 [00:01<00:00, 21.22it/s] 89%|███████████████████████████████████████████████████████████████████████████████████████████▏           | 31/35 [00:01<00:00, 21.14it/s] 97%|████████████████████████████████████████████████████████████████████████████████████████████████████   | 34/35 [00:01<00:00, 21.36it/s]100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:01<00:00, 18.86it/s]
  0%|                                                                                                                | 0/35 [00:00<?, ?it/s]  3%|██▉                                                                                                     | 1/35 [00:00<00:10,  3.11it/s]  9%|████████▉                                                                                               | 3/35 [00:00<00:03,  8.21it/s] 17%|█████████████████▊                                                                                      | 6/35 [00:00<00:02, 12.97it/s] 26%|██████████████████████████▋                                                                             | 9/35 [00:00<00:01, 15.92it/s] 34%|███████████████████████████████████▎                                                                   | 12/35 [00:00<00:01, 17.51it/s] 43%|████████████████████████████████████████████▏                                                          | 15/35 [00:01<00:01, 18.46it/s] 51%|████████████████████████████████████████████████████▉                                                  | 18/35 [00:01<00:00, 19.20it/s] 60%|█████████████████████████████████████████████████████████████▊                                         | 21/35 [00:01<00:00, 20.36it/s] 69%|██████████████████████████████████████████████████████████████████████▋                                | 24/35 [00:01<00:00, 21.41it/s][2025-03-28 01:11:53,387] [INFO] [logging.py:128:log_dist] [Rank 0] step=200, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:11:53,388] [INFO] [timer.py:264:stop] epoch=0/micro_step=200/global_step=200, RunningAvgSamplesPerSec=74.52791297289258, CurrSamplesPerSec=89.88202239155846, MemAllocated=0.12GB, MaxMemAllocated=2.02GB
 77%|███████████████████████████████████████████████████████████████████████████████▍                       | 27/35 [00:01<00:00, 21.44it/s] 86%|████████████████████████████████████████████████████████████████████████████████████████▎              | 30/35 [00:01<00:00, 21.34it/s] 94%|█████████████████████████████████████████████████████████████████████████████████████████████████      | 33/35 [00:01<00:00, 21.43it/s]100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:01<00:00, 17.74it/s]
  0%|                                                                                                                | 0/35 [00:00<?, ?it/s]  3%|██▉                                                                                                     | 1/35 [00:00<00:06,  5.17it/s] 11%|███████████▉                                                                                            | 4/35 [00:00<00:02, 13.26it/s] 20%|████████████████████▊                                                                                   | 7/35 [00:00<00:01, 16.34it/s] 29%|█████████████████████████████▍                                                                         | 10/35 [00:00<00:01, 18.20it/s] 37%|██████████████████████████████████████▎                                                                | 13/35 [00:00<00:01, 19.15it/s] 46%|███████████████████████████████████████████████                                                        | 16/35 [00:00<00:00, 20.17it/s] 54%|███████████████████████████████████████████████████████▉                                               | 19/35 [00:01<00:00, 19.92it/s] 63%|████████████████████████████████████████████████████████████████▋                                      | 22/35 [00:01<00:00, 20.66it/s] 71%|█████████████████████████████████████████████████████████████████████████▌                             | 25/35 [00:01<00:00, 20.65it/s] 80%|██████████████████████████████████████████████████████████████████████████████████▍                    | 28/35 [00:01<00:00, 20.89it/s] 89%|███████████████████████████████████████████████████████████████████████████████████████████▏           | 31/35 [00:01<00:00, 21.33it/s] 97%|████████████████████████████████████████████████████████████████████████████████████████████████████   | 34/35 [00:01<00:00, 21.70it/s]100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:01<00:00, 18.87it/s]
  0%|                                                                                                                | 0/35 [00:00<?, ?it/s]  3%|██▉                                                                                                     | 1/35 [00:00<00:21,  1.55it/s] 11%|███████████▉                                                                                            | 4/35 [00:00<00:04,  6.20it/s][2025-03-28 01:11:56,691] [INFO] [logging.py:128:log_dist] [Rank 0] step=250, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:11:56,691] [INFO] [timer.py:264:stop] epoch=0/micro_step=250/global_step=250, RunningAvgSamplesPerSec=72.93672093051751, CurrSamplesPerSec=87.89257776816463, MemAllocated=0.12GB, MaxMemAllocated=2.02GB
 20%|████████████████████▊                                                                                   | 7/35 [00:00<00:02, 10.06it/s] 29%|█████████████████████████████▍                                                                         | 10/35 [00:01<00:01, 13.07it/s] 37%|██████████████████████████████████████▎                                                                | 13/35 [00:01<00:01, 15.42it/s] 46%|███████████████████████████████████████████████                                                        | 16/35 [00:01<00:01, 17.17it/s] 54%|███████████████████████████████████████████████████████▉                                               | 19/35 [00:01<00:00, 18.43it/s] 63%|████████████████████████████████████████████████████████████████▋                                      | 22/35 [00:01<00:00, 18.70it/s] 71%|█████████████████████████████████████████████████████████████████████████▌                             | 25/35 [00:01<00:00, 19.60it/s] 80%|██████████████████████████████████████████████████████████████████████████████████▍                    | 28/35 [00:01<00:00, 19.97it/s] 89%|███████████████████████████████████████████████████████████████████████████████████████████▏           | 31/35 [00:02<00:00, 21.45it/s] 97%|████████████████████████████████████████████████████████████████████████████████████████████████████   | 34/35 [00:02<00:00, 21.79it/s]100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:02<00:00, 15.30it/s]
  0%|                                                                                                                | 0/35 [00:00<?, ?it/s]  3%|██▉                                                                                                     | 1/35 [00:00<00:06,  5.02it/s] 14%|██████████████▊                                                                                         | 5/35 [00:00<00:01, 17.39it/s] 23%|███████████████████████▊                                                                                | 8/35 [00:00<00:01, 19.32it/s] 31%|████████████████████████████████▎                                                                      | 11/35 [00:00<00:01, 20.07it/s] 40%|█████████████████████████████████████████▏                                                             | 14/35 [00:00<00:01, 20.67it/s] 49%|██████████████████████████████████████████████████                                                     | 17/35 [00:00<00:00, 21.12it/s][2025-03-28 01:11:59,204] [INFO] [logging.py:128:log_dist] [Rank 0] step=300, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:11:59,205] [INFO] [timer.py:264:stop] epoch=0/micro_step=300/global_step=300, RunningAvgSamplesPerSec=74.74407120077112, CurrSamplesPerSec=81.2636239072763, MemAllocated=0.12GB, MaxMemAllocated=2.02GB
 57%|██████████████████████████████████████████████████████████▊                                            | 20/35 [00:01<00:00, 21.27it/s] 66%|███████████████████████████████████████████████████████████████████▋                                   | 23/35 [00:01<00:00, 20.68it/s] 74%|████████████████████████████████████████████████████████████████████████████▌                          | 26/35 [00:01<00:00, 19.91it/s] 83%|█████████████████████████████████████████████████████████████████████████████████████▎                 | 29/35 [00:01<00:00, 20.52it/s] 91%|██████████████████████████████████████████████████████████████████████████████████████████████▏        | 32/35 [00:01<00:00, 21.01it/s]100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:01<00:00, 21.23it/s]100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:01<00:00, 19.40it/s]
  0%|                                                                                                                | 0/35 [00:00<?, ?it/s]  3%|██▉                                                                                                     | 1/35 [00:00<00:06,  5.32it/s]  9%|████████▉                                                                                               | 3/35 [00:00<00:02, 10.88it/s] 17%|█████████████████▊                                                                                      | 6/35 [00:00<00:01, 15.71it/s] 26%|██████████████████████████▋                                                                             | 9/35 [00:00<00:01, 18.10it/s] 34%|███████████████████████████████████▎                                                                   | 12/35 [00:00<00:01, 19.24it/s] 43%|████████████████████████████████████████████▏                                                          | 15/35 [00:00<00:01, 19.74it/s] 49%|██████████████████████████████████████████████████                                                     | 17/35 [00:00<00:00, 19.76it/s] 54%|███████████████████████████████████████████████████████▉                                               | 19/35 [00:01<00:00, 19.80it/s] 60%|█████████████████████████████████████████████████████████████▊                                         | 21/35 [00:01<00:00, 19.19it/s] 66%|███████████████████████████████████████████████████████████████████▋                                   | 23/35 [00:01<00:00, 19.04it/s] 74%|████████████████████████████████████████████████████████████████████████████▌                          | 26/35 [00:01<00:00, 19.73it/s] 80%|██████████████████████████████████████████████████████████████████████████████████▍                    | 28/35 [00:01<00:00, 18.59it/s] 86%|████████████████████████████████████████████████████████████████████████████████████████▎              | 30/35 [00:01<00:00, 18.89it/s] 91%|██████████████████████████████████████████████████████████████████████████████████████████████▏        | 32/35 [00:01<00:00, 18.73it/s][2025-03-28 01:12:01,938] [INFO] [logging.py:128:log_dist] [Rank 0] step=350, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:12:01,942] [INFO] [timer.py:264:stop] epoch=0/micro_step=350/global_step=350, RunningAvgSamplesPerSec=75.1426980589703, CurrSamplesPerSec=77.82427185720566, MemAllocated=0.12GB, MaxMemAllocated=2.02GB
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:01<00:00, 19.23it/s]100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:01<00:00, 17.75it/s]
  0%|                                                                                                                | 0/35 [00:00<?, ?it/s]  3%|██▉                                                                                                     | 1/35 [00:00<00:13,  2.55it/s] 11%|███████████▉                                                                                            | 4/35 [00:00<00:03,  8.82it/s] 20%|████████████████████▊                                                                                   | 7/35 [00:00<00:02, 12.56it/s] 29%|█████████████████████████████▍                                                                         | 10/35 [00:00<00:01, 15.28it/s] 34%|███████████████████████████████████▎                                                                   | 12/35 [00:00<00:01, 16.39it/s] 40%|█████████████████████████████████████████▏                                                             | 14/35 [00:01<00:01, 17.19it/s] 49%|██████████████████████████████████████████████████                                                     | 17/35 [00:01<00:00, 18.57it/s] 57%|██████████████████████████████████████████████████████████▊                                            | 20/35 [00:01<00:00, 18.90it/s] 66%|███████████████████████████████████████████████████████████████████▋                                   | 23/35 [00:01<00:00, 19.43it/s] 71%|█████████████████████████████████████████████████████████████████████████▌                             | 25/35 [00:01<00:00, 19.23it/s] 80%|██████████████████████████████████████████████████████████████████████████████████▍                    | 28/35 [00:01<00:00, 19.59it/s] 86%|████████████████████████████████████████████████████████████████████████████████████████▎              | 30/35 [00:01<00:00, 19.44it/s] 94%|█████████████████████████████████████████████████████████████████████████████████████████████████      | 33/35 [00:01<00:00, 20.98it/s]100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:02<00:00, 16.52it/s]
  0%|                                                                                                                | 0/35 [00:00<?, ?it/s]  3%|██▉                                                                                                     | 1/35 [00:00<00:09,  3.61it/s]  9%|████████▉                                                                                               | 3/35 [00:00<00:03,  8.81it/s] 17%|█████████████████▊                                                                                      | 6/35 [00:00<00:02, 13.24it/s] 23%|███████████████████████▊                                                                                | 8/35 [00:00<00:01, 14.77it/s] 29%|█████████████████████████████▍                                                                         | 10/35 [00:00<00:01, 15.99it/s] 37%|██████████████████████████████████████▎                                                                | 13/35 [00:00<00:01, 17.38it/s][2025-03-28 01:12:05,186] [INFO] [logging.py:128:log_dist] [Rank 0] step=400, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:12:05,190] [INFO] [timer.py:264:stop] epoch=0/micro_step=400/global_step=400, RunningAvgSamplesPerSec=74.1366405032221, CurrSamplesPerSec=75.86550509635757, MemAllocated=0.12GB, MaxMemAllocated=2.02GB
 43%|████████████████████████████████████████████▏                                                          | 15/35 [00:01<00:01, 17.99it/s] 51%|████████████████████████████████████████████████████▉                                                  | 18/35 [00:01<00:00, 18.61it/s] 57%|██████████████████████████████████████████████████████████▊                                            | 20/35 [00:01<00:00, 18.75it/s] 66%|███████████████████████████████████████████████████████████████████▋                                   | 23/35 [00:01<00:00, 18.91it/s] 71%|█████████████████████████████████████████████████████████████████████████▌                             | 25/35 [00:01<00:00, 18.75it/s] 80%|██████████████████████████████████████████████████████████████████████████████████▍                    | 28/35 [00:01<00:00, 19.27it/s] 86%|████████████████████████████████████████████████████████████████████████████████████████▎              | 30/35 [00:01<00:00, 19.21it/s] 94%|█████████████████████████████████████████████████████████████████████████████████████████████████      | 33/35 [00:01<00:00, 19.41it/s]100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:02<00:00, 16.75it/s]
  0%|                                                                                                                | 0/35 [00:00<?, ?it/s]  3%|██▉                                                                                                     | 1/35 [00:00<00:07,  4.35it/s]  9%|████████▉                                                                                               | 3/35 [00:00<00:03,  9.97it/s] 14%|██████████████▊                                                                                         | 5/35 [00:00<00:02, 12.99it/s] 20%|████████████████████▊                                                                                   | 7/35 [00:00<00:01, 14.97it/s] 26%|██████████████████████████▋                                                                             | 9/35 [00:00<00:01, 16.23it/s] 31%|████████████████████████████████▎                                                                      | 11/35 [00:00<00:01, 16.70it/s] 37%|██████████████████████████████████████▎                                                                | 13/35 [00:00<00:01, 17.37it/s] 43%|████████████████████████████████████████████▏                                                          | 15/35 [00:00<00:01, 17.84it/s] 49%|██████████████████████████████████████████████████                                                     | 17/35 [00:01<00:01, 17.58it/s] 54%|███████████████████████████████████████████████████████▉                                               | 19/35 [00:01<00:00, 17.95it/s] 60%|█████████████████████████████████████████████████████████████▊                                         | 21/35 [00:01<00:00, 18.23it/s] 66%|███████████████████████████████████████████████████████████████████▋                                   | 23/35 [00:01<00:00, 18.72it/s] 74%|████████████████████████████████████████████████████████████████████████████▌                          | 26/35 [00:01<00:00, 20.61it/s] 83%|█████████████████████████████████████████████████████████████████████████████████████▎                 | 29/35 [00:01<00:00, 21.43it/s][2025-03-28 01:12:08,023] [INFO] [logging.py:128:log_dist] [Rank 0] step=450, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:12:08,024] [INFO] [timer.py:264:stop] epoch=0/micro_step=450/global_step=450, RunningAvgSamplesPerSec=74.25292999377984, CurrSamplesPerSec=95.02102669888045, MemAllocated=0.12GB, MaxMemAllocated=2.02GB
 91%|██████████████████████████████████████████████████████████████████████████████████████████████▏        | 32/35 [00:01<00:00, 22.38it/s]100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:01<00:00, 22.59it/s]100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:01<00:00, 17.59it/s]
  0%|                                                                                                                | 0/35 [00:00<?, ?it/s]  3%|██▉                                                                                                     | 1/35 [00:00<00:25,  1.32it/s]  9%|████████▉                                                                                               | 3/35 [00:00<00:07,  4.19it/s] 14%|██████████████▊                                                                                         | 5/35 [00:00<00:04,  7.04it/s] 23%|███████████████████████▊                                                                                | 8/35 [00:01<00:02, 11.08it/s] 31%|████████████████████████████████▎                                                                      | 11/35 [00:01<00:01, 13.75it/s] 40%|█████████████████████████████████████████▏                                                             | 14/35 [00:01<00:01, 15.27it/s] 46%|███████████████████████████████████████████████                                                        | 16/35 [00:01<00:01, 16.16it/s] 51%|████████████████████████████████████████████████████▉                                                  | 18/35 [00:01<00:00, 17.03it/s] 60%|█████████████████████████████████████████████████████████████▊                                         | 21/35 [00:01<00:00, 18.54it/s] 69%|██████████████████████████████████████████████████████████████████████▋                                | 24/35 [00:01<00:00, 19.06it/s] 77%|███████████████████████████████████████████████████████████████████████████████▍                       | 27/35 [00:02<00:00, 18.69it/s] 83%|█████████████████████████████████████████████████████████████████████████████████████▎                 | 29/35 [00:02<00:00, 18.73it/s] 89%|███████████████████████████████████████████████████████████████████████████████████████████▏           | 31/35 [00:02<00:00, 18.75it/s] 94%|█████████████████████████████████████████████████████████████████████████████████████████████████      | 33/35 [00:02<00:00, 18.76it/s]100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:02<00:00, 18.81it/s]100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:02<00:00, 13.73it/s]
  0%|                                                                                                                | 0/35 [00:00<?, ?it/s]  3%|██▉                                                                                                     | 1/35 [00:00<00:07,  4.57it/s]  9%|████████▉                                                                                               | 3/35 [00:00<00:03, 10.14it/s] 17%|█████████████████▊                                                                                      | 6/35 [00:00<00:01, 15.00it/s] 26%|██████████████████████████▋                                                                             | 9/35 [00:00<00:01, 17.45it/s][2025-03-28 01:12:11,585] [INFO] [logging.py:128:log_dist] [Rank 0] step=500, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:12:11,585] [INFO] [timer.py:264:stop] epoch=0/micro_step=500/global_step=500, RunningAvgSamplesPerSec=72.76430445609053, CurrSamplesPerSec=90.55197571953836, MemAllocated=0.12GB, MaxMemAllocated=2.02GB
 34%|███████████████████████████████████▎                                                                   | 12/35 [00:00<00:01, 19.02it/s] 43%|████████████████████████████████████████████▏                                                          | 15/35 [00:00<00:01, 19.69it/s] 51%|████████████████████████████████████████████████████▉                                                  | 18/35 [00:01<00:00, 20.26it/s] 60%|█████████████████████████████████████████████████████████████▊                                         | 21/35 [00:01<00:00, 20.64it/s] 69%|██████████████████████████████████████████████████████████████████████▋                                | 24/35 [00:01<00:00, 21.06it/s] 77%|███████████████████████████████████████████████████████████████████████████████▍                       | 27/35 [00:01<00:00, 21.93it/s] 86%|████████████████████████████████████████████████████████████████████████████████████████▎              | 30/35 [00:01<00:00, 22.36it/s] 94%|█████████████████████████████████████████████████████████████████████████████████████████████████      | 33/35 [00:01<00:00, 22.74it/s]100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:01<00:00, 19.27it/s]
  0%|                                                                                                                | 0/35 [00:00<?, ?it/s]  3%|██▉                                                                                                     | 1/35 [00:00<00:15,  2.26it/s]  9%|████████▉                                                                                               | 3/35 [00:00<00:05,  6.28it/s] 14%|██████████████▊                                                                                         | 5/35 [00:00<00:03,  9.21it/s] 23%|███████████████████████▊                                                                                | 8/35 [00:00<00:02, 12.92it/s] 29%|█████████████████████████████▍                                                                         | 10/35 [00:00<00:01, 14.44it/s] 37%|██████████████████████████████████████▎                                                                | 13/35 [00:01<00:01, 16.69it/s] 46%|███████████████████████████████████████████████                                                        | 16/35 [00:01<00:01, 18.19it/s] 54%|███████████████████████████████████████████████████████▉                                               | 19/35 [00:01<00:00, 19.25it/s] 63%|████████████████████████████████████████████████████████████████▋                                      | 22/35 [00:01<00:00, 19.28it/s][2025-03-28 01:12:14,432] [INFO] [logging.py:128:log_dist] [Rank 0] step=550, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:12:14,433] [INFO] [timer.py:264:stop] epoch=0/micro_step=550/global_step=550, RunningAvgSamplesPerSec=72.89137913938232, CurrSamplesPerSec=88.87028351148372, MemAllocated=0.12GB, MaxMemAllocated=2.02GB
 71%|█████████████████████████████████████████████████████████████████████████▌                             | 25/35 [00:01<00:00, 20.06it/s] 80%|██████████████████████████████████████████████████████████████████████████████████▍                    | 28/35 [00:01<00:00, 20.68it/s] 89%|███████████████████████████████████████████████████████████████████████████████████████████▏           | 31/35 [00:01<00:00, 20.77it/s] 97%|████████████████████████████████████████████████████████████████████████████████████████████████████   | 34/35 [00:02<00:00, 20.64it/s]100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:02<00:00, 15.99it/s]
  0%|                                                                                                                | 0/35 [00:00<?, ?it/s]  3%|██▉                                                                                                     | 1/35 [00:00<00:13,  2.47it/s] 11%|███████████▉                                                                                            | 4/35 [00:00<00:03,  8.51it/s] 20%|████████████████████▊                                                                                   | 7/35 [00:00<00:02, 12.43it/s] 29%|█████████████████████████████▍                                                                         | 10/35 [00:00<00:01, 15.14it/s] 37%|██████████████████████████████████████▎                                                                | 13/35 [00:00<00:01, 17.12it/s] 46%|███████████████████████████████████████████████                                                        | 16/35 [00:01<00:01, 18.48it/s] 54%|███████████████████████████████████████████████████████▉                                               | 19/35 [00:01<00:00, 19.18it/s] 63%|████████████████████████████████████████████████████████████████▋                                      | 22/35 [00:01<00:00, 19.56it/s] 71%|█████████████████████████████████████████████████████████████████████████▌                             | 25/35 [00:01<00:00, 20.21it/s] 80%|██████████████████████████████████████████████████████████████████████████████████▍                    | 28/35 [00:01<00:00, 20.52it/s] 89%|███████████████████████████████████████████████████████████████████████████████████████████▏           | 31/35 [00:01<00:00, 20.98it/s] 97%|████████████████████████████████████████████████████████████████████████████████████████████████████   | 34/35 [00:01<00:00, 21.28it/s]100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:02<00:00, 16.90it/s]
  0%|                                                                                                                | 0/35 [00:00<?, ?it/s]  3%|██▉                                                                                                     | 1/35 [00:00<00:09,  3.45it/s] 11%|███████████▉                                                                                            | 4/35 [00:00<00:02, 10.71it/s][2025-03-28 01:12:17,601] [INFO] [logging.py:128:log_dist] [Rank 0] step=600, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:12:17,602] [INFO] [timer.py:264:stop] epoch=0/micro_step=600/global_step=600, RunningAvgSamplesPerSec=72.67279476314755, CurrSamplesPerSec=90.0098099753418, MemAllocated=0.12GB, MaxMemAllocated=2.02GB
 20%|████████████████████▊                                                                                   | 7/35 [00:00<00:01, 14.85it/s] 29%|█████████████████████████████▍                                                                         | 10/35 [00:00<00:01, 17.17it/s] 37%|██████████████████████████████████████▎                                                                | 13/35 [00:00<00:01, 18.64it/s] 46%|███████████████████████████████████████████████                                                        | 16/35 [00:00<00:00, 19.39it/s] 54%|███████████████████████████████████████████████████████▉                                               | 19/35 [00:01<00:00, 20.10it/s] 63%|████████████████████████████████████████████████████████████████▋                                      | 22/35 [00:01<00:00, 20.65it/s] 71%|█████████████████████████████████████████████████████████████████████████▌                             | 25/35 [00:01<00:00, 21.61it/s] 80%|██████████████████████████████████████████████████████████████████████████████████▍                    | 28/35 [00:01<00:00, 22.17it/s] 89%|███████████████████████████████████████████████████████████████████████████████████████████▏           | 31/35 [00:01<00:00, 22.03it/s] 97%|████████████████████████████████████████████████████████████████████████████████████████████████████   | 34/35 [00:01<00:00, 22.03it/s]100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:01<00:00, 18.52it/s]
  0%|                                                                                                                | 0/35 [00:00<?, ?it/s]  3%|██▉                                                                                                     | 1/35 [00:00<00:11,  2.86it/s]  9%|████████▉                                                                                               | 3/35 [00:00<00:04,  7.53it/s] 14%|██████████████▊                                                                                         | 5/35 [00:00<00:02, 10.78it/s] 20%|████████████████████▊                                                                                   | 7/35 [00:00<00:02, 13.03it/s] 26%|██████████████████████████▋                                                                             | 9/35 [00:00<00:01, 14.76it/s] 31%|████████████████████████████████▎                                                                      | 11/35 [00:00<00:01, 15.98it/s] 37%|██████████████████████████████████████▎                                                                | 13/35 [00:01<00:01, 16.83it/s] 46%|███████████████████████████████████████████████                                                        | 16/35 [00:01<00:01, 18.45it/s] 54%|███████████████████████████████████████████████████████▉                                               | 19/35 [00:01<00:00, 19.52it/s][2025-03-28 01:12:20,383] [INFO] [logging.py:128:log_dist] [Rank 0] step=650, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:12:20,385] [INFO] [timer.py:264:stop] epoch=0/micro_step=650/global_step=650, RunningAvgSamplesPerSec=72.93751465617133, CurrSamplesPerSec=82.46269379101088, MemAllocated=0.12GB, MaxMemAllocated=2.02GB
 63%|████████████████████████████████████████████████████████████████▋                                      | 22/35 [00:01<00:00, 20.16it/s] 71%|█████████████████████████████████████████████████████████████████████████▌                             | 25/35 [00:01<00:00, 20.87it/s] 80%|██████████████████████████████████████████████████████████████████████████████████▍                    | 28/35 [00:01<00:00, 21.91it/s] 89%|███████████████████████████████████████████████████████████████████████████████████████████▏           | 31/35 [00:01<00:00, 22.11it/s] 97%|████████████████████████████████████████████████████████████████████████████████████████████████████   | 34/35 [00:01<00:00, 22.15it/s]100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:02<00:00, 17.02it/s]
  0%|                                                                                                                | 0/35 [00:00<?, ?it/s]  3%|██▉                                                                                                     | 1/35 [00:00<00:11,  2.93it/s]  9%|████████▉                                                                                               | 3/35 [00:00<00:04,  7.93it/s] 17%|█████████████████▊                                                                                      | 6/35 [00:00<00:02, 12.89it/s] 26%|██████████████████████████▋                                                                             | 9/35 [00:00<00:01, 15.93it/s] 34%|███████████████████████████████████▎                                                                   | 12/35 [00:00<00:01, 17.96it/s] 43%|████████████████████████████████████████████▏                                                          | 15/35 [00:00<00:01, 19.60it/s] 51%|████████████████████████████████████████████████████▉                                                  | 18/35 [00:01<00:00, 20.17it/s] 60%|█████████████████████████████████████████████████████████████▊                                         | 21/35 [00:01<00:00, 20.76it/s] 69%|██████████████████████████████████████████████████████████████████████▋                                | 24/35 [00:01<00:00, 21.26it/s] 77%|███████████████████████████████████████████████████████████████████████████████▍                       | 27/35 [00:01<00:00, 21.24it/s] 86%|████████████████████████████████████████████████████████████████████████████████████████▎              | 30/35 [00:01<00:00, 21.20it/s] 94%|█████████████████████████████████████████████████████████████████████████████████████████████████      | 33/35 [00:01<00:00, 21.67it/s][2025-03-28 01:12:23,048] [INFO] [logging.py:128:log_dist] [Rank 0] step=700, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:12:23,049] [INFO] [timer.py:264:stop] epoch=0/micro_step=700/global_step=700, RunningAvgSamplesPerSec=73.41988040252099, CurrSamplesPerSec=91.99740151419067, MemAllocated=0.12GB, MaxMemAllocated=2.02GB
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [00:01<00:00, 17.84it/s]
[rank0]: Traceback (most recent call last):
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/main.py", line 9, in <module>
[rank0]:     train_deepspeed(cfg)
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/train.py", line 209, in train_deepspeed
[rank0]:     generate_during_training(model_engine, sample_dir, config, epoch, num_images=config.num_images//config.image_size, p=p)
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/generate.py", line 233, in generate_during_training_simulation_dif
[rank0]:     pred_noise = model_engine(x, t_batch)
[rank0]:                  ^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/deepspeed/utils/nvtx.py", line 18, in wrapped_fn
[rank0]:     ret_val = func(*args, **kwargs)
[rank0]:               ^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/deepspeed/runtime/engine.py", line 1987, in forward
[rank0]:     loss = self.module(*inputs, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/unet.py", line 216, in forward
[rank0]:     return self.final_conv(x)
[rank0]:            ^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
[rank0]:     input = module(input)
[rank0]:             ^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 554, in forward
[rank0]:     return self._conv_forward(input, self.weight, self.bias)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
[rank0]:     return F.conv2d(
[rank0]:            ^^^^^^^^^
[rank0]: torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 20.00 MiB. GPU 0 has a total capacity of 47.33 GiB of which 13.69 MiB is free. Process 3785418 has 294.00 MiB memory in use. Process 3794194 has 10.94 GiB memory in use. Process 3794200 has 3.12 GiB memory in use. Process 3794201 has 3.12 GiB memory in use. Process 3794198 has 4.08 GiB memory in use. Process 2534557 has 25.71 GiB memory in use. Of the allocated memory 24.41 GiB is allocated by PyTorch, and 670.49 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
[rank0]:[W328 01:12:26.873744903 ProcessGroupNCCL.cpp:1496] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[2025-03-28 01:12:28,048] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 577394
[2025-03-28 01:12:28,048] [ERROR] [launch.py:325:sigkill_handler] ['/hpc2hdd/home/yli045/.conda/envs/ywj/bin/python', '-u', 'main.py', '--local_rank=0', '--image_size', '64', '--batch_size', '4', '--num_epochs', '20', '--timesteps', '1000', '--lr', '2e-4', '--time_emb_dim', '32', '--mu1', '4', '--sigma1', '1', '--num1', '9000', '--mu2', '10', '--sigma2', '4', '--num2', '1000', '--samples_dir', './samples', '--checkpoints_dir', './checkpoints', '--fp16', '--mode', 'train', '--model_path', '', '--num_images', '1000', '--simulation_distribution', 'normal', '--use_different_noise', '--use_moe', '--num_experts', '2', '--moe_hidden_dim', '2', '--moe_tau', '0.1'] exits with return code = 1
[?2004h(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ bash scripts/script_normal_dif_test.sh 
[?2004l[2025-03-28 01:13:10,006] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-28 01:13:10,013] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-28 01:13:12,108] [WARNING] [runner.py:215:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2025-03-28 01:13:12,109] [INFO] [runner.py:607:main] cmd = /hpc2hdd/home/yli045/.conda/envs/ywj/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None main.py --image_size 64 --batch_size 1 --num_epochs 20 --timesteps 1000 --lr 2e-4 --time_emb_dim 32 --mu1 4 --sigma1 1 --num1 9000 --mu2 10 --sigma2 4 --num2 1000 --samples_dir ./samples --checkpoints_dir ./checkpoints --fp16 --mode train --model_path  --num_images 1000 --simulation_distribution normal --use_different_noise --use_moe --num_experts 2 --moe_hidden_dim 2 --moe_tau 0.1
[2025-03-28 01:13:14,462] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-28 01:13:14,470] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-28 01:13:15,676] [INFO] [launch.py:146:main] WORLD INFO DICT: {'localhost': [0]}
[2025-03-28 01:13:15,677] [INFO] [launch.py:152:main] nnodes=1, num_local_procs=1, node_rank=0
[2025-03-28 01:13:15,677] [INFO] [launch.py:163:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2025-03-28 01:13:15,677] [INFO] [launch.py:164:main] dist_world_size=1
[2025-03-28 01:13:15,677] [INFO] [launch.py:168:main] Setting CUDA_VISIBLE_DEVICES=0
[2025-03-28 01:13:15,678] [INFO] [launch.py:256:main] process 578393 spawned with command: ['/hpc2hdd/home/yli045/.conda/envs/ywj/bin/python', '-u', 'main.py', '--local_rank=0', '--image_size', '64', '--batch_size', '1', '--num_epochs', '20', '--timesteps', '1000', '--lr', '2e-4', '--time_emb_dim', '32', '--mu1', '4', '--sigma1', '1', '--num1', '9000', '--mu2', '10', '--sigma2', '4', '--num2', '1000', '--samples_dir', './samples', '--checkpoints_dir', './checkpoints', '--fp16', '--mode', 'train', '--model_path', '', '--num_images', '1000', '--simulation_distribution', 'normal', '--use_different_noise', '--use_moe', '--num_experts', '2', '--moe_hidden_dim', '2', '--moe_tau', '0.1']
[2025-03-28 01:13:19,789] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-03-28 01:13:37,610] [INFO] [logging.py:128:log_dist] [Rank -1] DeepSpeed info: version=0.16.4, git-hash=unknown, git-branch=unknown
[2025-03-28 01:13:37,611] [INFO] [comm.py:658:init_distributed] cdb=None
[2025-03-28 01:13:37,611] [INFO] [comm.py:689:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2025-03-28 01:13:37,620] [INFO] [config.py:734:__init__] Config mesh_device None world_size = 1
[2025-03-28 01:13:40,394] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
Using /hpc2hdd/home/yli045/.cache/torch_extensions/py312_cu124 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /hpc2hdd/home/yli045/.cache/torch_extensions/py312_cu124/fused_adam/build.ninja...
/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/utils/cpp_extension.py:2059: UserWarning: TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation. 
If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'].
  warnings.warn(
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 0.09703803062438965 seconds
[2025-03-28 01:13:40,496] [INFO] [logging.py:128:log_dist] [Rank 0] Using DeepSpeed Optimizer param name adamw as basic optimizer
[2025-03-28 01:13:40,496] [INFO] [logging.py:128:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2025-03-28 01:13:40,498] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Basic Optimizer = FusedAdam
[2025-03-28 01:13:40,498] [INFO] [utils.py:59:is_zero_supported_optimizer] Checking ZeRO support for optimizer=FusedAdam type=<class 'deepspeed.ops.adam.fused_adam.FusedAdam'>
[2025-03-28 01:13:40,499] [INFO] [logging.py:128:log_dist] [Rank 0] Creating torch.float16 ZeRO stage 2 optimizer
[2025-03-28 01:13:40,499] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 500000000
[2025-03-28 01:13:40,499] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 500000000
[2025-03-28 01:13:40,499] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2025-03-28 01:13:40,500] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2025-03-28 01:13:42,650] [INFO] [utils.py:781:see_memory_usage] Before initializing optimizer states
[2025-03-28 01:13:42,651] [INFO] [utils.py:782:see_memory_usage] MA 0.04 GB         Max_MA 0.05 GB         CA 0.05 GB         Max_CA 0 GB 
[2025-03-28 01:13:42,651] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 149.62 GB, percent = 14.8%
[2025-03-28 01:13:43,004] [INFO] [utils.py:781:see_memory_usage] After initializing optimizer states
[2025-03-28 01:13:43,004] [INFO] [utils.py:782:see_memory_usage] MA 0.04 GB         Max_MA 0.06 GB         CA 0.08 GB         Max_CA 0 GB 
[2025-03-28 01:13:43,005] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 150.73 GB, percent = 15.0%
[2025-03-28 01:13:43,005] [INFO] [stage_1_and_2.py:550:__init__] optimizer state initialized
[2025-03-28 01:13:43,128] [INFO] [utils.py:781:see_memory_usage] After initializing ZeRO optimizer
[2025-03-28 01:13:43,129] [INFO] [utils.py:782:see_memory_usage] MA 0.04 GB         Max_MA 0.04 GB         CA 0.08 GB         Max_CA 0 GB 
[2025-03-28 01:13:43,129] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 150.61 GB, percent = 14.9%
[2025-03-28 01:13:43,130] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Final Optimizer = DeepSpeedZeroOptimizer
[2025-03-28 01:13:43,130] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed using configured LR scheduler = None
[2025-03-28 01:13:43,130] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2025-03-28 01:13:43,130] [INFO] [logging.py:128:log_dist] [Rank 0] step=0, skipped=0, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:13:43,131] [INFO] [config.py:1001:print] DeepSpeedEngine configuration:
[2025-03-28 01:13:43,131] [INFO] [config.py:1005:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2025-03-28 01:13:43,131] [INFO] [config.py:1005:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'intra_op_parallelism': 1, 'single_submit': False, 'overlap_events': True, 'use_gds': False}
[2025-03-28 01:13:43,131] [INFO] [config.py:1005:print]   amp_enabled .................. False
[2025-03-28 01:13:43,131] [INFO] [config.py:1005:print]   amp_params ................... False
[2025-03-28 01:13:43,131] [INFO] [config.py:1005:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2025-03-28 01:13:43,131] [INFO] [config.py:1005:print]   bfloat16_enabled ............. False
[2025-03-28 01:13:43,131] [INFO] [config.py:1005:print]   bfloat16_immediate_grad_update  False
[2025-03-28 01:13:43,131] [INFO] [config.py:1005:print]   checkpoint_parallel_write_pipeline  False
[2025-03-28 01:13:43,131] [INFO] [config.py:1005:print]   checkpoint_tag_validation_enabled  True
[2025-03-28 01:13:43,131] [INFO] [config.py:1005:print]   checkpoint_tag_validation_fail  False
[2025-03-28 01:13:43,131] [INFO] [config.py:1005:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fb0811b2540>
[2025-03-28 01:13:43,132] [INFO] [config.py:1005:print]   communication_data_type ...... None
[2025-03-28 01:13:43,132] [INFO] [config.py:1005:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2025-03-28 01:13:43,132] [INFO] [config.py:1005:print]   curriculum_enabled_legacy .... False
[2025-03-28 01:13:43,132] [INFO] [config.py:1005:print]   curriculum_params_legacy ..... False
[2025-03-28 01:13:43,132] [INFO] [config.py:1005:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2025-03-28 01:13:43,132] [INFO] [config.py:1005:print]   data_efficiency_enabled ...... False
[2025-03-28 01:13:43,132] [INFO] [config.py:1005:print]   dataloader_drop_last ......... False
[2025-03-28 01:13:43,132] [INFO] [config.py:1005:print]   disable_allgather ............ False
[2025-03-28 01:13:43,132] [INFO] [config.py:1005:print]   dump_state ................... False
[2025-03-28 01:13:43,132] [INFO] [config.py:1005:print]   dynamic_loss_scale_args ...... {'init_scale': 65536, 'scale_window': 1000, 'delayed_shift': 2, 'consecutive_hysteresis': False, 'min_scale': 1}
[2025-03-28 01:13:43,132] [INFO] [config.py:1005:print]   eigenvalue_enabled ........... False
[2025-03-28 01:13:43,132] [INFO] [config.py:1005:print]   eigenvalue_gas_boundary_resolution  1
[2025-03-28 01:13:43,132] [INFO] [config.py:1005:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2025-03-28 01:13:43,132] [INFO] [config.py:1005:print]   eigenvalue_layer_num ......... 0
[2025-03-28 01:13:43,132] [INFO] [config.py:1005:print]   eigenvalue_max_iter .......... 100
[2025-03-28 01:13:43,132] [INFO] [config.py:1005:print]   eigenvalue_stability ......... 1e-06
[2025-03-28 01:13:43,132] [INFO] [config.py:1005:print]   eigenvalue_tol ............... 0.01
[2025-03-28 01:13:43,132] [INFO] [config.py:1005:print]   eigenvalue_verbose ........... False
[2025-03-28 01:13:43,132] [INFO] [config.py:1005:print]   elasticity_enabled ........... False
[2025-03-28 01:13:43,132] [INFO] [config.py:1005:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2025-03-28 01:13:43,132] [INFO] [config.py:1005:print]   fp16_auto_cast ............... False
[2025-03-28 01:13:43,132] [INFO] [config.py:1005:print]   fp16_enabled ................. True
[2025-03-28 01:13:43,132] [INFO] [config.py:1005:print]   fp16_master_weights_and_gradients  False
[2025-03-28 01:13:43,132] [INFO] [config.py:1005:print]   global_rank .................. 0
[2025-03-28 01:13:43,132] [INFO] [config.py:1005:print]   grad_accum_dtype ............. None
[2025-03-28 01:13:43,133] [INFO] [config.py:1005:print]   gradient_accumulation_steps .. 1
[2025-03-28 01:13:43,133] [INFO] [config.py:1005:print]   gradient_clipping ............ 1.0
[2025-03-28 01:13:43,133] [INFO] [config.py:1005:print]   gradient_predivide_factor .... 1.0
[2025-03-28 01:13:43,133] [INFO] [config.py:1005:print]   graph_harvesting ............. False
[2025-03-28 01:13:43,133] [INFO] [config.py:1005:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2025-03-28 01:13:43,133] [INFO] [config.py:1005:print]   initial_dynamic_scale ........ 65536
[2025-03-28 01:13:43,133] [INFO] [config.py:1005:print]   load_universal_checkpoint .... False
[2025-03-28 01:13:43,133] [INFO] [config.py:1005:print]   loss_scale ................... 0
[2025-03-28 01:13:43,133] [INFO] [config.py:1005:print]   memory_breakdown ............. False
[2025-03-28 01:13:43,133] [INFO] [config.py:1005:print]   mics_hierarchial_params_gather  False
[2025-03-28 01:13:43,133] [INFO] [config.py:1005:print]   mics_shard_size .............. -1
[2025-03-28 01:13:43,133] [INFO] [config.py:1005:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') comet=CometConfig(enabled=False, samples_log_interval=100, project=None, workspace=None, api_key=None, experiment_name=None, experiment_key=None, online=None, mode=None) wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName')
[2025-03-28 01:13:43,133] [INFO] [config.py:1005:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2025-03-28 01:13:43,133] [INFO] [config.py:1005:print]   optimizer_legacy_fusion ...... False
[2025-03-28 01:13:43,133] [INFO] [config.py:1005:print]   optimizer_name ............... adamw
[2025-03-28 01:13:43,133] [INFO] [config.py:1005:print]   optimizer_params ............. {'lr': 0.0002, 'weight_decay': 0.01}
[2025-03-28 01:13:43,133] [INFO] [config.py:1005:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2025-03-28 01:13:43,133] [INFO] [config.py:1005:print]   pld_enabled .................. False
[2025-03-28 01:13:43,133] [INFO] [config.py:1005:print]   pld_params ................... False
[2025-03-28 01:13:43,133] [INFO] [config.py:1005:print]   prescale_gradients ........... False
[2025-03-28 01:13:43,133] [INFO] [config.py:1005:print]   scheduler_name ............... None
[2025-03-28 01:13:43,133] [INFO] [config.py:1005:print]   scheduler_params ............. None
[2025-03-28 01:13:43,133] [INFO] [config.py:1005:print]   seq_parallel_communication_data_type  torch.float32
[2025-03-28 01:13:43,134] [INFO] [config.py:1005:print]   sparse_attention ............. None
[2025-03-28 01:13:43,134] [INFO] [config.py:1005:print]   sparse_gradients_enabled ..... False
[2025-03-28 01:13:43,134] [INFO] [config.py:1005:print]   steps_per_print .............. 50
[2025-03-28 01:13:43,134] [INFO] [config.py:1005:print]   tensor_parallel_config ....... dtype=torch.float16 autotp_size=0 tensor_parallel=TPConfig(tp_size=1, tp_grain_size=1, mpu=None, tp_group=None) injection_policy_tuple=None keep_module_on_host=False replace_with_kernel_inject=False
[2025-03-28 01:13:43,134] [INFO] [config.py:1005:print]   timers_config ................ enabled=True synchronized=True
[2025-03-28 01:13:43,134] [INFO] [config.py:1005:print]   train_batch_size ............. 1
[2025-03-28 01:13:43,134] [INFO] [config.py:1005:print]   train_micro_batch_size_per_gpu  1
[2025-03-28 01:13:43,134] [INFO] [config.py:1005:print]   use_data_before_expert_parallel_  False
[2025-03-28 01:13:43,134] [INFO] [config.py:1005:print]   use_node_local_storage ....... False
[2025-03-28 01:13:43,134] [INFO] [config.py:1005:print]   wall_clock_breakdown ......... False
[2025-03-28 01:13:43,134] [INFO] [config.py:1005:print]   weight_quantization_config ... None
[2025-03-28 01:13:43,134] [INFO] [config.py:1005:print]   world_size ................... 1
[2025-03-28 01:13:43,134] [INFO] [config.py:1005:print]   zero_allow_untested_optimizer  False
[2025-03-28 01:13:43,134] [INFO] [config.py:1005:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=500000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50000000 param_persistence_threshold=100000 model_persistence_threshold=9223372036854775807 max_live_parameters=1000000000 max_reuse_distance=1000000000 gather_16bit_weights_on_model_save=False module_granularity_threshold=0 use_all_reduce_for_fetch_params=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False zeropp_loco_param=None mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True log_trace_cache_warnings=False
[2025-03-28 01:13:43,134] [INFO] [config.py:1005:print]   zero_enabled ................. True
[2025-03-28 01:13:43,134] [INFO] [config.py:1005:print]   zero_force_ds_cpu_optimizer .. True
[2025-03-28 01:13:43,134] [INFO] [config.py:1005:print]   zero_optimization_stage ...... 2
[2025-03-28 01:13:43,134] [INFO] [config.py:991:print_user_config]   json = {
    "train_batch_size": 1, 
    "gradient_accumulation_steps": 1, 
    "optimizer": {
        "type": "AdamW", 
        "params": {
            "lr": 0.0002, 
            "weight_decay": 0.01
        }
    }, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "loss_scale_window": 1000
    }, 
    "zero_optimization": {
        "stage": 2, 
        "contiguous_gradients": true, 
        "overlap_comm": true
    }, 
    "steps_per_print": 50, 
    "gradient_clipping": 1.0
}
****START TRAINING****
image_size: 64, batch_size: 1, timesteps: 1000, time_emb_dim: 32
  0%|                                                                                                               | 0/139 [00:00<?, ?it/s][2025-03-28 01:13:45,193] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
  1%|▋                                                                                                      | 1/139 [00:01<04:15,  1.85s/it][2025-03-28 01:13:45,231] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
  2%|██▏                                                                                                    | 3/139 [00:02<01:23,  1.63it/s]  4%|███▋                                                                                                   | 5/139 [00:02<00:43,  3.06it/s]  6%|█████▉                                                                                                 | 8/139 [00:02<00:23,  5.58it/s]  8%|████████                                                                                              | 11/139 [00:02<00:15,  8.20it/s] 10%|██████████▎                                                                                           | 14/139 [00:02<00:11, 10.80it/s] 12%|████████████▍                                                                                         | 17/139 [00:02<00:09, 13.19it/s] 14%|██████████████▋                                                                                       | 20/139 [00:02<00:07, 15.27it/s] 17%|████████████████▉                                                                                     | 23/139 [00:03<00:06, 16.86it/s] 19%|███████████████████                                                                                   | 26/139 [00:03<00:06, 18.17it/s] 21%|█████████████████████▎                                                                                | 29/139 [00:03<00:05, 19.25it/s] 23%|███████████████████████▍                                                                              | 32/139 [00:03<00:05, 19.95it/s] 25%|█████████████████████████▋                                                                            | 35/139 [00:03<00:05, 20.46it/s] 27%|███████████████████████████▉                                                                          | 38/139 [00:03<00:04, 20.97it/s] 29%|██████████████████████████████                                                                        | 41/139 [00:03<00:04, 21.27it/s] 32%|████████████████████████████████▎                                                                     | 44/139 [00:04<00:04, 21.26it/s] 34%|██████████████████████████████████▍                                                                   | 47/139 [00:04<00:04, 21.28it/s][2025-03-28 01:13:47,717] [INFO] [logging.py:128:log_dist] [Rank 0] step=50, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:13:47,718] [INFO] [timer.py:264:stop] epoch=0/micro_step=50/global_step=50, RunningAvgSamplesPerSec=19.349029317355882, CurrSamplesPerSec=23.085176315760542, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 36%|████████████████████████████████████▋                                                                 | 50/139 [00:04<00:04, 21.41it/s] 38%|██████████████████████████████████████▉                                                               | 53/139 [00:04<00:03, 21.55it/s] 40%|█████████████████████████████████████████                                                             | 56/139 [00:04<00:03, 21.73it/s] 42%|███████████████████████████████████████████▎                                                          | 59/139 [00:04<00:03, 21.79it/s] 45%|█████████████████████████████████████████████▍                                                        | 62/139 [00:04<00:03, 21.89it/s] 47%|███████████████████████████████████████████████▋                                                      | 65/139 [00:05<00:03, 21.86it/s] 49%|█████████████████████████████████████████████████▉                                                    | 68/139 [00:05<00:03, 21.76it/s] 51%|████████████████████████████████████████████████████                                                  | 71/139 [00:05<00:03, 21.64it/s] 53%|██████████████████████████████████████████████████████▎                                               | 74/139 [00:05<00:02, 21.74it/s] 55%|████████████████████████████████████████████████████████▌                                             | 77/139 [00:05<00:02, 21.25it/s] 58%|██████████████████████████████████████████████████████████▋                                           | 80/139 [00:05<00:02, 20.92it/s] 60%|████████████████████████████████████████████████████████████▉                                         | 83/139 [00:05<00:02, 21.08it/s] 62%|███████████████████████████████████████████████████████████████                                       | 86/139 [00:06<00:02, 21.26it/s] 64%|█████████████████████████████████████████████████████████████████▎                                    | 89/139 [00:06<00:02, 20.95it/s] 66%|███████████████████████████████████████████████████████████████████▌                                  | 92/139 [00:06<00:02, 20.32it/s] 68%|█████████████████████████████████████████████████████████████████████▋                                | 95/139 [00:06<00:02, 19.71it/s] 71%|███████████████████████████████████████████████████████████████████████▉                              | 98/139 [00:06<00:02, 19.77it/s][2025-03-28 01:13:50,115] [INFO] [logging.py:128:log_dist] [Rank 0] step=100, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:13:50,116] [INFO] [timer.py:264:stop] epoch=0/micro_step=100/global_step=100, RunningAvgSamplesPerSec=20.111204730966108, CurrSamplesPerSec=19.6959886405886, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 72%|████████████████████████████████████████████████████████████████████████▋                            | 100/139 [00:06<00:01, 19.63it/s] 74%|██████████████████████████████████████████████████████████████████████████▊                          | 103/139 [00:06<00:01, 19.73it/s] 76%|█████████████████████████████████████████████████████████████████████████████                        | 106/139 [00:07<00:01, 19.94it/s] 78%|███████████████████████████████████████████████████████████████████████████████▏                     | 109/139 [00:07<00:01, 20.32it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▍                   | 112/139 [00:07<00:01, 20.43it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▌                 | 115/139 [00:07<00:01, 20.60it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▋               | 118/139 [00:07<00:01, 20.89it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▉             | 121/139 [00:07<00:00, 20.99it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████           | 124/139 [00:07<00:00, 20.80it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████████▎        | 127/139 [00:08<00:00, 20.81it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▍      | 130/139 [00:08<00:00, 20.77it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▋    | 133/139 [00:08<00:00, 20.49it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▊  | 136/139 [00:08<00:00, 20.72it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 139/139 [00:08<00:00, 20.48it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 139/139 [00:08<00:00, 15.97it/s]
/hpc2hdd/home/yli045/diffusion_noise_agent/train.py:189: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  df = pd.concat([df, pd.DataFrame([new_row])], ignore_index=True) # 使用 pd.concat 追加数据
  0%|                                                                                                               | 0/139 [00:00<?, ?it/s]  1%|▋                                                                                                      | 1/139 [00:00<00:39,  3.48it/s]  3%|██▉                                                                                                    | 4/139 [00:00<00:12, 10.64it/s]  5%|█████▏                                                                                                 | 7/139 [00:00<00:09, 14.15it/s]  7%|███████▎                                                                                              | 10/139 [00:00<00:08, 16.06it/s][2025-03-28 01:13:52,872] [INFO] [logging.py:128:log_dist] [Rank 0] step=150, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:13:52,876] [INFO] [timer.py:264:stop] epoch=0/micro_step=150/global_step=150, RunningAvgSamplesPerSec=19.76544081451485, CurrSamplesPerSec=20.149791909984977, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
  9%|████████▊                                                                                             | 12/139 [00:00<00:07, 16.78it/s] 10%|██████████▎                                                                                           | 14/139 [00:00<00:07, 17.37it/s] 12%|███████████▋                                                                                          | 16/139 [00:01<00:06, 18.04it/s] 13%|█████████████▏                                                                                        | 18/139 [00:01<00:06, 18.36it/s] 14%|██████████████▋                                                                                       | 20/139 [00:01<00:06, 18.65it/s] 16%|████████████████▏                                                                                     | 22/139 [00:01<00:06, 18.68it/s] 17%|█████████████████▌                                                                                    | 24/139 [00:01<00:06, 18.89it/s] 19%|███████████████████                                                                                   | 26/139 [00:01<00:05, 19.20it/s] 20%|████████████████████▌                                                                                 | 28/139 [00:01<00:05, 19.43it/s] 22%|██████████████████████                                                                                | 30/139 [00:01<00:05, 19.43it/s] 23%|███████████████████████▍                                                                              | 32/139 [00:01<00:05, 19.46it/s] 24%|████████████████████████▉                                                                             | 34/139 [00:01<00:05, 19.53it/s] 26%|██████████████████████████▍                                                                           | 36/139 [00:02<00:05, 19.39it/s] 27%|███████████████████████████▉                                                                          | 38/139 [00:02<00:05, 19.40it/s] 29%|█████████████████████████████▎                                                                        | 40/139 [00:02<00:05, 19.20it/s] 30%|██████████████████████████████▊                                                                       | 42/139 [00:02<00:05, 19.38it/s] 32%|████████████████████████████████▎                                                                     | 44/139 [00:02<00:04, 19.02it/s] 33%|█████████████████████████████████▊                                                                    | 46/139 [00:02<00:04, 18.97it/s] 35%|███████████████████████████████████▏                                                                  | 48/139 [00:02<00:04, 18.95it/s] 36%|████████████████████████████████████▋                                                                 | 50/139 [00:02<00:04, 18.97it/s] 37%|██████████████████████████████████████▏                                                               | 52/139 [00:02<00:04, 19.07it/s] 39%|███████████████████████████████████████▋                                                              | 54/139 [00:03<00:04, 18.86it/s] 40%|█████████████████████████████████████████                                                             | 56/139 [00:03<00:04, 18.99it/s] 42%|██████████████████████████████████████████▌                                                           | 58/139 [00:03<00:04, 19.19it/s] 43%|████████████████████████████████████████████                                                          | 60/139 [00:03<00:04, 19.24it/s][2025-03-28 01:13:55,473] [INFO] [logging.py:128:log_dist] [Rank 0] step=200, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:13:55,477] [INFO] [timer.py:264:stop] epoch=0/micro_step=200/global_step=200, RunningAvgSamplesPerSec=19.638798873071195, CurrSamplesPerSec=19.717006317578115, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 45%|█████████████████████████████████████████████▍                                                        | 62/139 [00:03<00:03, 19.33it/s] 47%|███████████████████████████████████████████████▋                                                      | 65/139 [00:03<00:03, 19.60it/s] 48%|█████████████████████████████████████████████████▏                                                    | 67/139 [00:03<00:03, 19.60it/s] 50%|██████████████████████████████████████████████████▋                                                   | 69/139 [00:03<00:03, 19.26it/s] 51%|████████████████████████████████████████████████████                                                  | 71/139 [00:03<00:03, 19.15it/s] 53%|█████████████████████████████████████████████████████▌                                                | 73/139 [00:04<00:03, 19.12it/s] 54%|███████████████████████████████████████████████████████                                               | 75/139 [00:04<00:03, 19.19it/s] 55%|████████████████████████████████████████████████████████▌                                             | 77/139 [00:04<00:03, 19.09it/s] 57%|█████████████████████████████████████████████████████████▉                                            | 79/139 [00:04<00:03, 18.97it/s] 58%|███████████████████████████████████████████████████████████▍                                          | 81/139 [00:04<00:03, 18.77it/s] 60%|████████████████████████████████████████████████████████████▉                                         | 83/139 [00:04<00:02, 18.80it/s] 61%|██████████████████████████████████████████████████████████████▎                                       | 85/139 [00:04<00:02, 18.47it/s] 63%|███████████████████████████████████████████████████████████████▊                                      | 87/139 [00:04<00:02, 18.55it/s] 64%|█████████████████████████████████████████████████████████████████▎                                    | 89/139 [00:04<00:02, 18.50it/s] 65%|██████████████████████████████████████████████████████████████████▊                                   | 91/139 [00:04<00:02, 18.29it/s] 67%|████████████████████████████████████████████████████████████████████▏                                 | 93/139 [00:05<00:02, 18.45it/s] 68%|█████████████████████████████████████████████████████████████████████▋                                | 95/139 [00:05<00:02, 18.76it/s] 70%|███████████████████████████████████████████████████████████████████████▏                              | 97/139 [00:05<00:02, 18.63it/s] 71%|████████████████████████████████████████████████████████████████████████▋                             | 99/139 [00:05<00:02, 18.77it/s] 73%|█████████████████████████████████████████████████████████████████████████▍                           | 101/139 [00:05<00:02, 18.70it/s] 74%|██████████████████████████████████████████████████████████████████████████▊                          | 103/139 [00:05<00:01, 18.55it/s] 76%|████████████████████████████████████████████████████████████████████████████▎                        | 105/139 [00:05<00:01, 18.26it/s] 77%|█████████████████████████████████████████████████████████████████████████████▋                       | 107/139 [00:05<00:01, 18.35it/s] 78%|███████████████████████████████████████████████████████████████████████████████▏                     | 109/139 [00:05<00:01, 18.18it/s][2025-03-28 01:13:58,153] [INFO] [logging.py:128:log_dist] [Rank 0] step=250, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:13:58,157] [INFO] [timer.py:264:stop] epoch=0/micro_step=250/global_step=250, RunningAvgSamplesPerSec=19.44140172373796, CurrSamplesPerSec=17.794099360388767, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 80%|████████████████████████████████████████████████████████████████████████████████▋                    | 111/139 [00:06<00:01, 18.07it/s] 81%|██████████████████████████████████████████████████████████████████████████████████                   | 113/139 [00:06<00:01, 17.98it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▌                 | 115/139 [00:06<00:01, 18.07it/s] 84%|█████████████████████████████████████████████████████████████████████████████████████                | 117/139 [00:06<00:01, 18.10it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▍              | 119/139 [00:06<00:01, 18.08it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▉             | 121/139 [00:06<00:00, 18.42it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████████▎           | 123/139 [00:06<00:00, 18.11it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▊          | 125/139 [00:06<00:00, 18.01it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████████▎        | 127/139 [00:06<00:00, 18.37it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▋       | 129/139 [00:07<00:00, 18.25it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▏     | 131/139 [00:07<00:00, 18.38it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▋    | 133/139 [00:07<00:00, 18.29it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████████   | 135/139 [00:07<00:00, 18.30it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▌ | 137/139 [00:07<00:00, 18.28it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 139/139 [00:07<00:00, 18.30it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 139/139 [00:07<00:00, 18.15it/s]
  0%|                                                                                                               | 0/139 [00:00<?, ?it/s]  1%|▋                                                                                                      | 1/139 [00:00<00:35,  3.83it/s]  2%|██▏                                                                                                    | 3/139 [00:00<00:14,  9.27it/s]  4%|████▍                                                                                                  | 6/139 [00:00<00:09, 13.93it/s]  6%|█████▉                                                                                                 | 8/139 [00:00<00:08, 15.21it/s]  7%|███████▎                                                                                              | 10/139 [00:00<00:07, 16.26it/s]  9%|████████▊                                                                                             | 12/139 [00:00<00:07, 16.78it/s] 10%|██████████▎                                                                                           | 14/139 [00:00<00:07, 17.05it/s] 12%|███████████▋                                                                                          | 16/139 [00:01<00:07, 16.76it/s] 13%|█████████████▏                                                                                        | 18/139 [00:01<00:07, 17.25it/s] 14%|██████████████▋                                                                                       | 20/139 [00:01<00:06, 17.35it/s][2025-03-28 01:14:01,204] [INFO] [logging.py:128:log_dist] [Rank 0] step=300, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:14:01,207] [INFO] [timer.py:264:stop] epoch=0/micro_step=300/global_step=300, RunningAvgSamplesPerSec=19.056468350212736, CurrSamplesPerSec=17.595609304376058, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 16%|████████████████▏                                                                                     | 22/139 [00:01<00:06, 17.42it/s] 17%|█████████████████▌                                                                                    | 24/139 [00:01<00:06, 17.60it/s] 19%|███████████████████                                                                                   | 26/139 [00:01<00:06, 17.76it/s] 21%|█████████████████████▎                                                                                | 29/139 [00:01<00:05, 18.39it/s] 22%|██████████████████████▋                                                                               | 31/139 [00:01<00:05, 18.43it/s] 24%|████████████████████████▏                                                                             | 33/139 [00:02<00:05, 18.34it/s] 25%|█████████████████████████▋                                                                            | 35/139 [00:02<00:05, 18.27it/s] 27%|███████████████████████████▏                                                                          | 37/139 [00:02<00:05, 18.23it/s] 28%|████████████████████████████▌                                                                         | 39/139 [00:02<00:05, 18.01it/s] 29%|██████████████████████████████                                                                        | 41/139 [00:02<00:05, 17.90it/s] 31%|███████████████████████████████▌                                                                      | 43/139 [00:02<00:05, 17.84it/s] 32%|█████████████████████████████████                                                                     | 45/139 [00:02<00:05, 17.83it/s] 34%|██████████████████████████████████▍                                                                   | 47/139 [00:02<00:05, 17.98it/s] 35%|███████████████████████████████████▉                                                                  | 49/139 [00:02<00:05, 17.87it/s] 37%|█████████████████████████████████████▍                                                                | 51/139 [00:03<00:04, 17.95it/s] 38%|██████████████████████████████████████▉                                                               | 53/139 [00:03<00:04, 18.05it/s] 40%|████████████████████████████████████████▎                                                             | 55/139 [00:03<00:04, 17.94it/s] 41%|█████████████████████████████████████████▊                                                            | 57/139 [00:03<00:04, 18.07it/s] 42%|███████████████████████████████████████████▎                                                          | 59/139 [00:03<00:04, 17.89it/s] 44%|████████████████████████████████████████████▊                                                         | 61/139 [00:03<00:04, 18.09it/s] 45%|██████████████████████████████████████████████▏                                                       | 63/139 [00:03<00:04, 18.13it/s] 47%|███████████████████████████████████████████████▋                                                      | 65/139 [00:03<00:04, 18.08it/s] 48%|█████████████████████████████████████████████████▏                                                    | 67/139 [00:03<00:03, 18.10it/s] 50%|██████████████████████████████████████████████████▋                                                   | 69/139 [00:04<00:03, 18.29it/s] 51%|████████████████████████████████████████████████████                                                  | 71/139 [00:04<00:03, 18.53it/s][2025-03-28 01:14:03,956] [INFO] [logging.py:128:log_dist] [Rank 0] step=350, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:14:03,958] [INFO] [timer.py:264:stop] epoch=0/micro_step=350/global_step=350, RunningAvgSamplesPerSec=18.931944367792507, CurrSamplesPerSec=18.74907963085121, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 53%|█████████████████████████████████████████████████████▌                                                | 73/139 [00:04<00:03, 18.52it/s] 54%|███████████████████████████████████████████████████████                                               | 75/139 [00:04<00:03, 18.30it/s] 55%|████████████████████████████████████████████████████████▌                                             | 77/139 [00:04<00:03, 18.18it/s] 57%|█████████████████████████████████████████████████████████▉                                            | 79/139 [00:04<00:03, 18.09it/s] 58%|███████████████████████████████████████████████████████████▍                                          | 81/139 [00:04<00:03, 17.99it/s] 60%|████████████████████████████████████████████████████████████▉                                         | 83/139 [00:04<00:03, 17.95it/s] 61%|██████████████████████████████████████████████████████████████▎                                       | 85/139 [00:04<00:03, 17.88it/s] 63%|███████████████████████████████████████████████████████████████▊                                      | 87/139 [00:05<00:02, 17.79it/s] 64%|█████████████████████████████████████████████████████████████████▎                                    | 89/139 [00:05<00:02, 18.02it/s] 65%|██████████████████████████████████████████████████████████████████▊                                   | 91/139 [00:05<00:02, 18.01it/s] 67%|████████████████████████████████████████████████████████████████████▏                                 | 93/139 [00:05<00:02, 18.05it/s] 68%|█████████████████████████████████████████████████████████████████████▋                                | 95/139 [00:05<00:02, 18.22it/s] 70%|███████████████████████████████████████████████████████████████████████▏                              | 97/139 [00:05<00:02, 18.17it/s] 71%|████████████████████████████████████████████████████████████████████████▋                             | 99/139 [00:05<00:02, 17.94it/s] 73%|█████████████████████████████████████████████████████████████████████████▍                           | 101/139 [00:05<00:02, 18.03it/s] 74%|██████████████████████████████████████████████████████████████████████████▊                          | 103/139 [00:05<00:01, 18.00it/s] 76%|████████████████████████████████████████████████████████████████████████████▎                        | 105/139 [00:06<00:01, 17.96it/s] 77%|█████████████████████████████████████████████████████████████████████████████▋                       | 107/139 [00:06<00:01, 17.95it/s] 78%|███████████████████████████████████████████████████████████████████████████████▏                     | 109/139 [00:06<00:01, 18.02it/s] 80%|████████████████████████████████████████████████████████████████████████████████▋                    | 111/139 [00:06<00:01, 17.90it/s] 81%|██████████████████████████████████████████████████████████████████████████████████                   | 113/139 [00:06<00:01, 17.85it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▌                 | 115/139 [00:06<00:01, 17.40it/s] 84%|█████████████████████████████████████████████████████████████████████████████████████                | 117/139 [00:06<00:01, 17.50it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▍              | 119/139 [00:06<00:01, 17.75it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▉             | 121/139 [00:06<00:01, 17.69it/s][2025-03-28 01:14:06,750] [INFO] [logging.py:128:log_dist] [Rank 0] step=400, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:14:06,754] [INFO] [timer.py:264:stop] epoch=0/micro_step=400/global_step=400, RunningAvgSamplesPerSec=18.79898040435624, CurrSamplesPerSec=18.364962964517247, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 88%|█████████████████████████████████████████████████████████████████████████████████████████▎           | 123/139 [00:07<00:00, 17.87it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▊          | 125/139 [00:07<00:00, 17.88it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████████▎        | 127/139 [00:07<00:00, 17.98it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▋       | 129/139 [00:07<00:00, 17.98it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▏     | 131/139 [00:07<00:00, 17.41it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▋    | 133/139 [00:07<00:00, 16.80it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████████   | 135/139 [00:07<00:00, 17.10it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▌ | 137/139 [00:07<00:00, 17.34it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 139/139 [00:07<00:00, 17.53it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 139/139 [00:07<00:00, 17.38it/s]
  0%|                                                                                                               | 0/139 [00:00<?, ?it/s]  1%|▋                                                                                                      | 1/139 [00:00<00:35,  3.92it/s]  2%|██▏                                                                                                    | 3/139 [00:00<00:14,  9.24it/s]  4%|███▋                                                                                                   | 5/139 [00:00<00:10, 12.25it/s]  5%|█████▏                                                                                                 | 7/139 [00:00<00:09, 14.07it/s]  6%|██████▋                                                                                                | 9/139 [00:00<00:08, 15.21it/s]  8%|████████                                                                                              | 11/139 [00:00<00:08, 15.97it/s]  9%|█████████▌                                                                                            | 13/139 [00:00<00:07, 16.50it/s] 11%|███████████                                                                                           | 15/139 [00:01<00:07, 16.85it/s] 12%|████████████▍                                                                                         | 17/139 [00:01<00:07, 17.03it/s] 14%|█████████████▉                                                                                        | 19/139 [00:01<00:07, 16.98it/s] 15%|███████████████▍                                                                                      | 21/139 [00:01<00:06, 17.10it/s] 17%|████████████████▉                                                                                     | 23/139 [00:01<00:06, 17.18it/s] 18%|██████████████████▎                                                                                   | 25/139 [00:01<00:06, 17.32it/s] 19%|███████████████████▊                                                                                  | 27/139 [00:01<00:06, 17.57it/s] 21%|█████████████████████▎                                                                                | 29/139 [00:01<00:06, 17.88it/s] 22%|██████████████████████▋                                                                               | 31/139 [00:01<00:06, 17.85it/s][2025-03-28 01:14:09,892] [INFO] [logging.py:128:log_dist] [Rank 0] step=450, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:14:09,896] [INFO] [timer.py:264:stop] epoch=0/micro_step=450/global_step=450, RunningAvgSamplesPerSec=18.54709946201959, CurrSamplesPerSec=16.91482184405304, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 24%|████████████████████████▏                                                                             | 33/139 [00:02<00:05, 17.70it/s] 25%|█████████████████████████▋                                                                            | 35/139 [00:02<00:05, 17.62it/s] 27%|███████████████████████████▏                                                                          | 37/139 [00:02<00:05, 17.60it/s] 28%|████████████████████████████▌                                                                         | 39/139 [00:02<00:05, 17.87it/s] 29%|██████████████████████████████                                                                        | 41/139 [00:02<00:05, 17.87it/s] 31%|███████████████████████████████▌                                                                      | 43/139 [00:02<00:05, 17.92it/s] 32%|█████████████████████████████████                                                                     | 45/139 [00:02<00:05, 18.03it/s] 34%|██████████████████████████████████▍                                                                   | 47/139 [00:02<00:05, 17.83it/s] 35%|███████████████████████████████████▉                                                                  | 49/139 [00:02<00:05, 17.83it/s] 37%|█████████████████████████████████████▍                                                                | 51/139 [00:03<00:04, 18.14it/s] 38%|██████████████████████████████████████▉                                                               | 53/139 [00:03<00:04, 18.20it/s] 40%|████████████████████████████████████████▎                                                             | 55/139 [00:03<00:04, 18.24it/s] 41%|█████████████████████████████████████████▊                                                            | 57/139 [00:03<00:04, 18.45it/s] 43%|████████████████████████████████████████████                                                          | 60/139 [00:03<00:04, 19.14it/s] 45%|█████████████████████████████████████████████▍                                                        | 62/139 [00:03<00:04, 19.08it/s] 46%|██████████████████████████████████████████████▉                                                       | 64/139 [00:03<00:03, 19.01it/s] 47%|████████████████████████████████████████████████▍                                                     | 66/139 [00:03<00:03, 18.82it/s] 49%|█████████████████████████████████████████████████▉                                                    | 68/139 [00:03<00:03, 18.70it/s] 50%|███████████████████████████████████████████████████▎                                                  | 70/139 [00:04<00:03, 18.83it/s] 52%|████████████████████████████████████████████████████▊                                                 | 72/139 [00:04<00:03, 18.50it/s] 53%|██████████████████████████████████████████████████████▎                                               | 74/139 [00:04<00:03, 18.41it/s] 55%|███████████████████████████████████████████████████████▊                                              | 76/139 [00:04<00:03, 18.27it/s] 56%|█████████████████████████████████████████████████████████▏                                            | 78/139 [00:04<00:03, 18.33it/s] 58%|██████████████████████████████████████████████████████████▋                                           | 80/139 [00:04<00:03, 18.47it/s] 59%|████████████████████████████████████████████████████████████▏                                         | 82/139 [00:04<00:03, 17.92it/s][2025-03-28 01:14:12,623] [INFO] [logging.py:128:log_dist] [Rank 0] step=500, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:14:12,627] [INFO] [timer.py:264:stop] epoch=0/micro_step=500/global_step=500, RunningAvgSamplesPerSec=18.52726975760659, CurrSamplesPerSec=18.09932114383271, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 60%|█████████████████████████████████████████████████████████████▋                                        | 84/139 [00:04<00:03, 18.01it/s] 62%|███████████████████████████████████████████████████████████████                                       | 86/139 [00:04<00:02, 18.02it/s] 63%|████████████████████████████████████████████████████████████████▌                                     | 88/139 [00:05<00:02, 18.23it/s] 65%|██████████████████████████████████████████████████████████████████                                    | 90/139 [00:05<00:02, 17.92it/s] 66%|███████████████████████████████████████████████████████████████████▌                                  | 92/139 [00:05<00:04, 11.05it/s] 68%|████████████████████████████████████████████████████████████████████▉                                 | 94/139 [00:05<00:03, 12.58it/s] 70%|███████████████████████████████████████████████████████████████████████▏                              | 97/139 [00:05<00:02, 14.90it/s] 72%|████████████████████████████████████████████████████████████████████████▋                            | 100/139 [00:05<00:02, 16.86it/s] 74%|██████████████████████████████████████████████████████████████████████████▊                          | 103/139 [00:06<00:02, 17.75it/s] 76%|█████████████████████████████████████████████████████████████████████████████                        | 106/139 [00:06<00:01, 19.21it/s] 78%|███████████████████████████████████████████████████████████████████████████████▏                     | 109/139 [00:06<00:01, 20.34it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▍                   | 112/139 [00:06<00:01, 20.05it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▌                 | 115/139 [00:06<00:01, 20.46it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▋               | 118/139 [00:06<00:00, 21.02it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▉             | 121/139 [00:06<00:00, 21.18it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████           | 124/139 [00:07<00:00, 21.19it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████████▎        | 127/139 [00:07<00:00, 19.57it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▍      | 130/139 [00:07<00:00, 20.14it/s][2025-03-28 01:14:15,326] [INFO] [logging.py:128:log_dist] [Rank 0] step=550, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:14:15,327] [INFO] [timer.py:264:stop] epoch=0/micro_step=550/global_step=550, RunningAvgSamplesPerSec=18.53087104983212, CurrSamplesPerSec=20.07725936253373, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 96%|████████████████████████████████████████████████████████████████████████████████████████████████▋    | 133/139 [00:07<00:00, 20.34it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▊  | 136/139 [00:07<00:00, 20.70it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 139/139 [00:07<00:00, 21.05it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 139/139 [00:07<00:00, 17.74it/s]
  0%|                                                                                                               | 0/139 [00:00<?, ?it/s]  1%|▋                                                                                                      | 1/139 [00:00<01:55,  1.20it/s]  1%|█▍                                                                                                     | 2/139 [00:01<01:52,  1.22it/s]  2%|██▏                                                                                                    | 3/139 [00:02<01:50,  1.23it/s]  3%|██▉                                                                                                    | 4/139 [00:02<01:27,  1.54it/s]  4%|███▋                                                                                                   | 5/139 [00:03<01:05,  2.06it/s]  5%|█████▏                                                                                                 | 7/139 [00:03<00:35,  3.76it/s]  7%|███████▎                                                                                              | 10/139 [00:03<00:19,  6.56it/s]  9%|█████████▌                                                                                            | 13/139 [00:03<00:13,  9.51it/s] 12%|███████████▋                                                                                          | 16/139 [00:03<00:10, 12.23it/s] 14%|█████████████▉                                                                                        | 19/139 [00:03<00:08, 14.47it/s] 16%|████████████████▏                                                                                     | 22/139 [00:03<00:07, 16.14it/s] 17%|█████████████████▌                                                                                    | 24/139 [00:03<00:06, 16.76it/s] 19%|███████████████████▊                                                                                  | 27/139 [00:04<00:06, 18.29it/s] 22%|██████████████████████                                                                                | 30/139 [00:04<00:05, 18.29it/s] 23%|███████████████████████▍                                                                              | 32/139 [00:04<00:05, 18.42it/s] 25%|█████████████████████████▋                                                                            | 35/139 [00:04<00:05, 19.14it/s] 27%|███████████████████████████▉                                                                          | 38/139 [00:04<00:05, 20.06it/s] 29%|██████████████████████████████                                                                        | 41/139 [00:04<00:04, 20.34it/s][2025-03-28 01:14:20,605] [INFO] [logging.py:128:log_dist] [Rank 0] step=600, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:14:20,607] [INFO] [timer.py:264:stop] epoch=0/micro_step=600/global_step=600, RunningAvgSamplesPerSec=17.242439745130508, CurrSamplesPerSec=21.251918416846507, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 32%|████████████████████████████████▎                                                                     | 44/139 [00:04<00:04, 20.74it/s] 34%|██████████████████████████████████▍                                                                   | 47/139 [00:05<00:04, 20.64it/s] 36%|████████████████████████████████████▋                                                                 | 50/139 [00:05<00:04, 20.72it/s] 38%|██████████████████████████████████████▉                                                               | 53/139 [00:05<00:04, 21.33it/s] 40%|█████████████████████████████████████████                                                             | 56/139 [00:05<00:03, 21.79it/s] 42%|███████████████████████████████████████████▎                                                          | 59/139 [00:05<00:03, 21.44it/s] 45%|█████████████████████████████████████████████▍                                                        | 62/139 [00:05<00:03, 21.59it/s] 47%|███████████████████████████████████████████████▋                                                      | 65/139 [00:05<00:03, 21.70it/s] 49%|█████████████████████████████████████████████████▉                                                    | 68/139 [00:06<00:03, 21.78it/s] 51%|████████████████████████████████████████████████████                                                  | 71/139 [00:06<00:03, 21.71it/s] 53%|██████████████████████████████████████████████████████▎                                               | 74/139 [00:06<00:03, 21.64it/s] 55%|████████████████████████████████████████████████████████▌                                             | 77/139 [00:06<00:02, 21.88it/s] 58%|██████████████████████████████████████████████████████████▋                                           | 80/139 [00:06<00:02, 21.89it/s] 60%|████████████████████████████████████████████████████████████▉                                         | 83/139 [00:06<00:02, 21.74it/s] 62%|███████████████████████████████████████████████████████████████                                       | 86/139 [00:06<00:02, 21.74it/s] 64%|█████████████████████████████████████████████████████████████████▎                                    | 89/139 [00:06<00:02, 21.73it/s] 66%|███████████████████████████████████████████████████████████████████▌                                  | 92/139 [00:07<00:02, 21.69it/s][2025-03-28 01:14:22,911] [INFO] [logging.py:128:log_dist] [Rank 0] step=650, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:14:22,914] [INFO] [timer.py:264:stop] epoch=0/micro_step=650/global_step=650, RunningAvgSamplesPerSec=17.521278280776787, CurrSamplesPerSec=20.527691369528082, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 68%|█████████████████████████████████████████████████████████████████████▋                                | 95/139 [00:07<00:02, 21.52it/s] 71%|███████████████████████████████████████████████████████████████████████▉                              | 98/139 [00:07<00:01, 21.48it/s] 73%|█████████████████████████████████████████████████████████████████████████▍                           | 101/139 [00:07<00:01, 21.33it/s] 75%|███████████████████████████████████████████████████████████████████████████▌                         | 104/139 [00:07<00:01, 22.12it/s] 77%|█████████████████████████████████████████████████████████████████████████████▋                       | 107/139 [00:07<00:01, 22.83it/s] 79%|███████████████████████████████████████████████████████████████████████████████▉                     | 110/139 [00:07<00:01, 23.10it/s] 81%|██████████████████████████████████████████████████████████████████████████████████                   | 113/139 [00:08<00:01, 22.88it/s] 83%|████████████████████████████████████████████████████████████████████████████████████▎                | 116/139 [00:08<00:01, 22.09it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▍              | 119/139 [00:08<00:00, 21.75it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▋            | 122/139 [00:08<00:00, 21.49it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▊          | 125/139 [00:08<00:00, 21.60it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████        | 128/139 [00:08<00:00, 21.06it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▏     | 131/139 [00:08<00:00, 21.07it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████▎   | 134/139 [00:09<00:00, 20.81it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▌ | 137/139 [00:09<00:00, 20.77it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 139/139 [00:09<00:00, 14.87it/s]
  0%|                                                                                                               | 0/139 [00:00<?, ?it/s]  1%|▋                                                                                                      | 1/139 [00:00<00:30,  4.53it/s]  2%|██▏                                                                                                    | 3/139 [00:00<00:12, 10.51it/s][2025-03-28 01:14:25,514] [INFO] [logging.py:128:log_dist] [Rank 0] step=700, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:14:25,516] [INFO] [timer.py:264:stop] epoch=0/micro_step=700/global_step=700, RunningAvgSamplesPerSec=17.70854919481841, CurrSamplesPerSec=21.915051240237858, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
  4%|████▍                                                                                                  | 6/139 [00:00<00:08, 15.29it/s]  6%|██████▋                                                                                                | 9/139 [00:00<00:12, 10.75it/s]  8%|████████                                                                                              | 11/139 [00:00<00:10, 12.35it/s] 10%|██████████▎                                                                                           | 14/139 [00:01<00:08, 14.33it/s] 12%|████████████▍                                                                                         | 17/139 [00:01<00:07, 16.14it/s] 14%|█████████████▉                                                                                        | 19/139 [00:01<00:07, 16.57it/s] 16%|████████████████▏                                                                                     | 22/139 [00:01<00:06, 17.44it/s] 17%|█████████████████▌                                                                                    | 24/139 [00:01<00:06, 17.43it/s] 19%|███████████████████                                                                                   | 26/139 [00:01<00:06, 17.95it/s] 20%|████████████████████▌                                                                                 | 28/139 [00:01<00:06, 18.43it/s] 22%|██████████████████████▋                                                                               | 31/139 [00:01<00:05, 19.35it/s] 24%|████████████████████████▉                                                                             | 34/139 [00:02<00:05, 20.23it/s] 27%|███████████████████████████▏                                                                          | 37/139 [00:02<00:04, 20.67it/s] 29%|█████████████████████████████▎                                                                        | 40/139 [00:02<00:04, 21.07it/s] 31%|███████████████████████████████▌                                                                      | 43/139 [00:02<00:04, 20.96it/s] 33%|█████████████████████████████████▊                                                                    | 46/139 [00:02<00:04, 20.88it/s] 35%|███████████████████████████████████▉                                                                  | 49/139 [00:02<00:04, 20.53it/s] 37%|██████████████████████████████████████▏                                                               | 52/139 [00:02<00:04, 21.00it/s][2025-03-28 01:14:28,186] [INFO] [logging.py:128:log_dist] [Rank 0] step=750, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:14:28,186] [INFO] [timer.py:264:stop] epoch=0/micro_step=750/global_step=750, RunningAvgSamplesPerSec=17.77587240133258, CurrSamplesPerSec=23.58680165213971, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 40%|████████████████████████████████████████▎                                                             | 55/139 [00:03<00:03, 21.74it/s] 42%|██████████████████████████████████████████▌                                                           | 58/139 [00:03<00:03, 21.88it/s] 44%|████████████████████████████████████████████▊                                                         | 61/139 [00:03<00:03, 21.81it/s] 46%|██████████████████████████████████████████████▉                                                       | 64/139 [00:03<00:03, 20.68it/s] 48%|█████████████████████████████████████████████████▏                                                    | 67/139 [00:03<00:03, 20.10it/s] 50%|███████████████████████████████████████████████████▎                                                  | 70/139 [00:03<00:03, 20.56it/s] 53%|█████████████████████████████████████████████████████▌                                                | 73/139 [00:03<00:03, 21.32it/s] 55%|███████████████████████████████████████████████████████▊                                              | 76/139 [00:04<00:03, 20.66it/s] 57%|█████████████████████████████████████████████████████████▉                                            | 79/139 [00:04<00:02, 21.06it/s] 59%|████████████████████████████████████████████████████████████▏                                         | 82/139 [00:04<00:02, 21.28it/s] 61%|██████████████████████████████████████████████████████████████▎                                       | 85/139 [00:04<00:02, 20.53it/s] 63%|████████████████████████████████████████████████████████████████▌                                     | 88/139 [00:04<00:02, 19.56it/s] 65%|██████████████████████████████████████████████████████████████████                                    | 90/139 [00:04<00:02, 19.45it/s] 67%|████████████████████████████████████████████████████████████████████▏                                 | 93/139 [00:04<00:02, 19.90it/s] 69%|██████████████████████████████████████████████████████████████████████▍                               | 96/139 [00:05<00:02, 20.31it/s] 71%|████████████████████████████████████████████████████████████████████████▋                             | 99/139 [00:05<00:02, 19.71it/s] 73%|██████████████████████████████████████████████████████████████████████████                           | 102/139 [00:05<00:01, 20.69it/s][2025-03-28 01:14:30,614] [INFO] [logging.py:128:log_dist] [Rank 0] step=800, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:14:30,615] [INFO] [timer.py:264:stop] epoch=0/micro_step=800/global_step=800, RunningAvgSamplesPerSec=17.9318326846825, CurrSamplesPerSec=22.96522357334603, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 76%|████████████████████████████████████████████████████████████████████████████▎                        | 105/139 [00:05<00:01, 21.41it/s] 78%|██████████████████████████████████████████████████████████████████████████████▍                      | 108/139 [00:05<00:01, 21.71it/s] 80%|████████████████████████████████████████████████████████████████████████████████▋                    | 111/139 [00:05<00:01, 21.24it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▊                  | 114/139 [00:05<00:01, 23.12it/s] 84%|█████████████████████████████████████████████████████████████████████████████████████                | 117/139 [00:06<00:00, 23.05it/s] 86%|███████████████████████████████████████████████████████████████████████████████████████▏             | 120/139 [00:06<00:00, 22.98it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████████▎           | 123/139 [00:06<00:00, 22.57it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▌         | 126/139 [00:06<00:00, 22.25it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▋       | 129/139 [00:06<00:00, 22.40it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▉     | 132/139 [00:06<00:00, 22.34it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████████   | 135/139 [00:06<00:00, 22.10it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████▎| 138/139 [00:06<00:00, 22.19it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 139/139 [00:07<00:00, 19.64it/s]
  0%|                                                                                                               | 0/139 [00:00<?, ?it/s]  1%|▋                                                                                                      | 1/139 [00:00<00:28,  4.78it/s]  3%|██▉                                                                                                    | 4/139 [00:00<00:10, 12.97it/s]  5%|█████▏                                                                                                 | 7/139 [00:00<00:07, 16.64it/s]  7%|███████▎                                                                                              | 10/139 [00:00<00:06, 18.51it/s]  9%|█████████▌                                                                                            | 13/139 [00:00<00:06, 19.79it/s][2025-03-28 01:14:33,099] [INFO] [logging.py:128:log_dist] [Rank 0] step=850, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:14:33,100] [INFO] [timer.py:264:stop] epoch=0/micro_step=850/global_step=850, RunningAvgSamplesPerSec=18.108304045019025, CurrSamplesPerSec=24.21944516404949, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 12%|███████████▋                                                                                          | 16/139 [00:00<00:05, 21.04it/s] 14%|█████████████▉                                                                                        | 19/139 [00:01<00:05, 21.73it/s] 16%|████████████████▏                                                                                     | 22/139 [00:01<00:05, 21.88it/s] 18%|██████████████████▎                                                                                   | 25/139 [00:01<00:05, 21.85it/s] 20%|████████████████████▌                                                                                 | 28/139 [00:01<00:05, 22.01it/s] 22%|██████████████████████▋                                                                               | 31/139 [00:01<00:04, 22.24it/s] 24%|████████████████████████▉                                                                             | 34/139 [00:01<00:04, 22.03it/s] 27%|███████████████████████████▏                                                                          | 37/139 [00:01<00:04, 21.95it/s] 29%|█████████████████████████████▎                                                                        | 40/139 [00:01<00:04, 21.98it/s] 31%|███████████████████████████████▌                                                                      | 43/139 [00:02<00:04, 21.27it/s] 33%|█████████████████████████████████▊                                                                    | 46/139 [00:02<00:04, 21.40it/s] 35%|███████████████████████████████████▉                                                                  | 49/139 [00:02<00:04, 20.68it/s] 37%|██████████████████████████████████████▏                                                               | 52/139 [00:02<00:04, 21.12it/s] 40%|████████████████████████████████████████▎                                                             | 55/139 [00:02<00:03, 21.61it/s] 42%|██████████████████████████████████████████▌                                                           | 58/139 [00:02<00:03, 22.36it/s] 44%|████████████████████████████████████████████▊                                                         | 61/139 [00:02<00:03, 22.71it/s] 46%|██████████████████████████████████████████████▉                                                       | 64/139 [00:03<00:03, 23.08it/s][2025-03-28 01:14:35,353] [INFO] [logging.py:128:log_dist] [Rank 0] step=900, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:14:35,354] [INFO] [timer.py:264:stop] epoch=0/micro_step=900/global_step=900, RunningAvgSamplesPerSec=18.29780633325429, CurrSamplesPerSec=23.959073378172217, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 48%|█████████████████████████████████████████████████▏                                                    | 67/139 [00:03<00:03, 23.33it/s] 50%|███████████████████████████████████████████████████▎                                                  | 70/139 [00:03<00:02, 23.45it/s] 53%|█████████████████████████████████████████████████████▌                                                | 73/139 [00:03<00:02, 23.51it/s] 55%|███████████████████████████████████████████████████████▊                                              | 76/139 [00:03<00:02, 23.47it/s] 57%|█████████████████████████████████████████████████████████▉                                            | 79/139 [00:03<00:02, 23.37it/s] 59%|████████████████████████████████████████████████████████████▏                                         | 82/139 [00:03<00:02, 23.29it/s] 61%|██████████████████████████████████████████████████████████████▎                                       | 85/139 [00:03<00:02, 22.98it/s] 63%|████████████████████████████████████████████████████████████████▌                                     | 88/139 [00:04<00:02, 22.71it/s] 65%|██████████████████████████████████████████████████████████████████▊                                   | 91/139 [00:04<00:02, 22.82it/s] 68%|████████████████████████████████████████████████████████████████████▉                                 | 94/139 [00:04<00:01, 23.05it/s] 70%|███████████████████████████████████████████████████████████████████████▏                              | 97/139 [00:04<00:01, 23.37it/s] 72%|████████████████████████████████████████████████████████████████████████▋                            | 100/139 [00:04<00:01, 23.53it/s] 74%|██████████████████████████████████████████████████████████████████████████▊                          | 103/139 [00:04<00:01, 23.75it/s] 76%|█████████████████████████████████████████████████████████████████████████████                        | 106/139 [00:04<00:01, 23.54it/s] 78%|███████████████████████████████████████████████████████████████████████████████▏                     | 109/139 [00:04<00:01, 22.47it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▍                   | 112/139 [00:05<00:01, 22.01it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▌                 | 115/139 [00:05<00:01, 22.14it/s][2025-03-28 01:14:37,535] [INFO] [logging.py:128:log_dist] [Rank 0] step=950, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:14:37,536] [INFO] [timer.py:264:stop] epoch=0/micro_step=950/global_step=950, RunningAvgSamplesPerSec=18.49615370311358, CurrSamplesPerSec=22.018477199442522, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 85%|█████████████████████████████████████████████████████████████████████████████████████▋               | 118/139 [00:05<00:00, 21.50it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▉             | 121/139 [00:05<00:00, 21.47it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████           | 124/139 [00:05<00:00, 20.95it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████████▎        | 127/139 [00:05<00:00, 21.03it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▍      | 130/139 [00:05<00:00, 21.21it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▋    | 133/139 [00:06<00:00, 20.56it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▊  | 136/139 [00:06<00:00, 20.42it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 139/139 [00:06<00:00, 20.62it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 139/139 [00:06<00:00, 21.37it/s]
  0%|                                                                                                               | 0/139 [00:00<?, ?it/s]  1%|▋                                                                                                      | 1/139 [00:00<00:24,  5.57it/s]  2%|██▏                                                                                                    | 3/139 [00:00<00:11, 11.45it/s]  4%|███▋                                                                                                   | 5/139 [00:00<00:09, 14.36it/s]  5%|█████▏                                                                                                 | 7/139 [00:00<00:08, 16.15it/s]  7%|███████▎                                                                                              | 10/139 [00:00<00:07, 17.72it/s]  9%|████████▊                                                                                             | 12/139 [00:00<00:06, 18.36it/s] 10%|██████████▎                                                                                           | 14/139 [00:00<00:06, 18.80it/s] 12%|████████████▍                                                                                         | 17/139 [00:00<00:06, 19.70it/s] 14%|██████████████▋                                                                                       | 20/139 [00:01<00:05, 20.00it/s] 17%|████████████████▉                                                                                     | 23/139 [00:01<00:05, 20.21it/s] 19%|███████████████████                                                                                   | 26/139 [00:01<00:05, 19.78it/s][2025-03-28 01:14:40,253] [INFO] [logging.py:128:log_dist] [Rank 0] step=1000, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:14:40,254] [INFO] [timer.py:264:stop] epoch=0/micro_step=1000/global_step=1000, RunningAvgSamplesPerSec=18.54923341239827, CurrSamplesPerSec=20.657607583489952, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 20%|████████████████████▌                                                                                 | 28/139 [00:01<00:05, 19.25it/s][2025-03-28 01:14:40,421] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
 22%|██████████████████████                                                                                | 30/139 [00:01<00:05, 19.23it/s][2025-03-28 01:14:40,467] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
 23%|███████████████████████▍                                                                              | 32/139 [00:01<00:05, 19.31it/s] 24%|████████████████████████▉                                                                             | 34/139 [00:01<00:05, 19.31it/s] 26%|██████████████████████████▍                                                                           | 36/139 [00:01<00:05, 19.35it/s] 27%|███████████████████████████▉                                                                          | 38/139 [00:02<00:05, 19.35it/s] 29%|██████████████████████████████                                                                        | 41/139 [00:02<00:04, 19.97it/s] 32%|████████████████████████████████▎                                                                     | 44/139 [00:02<00:04, 19.66it/s] 33%|█████████████████████████████████▊                                                                    | 46/139 [00:02<00:04, 18.70it/s] 35%|███████████████████████████████████▏                                                                  | 48/139 [00:02<00:04, 18.43it/s] 37%|█████████████████████████████████████▍                                                                | 51/139 [00:02<00:04, 18.70it/s] 38%|██████████████████████████████████████▉                                                               | 53/139 [00:02<00:04, 18.75it/s] 40%|████████████████████████████████████████▎                                                             | 55/139 [00:02<00:04, 18.43it/s] 41%|█████████████████████████████████████████▊                                                            | 57/139 [00:03<00:04, 18.24it/s] 43%|████████████████████████████████████████████                                                          | 60/139 [00:03<00:04, 18.60it/s] 45%|█████████████████████████████████████████████▍                                                        | 62/139 [00:03<00:04, 18.49it/s] 46%|██████████████████████████████████████████████▉                                                       | 64/139 [00:03<00:04, 17.76it/s] 47%|████████████████████████████████████████████████▍                                                     | 66/139 [00:03<00:04, 17.74it/s] 49%|█████████████████████████████████████████████████▉                                                    | 68/139 [00:03<00:04, 17.53it/s] 50%|███████████████████████████████████████████████████▎                                                  | 70/139 [00:03<00:03, 17.40it/s] 52%|████████████████████████████████████████████████████▊                                                 | 72/139 [00:03<00:03, 17.50it/s] 54%|███████████████████████████████████████████████████████                                               | 75/139 [00:04<00:03, 18.22it/s][2025-03-28 01:14:42,978] [INFO] [logging.py:128:log_dist] [Rank 0] step=1050, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:14:42,982] [INFO] [timer.py:264:stop] epoch=0/micro_step=1050/global_step=1050, RunningAvgSamplesPerSec=18.540425072771697, CurrSamplesPerSec=17.119175341321252, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 55%|████████████████████████████████████████████████████████▌                                             | 77/139 [00:04<00:03, 17.74it/s] 57%|█████████████████████████████████████████████████████████▉                                            | 79/139 [00:04<00:03, 17.76it/s] 58%|███████████████████████████████████████████████████████████▍                                          | 81/139 [00:04<00:03, 17.24it/s] 60%|████████████████████████████████████████████████████████████▉                                         | 83/139 [00:04<00:03, 17.37it/s] 61%|██████████████████████████████████████████████████████████████▎                                       | 85/139 [00:04<00:03, 16.50it/s] 63%|███████████████████████████████████████████████████████████████▊                                      | 87/139 [00:04<00:03, 16.82it/s] 64%|█████████████████████████████████████████████████████████████████▎                                    | 89/139 [00:04<00:02, 16.92it/s] 65%|██████████████████████████████████████████████████████████████████▊                                   | 91/139 [00:05<00:02, 17.15it/s] 67%|████████████████████████████████████████████████████████████████████▏                                 | 93/139 [00:05<00:02, 17.28it/s] 68%|█████████████████████████████████████████████████████████████████████▋                                | 95/139 [00:05<00:02, 17.56it/s] 71%|███████████████████████████████████████████████████████████████████████▉                              | 98/139 [00:05<00:02, 19.15it/s] 73%|█████████████████████████████████████████████████████████████████████████▍                           | 101/139 [00:05<00:01, 20.44it/s] 75%|███████████████████████████████████████████████████████████████████████████▌                         | 104/139 [00:05<00:01, 20.03it/s] 76%|█████████████████████████████████████████████████████████████████████████████                        | 106/139 [00:05<00:01, 19.23it/s] 78%|██████████████████████████████████████████████████████████████████████████████▍                      | 108/139 [00:05<00:01, 18.80it/s] 79%|███████████████████████████████████████████████████████████████████████████████▉                     | 110/139 [00:06<00:01, 18.65it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▍                   | 112/139 [00:06<00:01, 18.23it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▊                  | 114/139 [00:06<00:01, 17.94it/s] 83%|████████████████████████████████████████████████████████████████████████████████████▎                | 116/139 [00:06<00:01, 17.69it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▋               | 118/139 [00:06<00:01, 17.68it/s] 86%|███████████████████████████████████████████████████████████████████████████████████████▏             | 120/139 [00:06<00:01, 17.49it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▋            | 122/139 [00:06<00:00, 17.39it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████           | 124/139 [00:06<00:00, 17.84it/s][2025-03-28 01:14:45,733] [INFO] [logging.py:128:log_dist] [Rank 0] step=1100, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:14:45,733] [INFO] [timer.py:264:stop] epoch=0/micro_step=1100/global_step=1100, RunningAvgSamplesPerSec=18.525551827208943, CurrSamplesPerSec=21.697609419564213, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 91%|████████████████████████████████████████████████████████████████████████████████████████████▎        | 127/139 [00:06<00:00, 19.13it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▍      | 130/139 [00:07<00:00, 20.05it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▋    | 133/139 [00:07<00:00, 20.85it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▊  | 136/139 [00:07<00:00, 19.77it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████▎| 138/139 [00:07<00:00, 19.23it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 139/139 [00:07<00:00, 18.21it/s]
  0%|                                                                                                               | 0/139 [00:00<?, ?it/s]  1%|▋                                                                                                      | 1/139 [00:00<00:48,  2.84it/s]  2%|██▏                                                                                                    | 3/139 [00:00<00:18,  7.43it/s]  4%|███▋                                                                                                   | 5/139 [00:00<00:12, 10.47it/s]  6%|█████▉                                                                                                 | 8/139 [00:00<00:09, 14.20it/s]  7%|███████▎                                                                                              | 10/139 [00:00<00:08, 15.50it/s]  9%|████████▊                                                                                             | 12/139 [00:00<00:07, 16.60it/s] 11%|███████████                                                                                           | 15/139 [00:01<00:06, 18.59it/s] 13%|█████████████▏                                                                                        | 18/139 [00:01<00:06, 19.66it/s] 15%|███████████████▍                                                                                      | 21/139 [00:01<00:06, 19.45it/s] 17%|████████████████▉                                                                                     | 23/139 [00:01<00:06, 18.99it/s] 18%|██████████████████▎                                                                                   | 25/139 [00:01<00:06, 18.66it/s] 19%|███████████████████▊                                                                                  | 27/139 [00:01<00:06, 18.23it/s] 21%|█████████████████████▎                                                                                | 29/139 [00:01<00:06, 17.92it/s] 22%|██████████████████████▋                                                                               | 31/139 [00:01<00:06, 17.69it/s] 24%|████████████████████████▏                                                                             | 33/139 [00:02<00:05, 17.67it/s] 25%|█████████████████████████▋                                                                            | 35/139 [00:02<00:05, 17.49it/s] 27%|███████████████████████████▏                                                                          | 37/139 [00:02<00:05, 17.37it/s][2025-03-28 01:14:48,784] [INFO] [logging.py:128:log_dist] [Rank 0] step=1150, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:14:48,788] [INFO] [timer.py:264:stop] epoch=0/micro_step=1150/global_step=1150, RunningAvgSamplesPerSec=18.47074322736102, CurrSamplesPerSec=17.12183090509686, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 28%|████████████████████████████▌                                                                         | 39/139 [00:02<00:05, 17.27it/s] 29%|██████████████████████████████                                                                        | 41/139 [00:02<00:05, 17.95it/s] 31%|███████████████████████████████▌                                                                      | 43/139 [00:02<00:06, 14.39it/s] 33%|█████████████████████████████████▊                                                                    | 46/139 [00:02<00:05, 16.61it/s] 35%|███████████████████████████████████▉                                                                  | 49/139 [00:02<00:04, 18.21it/s] 37%|██████████████████████████████████████▏                                                               | 52/139 [00:03<00:04, 19.63it/s] 40%|████████████████████████████████████████▎                                                             | 55/139 [00:03<00:04, 20.72it/s] 42%|██████████████████████████████████████████▌                                                           | 58/139 [00:03<00:03, 21.58it/s] 44%|████████████████████████████████████████████▊                                                         | 61/139 [00:03<00:03, 20.02it/s] 46%|██████████████████████████████████████████████▉                                                       | 64/139 [00:03<00:03, 19.33it/s] 47%|████████████████████████████████████████████████▍                                                     | 66/139 [00:03<00:03, 18.78it/s] 49%|█████████████████████████████████████████████████▉                                                    | 68/139 [00:03<00:03, 18.36it/s] 50%|███████████████████████████████████████████████████▎                                                  | 70/139 [00:04<00:03, 18.03it/s] 52%|████████████████████████████████████████████████████▊                                                 | 72/139 [00:04<00:03, 17.77it/s] 53%|██████████████████████████████████████████████████████▎                                               | 74/139 [00:04<00:03, 17.74it/s] 55%|███████████████████████████████████████████████████████▊                                              | 76/139 [00:04<00:03, 17.38it/s] 56%|█████████████████████████████████████████████████████████▏                                            | 78/139 [00:04<00:03, 17.52it/s] 58%|██████████████████████████████████████████████████████████▋                                           | 80/139 [00:04<00:03, 17.77it/s] 60%|████████████████████████████████████████████████████████████▉                                         | 83/139 [00:04<00:02, 18.71it/s] 62%|███████████████████████████████████████████████████████████████                                       | 86/139 [00:04<00:02, 19.66it/s][2025-03-28 01:14:51,449] [INFO] [logging.py:128:log_dist] [Rank 0] step=1200, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:14:51,450] [INFO] [timer.py:264:stop] epoch=0/micro_step=1200/global_step=1200, RunningAvgSamplesPerSec=18.48566804494221, CurrSamplesPerSec=21.51883054904059, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 64%|█████████████████████████████████████████████████████████████████▎                                    | 89/139 [00:05<00:02, 20.31it/s] 66%|███████████████████████████████████████████████████████████████████▌                                  | 92/139 [00:05<00:02, 19.77it/s] 68%|█████████████████████████████████████████████████████████████████████▋                                | 95/139 [00:05<00:02, 19.78it/s] 71%|███████████████████████████████████████████████████████████████████████▉                              | 98/139 [00:05<00:02, 20.41it/s] 73%|█████████████████████████████████████████████████████████████████████████▍                           | 101/139 [00:05<00:01, 20.01it/s] 75%|███████████████████████████████████████████████████████████████████████████▌                         | 104/139 [00:05<00:01, 20.60it/s] 77%|█████████████████████████████████████████████████████████████████████████████▋                       | 107/139 [00:05<00:01, 20.92it/s] 79%|███████████████████████████████████████████████████████████████████████████████▉                     | 110/139 [00:06<00:01, 21.28it/s] 81%|██████████████████████████████████████████████████████████████████████████████████                   | 113/139 [00:06<00:01, 22.18it/s] 83%|████████████████████████████████████████████████████████████████████████████████████▎                | 116/139 [00:06<00:01, 20.17it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▍              | 119/139 [00:06<00:01, 18.90it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▉             | 121/139 [00:06<00:00, 18.50it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████████▎           | 123/139 [00:06<00:00, 18.16it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▊          | 125/139 [00:06<00:00, 17.90it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████████▎        | 127/139 [00:07<00:00, 17.87it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▋       | 129/139 [00:07<00:00, 17.99it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▏     | 131/139 [00:07<00:00, 17.73it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▋    | 133/139 [00:07<00:00, 17.55it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████████   | 135/139 [00:07<00:00, 17.60it/s][2025-03-28 01:14:54,046] [INFO] [logging.py:128:log_dist] [Rank 0] step=1250, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:14:54,047] [INFO] [timer.py:264:stop] epoch=0/micro_step=1250/global_step=1250, RunningAvgSamplesPerSec=18.51692895458861, CurrSamplesPerSec=21.583277018504212, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 99%|████████████████████████████████████████████████████████████████████████████████████████████████████▎| 138/139 [00:07<00:00, 19.08it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 139/139 [00:07<00:00, 18.02it/s]
  0%|                                                                                                               | 0/139 [00:00<?, ?it/s]  1%|▋                                                                                                      | 1/139 [00:00<01:01,  2.26it/s]  3%|██▉                                                                                                    | 4/139 [00:00<00:16,  8.20it/s]  5%|█████▏                                                                                                 | 7/139 [00:00<00:10, 12.37it/s]  7%|███████▎                                                                                              | 10/139 [00:00<00:08, 15.24it/s]  9%|█████████▌                                                                                            | 13/139 [00:00<00:07, 17.31it/s] 12%|███████████▋                                                                                          | 16/139 [00:01<00:06, 18.76it/s] 14%|█████████████▉                                                                                        | 19/139 [00:01<00:05, 20.07it/s] 16%|████████████████▏                                                                                     | 22/139 [00:01<00:05, 20.98it/s] 18%|██████████████████▎                                                                                   | 25/139 [00:01<00:05, 21.61it/s] 20%|████████████████████▌                                                                                 | 28/139 [00:01<00:05, 21.81it/s] 22%|██████████████████████▋                                                                               | 31/139 [00:01<00:05, 20.32it/s] 24%|████████████████████████▉                                                                             | 34/139 [00:01<00:05, 19.25it/s] 26%|██████████████████████████▍                                                                           | 36/139 [00:02<00:05, 18.74it/s] 27%|███████████████████████████▉                                                                          | 38/139 [00:02<00:05, 18.33it/s] 29%|█████████████████████████████▎                                                                        | 40/139 [00:02<00:05, 18.00it/s] 30%|██████████████████████████████▊                                                                       | 42/139 [00:02<00:05, 17.73it/s] 32%|████████████████████████████████▎                                                                     | 44/139 [00:02<00:05, 17.70it/s] 33%|█████████████████████████████████▊                                                                    | 46/139 [00:02<00:05, 17.50it/s][2025-03-28 01:14:57,028] [INFO] [logging.py:128:log_dist] [Rank 0] step=1300, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:14:57,028] [INFO] [timer.py:264:stop] epoch=0/micro_step=1300/global_step=1300, RunningAvgSamplesPerSec=18.48729242982219, CurrSamplesPerSec=22.444052478252267, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 35%|███████████████████████████████████▉                                                                  | 49/139 [00:02<00:04, 18.81it/s] 37%|██████████████████████████████████████▏                                                               | 52/139 [00:02<00:04, 20.10it/s] 40%|████████████████████████████████████████▎                                                             | 55/139 [00:03<00:04, 20.55it/s] 42%|██████████████████████████████████████████▌                                                           | 58/139 [00:03<00:03, 20.81it/s] 44%|████████████████████████████████████████████▊                                                         | 61/139 [00:03<00:03, 21.15it/s] 46%|██████████████████████████████████████████████▉                                                       | 64/139 [00:03<00:03, 20.27it/s] 48%|█████████████████████████████████████████████████▏                                                    | 67/139 [00:03<00:03, 19.57it/s] 50%|██████████████████████████████████████████████████▋                                                   | 69/139 [00:03<00:03, 19.24it/s] 52%|████████████████████████████████████████████████████▊                                                 | 72/139 [00:03<00:03, 19.76it/s] 53%|██████████████████████████████████████████████████████▎                                               | 74/139 [00:04<00:03, 19.38it/s] 55%|███████████████████████████████████████████████████████▊                                              | 76/139 [00:04<00:03, 19.53it/s] 57%|█████████████████████████████████████████████████████████▉                                            | 79/139 [00:04<00:02, 20.55it/s] 59%|████████████████████████████████████████████████████████████▏                                         | 82/139 [00:04<00:02, 20.29it/s] 61%|██████████████████████████████████████████████████████████████▎                                       | 85/139 [00:04<00:02, 20.89it/s] 63%|████████████████████████████████████████████████████████████████▌                                     | 88/139 [00:04<00:02, 20.42it/s] 65%|██████████████████████████████████████████████████████████████████▊                                   | 91/139 [00:04<00:02, 20.63it/s] 68%|████████████████████████████████████████████████████████████████████▉                                 | 94/139 [00:05<00:02, 21.16it/s] 70%|███████████████████████████████████████████████████████████████████████▏                              | 97/139 [00:05<00:01, 21.96it/s][2025-03-28 01:14:59,420] [INFO] [logging.py:128:log_dist] [Rank 0] step=1350, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:14:59,421] [INFO] [timer.py:264:stop] epoch=0/micro_step=1350/global_step=1350, RunningAvgSamplesPerSec=18.568464652914766, CurrSamplesPerSec=24.343991165428314, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 72%|████████████████████████████████████████████████████████████████████████▋                            | 100/139 [00:05<00:01, 22.61it/s] 74%|██████████████████████████████████████████████████████████████████████████▊                          | 103/139 [00:05<00:01, 21.84it/s] 76%|█████████████████████████████████████████████████████████████████████████████                        | 106/139 [00:05<00:01, 20.48it/s] 78%|███████████████████████████████████████████████████████████████████████████████▏                     | 109/139 [00:05<00:01, 19.63it/s] 80%|████████████████████████████████████████████████████████████████████████████████▋                    | 111/139 [00:05<00:01, 19.32it/s] 81%|██████████████████████████████████████████████████████████████████████████████████                   | 113/139 [00:05<00:01, 18.91it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▌                 | 115/139 [00:06<00:01, 18.58it/s] 84%|█████████████████████████████████████████████████████████████████████████████████████                | 117/139 [00:06<00:01, 18.33it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▍              | 119/139 [00:06<00:01, 17.98it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▉             | 121/139 [00:06<00:01, 17.73it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████           | 124/139 [00:06<00:00, 19.03it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████████▎        | 127/139 [00:06<00:00, 19.18it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▍      | 130/139 [00:06<00:00, 19.63it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▋    | 133/139 [00:07<00:00, 20.32it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▊  | 136/139 [00:07<00:00, 20.87it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 139/139 [00:07<00:00, 21.27it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 139/139 [00:07<00:00, 18.97it/s]
  0%|                                                                                                               | 0/139 [00:00<?, ?it/s]  1%|▋                                                                                                      | 1/139 [00:00<00:38,  3.55it/s]  3%|██▉                                                                                                    | 4/139 [00:00<00:12, 11.04it/s]  4%|████▍                                                                                                  | 6/139 [00:00<00:09, 13.64it/s]  6%|██████▋                                                                                                | 9/139 [00:00<00:07, 16.79it/s][2025-03-28 01:15:02,261] [INFO] [logging.py:128:log_dist] [Rank 0] step=1400, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:15:02,262] [INFO] [timer.py:264:stop] epoch=0/micro_step=1400/global_step=1400, RunningAvgSamplesPerSec=18.568028560713202, CurrSamplesPerSec=21.50393657817105, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
  9%|████████▊                                                                                             | 12/139 [00:00<00:06, 18.59it/s] 11%|███████████                                                                                           | 15/139 [00:00<00:06, 20.02it/s] 13%|█████████████▏                                                                                        | 18/139 [00:01<00:05, 20.67it/s] 15%|███████████████▍                                                                                      | 21/139 [00:01<00:05, 21.40it/s] 17%|█████████████████▌                                                                                    | 24/139 [00:01<00:05, 21.81it/s] 19%|███████████████████▊                                                                                  | 27/139 [00:01<00:05, 21.91it/s] 22%|██████████████████████                                                                                | 30/139 [00:01<00:04, 22.11it/s] 24%|████████████████████████▏                                                                             | 33/139 [00:01<00:04, 22.08it/s] 26%|██████████████████████████▍                                                                           | 36/139 [00:01<00:04, 22.01it/s] 28%|████████████████████████████▌                                                                         | 39/139 [00:02<00:04, 21.56it/s] 30%|██████████████████████████████▊                                                                       | 42/139 [00:02<00:04, 20.78it/s] 32%|█████████████████████████████████                                                                     | 45/139 [00:02<00:04, 20.79it/s] 35%|███████████████████████████████████▏                                                                  | 48/139 [00:02<00:04, 21.27it/s] 37%|█████████████████████████████████████▍                                                                | 51/139 [00:02<00:04, 21.55it/s] 39%|███████████████████████████████████████▋                                                              | 54/139 [00:02<00:03, 21.72it/s] 41%|█████████████████████████████████████████▊                                                            | 57/139 [00:02<00:03, 21.75it/s][2025-03-28 01:15:04,547] [INFO] [logging.py:128:log_dist] [Rank 0] step=1450, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:15:04,548] [INFO] [timer.py:264:stop] epoch=0/micro_step=1450/global_step=1450, RunningAvgSamplesPerSec=18.66692835528922, CurrSamplesPerSec=21.444237379526154, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 43%|████████████████████████████████████████████                                                          | 60/139 [00:02<00:03, 21.73it/s] 45%|██████████████████████████████████████████████▏                                                       | 63/139 [00:03<00:03, 21.72it/s] 47%|████████████████████████████████████████████████▍                                                     | 66/139 [00:03<00:03, 21.75it/s] 50%|██████████████████████████████████████████████████▋                                                   | 69/139 [00:03<00:03, 20.25it/s] 52%|████████████████████████████████████████████████████▊                                                 | 72/139 [00:03<00:03, 19.35it/s] 53%|██████████████████████████████████████████████████████▎                                               | 74/139 [00:03<00:03, 18.84it/s] 55%|███████████████████████████████████████████████████████▊                                              | 76/139 [00:03<00:03, 18.42it/s] 56%|█████████████████████████████████████████████████████████▏                                            | 78/139 [00:03<00:03, 18.08it/s] 58%|██████████████████████████████████████████████████████████▋                                           | 80/139 [00:04<00:03, 17.81it/s] 59%|████████████████████████████████████████████████████████████▏                                         | 82/139 [00:04<00:03, 17.61it/s] 60%|█████████████████████████████████████████████████████████████▋                                        | 84/139 [00:04<00:03, 17.77it/s] 63%|███████████████████████████████████████████████████████████████▊                                      | 87/139 [00:04<00:02, 19.18it/s] 65%|██████████████████████████████████████████████████████████████████                                    | 90/139 [00:04<00:02, 20.13it/s] 67%|████████████████████████████████████████████████████████████████████▏                                 | 93/139 [00:04<00:02, 20.71it/s] 69%|██████████████████████████████████████████████████████████████████████▍                               | 96/139 [00:04<00:02, 21.49it/s] 71%|████████████████████████████████████████████████████████████████████████▋                             | 99/139 [00:04<00:01, 22.24it/s] 73%|██████████████████████████████████████████████████████████████████████████                           | 102/139 [00:05<00:01, 22.78it/s] 76%|████████████████████████████████████████████████████████████████████████████▎                        | 105/139 [00:05<00:01, 22.75it/s] 78%|██████████████████████████████████████████████████████████████████████████████▍                      | 108/139 [00:05<00:01, 22.46it/s][2025-03-28 01:15:06,989] [INFO] [logging.py:128:log_dist] [Rank 0] step=1500, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:15:06,990] [INFO] [timer.py:264:stop] epoch=0/micro_step=1500/global_step=1500, RunningAvgSamplesPerSec=18.723448976910824, CurrSamplesPerSec=20.698180418872546, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 80%|████████████████████████████████████████████████████████████████████████████████▋                    | 111/139 [00:05<00:01, 22.88it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▊                  | 114/139 [00:05<00:01, 22.25it/s] 84%|█████████████████████████████████████████████████████████████████████████████████████                | 117/139 [00:05<00:00, 22.10it/s] 86%|███████████████████████████████████████████████████████████████████████████████████████▏             | 120/139 [00:05<00:00, 21.96it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████████▎           | 123/139 [00:06<00:00, 22.04it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▌         | 126/139 [00:06<00:00, 21.99it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▋       | 129/139 [00:06<00:00, 21.03it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▉     | 132/139 [00:06<00:00, 21.35it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████████   | 135/139 [00:06<00:00, 21.48it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████▎| 138/139 [00:06<00:00, 21.85it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 139/139 [00:06<00:00, 20.30it/s]
  0%|                                                                                                               | 0/139 [00:00<?, ?it/s]  1%|▋                                                                                                      | 1/139 [00:00<00:25,  5.31it/s]  2%|██▏                                                                                                    | 3/139 [00:00<00:11, 11.58it/s]  4%|████▍                                                                                                  | 6/139 [00:00<00:08, 16.05it/s]  6%|██████▋                                                                                                | 9/139 [00:00<00:07, 18.26it/s]  9%|████████▊                                                                                             | 12/139 [00:00<00:06, 18.63it/s] 11%|███████████                                                                                           | 15/139 [00:00<00:06, 19.56it/s] 13%|█████████████▏                                                                                        | 18/139 [00:00<00:05, 20.48it/s][2025-03-28 01:15:09,579] [INFO] [logging.py:128:log_dist] [Rank 0] step=1550, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:15:09,580] [INFO] [timer.py:264:stop] epoch=0/micro_step=1550/global_step=1550, RunningAvgSamplesPerSec=18.77940991377102, CurrSamplesPerSec=22.461841351547037, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 15%|███████████████▍                                                                                      | 21/139 [00:01<00:05, 20.95it/s] 17%|█████████████████▌                                                                                    | 24/139 [00:01<00:05, 21.33it/s] 19%|███████████████████▊                                                                                  | 27/139 [00:01<00:05, 21.37it/s] 22%|██████████████████████                                                                                | 30/139 [00:01<00:05, 21.19it/s] 24%|████████████████████████▏                                                                             | 33/139 [00:01<00:04, 21.37it/s] 26%|██████████████████████████▍                                                                           | 36/139 [00:01<00:04, 21.46it/s] 28%|████████████████████████████▌                                                                         | 39/139 [00:01<00:04, 21.59it/s] 30%|██████████████████████████████▊                                                                       | 42/139 [00:02<00:04, 21.62it/s] 32%|█████████████████████████████████                                                                     | 45/139 [00:02<00:04, 21.49it/s] 35%|███████████████████████████████████▏                                                                  | 48/139 [00:02<00:04, 21.42it/s] 37%|█████████████████████████████████████▍                                                                | 51/139 [00:02<00:04, 21.42it/s] 39%|███████████████████████████████████████▋                                                              | 54/139 [00:02<00:03, 21.39it/s] 41%|█████████████████████████████████████████▊                                                            | 57/139 [00:02<00:03, 21.43it/s] 43%|████████████████████████████████████████████                                                          | 60/139 [00:02<00:03, 21.38it/s] 45%|██████████████████████████████████████████████▏                                                       | 63/139 [00:03<00:03, 20.20it/s] 47%|████████████████████████████████████████████████▍                                                     | 66/139 [00:03<00:03, 19.31it/s] 50%|██████████████████████████████████████████████████▋                                                   | 69/139 [00:03<00:03, 19.76it/s][2025-03-28 01:15:11,975] [INFO] [logging.py:128:log_dist] [Rank 0] step=1600, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:15:11,976] [INFO] [timer.py:264:stop] epoch=0/micro_step=1600/global_step=1600, RunningAvgSamplesPerSec=18.839441114479023, CurrSamplesPerSec=20.985454939745747, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 52%|████████████████████████████████████████████████████▊                                                 | 72/139 [00:03<00:03, 19.94it/s] 54%|███████████████████████████████████████████████████████                                               | 75/139 [00:03<00:03, 20.00it/s] 56%|█████████████████████████████████████████████████████████▏                                            | 78/139 [00:03<00:03, 20.09it/s] 58%|███████████████████████████████████████████████████████████▍                                          | 81/139 [00:04<00:02, 20.16it/s] 60%|█████████████████████████████████████████████████████████████▋                                        | 84/139 [00:04<00:02, 20.33it/s] 63%|███████████████████████████████████████████████████████████████▊                                      | 87/139 [00:04<00:02, 20.30it/s] 65%|██████████████████████████████████████████████████████████████████                                    | 90/139 [00:04<00:02, 20.17it/s] 67%|████████████████████████████████████████████████████████████████████▏                                 | 93/139 [00:04<00:02, 20.01it/s] 69%|██████████████████████████████████████████████████████████████████████▍                               | 96/139 [00:04<00:02, 19.95it/s] 71%|███████████████████████████████████████████████████████████████████████▉                              | 98/139 [00:04<00:02, 19.85it/s] 73%|█████████████████████████████████████████████████████████████████████████▍                           | 101/139 [00:05<00:01, 19.94it/s] 74%|██████████████████████████████████████████████████████████████████████████▊                          | 103/139 [00:05<00:01, 19.84it/s] 76%|████████████████████████████████████████████████████████████████████████████▎                        | 105/139 [00:05<00:01, 19.79it/s] 77%|█████████████████████████████████████████████████████████████████████████████▋                       | 107/139 [00:05<00:01, 19.47it/s] 78%|███████████████████████████████████████████████████████████████████████████████▏                     | 109/139 [00:05<00:01, 19.49it/s] 80%|████████████████████████████████████████████████████████████████████████████████▋                    | 111/139 [00:05<00:01, 19.14it/s] 81%|██████████████████████████████████████████████████████████████████████████████████                   | 113/139 [00:05<00:01, 19.07it/s] 83%|████████████████████████████████████████████████████████████████████████████████████▎                | 116/139 [00:05<00:01, 19.16it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▋               | 118/139 [00:05<00:01, 19.08it/s] 86%|███████████████████████████████████████████████████████████████████████████████████████▏             | 120/139 [00:06<00:01, 18.92it/s][2025-03-28 01:15:14,514] [INFO] [logging.py:128:log_dist] [Rank 0] step=1650, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:15:14,517] [INFO] [timer.py:264:stop] epoch=0/micro_step=1650/global_step=1650, RunningAvgSamplesPerSec=18.865142424502487, CurrSamplesPerSec=20.0827388800796, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 88%|████████████████████████████████████████████████████████████████████████████████████████▋            | 122/139 [00:06<00:00, 19.16it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████           | 124/139 [00:06<00:00, 19.19it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▌         | 126/139 [00:06<00:00, 19.03it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████        | 128/139 [00:06<00:00, 18.76it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▍      | 130/139 [00:06<00:00, 18.55it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▉     | 132/139 [00:06<00:00, 18.64it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████▎   | 134/139 [00:06<00:00, 18.81it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▊  | 136/139 [00:06<00:00, 18.83it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████▎| 138/139 [00:06<00:00, 19.01it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 139/139 [00:07<00:00, 19.60it/s]
  0%|                                                                                                               | 0/139 [00:00<?, ?it/s]  1%|▋                                                                                                      | 1/139 [00:00<00:25,  5.35it/s]  2%|██▏                                                                                                    | 3/139 [00:00<00:12, 11.15it/s]  4%|███▋                                                                                                   | 5/139 [00:00<00:09, 13.88it/s]  5%|█████▏                                                                                                 | 7/139 [00:00<00:08, 15.61it/s]  6%|██████▋                                                                                                | 9/139 [00:00<00:07, 16.54it/s]  8%|████████                                                                                              | 11/139 [00:00<00:07, 17.12it/s]  9%|█████████▌                                                                                            | 13/139 [00:00<00:07, 17.69it/s] 11%|███████████                                                                                           | 15/139 [00:00<00:07, 17.67it/s] 12%|████████████▍                                                                                         | 17/139 [00:01<00:06, 18.08it/s] 14%|█████████████▉                                                                                        | 19/139 [00:01<00:06, 18.19it/s] 15%|███████████████▍                                                                                      | 21/139 [00:01<00:06, 18.50it/s] 17%|████████████████▉                                                                                     | 23/139 [00:01<00:06, 18.51it/s] 18%|██████████████████▎                                                                                   | 25/139 [00:01<00:06, 18.51it/s] 19%|███████████████████▊                                                                                  | 27/139 [00:01<00:06, 18.62it/s] 21%|█████████████████████▎                                                                                | 29/139 [00:01<00:05, 18.59it/s] 22%|██████████████████████▋                                                                               | 31/139 [00:01<00:05, 18.50it/s][2025-03-28 01:15:17,431] [INFO] [logging.py:128:log_dist] [Rank 0] step=1700, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:15:17,434] [INFO] [timer.py:264:stop] epoch=0/micro_step=1700/global_step=1700, RunningAvgSamplesPerSec=18.84402941228626, CurrSamplesPerSec=19.804145408757446, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 24%|████████████████████████▏                                                                             | 33/139 [00:01<00:05, 18.62it/s] 25%|█████████████████████████▋                                                                            | 35/139 [00:02<00:05, 18.49it/s] 27%|███████████████████████████▏                                                                          | 37/139 [00:02<00:05, 18.40it/s] 28%|████████████████████████████▌                                                                         | 39/139 [00:02<00:05, 18.68it/s] 29%|██████████████████████████████                                                                        | 41/139 [00:02<00:05, 18.72it/s] 31%|███████████████████████████████▌                                                                      | 43/139 [00:02<00:05, 18.37it/s] 32%|█████████████████████████████████                                                                     | 45/139 [00:02<00:05, 18.29it/s] 34%|██████████████████████████████████▍                                                                   | 47/139 [00:02<00:05, 18.20it/s] 35%|███████████████████████████████████▉                                                                  | 49/139 [00:02<00:04, 18.13it/s] 37%|█████████████████████████████████████▍                                                                | 51/139 [00:02<00:04, 18.02it/s] 38%|██████████████████████████████████████▉                                                               | 53/139 [00:03<00:04, 18.25it/s] 40%|████████████████████████████████████████▎                                                             | 55/139 [00:03<00:04, 18.53it/s] 41%|█████████████████████████████████████████▊                                                            | 57/139 [00:03<00:04, 18.62it/s] 42%|███████████████████████████████████████████▎                                                          | 59/139 [00:03<00:04, 18.83it/s] 44%|████████████████████████████████████████████▊                                                         | 61/139 [00:03<00:04, 18.72it/s] 45%|██████████████████████████████████████████████▏                                                       | 63/139 [00:03<00:04, 18.92it/s] 47%|███████████████████████████████████████████████▋                                                      | 65/139 [00:03<00:04, 17.92it/s] 48%|█████████████████████████████████████████████████▏                                                    | 67/139 [00:03<00:04, 17.90it/s] 50%|██████████████████████████████████████████████████▋                                                   | 69/139 [00:03<00:03, 17.88it/s] 51%|████████████████████████████████████████████████████                                                  | 71/139 [00:03<00:03, 18.47it/s] 53%|█████████████████████████████████████████████████████▌                                                | 73/139 [00:04<00:03, 18.29it/s] 54%|███████████████████████████████████████████████████████                                               | 75/139 [00:04<00:03, 18.16it/s] 55%|████████████████████████████████████████████████████████▌                                             | 77/139 [00:04<00:03, 17.09it/s] 57%|█████████████████████████████████████████████████████████▉                                            | 79/139 [00:04<00:03, 17.22it/s] 58%|███████████████████████████████████████████████████████████▍                                          | 81/139 [00:04<00:03, 17.65it/s][2025-03-28 01:15:20,186] [INFO] [logging.py:128:log_dist] [Rank 0] step=1750, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:15:20,190] [INFO] [timer.py:264:stop] epoch=0/micro_step=1750/global_step=1750, RunningAvgSamplesPerSec=18.82450082041021, CurrSamplesPerSec=18.616760909771937, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 60%|████████████████████████████████████████████████████████████▉                                         | 83/139 [00:04<00:03, 17.92it/s] 61%|██████████████████████████████████████████████████████████████▎                                       | 85/139 [00:04<00:03, 17.98it/s] 63%|███████████████████████████████████████████████████████████████▊                                      | 87/139 [00:04<00:03, 17.18it/s] 64%|█████████████████████████████████████████████████████████████████▎                                    | 89/139 [00:05<00:02, 17.40it/s] 65%|██████████████████████████████████████████████████████████████████▊                                   | 91/139 [00:05<00:02, 17.71it/s] 67%|████████████████████████████████████████████████████████████████████▏                                 | 93/139 [00:05<00:02, 17.94it/s] 68%|█████████████████████████████████████████████████████████████████████▋                                | 95/139 [00:05<00:02, 17.91it/s] 70%|███████████████████████████████████████████████████████████████████████▏                              | 97/139 [00:05<00:02, 18.00it/s] 71%|████████████████████████████████████████████████████████████████████████▋                             | 99/139 [00:05<00:02, 18.02it/s] 73%|█████████████████████████████████████████████████████████████████████████▍                           | 101/139 [00:05<00:02, 18.08it/s] 74%|██████████████████████████████████████████████████████████████████████████▊                          | 103/139 [00:05<00:01, 18.12it/s] 76%|████████████████████████████████████████████████████████████████████████████▎                        | 105/139 [00:05<00:01, 18.04it/s] 77%|█████████████████████████████████████████████████████████████████████████████▋                       | 107/139 [00:06<00:01, 18.02it/s] 78%|███████████████████████████████████████████████████████████████████████████████▏                     | 109/139 [00:06<00:01, 17.95it/s] 80%|████████████████████████████████████████████████████████████████████████████████▋                    | 111/139 [00:06<00:01, 17.90it/s] 81%|██████████████████████████████████████████████████████████████████████████████████                   | 113/139 [00:06<00:01, 18.17it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▌                 | 115/139 [00:06<00:01, 18.30it/s] 84%|█████████████████████████████████████████████████████████████████████████████████████                | 117/139 [00:06<00:01, 18.25it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▍              | 119/139 [00:06<00:01, 18.23it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▉             | 121/139 [00:06<00:00, 18.35it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████████▎           | 123/139 [00:06<00:00, 18.48it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▊          | 125/139 [00:06<00:00, 18.50it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████████▎        | 127/139 [00:07<00:00, 18.11it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▋       | 129/139 [00:07<00:00, 17.86it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▏     | 131/139 [00:07<00:00, 18.01it/s][2025-03-28 01:15:22,973] [INFO] [logging.py:128:log_dist] [Rank 0] step=1800, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:15:22,977] [INFO] [timer.py:264:stop] epoch=0/micro_step=1800/global_step=1800, RunningAvgSamplesPerSec=18.800111652545148, CurrSamplesPerSec=14.30593964343012, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 96%|████████████████████████████████████████████████████████████████████████████████████████████████▋    | 133/139 [00:07<00:00, 17.50it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████████   | 135/139 [00:07<00:00, 17.97it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▌ | 137/139 [00:07<00:00, 17.12it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 139/139 [00:07<00:00, 16.56it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 139/139 [00:07<00:00, 17.67it/s]
  0%|                                                                                                               | 0/139 [00:00<?, ?it/s]  1%|▋                                                                                                      | 1/139 [00:00<00:25,  5.41it/s]  2%|██▏                                                                                                    | 3/139 [00:00<00:11, 11.51it/s]  4%|███▋                                                                                                   | 5/139 [00:00<00:09, 14.21it/s]  5%|█████▏                                                                                                 | 7/139 [00:00<00:08, 15.52it/s]  6%|██████▋                                                                                                | 9/139 [00:00<00:07, 16.29it/s]  8%|████████                                                                                              | 11/139 [00:00<00:07, 17.22it/s]  9%|█████████▌                                                                                            | 13/139 [00:00<00:07, 17.37it/s] 11%|███████████                                                                                           | 15/139 [00:00<00:07, 16.94it/s] 12%|████████████▍                                                                                         | 17/139 [00:01<00:06, 17.59it/s] 14%|█████████████▉                                                                                        | 19/139 [00:01<00:06, 17.70it/s] 15%|███████████████▍                                                                                      | 21/139 [00:01<00:06, 17.56it/s] 17%|████████████████▉                                                                                     | 23/139 [00:01<00:06, 16.90it/s] 18%|██████████████████▎                                                                                   | 25/139 [00:01<00:06, 16.67it/s] 19%|███████████████████▊                                                                                  | 27/139 [00:01<00:06, 16.98it/s] 21%|█████████████████████▎                                                                                | 29/139 [00:01<00:06, 17.37it/s] 22%|██████████████████████▋                                                                               | 31/139 [00:01<00:06, 17.45it/s] 24%|████████████████████████▏                                                                             | 33/139 [00:01<00:05, 17.67it/s] 25%|█████████████████████████▋                                                                            | 35/139 [00:02<00:05, 17.63it/s] 27%|███████████████████████████▏                                                                          | 37/139 [00:02<00:05, 17.80it/s] 28%|████████████████████████████▌                                                                         | 39/139 [00:02<00:05, 17.93it/s] 29%|██████████████████████████████                                                                        | 41/139 [00:02<00:05, 18.12it/s][2025-03-28 01:15:26,011] [INFO] [logging.py:128:log_dist] [Rank 0] step=1850, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:15:26,015] [INFO] [timer.py:264:stop] epoch=0/micro_step=1850/global_step=1850, RunningAvgSamplesPerSec=18.75381931709828, CurrSamplesPerSec=18.44572847897924, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 31%|███████████████████████████████▌                                                                      | 43/139 [00:02<00:05, 18.11it/s] 32%|█████████████████████████████████                                                                     | 45/139 [00:02<00:05, 18.26it/s] 34%|██████████████████████████████████▍                                                                   | 47/139 [00:02<00:05, 18.12it/s] 35%|███████████████████████████████████▉                                                                  | 49/139 [00:02<00:05, 17.48it/s] 37%|█████████████████████████████████████▍                                                                | 51/139 [00:03<00:05, 16.93it/s] 38%|██████████████████████████████████████▉                                                               | 53/139 [00:03<00:05, 17.09it/s] 40%|████████████████████████████████████████▎                                                             | 55/139 [00:03<00:04, 17.58it/s] 41%|█████████████████████████████████████████▊                                                            | 57/139 [00:03<00:04, 16.90it/s] 42%|███████████████████████████████████████████▎                                                          | 59/139 [00:03<00:04, 17.10it/s] 44%|████████████████████████████████████████████▊                                                         | 61/139 [00:03<00:04, 17.40it/s] 45%|██████████████████████████████████████████████▏                                                       | 63/139 [00:03<00:04, 17.51it/s] 47%|███████████████████████████████████████████████▋                                                      | 65/139 [00:03<00:04, 17.64it/s] 48%|█████████████████████████████████████████████████▏                                                    | 67/139 [00:03<00:04, 17.89it/s] 50%|██████████████████████████████████████████████████▋                                                   | 69/139 [00:04<00:03, 17.89it/s] 51%|████████████████████████████████████████████████████                                                  | 71/139 [00:04<00:03, 18.04it/s] 53%|█████████████████████████████████████████████████████▌                                                | 73/139 [00:04<00:03, 18.00it/s] 54%|███████████████████████████████████████████████████████                                               | 75/139 [00:04<00:03, 17.36it/s] 55%|████████████████████████████████████████████████████████▌                                             | 77/139 [00:04<00:03, 17.72it/s] 57%|█████████████████████████████████████████████████████████▉                                            | 79/139 [00:04<00:03, 17.86it/s] 58%|███████████████████████████████████████████████████████████▍                                          | 81/139 [00:04<00:03, 17.98it/s] 60%|████████████████████████████████████████████████████████████▉                                         | 83/139 [00:04<00:03, 17.93it/s] 61%|██████████████████████████████████████████████████████████████▎                                       | 85/139 [00:04<00:02, 18.09it/s] 63%|███████████████████████████████████████████████████████████████▊                                      | 87/139 [00:05<00:02, 18.17it/s] 64%|█████████████████████████████████████████████████████████████████▎                                    | 89/139 [00:05<00:02, 18.43it/s] 65%|██████████████████████████████████████████████████████████████████▊                                   | 91/139 [00:05<00:02, 18.34it/s][2025-03-28 01:15:28,830] [INFO] [logging.py:128:log_dist] [Rank 0] step=1900, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:15:28,834] [INFO] [timer.py:264:stop] epoch=0/micro_step=1900/global_step=1900, RunningAvgSamplesPerSec=18.726760707199848, CurrSamplesPerSec=17.40720399793583, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 67%|████████████████████████████████████████████████████████████████████▏                                 | 93/139 [00:05<00:02, 18.02it/s] 68%|█████████████████████████████████████████████████████████████████████▋                                | 95/139 [00:05<00:02, 18.10it/s] 70%|███████████████████████████████████████████████████████████████████████▏                              | 97/139 [00:05<00:02, 17.97it/s] 71%|████████████████████████████████████████████████████████████████████████▋                             | 99/139 [00:05<00:02, 17.56it/s] 73%|█████████████████████████████████████████████████████████████████████████▍                           | 101/139 [00:05<00:02, 17.57it/s] 74%|██████████████████████████████████████████████████████████████████████████▊                          | 103/139 [00:05<00:02, 17.76it/s] 76%|████████████████████████████████████████████████████████████████████████████▎                        | 105/139 [00:06<00:01, 17.34it/s] 77%|█████████████████████████████████████████████████████████████████████████████▋                       | 107/139 [00:06<00:01, 17.73it/s] 78%|███████████████████████████████████████████████████████████████████████████████▏                     | 109/139 [00:06<00:01, 17.87it/s] 80%|████████████████████████████████████████████████████████████████████████████████▋                    | 111/139 [00:06<00:01, 17.95it/s] 81%|██████████████████████████████████████████████████████████████████████████████████                   | 113/139 [00:06<00:01, 18.14it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▌                 | 115/139 [00:06<00:01, 18.08it/s] 84%|█████████████████████████████████████████████████████████████████████████████████████                | 117/139 [00:06<00:01, 18.06it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▍              | 119/139 [00:06<00:01, 18.09it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▉             | 121/139 [00:06<00:00, 18.28it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████████▎           | 123/139 [00:07<00:00, 18.28it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▊          | 125/139 [00:07<00:00, 18.38it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████████▎        | 127/139 [00:07<00:00, 18.21it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▋       | 129/139 [00:07<00:00, 18.32it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▏     | 131/139 [00:07<00:00, 18.45it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▋    | 133/139 [00:07<00:00, 18.24it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████████   | 135/139 [00:07<00:00, 17.59it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▌ | 137/139 [00:07<00:00, 17.64it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 139/139 [00:07<00:00, 17.64it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 139/139 [00:07<00:00, 17.38it/s]
  0%|                                                                                                               | 0/139 [00:00<?, ?it/s]  1%|▋                                                                                                      | 1/139 [00:00<00:27,  5.11it/s]  2%|██▏                                                                                                    | 3/139 [00:00<00:12, 10.61it/s][2025-03-28 01:15:31,856] [INFO] [logging.py:128:log_dist] [Rank 0] step=1950, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:15:31,859] [INFO] [timer.py:264:stop] epoch=0/micro_step=1950/global_step=1950, RunningAvgSamplesPerSec=18.689503168366105, CurrSamplesPerSec=17.72020041274115, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
  4%|███▋                                                                                                   | 5/139 [00:00<00:10, 13.34it/s]  5%|█████▏                                                                                                 | 7/139 [00:00<00:08, 14.85it/s]  6%|██████▋                                                                                                | 9/139 [00:00<00:08, 15.76it/s]  8%|████████                                                                                              | 11/139 [00:00<00:07, 16.48it/s]  9%|█████████▌                                                                                            | 13/139 [00:00<00:07, 16.78it/s] 11%|███████████                                                                                           | 15/139 [00:00<00:07, 17.23it/s] 13%|█████████████▏                                                                                        | 18/139 [00:01<00:06, 18.51it/s] 14%|██████████████▋                                                                                       | 20/139 [00:01<00:06, 18.47it/s] 16%|████████████████▏                                                                                     | 22/139 [00:01<00:06, 18.44it/s] 17%|█████████████████▌                                                                                    | 24/139 [00:01<00:06, 18.34it/s] 19%|███████████████████                                                                                   | 26/139 [00:01<00:06, 18.27it/s] 20%|████████████████████▌                                                                                 | 28/139 [00:01<00:06, 18.24it/s] 22%|██████████████████████                                                                                | 30/139 [00:01<00:06, 18.05it/s] 23%|███████████████████████▍                                                                              | 32/139 [00:01<00:06, 17.81it/s] 24%|████████████████████████▉                                                                             | 34/139 [00:02<00:05, 17.93it/s] 26%|██████████████████████████▍                                                                           | 36/139 [00:02<00:05, 17.91it/s] 27%|███████████████████████████▉                                                                          | 38/139 [00:02<00:05, 17.95it/s] 29%|█████████████████████████████▎                                                                        | 40/139 [00:02<00:05, 18.30it/s] 30%|██████████████████████████████▊                                                                       | 42/139 [00:02<00:05, 18.43it/s] 32%|████████████████████████████████▎                                                                     | 44/139 [00:02<00:05, 18.43it/s] 33%|█████████████████████████████████▊                                                                    | 46/139 [00:02<00:05, 18.37it/s] 35%|███████████████████████████████████▏                                                                  | 48/139 [00:02<00:04, 18.60it/s] 36%|████████████████████████████████████▋                                                                 | 50/139 [00:02<00:04, 18.23it/s] 37%|██████████████████████████████████████▏                                                               | 52/139 [00:03<00:04, 18.30it/s][2025-03-28 01:15:34,595] [INFO] [logging.py:128:log_dist] [Rank 0] step=2000, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:15:34,599] [INFO] [timer.py:264:stop] epoch=0/micro_step=2000/global_step=2000, RunningAvgSamplesPerSec=18.679335709597662, CurrSamplesPerSec=17.999049486169913, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 39%|███████████████████████████████████████▋                                                              | 54/139 [00:03<00:04, 18.38it/s] 40%|█████████████████████████████████████████                                                             | 56/139 [00:03<00:04, 18.08it/s] 42%|██████████████████████████████████████████▌                                                           | 58/139 [00:03<00:04, 17.90it/s][2025-03-28 01:15:34,873] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2025-03-28 01:15:34,921] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
 44%|████████████████████████████████████████████▊                                                         | 61/139 [00:03<00:04, 18.79it/s] 45%|██████████████████████████████████████████████▏                                                       | 63/139 [00:03<00:04, 18.75it/s] 47%|████████████████████████████████████████████████▍                                                     | 66/139 [00:03<00:03, 19.59it/s] 49%|█████████████████████████████████████████████████▉                                                    | 68/139 [00:03<00:03, 19.26it/s] 50%|███████████████████████████████████████████████████▎                                                  | 70/139 [00:03<00:03, 19.00it/s] 52%|████████████████████████████████████████████████████▊                                                 | 72/139 [00:04<00:03, 18.61it/s] 53%|██████████████████████████████████████████████████████▎                                               | 74/139 [00:04<00:03, 18.50it/s] 55%|███████████████████████████████████████████████████████▊                                              | 76/139 [00:04<00:03, 18.58it/s] 56%|█████████████████████████████████████████████████████████▏                                            | 78/139 [00:04<00:03, 18.53it/s] 58%|██████████████████████████████████████████████████████████▋                                           | 80/139 [00:04<00:03, 18.37it/s] 59%|████████████████████████████████████████████████████████████▏                                         | 82/139 [00:04<00:03, 18.24it/s] 61%|██████████████████████████████████████████████████████████████▎                                       | 85/139 [00:04<00:02, 19.23it/s] 63%|███████████████████████████████████████████████████████████████▊                                      | 87/139 [00:04<00:02, 18.90it/s] 64%|█████████████████████████████████████████████████████████████████▎                                    | 89/139 [00:04<00:02, 18.52it/s] 65%|██████████████████████████████████████████████████████████████████▊                                   | 91/139 [00:05<00:02, 18.54it/s] 67%|████████████████████████████████████████████████████████████████████▏                                 | 93/139 [00:05<00:02, 18.37it/s] 68%|█████████████████████████████████████████████████████████████████████▋                                | 95/139 [00:05<00:02, 18.18it/s] 70%|███████████████████████████████████████████████████████████████████████▏                              | 97/139 [00:05<00:02, 18.05it/s] 71%|████████████████████████████████████████████████████████████████████████▋                             | 99/139 [00:05<00:02, 18.17it/s] 73%|█████████████████████████████████████████████████████████████████████████▍                           | 101/139 [00:05<00:02, 18.07it/s] 74%|██████████████████████████████████████████████████████████████████████████▊                          | 103/139 [00:05<00:02, 17.99it/s][2025-03-28 01:15:37,300] [INFO] [logging.py:128:log_dist] [Rank 0] step=2050, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:15:37,304] [INFO] [timer.py:264:stop] epoch=0/micro_step=2050/global_step=2050, RunningAvgSamplesPerSec=18.675544825937326, CurrSamplesPerSec=17.641865395209976, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 76%|████████████████████████████████████████████████████████████████████████████▎                        | 105/139 [00:05<00:01, 17.93it/s] 77%|█████████████████████████████████████████████████████████████████████████████▋                       | 107/139 [00:05<00:01, 18.42it/s] 79%|███████████████████████████████████████████████████████████████████████████████▉                     | 110/139 [00:06<00:01, 19.14it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▍                   | 112/139 [00:06<00:01, 18.77it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▊                  | 114/139 [00:06<00:01, 18.84it/s] 83%|████████████████████████████████████████████████████████████████████████████████████▎                | 116/139 [00:06<00:01, 18.66it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▋               | 118/139 [00:06<00:01, 18.29it/s] 86%|███████████████████████████████████████████████████████████████████████████████████████▏             | 120/139 [00:06<00:01, 18.10it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▋            | 122/139 [00:06<00:00, 17.95it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████           | 124/139 [00:06<00:00, 17.85it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████████▎        | 127/139 [00:07<00:00, 19.19it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▋       | 129/139 [00:07<00:00, 18.71it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▉     | 132/139 [00:07<00:00, 19.75it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████████   | 135/139 [00:07<00:00, 19.71it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████▎| 138/139 [00:07<00:00, 20.40it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 139/139 [00:07<00:00, 18.08it/s]
  0%|                                                                                                               | 0/139 [00:00<?, ?it/s]  1%|▋                                                                                                      | 1/139 [00:00<00:29,  4.65it/s]  2%|██▏                                                                                                    | 3/139 [00:00<00:13, 10.04it/s]  4%|███▋                                                                                                   | 5/139 [00:00<00:10, 12.84it/s]  5%|█████▏                                                                                                 | 7/139 [00:00<00:09, 14.45it/s]  6%|██████▋                                                                                                | 9/139 [00:00<00:08, 15.63it/s]  8%|████████                                                                                              | 11/139 [00:00<00:07, 16.30it/s]  9%|█████████▌                                                                                            | 13/139 [00:00<00:07, 16.72it/s][2025-03-28 01:15:40,275] [INFO] [logging.py:128:log_dist] [Rank 0] step=2100, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:15:40,279] [INFO] [timer.py:264:stop] epoch=0/micro_step=2100/global_step=2100, RunningAvgSamplesPerSec=18.66026694128887, CurrSamplesPerSec=15.202250982753986, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 11%|███████████                                                                                           | 15/139 [00:01<00:07, 16.53it/s] 12%|████████████▍                                                                                         | 17/139 [00:01<00:07, 16.82it/s] 14%|█████████████▉                                                                                        | 19/139 [00:01<00:07, 17.06it/s] 15%|███████████████▍                                                                                      | 21/139 [00:01<00:06, 17.54it/s] 17%|████████████████▉                                                                                     | 23/139 [00:01<00:06, 17.81it/s] 18%|██████████████████▎                                                                                   | 25/139 [00:01<00:06, 17.57it/s] 19%|███████████████████▊                                                                                  | 27/139 [00:01<00:06, 17.71it/s] 21%|█████████████████████▎                                                                                | 29/139 [00:01<00:06, 17.82it/s] 22%|██████████████████████▋                                                                               | 31/139 [00:01<00:06, 17.69it/s] 24%|████████████████████████▏                                                                             | 33/139 [00:02<00:06, 17.66it/s] 25%|█████████████████████████▋                                                                            | 35/139 [00:02<00:05, 17.84it/s] 27%|███████████████████████████▏                                                                          | 37/139 [00:02<00:05, 17.98it/s] 28%|████████████████████████████▌                                                                         | 39/139 [00:02<00:05, 18.21it/s] 29%|██████████████████████████████                                                                        | 41/139 [00:02<00:05, 18.07it/s] 31%|███████████████████████████████▌                                                                      | 43/139 [00:02<00:05, 18.06it/s] 32%|█████████████████████████████████                                                                     | 45/139 [00:02<00:05, 17.75it/s] 34%|██████████████████████████████████▍                                                                   | 47/139 [00:02<00:05, 17.74it/s] 35%|███████████████████████████████████▉                                                                  | 49/139 [00:02<00:05, 17.80it/s] 37%|█████████████████████████████████████▍                                                                | 51/139 [00:03<00:04, 17.91it/s] 38%|██████████████████████████████████████▉                                                               | 53/139 [00:03<00:04, 17.99it/s] 40%|████████████████████████████████████████▎                                                             | 55/139 [00:03<00:04, 18.01it/s] 41%|█████████████████████████████████████████▊                                                            | 57/139 [00:03<00:04, 17.89it/s] 42%|███████████████████████████████████████████▎                                                          | 59/139 [00:03<00:04, 17.95it/s] 44%|████████████████████████████████████████████▊                                                         | 61/139 [00:03<00:04, 18.15it/s] 45%|██████████████████████████████████████████████▏                                                       | 63/139 [00:03<00:04, 18.15it/s][2025-03-28 01:15:43,061] [INFO] [logging.py:128:log_dist] [Rank 0] step=2150, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:15:43,065] [INFO] [timer.py:264:stop] epoch=0/micro_step=2150/global_step=2150, RunningAvgSamplesPerSec=18.644004091556766, CurrSamplesPerSec=17.918005658077814, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 47%|███████████████████████████████████████████████▋                                                      | 65/139 [00:03<00:04, 18.01it/s] 48%|█████████████████████████████████████████████████▏                                                    | 67/139 [00:03<00:03, 18.08it/s] 50%|██████████████████████████████████████████████████▋                                                   | 69/139 [00:04<00:03, 18.00it/s] 51%|████████████████████████████████████████████████████                                                  | 71/139 [00:04<00:03, 18.54it/s] 53%|██████████████████████████████████████████████████████▎                                               | 74/139 [00:04<00:03, 19.90it/s] 55%|████████████████████████████████████████████████████████▌                                             | 77/139 [00:04<00:03, 20.43it/s] 58%|██████████████████████████████████████████████████████████▋                                           | 80/139 [00:04<00:02, 21.00it/s] 60%|████████████████████████████████████████████████████████████▉                                         | 83/139 [00:04<00:02, 21.44it/s] 62%|███████████████████████████████████████████████████████████████                                       | 86/139 [00:04<00:02, 21.84it/s] 64%|█████████████████████████████████████████████████████████████████▎                                    | 89/139 [00:04<00:02, 21.15it/s] 66%|███████████████████████████████████████████████████████████████████▌                                  | 92/139 [00:05<00:02, 21.24it/s] 68%|█████████████████████████████████████████████████████████████████████▋                                | 95/139 [00:05<00:02, 21.56it/s] 71%|███████████████████████████████████████████████████████████████████████▉                              | 98/139 [00:05<00:01, 21.64it/s] 73%|█████████████████████████████████████████████████████████████████████████▍                           | 101/139 [00:05<00:01, 21.49it/s] 75%|███████████████████████████████████████████████████████████████████████████▌                         | 104/139 [00:05<00:01, 21.49it/s] 77%|█████████████████████████████████████████████████████████████████████████████▋                       | 107/139 [00:05<00:01, 21.73it/s] 79%|███████████████████████████████████████████████████████████████████████████████▉                     | 110/139 [00:05<00:01, 21.96it/s] 81%|██████████████████████████████████████████████████████████████████████████████████                   | 113/139 [00:06<00:01, 22.01it/s][2025-03-28 01:15:45,401] [INFO] [logging.py:128:log_dist] [Rank 0] step=2200, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:15:45,402] [INFO] [timer.py:264:stop] epoch=0/micro_step=2200/global_step=2200, RunningAvgSamplesPerSec=18.699705535850075, CurrSamplesPerSec=21.930061691020992, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 83%|████████████████████████████████████████████████████████████████████████████████████▎                | 116/139 [00:06<00:01, 21.92it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▍              | 119/139 [00:06<00:00, 22.13it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▋            | 122/139 [00:06<00:00, 21.90it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▊          | 125/139 [00:06<00:00, 21.74it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████        | 128/139 [00:06<00:00, 21.67it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▏     | 131/139 [00:06<00:00, 20.97it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████▎   | 134/139 [00:07<00:00, 20.99it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▌ | 137/139 [00:07<00:00, 21.31it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 139/139 [00:07<00:00, 17.62it/s]
  0%|                                                                                                               | 0/139 [00:00<?, ?it/s]  1%|▋                                                                                                      | 1/139 [00:01<04:20,  1.89s/it]  3%|██▉                                                                                                    | 4/139 [00:02<00:52,  2.55it/s]  5%|█████▏                                                                                                 | 7/139 [00:02<00:26,  4.94it/s]  6%|██████▋                                                                                                | 9/139 [00:02<00:33,  3.92it/s]  8%|████████                                                                                              | 11/139 [00:04<00:52,  2.45it/s]  9%|████████▊                                                                                             | 12/139 [00:04<00:45,  2.80it/s] 10%|██████████▎                                                                                           | 14/139 [00:04<00:31,  3.95it/s] 12%|███████████▋                                                                                          | 16/139 [00:04<00:23,  5.33it/s] 14%|█████████████▉                                                                                        | 19/139 [00:04<00:15,  7.80it/s] 16%|████████████████▏                                                                                     | 22/139 [00:04<00:11, 10.22it/s] 18%|██████████████████▎                                                                                   | 25/139 [00:05<00:09, 12.55it/s][2025-03-28 01:15:52,780] [INFO] [logging.py:128:log_dist] [Rank 0] step=2250, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:15:52,781] [INFO] [timer.py:264:stop] epoch=0/micro_step=2250/global_step=2250, RunningAvgSamplesPerSec=18.39692160161335, CurrSamplesPerSec=21.238036727755894, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 20%|████████████████████▌                                                                                 | 28/139 [00:05<00:07, 14.41it/s] 22%|██████████████████████▋                                                                               | 31/139 [00:05<00:06, 16.18it/s] 24%|████████████████████████▉                                                                             | 34/139 [00:05<00:05, 17.57it/s] 27%|███████████████████████████▏                                                                          | 37/139 [00:05<00:05, 18.61it/s] 29%|█████████████████████████████▎                                                                        | 40/139 [00:05<00:05, 18.68it/s] 31%|███████████████████████████████▌                                                                      | 43/139 [00:05<00:04, 19.53it/s] 33%|█████████████████████████████████▊                                                                    | 46/139 [00:06<00:04, 20.26it/s] 35%|███████████████████████████████████▉                                                                  | 49/139 [00:06<00:04, 20.71it/s] 37%|██████████████████████████████████████▏                                                               | 52/139 [00:06<00:04, 20.80it/s] 40%|████████████████████████████████████████▎                                                             | 55/139 [00:06<00:03, 21.17it/s] 42%|██████████████████████████████████████████▌                                                           | 58/139 [00:06<00:03, 21.31it/s] 44%|████████████████████████████████████████████▊                                                         | 61/139 [00:06<00:03, 21.29it/s] 46%|██████████████████████████████████████████████▉                                                       | 64/139 [00:06<00:03, 20.17it/s] 48%|█████████████████████████████████████████████████▏                                                    | 67/139 [00:07<00:03, 20.65it/s] 50%|███████████████████████████████████████████████████▎                                                  | 70/139 [00:07<00:03, 21.02it/s] 53%|█████████████████████████████████████████████████████▌                                                | 73/139 [00:07<00:03, 21.42it/s][2025-03-28 01:15:55,135] [INFO] [logging.py:128:log_dist] [Rank 0] step=2300, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:15:55,136] [INFO] [timer.py:264:stop] epoch=0/micro_step=2300/global_step=2300, RunningAvgSamplesPerSec=18.451385558934486, CurrSamplesPerSec=21.48135919082413, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 55%|███████████████████████████████████████████████████████▊                                              | 76/139 [00:07<00:02, 21.53it/s] 57%|█████████████████████████████████████████████████████████▉                                            | 79/139 [00:07<00:02, 21.90it/s] 59%|████████████████████████████████████████████████████████████▏                                         | 82/139 [00:07<00:02, 21.89it/s] 61%|██████████████████████████████████████████████████████████████▎                                       | 85/139 [00:07<00:02, 21.67it/s] 63%|████████████████████████████████████████████████████████████████▌                                     | 88/139 [00:08<00:02, 22.18it/s] 65%|██████████████████████████████████████████████████████████████████▊                                   | 91/139 [00:08<00:02, 22.68it/s] 68%|████████████████████████████████████████████████████████████████████▉                                 | 94/139 [00:09<00:08,  5.28it/s] 69%|██████████████████████████████████████████████████████████████████████▍                               | 96/139 [00:10<00:09,  4.64it/s] 71%|███████████████████████████████████████████████████████████████████████▉                              | 98/139 [00:10<00:07,  5.62it/s] 72%|████████████████████████████████████████████████████████████████████████▋                            | 100/139 [00:10<00:05,  6.87it/s] 73%|██████████████████████████████████████████████████████████████████████████                           | 102/139 [00:10<00:04,  8.29it/s] 76%|████████████████████████████████████████████████████████████████████████████▎                        | 105/139 [00:10<00:03, 10.87it/s] 77%|█████████████████████████████████████████████████████████████████████████████▋                       | 107/139 [00:10<00:02, 11.91it/s] 79%|███████████████████████████████████████████████████████████████████████████████▉                     | 110/139 [00:11<00:02, 14.12it/s] 81%|██████████████████████████████████████████████████████████████████████████████████                   | 113/139 [00:11<00:01, 16.09it/s] 83%|████████████████████████████████████████████████████████████████████████████████████▎                | 116/139 [00:11<00:01, 17.61it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▍              | 119/139 [00:11<00:01, 18.88it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▋            | 122/139 [00:11<00:00, 19.75it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▊          | 125/139 [00:11<00:00, 20.39it/s][2025-03-28 01:15:59,440] [INFO] [logging.py:128:log_dist] [Rank 0] step=2350, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:15:59,442] [INFO] [timer.py:264:stop] epoch=0/micro_step=2350/global_step=2350, RunningAvgSamplesPerSec=18.22387102940923, CurrSamplesPerSec=21.66790542970731, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 92%|█████████████████████████████████████████████████████████████████████████████████████████████        | 128/139 [00:11<00:00, 20.96it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▏     | 131/139 [00:12<00:00, 21.29it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████▎   | 134/139 [00:12<00:00, 21.77it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▌ | 137/139 [00:12<00:00, 21.96it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 139/139 [00:12<00:00, 11.18it/s]
  0%|                                                                                                               | 0/139 [00:00<?, ?it/s]  1%|▋                                                                                                      | 1/139 [00:00<00:48,  2.86it/s]  2%|██▏                                                                                                    | 3/139 [00:00<00:17,  7.64it/s]  4%|████▍                                                                                                  | 6/139 [00:00<00:10, 12.62it/s]  6%|██████▋                                                                                                | 9/139 [00:00<00:08, 15.59it/s]  9%|████████▊                                                                                             | 12/139 [00:00<00:07, 17.67it/s] 11%|███████████                                                                                           | 15/139 [00:01<00:06, 19.02it/s] 13%|█████████████▏                                                                                        | 18/139 [00:01<00:06, 20.03it/s] 15%|███████████████▍                                                                                      | 21/139 [00:01<00:05, 21.11it/s] 17%|█████████████████▌                                                                                    | 24/139 [00:01<00:05, 21.96it/s] 19%|███████████████████▊                                                                                  | 27/139 [00:01<00:05, 22.38it/s] 22%|██████████████████████                                                                                | 30/139 [00:01<00:04, 21.85it/s] 24%|████████████████████████▏                                                                             | 33/139 [00:01<00:04, 21.96it/s] 26%|██████████████████████████▍                                                                           | 36/139 [00:01<00:04, 21.93it/s][2025-03-28 01:16:02,107] [INFO] [logging.py:128:log_dist] [Rank 0] step=2400, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:16:02,108] [INFO] [timer.py:264:stop] epoch=0/micro_step=2400/global_step=2400, RunningAvgSamplesPerSec=18.257919671896033, CurrSamplesPerSec=22.264746149444292, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 28%|████████████████████████████▌                                                                         | 39/139 [00:02<00:04, 22.04it/s] 30%|██████████████████████████████▊                                                                       | 42/139 [00:02<00:04, 21.81it/s] 32%|█████████████████████████████████                                                                     | 45/139 [00:02<00:04, 21.75it/s] 35%|███████████████████████████████████▏                                                                  | 48/139 [00:02<00:04, 21.74it/s] 37%|█████████████████████████████████████▍                                                                | 51/139 [00:02<00:04, 21.81it/s] 39%|███████████████████████████████████████▋                                                              | 54/139 [00:02<00:03, 21.77it/s] 41%|█████████████████████████████████████████▊                                                            | 57/139 [00:02<00:03, 21.82it/s] 43%|████████████████████████████████████████████                                                          | 60/139 [00:03<00:03, 21.82it/s] 45%|██████████████████████████████████████████████▏                                                       | 63/139 [00:03<00:03, 21.80it/s] 47%|████████████████████████████████████████████████▍                                                     | 66/139 [00:03<00:03, 21.52it/s] 50%|██████████████████████████████████████████████████▋                                                   | 69/139 [00:03<00:03, 22.03it/s] 52%|████████████████████████████████████████████████████▊                                                 | 72/139 [00:03<00:02, 22.33it/s] 54%|███████████████████████████████████████████████████████                                               | 75/139 [00:03<00:02, 22.04it/s] 56%|█████████████████████████████████████████████████████████▏                                            | 78/139 [00:03<00:02, 22.10it/s] 58%|███████████████████████████████████████████████████████████▍                                          | 81/139 [00:03<00:02, 22.21it/s] 60%|█████████████████████████████████████████████████████████████▋                                        | 84/139 [00:04<00:02, 22.51it/s][2025-03-28 01:16:04,376] [INFO] [logging.py:128:log_dist] [Rank 0] step=2450, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:16:04,376] [INFO] [timer.py:264:stop] epoch=0/micro_step=2450/global_step=2450, RunningAvgSamplesPerSec=18.32301503837222, CurrSamplesPerSec=22.96522357334603, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 63%|███████████████████████████████████████████████████████████████▊                                      | 87/139 [00:04<00:02, 22.43it/s] 65%|██████████████████████████████████████████████████████████████████                                    | 90/139 [00:04<00:02, 22.41it/s] 67%|████████████████████████████████████████████████████████████████████▏                                 | 93/139 [00:04<00:02, 22.40it/s] 69%|██████████████████████████████████████████████████████████████████████▍                               | 96/139 [00:04<00:01, 22.33it/s] 71%|████████████████████████████████████████████████████████████████████████▋                             | 99/139 [00:04<00:01, 22.16it/s] 73%|██████████████████████████████████████████████████████████████████████████                           | 102/139 [00:04<00:01, 22.09it/s] 76%|████████████████████████████████████████████████████████████████████████████▎                        | 105/139 [00:05<00:01, 22.19it/s] 78%|██████████████████████████████████████████████████████████████████████████████▍                      | 108/139 [00:05<00:01, 22.16it/s] 80%|████████████████████████████████████████████████████████████████████████████████▋                    | 111/139 [00:05<00:01, 21.40it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▊                  | 114/139 [00:05<00:01, 21.41it/s] 84%|█████████████████████████████████████████████████████████████████████████████████████                | 117/139 [00:05<00:01, 21.51it/s] 86%|███████████████████████████████████████████████████████████████████████████████████████▏             | 120/139 [00:05<00:00, 21.05it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████████▎           | 123/139 [00:05<00:00, 21.51it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▌         | 126/139 [00:06<00:00, 21.78it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▋       | 129/139 [00:06<00:00, 23.22it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▉     | 132/139 [00:06<00:00, 23.63it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████████   | 135/139 [00:06<00:00, 23.16it/s][2025-03-28 01:16:06,617] [INFO] [logging.py:128:log_dist] [Rank 0] step=2500, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:16:06,618] [INFO] [timer.py:264:stop] epoch=0/micro_step=2500/global_step=2500, RunningAvgSamplesPerSec=18.389527335149406, CurrSamplesPerSec=24.39680816427749, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 99%|████████████████████████████████████████████████████████████████████████████████████████████████████▎| 138/139 [00:06<00:00, 23.45it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 139/139 [00:06<00:00, 20.92it/s]
  0%|                                                                                                               | 0/139 [00:00<?, ?it/s]  1%|▋                                                                                                      | 1/139 [00:00<00:26,  5.19it/s]  2%|██▏                                                                                                    | 3/139 [00:00<00:11, 11.40it/s]  4%|████▍                                                                                                  | 6/139 [00:00<00:08, 15.79it/s]  6%|██████▋                                                                                                | 9/139 [00:00<00:07, 18.12it/s]  9%|████████▊                                                                                             | 12/139 [00:00<00:06, 19.87it/s] 11%|███████████                                                                                           | 15/139 [00:00<00:05, 21.29it/s] 13%|█████████████▏                                                                                        | 18/139 [00:00<00:05, 22.03it/s] 15%|███████████████▍                                                                                      | 21/139 [00:01<00:05, 22.35it/s] 17%|█████████████████▌                                                                                    | 24/139 [00:01<00:05, 22.33it/s] 19%|███████████████████▊                                                                                  | 27/139 [00:01<00:05, 22.28it/s] 22%|██████████████████████                                                                                | 30/139 [00:01<00:04, 22.23it/s] 24%|████████████████████████▏                                                                             | 33/139 [00:01<00:04, 22.70it/s] 26%|██████████████████████████▍                                                                           | 36/139 [00:01<00:04, 23.59it/s] 28%|████████████████████████████▌                                                                         | 39/139 [00:01<00:04, 23.64it/s] 30%|██████████████████████████████▊                                                                       | 42/139 [00:01<00:04, 23.66it/s] 32%|█████████████████████████████████                                                                     | 45/139 [00:02<00:03, 23.85it/s][2025-03-28 01:16:09,060] [INFO] [logging.py:128:log_dist] [Rank 0] step=2550, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:16:09,061] [INFO] [timer.py:264:stop] epoch=0/micro_step=2550/global_step=2550, RunningAvgSamplesPerSec=18.449521654580714, CurrSamplesPerSec=21.459048739465626, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 35%|███████████████████████████████████▏                                                                  | 48/139 [00:02<00:03, 23.05it/s] 37%|█████████████████████████████████████▍                                                                | 51/139 [00:02<00:03, 23.07it/s] 39%|███████████████████████████████████████▋                                                              | 54/139 [00:02<00:03, 23.42it/s] 41%|█████████████████████████████████████████▊                                                            | 57/139 [00:02<00:03, 23.35it/s] 43%|████████████████████████████████████████████                                                          | 60/139 [00:02<00:03, 23.49it/s] 45%|██████████████████████████████████████████████▏                                                       | 63/139 [00:02<00:03, 23.63it/s] 47%|████████████████████████████████████████████████▍                                                     | 66/139 [00:03<00:03, 23.63it/s] 50%|██████████████████████████████████████████████████▋                                                   | 69/139 [00:03<00:02, 23.65it/s] 52%|████████████████████████████████████████████████████▊                                                 | 72/139 [00:03<00:02, 23.68it/s] 54%|███████████████████████████████████████████████████████                                               | 75/139 [00:03<00:02, 23.41it/s] 56%|█████████████████████████████████████████████████████████▏                                            | 78/139 [00:03<00:02, 23.26it/s] 58%|███████████████████████████████████████████████████████████▍                                          | 81/139 [00:03<00:02, 23.70it/s] 60%|█████████████████████████████████████████████████████████████▋                                        | 84/139 [00:03<00:02, 23.09it/s] 63%|███████████████████████████████████████████████████████████████▊                                      | 87/139 [00:03<00:02, 23.14it/s] 65%|██████████████████████████████████████████████████████████████████                                    | 90/139 [00:04<00:02, 23.41it/s] 67%|████████████████████████████████████████████████████████████████████▏                                 | 93/139 [00:04<00:01, 23.37it/s] 69%|██████████████████████████████████████████████████████████████████████▍                               | 96/139 [00:04<00:01, 23.50it/s][2025-03-28 01:16:11,186] [INFO] [logging.py:128:log_dist] [Rank 0] step=2600, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:16:11,186] [INFO] [timer.py:264:stop] epoch=0/micro_step=2600/global_step=2600, RunningAvgSamplesPerSec=18.52715849194783, CurrSamplesPerSec=24.49426079017935, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 71%|████████████████████████████████████████████████████████████████████████▋                             | 99/139 [00:04<00:01, 23.62it/s] 73%|██████████████████████████████████████████████████████████████████████████                           | 102/139 [00:04<00:01, 23.35it/s] 76%|████████████████████████████████████████████████████████████████████████████▎                        | 105/139 [00:04<00:01, 23.00it/s] 78%|██████████████████████████████████████████████████████████████████████████████▍                      | 108/139 [00:04<00:01, 22.05it/s] 80%|████████████████████████████████████████████████████████████████████████████████▋                    | 111/139 [00:04<00:01, 21.82it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▊                  | 114/139 [00:05<00:01, 21.97it/s] 84%|█████████████████████████████████████████████████████████████████████████████████████                | 117/139 [00:05<00:01, 21.40it/s] 86%|███████████████████████████████████████████████████████████████████████████████████████▏             | 120/139 [00:05<00:00, 21.45it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████████▎           | 123/139 [00:05<00:00, 21.11it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▌         | 126/139 [00:05<00:00, 20.65it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▋       | 129/139 [00:05<00:00, 19.75it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▏     | 131/139 [00:05<00:00, 18.58it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▋    | 133/139 [00:06<00:00, 18.73it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████████   | 135/139 [00:06<00:00, 18.64it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▌ | 137/139 [00:06<00:00, 18.75it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 139/139 [00:06<00:00, 18.97it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 139/139 [00:06<00:00, 21.45it/s]
  0%|                                                                                                               | 0/139 [00:00<?, ?it/s]  1%|▋                                                                                                      | 1/139 [00:00<00:57,  2.39it/s]  2%|██▏                                                                                                    | 3/139 [00:00<00:19,  6.85it/s]  4%|███▋                                                                                                   | 5/139 [00:00<00:13, 10.30it/s]  6%|█████▉                                                                                                 | 8/139 [00:00<00:09, 13.75it/s][2025-03-28 01:16:14,148] [INFO] [logging.py:128:log_dist] [Rank 0] step=2650, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:16:14,152] [INFO] [timer.py:264:stop] epoch=0/micro_step=2650/global_step=2650, RunningAvgSamplesPerSec=18.51602240823892, CurrSamplesPerSec=15.394698528353711, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
  7%|███████▎                                                                                              | 10/139 [00:00<00:08, 14.70it/s]  9%|████████▊                                                                                             | 12/139 [00:00<00:08, 15.75it/s] 10%|██████████▎                                                                                           | 14/139 [00:01<00:07, 16.53it/s] 12%|████████████▍                                                                                         | 17/139 [00:01<00:06, 18.72it/s] 14%|██████████████▋                                                                                       | 20/139 [00:01<00:05, 20.36it/s] 17%|████████████████▉                                                                                     | 23/139 [00:01<00:05, 19.98it/s] 19%|███████████████████                                                                                   | 26/139 [00:01<00:05, 19.25it/s] 20%|████████████████████▌                                                                                 | 28/139 [00:01<00:05, 19.41it/s] 22%|██████████████████████                                                                                | 30/139 [00:01<00:05, 19.40it/s] 23%|███████████████████████▍                                                                              | 32/139 [00:01<00:05, 19.11it/s] 24%|████████████████████████▉                                                                             | 34/139 [00:02<00:05, 18.57it/s] 26%|██████████████████████████▍                                                                           | 36/139 [00:02<00:05, 18.51it/s] 27%|███████████████████████████▉                                                                          | 38/139 [00:02<00:05, 18.51it/s] 29%|██████████████████████████████                                                                        | 41/139 [00:02<00:05, 18.73it/s] 31%|███████████████████████████████▌                                                                      | 43/139 [00:02<00:05, 18.50it/s] 32%|█████████████████████████████████                                                                     | 45/139 [00:02<00:05, 18.10it/s] 34%|██████████████████████████████████▍                                                                   | 47/139 [00:02<00:05, 17.83it/s] 35%|███████████████████████████████████▉                                                                  | 49/139 [00:02<00:05, 17.82it/s] 37%|█████████████████████████████████████▍                                                                | 51/139 [00:03<00:04, 18.10it/s] 38%|██████████████████████████████████████▉                                                               | 53/139 [00:03<00:04, 18.47it/s] 40%|████████████████████████████████████████▎                                                             | 55/139 [00:03<00:04, 18.27it/s] 41%|█████████████████████████████████████████▊                                                            | 57/139 [00:03<00:04, 17.92it/s][2025-03-28 01:16:16,806] [INFO] [logging.py:128:log_dist] [Rank 0] step=2700, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:16:16,810] [INFO] [timer.py:264:stop] epoch=0/micro_step=2700/global_step=2700, RunningAvgSamplesPerSec=18.5220809921247, CurrSamplesPerSec=17.089530986044025, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 42%|███████████████████████████████████████████▎                                                          | 59/139 [00:03<00:04, 17.67it/s] 44%|████████████████████████████████████████████▊                                                         | 61/139 [00:03<00:04, 17.71it/s] 45%|██████████████████████████████████████████████▏                                                       | 63/139 [00:03<00:04, 18.16it/s] 47%|███████████████████████████████████████████████▋                                                      | 65/139 [00:03<00:04, 18.27it/s] 48%|█████████████████████████████████████████████████▏                                                    | 67/139 [00:03<00:03, 18.36it/s] 50%|███████████████████████████████████████████████████▎                                                  | 70/139 [00:04<00:03, 19.61it/s] 53%|█████████████████████████████████████████████████████▌                                                | 73/139 [00:04<00:03, 20.36it/s] 55%|███████████████████████████████████████████████████████▊                                              | 76/139 [00:04<00:03, 20.92it/s] 57%|█████████████████████████████████████████████████████████▉                                            | 79/139 [00:04<00:02, 20.60it/s] 59%|████████████████████████████████████████████████████████████▏                                         | 82/139 [00:04<00:02, 19.37it/s] 60%|█████████████████████████████████████████████████████████████▋                                        | 84/139 [00:04<00:02, 18.81it/s] 62%|███████████████████████████████████████████████████████████████                                       | 86/139 [00:04<00:02, 18.38it/s] 63%|████████████████████████████████████████████████████████████████▌                                     | 88/139 [00:05<00:02, 18.04it/s] 65%|██████████████████████████████████████████████████████████████████                                    | 90/139 [00:05<00:02, 17.79it/s] 66%|███████████████████████████████████████████████████████████████████▌                                  | 92/139 [00:05<00:02, 17.78it/s] 68%|████████████████████████████████████████████████████████████████████▉                                 | 94/139 [00:05<00:02, 17.77it/s] 69%|██████████████████████████████████████████████████████████████████████▍                               | 96/139 [00:05<00:02, 17.60it/s] 71%|███████████████████████████████████████████████████████████████████████▉                              | 98/139 [00:05<00:02, 17.86it/s] 73%|█████████████████████████████████████████████████████████████████████████▍                           | 101/139 [00:05<00:01, 19.05it/s] 75%|███████████████████████████████████████████████████████████████████████████▌                         | 104/139 [00:05<00:01, 19.80it/s] 76%|█████████████████████████████████████████████████████████████████████████████                        | 106/139 [00:05<00:01, 19.49it/s][2025-03-28 01:16:19,420] [INFO] [logging.py:128:log_dist] [Rank 0] step=2750, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:16:19,420] [INFO] [timer.py:264:stop] epoch=0/micro_step=2750/global_step=2750, RunningAvgSamplesPerSec=18.534050082164942, CurrSamplesPerSec=21.156086299401313, MemAllocated=0.11GB, MaxMemAllocated=1.99GB
 78%|███████████████████████████████████████████████████████████████████████████████▏                     | 109/139 [00:06<00:01, 20.16it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▍                   | 112/139 [00:06<00:01, 19.93it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▊                  | 114/139 [00:06<00:01, 19.48it/s] 83%|████████████████████████████████████████████████████████████████████████████████████▎                | 116/139 [00:06<00:01, 18.82it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▋               | 118/139 [00:06<00:01, 17.68it/s] 86%|███████████████████████████████████████████████████████████████████████████████████████▏             | 120/139 [00:06<00:01, 17.70it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▋            | 122/139 [00:06<00:00, 17.37it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████           | 124/139 [00:06<00:00, 17.30it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▌         | 126/139 [00:07<00:00, 17.20it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████        | 128/139 [00:07<00:00, 17.25it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▍      | 130/139 [00:07<00:00, 17.38it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▉     | 132/139 [00:07<00:00, 17.59it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████████   | 135/139 [00:07<00:00, 19.48it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████▎| 138/139 [00:07<00:00, 20.81it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 139/139 [00:07<00:00, 17.85it/s]
[rank0]: Traceback (most recent call last):
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/main.py", line 9, in <module>
[rank0]:     train_deepspeed(cfg)
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/train.py", line 209, in train_deepspeed
[rank0]:     generate_during_training(model_engine, sample_dir, config, epoch, num_images=config.num_images//config.image_size, p=p)
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/generate.py", line 233, in generate_during_training_simulation_dif
[rank0]:     pred_noise = model_engine(x, t_batch)
[rank0]:                  ^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/deepspeed/utils/nvtx.py", line 18, in wrapped_fn
[rank0]:     ret_val = func(*args, **kwargs)
[rank0]:               ^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/deepspeed/runtime/engine.py", line 1987, in forward
[rank0]:     loss = self.module(*inputs, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/unet.py", line 216, in forward
[rank0]:     return self.final_conv(x)
[rank0]:            ^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
[rank0]:     input = module(input)
[rank0]:             ^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 554, in forward
[rank0]:     return self._conv_forward(input, self.weight, self.bias)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
[rank0]:     return F.conv2d(
[rank0]:            ^^^^^^^^^
[rank0]: torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 20.00 MiB. GPU 0 has a total capacity of 47.33 GiB of which 13.69 MiB is free. Process 3785418 has 294.00 MiB memory in use. Process 3794194 has 4.08 GiB memory in use. Process 3794200 has 3.12 GiB memory in use. Process 3794201 has 3.12 GiB memory in use. Process 3794198 has 10.93 GiB memory in use. Process 2545723 has 25.72 GiB memory in use. Of the allocated memory 24.41 GiB is allocated by PyTorch, and 675.00 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
[rank0]:[W328 01:16:26.762953340 ProcessGroupNCCL.cpp:1496] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[2025-03-28 01:16:27,855] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 578393
[2025-03-28 01:16:27,855] [ERROR] [launch.py:325:sigkill_handler] ['/hpc2hdd/home/yli045/.conda/envs/ywj/bin/python', '-u', 'main.py', '--local_rank=0', '--image_size', '64', '--batch_size', '1', '--num_epochs', '20', '--timesteps', '1000', '--lr', '2e-4', '--time_emb_dim', '32', '--mu1', '4', '--sigma1', '1', '--num1', '9000', '--mu2', '10', '--sigma2', '4', '--num2', '1000', '--samples_dir', './samples', '--checkpoints_dir', './checkpoints', '--fp16', '--mode', 'train', '--model_path', '', '--num_images', '1000', '--simulation_distribution', 'normal', '--use_different_noise', '--use_moe', '--num_experts', '2', '--moe_hidden_dim', '2', '--moe_tau', '0.1'] exits with return code = 1
[?2004h(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ bash scripts/script_normal_dif_test.sh 
[?2004l[2025-03-28 01:16:50,704] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-28 01:16:50,711] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-28 01:16:53,020] [WARNING] [runner.py:215:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2025-03-28 01:16:53,021] [INFO] [runner.py:607:main] cmd = /hpc2hdd/home/yli045/.conda/envs/ywj/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None main.py --image_size 16 --batch_size 1 --num_epochs 20 --timesteps 1000 --lr 2e-4 --time_emb_dim 32 --mu1 4 --sigma1 1 --num1 9000 --mu2 10 --sigma2 4 --num2 1000 --samples_dir ./samples --checkpoints_dir ./checkpoints --fp16 --mode train --model_path  --num_images 1000 --simulation_distribution normal --use_different_noise --use_moe --num_experts 2 --moe_hidden_dim 2 --moe_tau 0.1
[2025-03-28 01:16:55,891] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-28 01:16:55,899] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-28 01:16:57,064] [INFO] [launch.py:146:main] WORLD INFO DICT: {'localhost': [0]}
[2025-03-28 01:16:57,064] [INFO] [launch.py:152:main] nnodes=1, num_local_procs=1, node_rank=0
[2025-03-28 01:16:57,064] [INFO] [launch.py:163:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2025-03-28 01:16:57,064] [INFO] [launch.py:164:main] dist_world_size=1
[2025-03-28 01:16:57,064] [INFO] [launch.py:168:main] Setting CUDA_VISIBLE_DEVICES=0
[2025-03-28 01:16:57,065] [INFO] [launch.py:256:main] process 580064 spawned with command: ['/hpc2hdd/home/yli045/.conda/envs/ywj/bin/python', '-u', 'main.py', '--local_rank=0', '--image_size', '16', '--batch_size', '1', '--num_epochs', '20', '--timesteps', '1000', '--lr', '2e-4', '--time_emb_dim', '32', '--mu1', '4', '--sigma1', '1', '--num1', '9000', '--mu2', '10', '--sigma2', '4', '--num2', '1000', '--samples_dir', './samples', '--checkpoints_dir', './checkpoints', '--fp16', '--mode', 'train', '--model_path', '', '--num_images', '1000', '--simulation_distribution', 'normal', '--use_different_noise', '--use_moe', '--num_experts', '2', '--moe_hidden_dim', '2', '--moe_tau', '0.1']
[2025-03-28 01:17:01,675] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-03-28 01:17:14,899] [INFO] [logging.py:128:log_dist] [Rank -1] DeepSpeed info: version=0.16.4, git-hash=unknown, git-branch=unknown
[2025-03-28 01:17:14,900] [INFO] [comm.py:658:init_distributed] cdb=None
[2025-03-28 01:17:14,900] [INFO] [comm.py:689:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2025-03-28 01:17:14,904] [INFO] [config.py:734:__init__] Config mesh_device None world_size = 1
[2025-03-28 01:17:16,860] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
Using /hpc2hdd/home/yli045/.cache/torch_extensions/py312_cu124 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /hpc2hdd/home/yli045/.cache/torch_extensions/py312_cu124/fused_adam/build.ninja...
/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/utils/cpp_extension.py:2059: UserWarning: TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation. 
If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'].
  warnings.warn(
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 0.18775296211242676 seconds
[2025-03-28 01:17:17,053] [INFO] [logging.py:128:log_dist] [Rank 0] Using DeepSpeed Optimizer param name adamw as basic optimizer
[2025-03-28 01:17:17,054] [INFO] [logging.py:128:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2025-03-28 01:17:17,056] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Basic Optimizer = FusedAdam
[2025-03-28 01:17:17,056] [INFO] [utils.py:59:is_zero_supported_optimizer] Checking ZeRO support for optimizer=FusedAdam type=<class 'deepspeed.ops.adam.fused_adam.FusedAdam'>
[2025-03-28 01:17:17,056] [INFO] [logging.py:128:log_dist] [Rank 0] Creating torch.float16 ZeRO stage 2 optimizer
[2025-03-28 01:17:17,057] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 500000000
[2025-03-28 01:17:17,057] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 500000000
[2025-03-28 01:17:17,057] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2025-03-28 01:17:17,057] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2025-03-28 01:17:17,899] [INFO] [utils.py:781:see_memory_usage] Before initializing optimizer states
[2025-03-28 01:17:17,899] [INFO] [utils.py:782:see_memory_usage] MA 0.0 GB         Max_MA 0.0 GB         CA 0.02 GB         Max_CA 0 GB 
[2025-03-28 01:17:17,900] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 151.02 GB, percent = 15.0%
[2025-03-28 01:17:18,025] [INFO] [utils.py:781:see_memory_usage] After initializing optimizer states
[2025-03-28 01:17:18,025] [INFO] [utils.py:782:see_memory_usage] MA 0.0 GB         Max_MA 0.0 GB         CA 0.02 GB         Max_CA 0 GB 
[2025-03-28 01:17:18,025] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 151.0 GB, percent = 15.0%
[2025-03-28 01:17:18,025] [INFO] [stage_1_and_2.py:550:__init__] optimizer state initialized
[2025-03-28 01:17:18,160] [INFO] [utils.py:781:see_memory_usage] After initializing ZeRO optimizer
[2025-03-28 01:17:18,160] [INFO] [utils.py:782:see_memory_usage] MA 0.0 GB         Max_MA 0.0 GB         CA 0.02 GB         Max_CA 0 GB 
[2025-03-28 01:17:18,161] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 151.52 GB, percent = 15.0%
[2025-03-28 01:17:18,162] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Final Optimizer = DeepSpeedZeroOptimizer
[2025-03-28 01:17:18,162] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed using configured LR scheduler = None
[2025-03-28 01:17:18,162] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2025-03-28 01:17:18,162] [INFO] [logging.py:128:log_dist] [Rank 0] step=0, skipped=0, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:17:18,162] [INFO] [config.py:1001:print] DeepSpeedEngine configuration:
[2025-03-28 01:17:18,163] [INFO] [config.py:1005:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2025-03-28 01:17:18,163] [INFO] [config.py:1005:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'intra_op_parallelism': 1, 'single_submit': False, 'overlap_events': True, 'use_gds': False}
[2025-03-28 01:17:18,163] [INFO] [config.py:1005:print]   amp_enabled .................. False
[2025-03-28 01:17:18,163] [INFO] [config.py:1005:print]   amp_params ................... False
[2025-03-28 01:17:18,163] [INFO] [config.py:1005:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2025-03-28 01:17:18,163] [INFO] [config.py:1005:print]   bfloat16_enabled ............. False
[2025-03-28 01:17:18,163] [INFO] [config.py:1005:print]   bfloat16_immediate_grad_update  False
[2025-03-28 01:17:18,163] [INFO] [config.py:1005:print]   checkpoint_parallel_write_pipeline  False
[2025-03-28 01:17:18,163] [INFO] [config.py:1005:print]   checkpoint_tag_validation_enabled  True
[2025-03-28 01:17:18,163] [INFO] [config.py:1005:print]   checkpoint_tag_validation_fail  False
[2025-03-28 01:17:18,163] [INFO] [config.py:1005:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fab65b96b70>
[2025-03-28 01:17:18,163] [INFO] [config.py:1005:print]   communication_data_type ...... None
[2025-03-28 01:17:18,164] [INFO] [config.py:1005:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2025-03-28 01:17:18,164] [INFO] [config.py:1005:print]   curriculum_enabled_legacy .... False
[2025-03-28 01:17:18,164] [INFO] [config.py:1005:print]   curriculum_params_legacy ..... False
[2025-03-28 01:17:18,164] [INFO] [config.py:1005:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2025-03-28 01:17:18,164] [INFO] [config.py:1005:print]   data_efficiency_enabled ...... False
[2025-03-28 01:17:18,164] [INFO] [config.py:1005:print]   dataloader_drop_last ......... False
[2025-03-28 01:17:18,164] [INFO] [config.py:1005:print]   disable_allgather ............ False
[2025-03-28 01:17:18,164] [INFO] [config.py:1005:print]   dump_state ................... False
[2025-03-28 01:17:18,164] [INFO] [config.py:1005:print]   dynamic_loss_scale_args ...... {'init_scale': 65536, 'scale_window': 1000, 'delayed_shift': 2, 'consecutive_hysteresis': False, 'min_scale': 1}
[2025-03-28 01:17:18,164] [INFO] [config.py:1005:print]   eigenvalue_enabled ........... False
[2025-03-28 01:17:18,164] [INFO] [config.py:1005:print]   eigenvalue_gas_boundary_resolution  1
[2025-03-28 01:17:18,164] [INFO] [config.py:1005:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2025-03-28 01:17:18,164] [INFO] [config.py:1005:print]   eigenvalue_layer_num ......... 0
[2025-03-28 01:17:18,164] [INFO] [config.py:1005:print]   eigenvalue_max_iter .......... 100
[2025-03-28 01:17:18,164] [INFO] [config.py:1005:print]   eigenvalue_stability ......... 1e-06
[2025-03-28 01:17:18,164] [INFO] [config.py:1005:print]   eigenvalue_tol ............... 0.01
[2025-03-28 01:17:18,164] [INFO] [config.py:1005:print]   eigenvalue_verbose ........... False
[2025-03-28 01:17:18,164] [INFO] [config.py:1005:print]   elasticity_enabled ........... False
[2025-03-28 01:17:18,164] [INFO] [config.py:1005:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2025-03-28 01:17:18,164] [INFO] [config.py:1005:print]   fp16_auto_cast ............... False
[2025-03-28 01:17:18,164] [INFO] [config.py:1005:print]   fp16_enabled ................. True
[2025-03-28 01:17:18,164] [INFO] [config.py:1005:print]   fp16_master_weights_and_gradients  False
[2025-03-28 01:17:18,164] [INFO] [config.py:1005:print]   global_rank .................. 0
[2025-03-28 01:17:18,164] [INFO] [config.py:1005:print]   grad_accum_dtype ............. None
[2025-03-28 01:17:18,164] [INFO] [config.py:1005:print]   gradient_accumulation_steps .. 1
[2025-03-28 01:17:18,165] [INFO] [config.py:1005:print]   gradient_clipping ............ 1.0
[2025-03-28 01:17:18,165] [INFO] [config.py:1005:print]   gradient_predivide_factor .... 1.0
[2025-03-28 01:17:18,165] [INFO] [config.py:1005:print]   graph_harvesting ............. False
[2025-03-28 01:17:18,165] [INFO] [config.py:1005:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2025-03-28 01:17:18,165] [INFO] [config.py:1005:print]   initial_dynamic_scale ........ 65536
[2025-03-28 01:17:18,165] [INFO] [config.py:1005:print]   load_universal_checkpoint .... False
[2025-03-28 01:17:18,165] [INFO] [config.py:1005:print]   loss_scale ................... 0
[2025-03-28 01:17:18,165] [INFO] [config.py:1005:print]   memory_breakdown ............. False
[2025-03-28 01:17:18,165] [INFO] [config.py:1005:print]   mics_hierarchial_params_gather  False
[2025-03-28 01:17:18,165] [INFO] [config.py:1005:print]   mics_shard_size .............. -1
[2025-03-28 01:17:18,165] [INFO] [config.py:1005:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') comet=CometConfig(enabled=False, samples_log_interval=100, project=None, workspace=None, api_key=None, experiment_name=None, experiment_key=None, online=None, mode=None) wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName')
[2025-03-28 01:17:18,165] [INFO] [config.py:1005:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2025-03-28 01:17:18,165] [INFO] [config.py:1005:print]   optimizer_legacy_fusion ...... False
[2025-03-28 01:17:18,165] [INFO] [config.py:1005:print]   optimizer_name ............... adamw
[2025-03-28 01:17:18,165] [INFO] [config.py:1005:print]   optimizer_params ............. {'lr': 0.0002, 'weight_decay': 0.01}
[2025-03-28 01:17:18,165] [INFO] [config.py:1005:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2025-03-28 01:17:18,165] [INFO] [config.py:1005:print]   pld_enabled .................. False
[2025-03-28 01:17:18,165] [INFO] [config.py:1005:print]   pld_params ................... False
[2025-03-28 01:17:18,165] [INFO] [config.py:1005:print]   prescale_gradients ........... False
[2025-03-28 01:17:18,165] [INFO] [config.py:1005:print]   scheduler_name ............... None
[2025-03-28 01:17:18,165] [INFO] [config.py:1005:print]   scheduler_params ............. None
[2025-03-28 01:17:18,165] [INFO] [config.py:1005:print]   seq_parallel_communication_data_type  torch.float32
[2025-03-28 01:17:18,165] [INFO] [config.py:1005:print]   sparse_attention ............. None
[2025-03-28 01:17:18,166] [INFO] [config.py:1005:print]   sparse_gradients_enabled ..... False
[2025-03-28 01:17:18,166] [INFO] [config.py:1005:print]   steps_per_print .............. 50
[2025-03-28 01:17:18,166] [INFO] [config.py:1005:print]   tensor_parallel_config ....... dtype=torch.float16 autotp_size=0 tensor_parallel=TPConfig(tp_size=1, tp_grain_size=1, mpu=None, tp_group=None) injection_policy_tuple=None keep_module_on_host=False replace_with_kernel_inject=False
[2025-03-28 01:17:18,166] [INFO] [config.py:1005:print]   timers_config ................ enabled=True synchronized=True
[2025-03-28 01:17:18,166] [INFO] [config.py:1005:print]   train_batch_size ............. 1
[2025-03-28 01:17:18,166] [INFO] [config.py:1005:print]   train_micro_batch_size_per_gpu  1
[2025-03-28 01:17:18,166] [INFO] [config.py:1005:print]   use_data_before_expert_parallel_  False
[2025-03-28 01:17:18,166] [INFO] [config.py:1005:print]   use_node_local_storage ....... False
[2025-03-28 01:17:18,166] [INFO] [config.py:1005:print]   wall_clock_breakdown ......... False
[2025-03-28 01:17:18,166] [INFO] [config.py:1005:print]   weight_quantization_config ... None
[2025-03-28 01:17:18,166] [INFO] [config.py:1005:print]   world_size ................... 1
[2025-03-28 01:17:18,166] [INFO] [config.py:1005:print]   zero_allow_untested_optimizer  False
[2025-03-28 01:17:18,166] [INFO] [config.py:1005:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=500000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50000000 param_persistence_threshold=100000 model_persistence_threshold=9223372036854775807 max_live_parameters=1000000000 max_reuse_distance=1000000000 gather_16bit_weights_on_model_save=False module_granularity_threshold=0 use_all_reduce_for_fetch_params=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False zeropp_loco_param=None mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True log_trace_cache_warnings=False
[2025-03-28 01:17:18,166] [INFO] [config.py:1005:print]   zero_enabled ................. True
[2025-03-28 01:17:18,166] [INFO] [config.py:1005:print]   zero_force_ds_cpu_optimizer .. True
[2025-03-28 01:17:18,166] [INFO] [config.py:1005:print]   zero_optimization_stage ...... 2
[2025-03-28 01:17:18,166] [INFO] [config.py:991:print_user_config]   json = {
    "train_batch_size": 1, 
    "gradient_accumulation_steps": 1, 
    "optimizer": {
        "type": "AdamW", 
        "params": {
            "lr": 0.0002, 
            "weight_decay": 0.01
        }
    }, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "loss_scale_window": 1000
    }, 
    "zero_optimization": {
        "stage": 2, 
        "contiguous_gradients": true, 
        "overlap_comm": true
    }, 
    "steps_per_print": 50, 
    "gradient_clipping": 1.0
}
****START TRAINING****
image_size: 16, batch_size: 1, timesteps: 1000, time_emb_dim: 32
  0%|                                                                                                               | 0/561 [00:00<?, ?it/s][2025-03-28 01:17:19,990] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
  0%|▏                                                                                                      | 1/561 [00:01<16:35,  1.78s/it][2025-03-28 01:17:20,027] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
  1%|▌                                                                                                      | 3/561 [00:02<05:40,  1.64it/s]  1%|▉                                                                                                      | 5/561 [00:02<03:01,  3.07it/s]  1%|█▍                                                                                                     | 8/561 [00:02<01:39,  5.57it/s]  2%|██                                                                                                    | 11/561 [00:02<01:07,  8.18it/s]  2%|██▌                                                                                                   | 14/561 [00:02<00:51, 10.72it/s]  3%|███                                                                                                   | 17/561 [00:02<00:41, 13.15it/s]  4%|███▋                                                                                                  | 20/561 [00:02<00:34, 15.51it/s]  4%|████▏                                                                                                 | 23/561 [00:03<00:30, 17.43it/s]  5%|████▋                                                                                                 | 26/561 [00:03<00:28, 19.03it/s]  5%|█████▎                                                                                                | 29/561 [00:03<00:26, 20.15it/s]  6%|█████▊                                                                                                | 32/561 [00:03<00:24, 21.20it/s]  6%|██████▎                                                                                               | 35/561 [00:03<00:23, 22.04it/s]  7%|██████▉                                                                                               | 38/561 [00:03<00:23, 22.54it/s]  7%|███████▍                                                                                              | 41/561 [00:03<00:22, 22.74it/s]  8%|████████                                                                                              | 44/561 [00:04<00:23, 21.61it/s]  8%|████████▌                                                                                             | 47/561 [00:04<00:23, 21.72it/s][2025-03-28 01:17:22,494] [INFO] [logging.py:128:log_dist] [Rank 0] step=50, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:17:22,495] [INFO] [timer.py:264:stop] epoch=0/micro_step=50/global_step=50, RunningAvgSamplesPerSec=19.494750039725112, CurrSamplesPerSec=22.90952938091229, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
  9%|█████████                                                                                             | 50/561 [00:04<00:23, 21.80it/s]  9%|█████████▋                                                                                            | 53/561 [00:04<00:22, 22.16it/s] 10%|██████████▏                                                                                           | 56/561 [00:04<00:22, 22.24it/s] 11%|██████████▋                                                                                           | 59/561 [00:04<00:22, 22.23it/s] 11%|███████████▎                                                                                          | 62/561 [00:04<00:22, 21.98it/s] 12%|███████████▊                                                                                          | 65/561 [00:04<00:22, 21.98it/s] 12%|████████████▎                                                                                         | 68/561 [00:05<00:23, 21.36it/s] 13%|████████████▉                                                                                         | 71/561 [00:05<00:22, 21.45it/s] 13%|█████████████▍                                                                                        | 74/561 [00:05<00:22, 21.65it/s] 14%|██████████████                                                                                        | 77/561 [00:05<00:22, 21.55it/s] 14%|██████████████▌                                                                                       | 80/561 [00:05<00:23, 20.54it/s] 15%|███████████████                                                                                       | 83/561 [00:05<00:23, 20.61it/s] 15%|███████████████▋                                                                                      | 86/561 [00:05<00:22, 20.83it/s] 16%|████████████████▏                                                                                     | 89/561 [00:06<00:22, 20.85it/s] 16%|████████████████▋                                                                                     | 92/561 [00:06<00:22, 20.91it/s] 17%|█████████████████▎                                                                                    | 95/561 [00:06<00:22, 20.44it/s] 17%|█████████████████▊                                                                                    | 98/561 [00:06<00:22, 20.44it/s][2025-03-28 01:17:24,861] [INFO] [logging.py:128:log_dist] [Rank 0] step=100, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:17:24,864] [INFO] [timer.py:264:stop] epoch=0/micro_step=100/global_step=100, RunningAvgSamplesPerSec=20.309679360062106, CurrSamplesPerSec=19.88281703660622, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 18%|██████████████████▏                                                                                  | 101/561 [00:06<00:22, 20.77it/s] 19%|██████████████████▋                                                                                  | 104/561 [00:06<00:22, 20.28it/s] 19%|███████████████████▎                                                                                 | 107/561 [00:07<00:22, 20.27it/s] 20%|███████████████████▊                                                                                 | 110/561 [00:07<00:21, 20.59it/s] 20%|████████████████████▎                                                                                | 113/561 [00:07<00:21, 20.67it/s] 21%|████████████████████▉                                                                                | 116/561 [00:07<00:21, 20.87it/s] 21%|█████████████████████▍                                                                               | 119/561 [00:07<00:21, 20.97it/s] 22%|█████████████████████▉                                                                               | 122/561 [00:07<00:21, 20.11it/s] 22%|██████████████████████▌                                                                              | 125/561 [00:07<00:22, 19.62it/s] 23%|██████████████████████▊                                                                              | 127/561 [00:08<00:22, 19.05it/s] 23%|███████████████████████▏                                                                             | 129/561 [00:08<00:23, 18.77it/s] 24%|███████████████████████▊                                                                             | 132/561 [00:08<00:22, 18.98it/s] 24%|████████████████████████                                                                             | 134/561 [00:08<00:22, 18.88it/s] 24%|████████████████████████▍                                                                            | 136/561 [00:08<00:22, 18.82it/s] 25%|████████████████████████▊                                                                            | 138/561 [00:08<00:22, 18.74it/s] 25%|█████████████████████████▏                                                                           | 140/561 [00:08<00:22, 18.87it/s] 25%|█████████████████████████▌                                                                           | 142/561 [00:08<00:22, 18.80it/s] 26%|█████████████████████████▉                                                                           | 144/561 [00:08<00:22, 18.73it/s] 26%|██████████████████████████▎                                                                          | 146/561 [00:09<00:22, 18.72it/s] 26%|██████████████████████████▋                                                                          | 148/561 [00:09<00:22, 18.54it/s][2025-03-28 01:17:27,446] [INFO] [logging.py:128:log_dist] [Rank 0] step=150, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:17:27,449] [INFO] [timer.py:264:stop] epoch=0/micro_step=150/global_step=150, RunningAvgSamplesPerSec=19.98776669079661, CurrSamplesPerSec=18.139711945149728, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 27%|███████████████████████████                                                                          | 150/561 [00:09<00:21, 18.74it/s] 27%|███████████████████████████▎                                                                         | 152/561 [00:09<00:21, 18.77it/s] 27%|███████████████████████████▋                                                                         | 154/561 [00:09<00:21, 18.74it/s] 28%|████████████████████████████                                                                         | 156/561 [00:09<00:21, 18.55it/s] 28%|████████████████████████████▍                                                                        | 158/561 [00:09<00:21, 18.59it/s] 29%|████████████████████████████▊                                                                        | 160/561 [00:09<00:21, 18.63it/s] 29%|█████████████████████████████▏                                                                       | 162/561 [00:09<00:21, 18.82it/s] 29%|█████████████████████████████▌                                                                       | 164/561 [00:09<00:21, 18.80it/s] 30%|██████████████████████████████                                                                       | 167/561 [00:10<00:19, 20.21it/s] 30%|██████████████████████████████▌                                                                      | 170/561 [00:10<00:18, 21.31it/s] 31%|███████████████████████████████▏                                                                     | 173/561 [00:10<00:17, 22.12it/s] 31%|███████████████████████████████▋                                                                     | 176/561 [00:10<00:18, 21.30it/s] 32%|████████████████████████████████▏                                                                    | 179/561 [00:10<00:18, 20.61it/s] 32%|████████████████████████████████▊                                                                    | 182/561 [00:10<00:18, 20.26it/s] 33%|█████████████████████████████████▎                                                                   | 185/561 [00:10<00:19, 19.54it/s] 33%|█████████████████████████████████▋                                                                   | 187/561 [00:11<00:19, 19.50it/s] 34%|██████████████████████████████████▏                                                                  | 190/561 [00:11<00:19, 19.46it/s] 34%|██████████████████████████████████▌                                                                  | 192/561 [00:11<00:19, 19.10it/s] 35%|██████████████████████████████████▉                                                                  | 194/561 [00:11<00:19, 18.82it/s] 35%|███████████████████████████████████▎                                                                 | 196/561 [00:11<00:19, 18.63it/s] 35%|███████████████████████████████████▊                                                                 | 199/561 [00:11<00:17, 20.38it/s][2025-03-28 01:17:29,966] [INFO] [logging.py:128:log_dist] [Rank 0] step=200, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:17:29,967] [INFO] [timer.py:264:stop] epoch=0/micro_step=200/global_step=200, RunningAvgSamplesPerSec=19.967212570825872, CurrSamplesPerSec=22.088747382970805, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 36%|████████████████████████████████████▎                                                                | 202/561 [00:11<00:17, 20.84it/s] 37%|████████████████████████████████████▉                                                                | 205/561 [00:11<00:16, 21.25it/s] 37%|█████████████████████████████████████▍                                                               | 208/561 [00:12<00:16, 21.55it/s] 38%|█████████████████████████████████████▉                                                               | 211/561 [00:12<00:16, 21.62it/s] 38%|██████████████████████████████████████▌                                                              | 214/561 [00:12<00:16, 21.67it/s] 39%|███████████████████████████████████████                                                              | 217/561 [00:12<00:16, 20.43it/s] 39%|███████████████████████████████████████▌                                                             | 220/561 [00:12<00:17, 19.64it/s] 40%|███████████████████████████████████████▉                                                             | 222/561 [00:12<00:17, 19.25it/s] 40%|████████████████████████████████████████▎                                                            | 224/561 [00:12<00:17, 18.94it/s] 40%|████████████████████████████████████████▋                                                            | 226/561 [00:13<00:17, 18.70it/s] 41%|█████████████████████████████████████████                                                            | 228/561 [00:13<00:17, 18.52it/s] 41%|█████████████████████████████████████████▍                                                           | 230/561 [00:13<00:18, 18.22it/s] 41%|█████████████████████████████████████████▊                                                           | 232/561 [00:13<00:18, 18.20it/s] 42%|██████████████████████████████████████████▏                                                          | 234/561 [00:13<00:17, 18.19it/s] 42%|██████████████████████████████████████████▋                                                          | 237/561 [00:13<00:16, 19.60it/s] 43%|███████████████████████████████████████████▏                                                         | 240/561 [00:13<00:15, 20.32it/s] 43%|███████████████████████████████████████████▋                                                         | 243/561 [00:13<00:15, 20.87it/s] 44%|████████████████████████████████████████████▎                                                        | 246/561 [00:14<00:14, 22.48it/s] 44%|████████████████████████████████████████████▊                                                        | 249/561 [00:14<00:14, 21.04it/s][2025-03-28 01:17:32,461] [INFO] [logging.py:128:log_dist] [Rank 0] step=250, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:17:32,464] [INFO] [timer.py:264:stop] epoch=0/micro_step=250/global_step=250, RunningAvgSamplesPerSec=19.988163988789662, CurrSamplesPerSec=15.035654522066784, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 45%|█████████████████████████████████████████████▎                                                       | 252/561 [00:14<00:15, 19.55it/s] 45%|█████████████████████████████████████████████▋                                                       | 254/561 [00:14<00:16, 19.18it/s] 46%|██████████████████████████████████████████████                                                       | 256/561 [00:14<00:16, 18.89it/s] 46%|██████████████████████████████████████████████▍                                                      | 258/561 [00:14<00:16, 18.67it/s] 47%|██████████████████████████████████████████████▉                                                      | 261/561 [00:14<00:15, 19.62it/s] 47%|███████████████████████████████████████████████▎                                                     | 263/561 [00:14<00:15, 19.03it/s] 47%|███████████████████████████████████████████████▋                                                     | 265/561 [00:15<00:15, 19.09it/s] 48%|████████████████████████████████████████████████▏                                                    | 268/561 [00:15<00:14, 20.12it/s] 48%|████████████████████████████████████████████████▊                                                    | 271/561 [00:15<00:13, 20.96it/s] 49%|█████████████████████████████████████████████████▎                                                   | 274/561 [00:15<00:13, 21.13it/s] 49%|█████████████████████████████████████████████████▊                                                   | 277/561 [00:15<00:13, 20.49it/s] 50%|██████████████████████████████████████████████████▍                                                  | 280/561 [00:15<00:14, 20.01it/s] 50%|██████████████████████████████████████████████████▉                                                  | 283/561 [00:15<00:14, 19.22it/s] 51%|███████████████████████████████████████████████████▎                                                 | 285/561 [00:16<00:14, 18.95it/s] 51%|███████████████████████████████████████████████████▋                                                 | 287/561 [00:16<00:14, 18.73it/s] 52%|████████████████████████████████████████████████████                                                 | 289/561 [00:16<00:14, 18.55it/s] 52%|████████████████████████████████████████████████████▍                                                | 291/561 [00:16<00:14, 18.42it/s] 52%|████████████████████████████████████████████████████▊                                                | 293/561 [00:16<00:14, 18.14it/s] 53%|█████████████████████████████████████████████████████                                                | 295/561 [00:16<00:14, 18.13it/s] 53%|█████████████████████████████████████████████████████▍                                               | 297/561 [00:16<00:14, 18.11it/s][2025-03-28 01:17:35,067] [INFO] [logging.py:128:log_dist] [Rank 0] step=300, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:17:35,067] [INFO] [timer.py:264:stop] epoch=0/micro_step=300/global_step=300, RunningAvgSamplesPerSec=19.86036932456246, CurrSamplesPerSec=22.138531162188997, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 53%|██████████████████████████████████████████████████████                                               | 300/561 [00:16<00:13, 19.46it/s] 54%|██████████████████████████████████████████████████████▌                                              | 303/561 [00:16<00:12, 20.25it/s] 55%|███████████████████████████████████████████████████████                                              | 306/561 [00:17<00:12, 20.65it/s] 55%|███████████████████████████████████████████████████████▋                                             | 309/561 [00:17<00:11, 21.08it/s] 56%|████████████████████████████████████████████████████████▏                                            | 312/561 [00:17<00:11, 21.94it/s] 56%|████████████████████████████████████████████████████████▋                                            | 315/561 [00:17<00:11, 22.31it/s] 57%|█████████████████████████████████████████████████████████▎                                           | 318/561 [00:17<00:11, 20.92it/s] 57%|█████████████████████████████████████████████████████████▊                                           | 321/561 [00:17<00:12, 19.95it/s] 58%|██████████████████████████████████████████████████████████▎                                          | 324/561 [00:18<00:12, 19.34it/s] 58%|██████████████████████████████████████████████████████████▋                                          | 326/561 [00:18<00:12, 18.88it/s] 58%|███████████████████████████████████████████████████████████                                          | 328/561 [00:18<00:12, 18.67it/s] 59%|███████████████████████████████████████████████████████████▍                                         | 330/561 [00:18<00:12, 18.51it/s] 59%|███████████████████████████████████████████████████████████▊                                         | 332/561 [00:18<00:12, 18.39it/s] 60%|████████████████████████████████████████████████████████████▏                                        | 334/561 [00:18<00:12, 18.31it/s] 60%|████████████████████████████████████████████████████████████▍                                        | 336/561 [00:18<00:12, 18.27it/s] 60%|█████████████████████████████████████████████████████████████                                        | 339/561 [00:18<00:11, 19.18it/s] 61%|█████████████████████████████████████████████████████████████▌                                       | 342/561 [00:18<00:10, 20.81it/s] 61%|██████████████████████████████████████████████████████████████                                       | 345/561 [00:19<00:10, 20.11it/s] 62%|██████████████████████████████████████████████████████████████▋                                      | 348/561 [00:19<00:10, 20.18it/s][2025-03-28 01:17:37,559] [INFO] [logging.py:128:log_dist] [Rank 0] step=350, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:17:37,560] [INFO] [timer.py:264:stop] epoch=0/micro_step=350/global_step=350, RunningAvgSamplesPerSec=19.895519969537162, CurrSamplesPerSec=22.391332649689303, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 63%|███████████████████████████████████████████████████████████████▏                                     | 351/561 [00:19<00:10, 20.73it/s] 63%|███████████████████████████████████████████████████████████████▋                                     | 354/561 [00:19<00:09, 21.09it/s] 64%|████████████████████████████████████████████████████████████████▎                                    | 357/561 [00:19<00:10, 20.18it/s] 64%|████████████████████████████████████████████████████████████████▊                                    | 360/561 [00:19<00:10, 19.49it/s] 65%|█████████████████████████████████████████████████████████████████▏                                   | 362/561 [00:19<00:10, 19.16it/s] 65%|█████████████████████████████████████████████████████████████████▌                                   | 364/561 [00:20<00:10, 18.89it/s] 65%|█████████████████████████████████████████████████████████████████▉                                   | 366/561 [00:20<00:10, 18.67it/s] 66%|██████████████████████████████████████████████████████████████████▎                                  | 368/561 [00:20<00:10, 18.33it/s] 66%|██████████████████████████████████████████████████████████████████▌                                  | 370/561 [00:20<00:10, 18.25it/s] 66%|██████████████████████████████████████████████████████████████████▉                                  | 372/561 [00:20<00:10, 18.02it/s] 67%|███████████████████████████████████████████████████████████████████▎                                 | 374/561 [00:20<00:10, 18.34it/s] 67%|███████████████████████████████████████████████████████████████████▊                                 | 377/561 [00:20<00:09, 19.96it/s] 68%|████████████████████████████████████████████████████████████████████▍                                | 380/561 [00:20<00:08, 21.12it/s] 68%|████████████████████████████████████████████████████████████████████▉                                | 383/561 [00:21<00:08, 21.53it/s] 69%|█████████████████████████████████████████████████████████████████████▍                               | 386/561 [00:21<00:08, 21.61it/s] 69%|██████████████████████████████████████████████████████████████████████                               | 389/561 [00:21<00:07, 21.68it/s] 70%|██████████████████████████████████████████████████████████████████████▌                              | 392/561 [00:21<00:07, 21.76it/s] 70%|███████████████████████████████████████████████████████████████████████                              | 395/561 [00:21<00:07, 21.27it/s] 71%|███████████████████████████████████████████████████████████████████████▋                             | 398/561 [00:21<00:07, 21.49it/s][2025-03-28 01:17:40,028] [INFO] [logging.py:128:log_dist] [Rank 0] step=400, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:17:40,031] [INFO] [timer.py:264:stop] epoch=0/micro_step=400/global_step=400, RunningAvgSamplesPerSec=19.94375944705374, CurrSamplesPerSec=18.866983946082037, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 71%|████████████████████████████████████████████████████████████████████████▏                            | 401/561 [00:21<00:07, 20.92it/s] 72%|████████████████████████████████████████████████████████████████████████▋                            | 404/561 [00:22<00:07, 19.96it/s] 73%|█████████████████████████████████████████████████████████████████████████▎                           | 407/561 [00:22<00:08, 19.19it/s] 73%|█████████████████████████████████████████████████████████████████████████▋                           | 409/561 [00:22<00:08, 18.93it/s] 73%|█████████████████████████████████████████████████████████████████████████▉                           | 411/561 [00:22<00:08, 18.71it/s] 74%|██████████████████████████████████████████████████████████████████████████▎                          | 413/561 [00:22<00:07, 18.54it/s] 74%|██████████████████████████████████████████████████████████████████████████▋                          | 415/561 [00:22<00:07, 18.41it/s] 74%|███████████████████████████████████████████████████████████████████████████                          | 417/561 [00:22<00:07, 18.33it/s] 75%|███████████████████████████████████████████████████████████████████████████▍                         | 419/561 [00:22<00:07, 18.41it/s] 75%|███████████████████████████████████████████████████████████████████████████▉                         | 422/561 [00:23<00:07, 19.65it/s] 76%|████████████████████████████████████████████████████████████████████████████▌                        | 425/561 [00:23<00:06, 20.58it/s] 76%|█████████████████████████████████████████████████████████████████████████████                        | 428/561 [00:23<00:06, 21.57it/s] 77%|█████████████████████████████████████████████████████████████████████████████▌                       | 431/561 [00:23<00:05, 21.72it/s] 77%|██████████████████████████████████████████████████████████████████████████████▏                      | 434/561 [00:23<00:05, 21.72it/s] 78%|██████████████████████████████████████████████████████████████████████████████▋                      | 437/561 [00:23<00:05, 21.87it/s] 78%|███████████████████████████████████████████████████████████████████████████████▏                     | 440/561 [00:23<00:05, 21.57it/s] 79%|███████████████████████████████████████████████████████████████████████████████▊                     | 443/561 [00:23<00:05, 21.49it/s] 80%|████████████████████████████████████████████████████████████████████████████████▎                    | 446/561 [00:24<00:05, 21.94it/s] 80%|████████████████████████████████████████████████████████████████████████████████▊                    | 449/561 [00:24<00:05, 22.39it/s][2025-03-28 01:17:42,473] [INFO] [logging.py:128:log_dist] [Rank 0] step=450, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:17:42,474] [INFO] [timer.py:264:stop] epoch=0/micro_step=450/global_step=450, RunningAvgSamplesPerSec=20.005920195119902, CurrSamplesPerSec=22.256948433718893, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 81%|█████████████████████████████████████████████████████████████████████████████████▍                   | 452/561 [00:24<00:04, 22.32it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▉                   | 455/561 [00:24<00:04, 22.82it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▍                  | 458/561 [00:24<00:04, 22.94it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▉                  | 461/561 [00:24<00:04, 21.40it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▌                 | 464/561 [00:24<00:04, 20.13it/s] 83%|████████████████████████████████████████████████████████████████████████████████████                 | 467/561 [00:25<00:04, 19.32it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▍                | 469/561 [00:25<00:04, 18.88it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▊                | 471/561 [00:25<00:04, 18.69it/s] 84%|█████████████████████████████████████████████████████████████████████████████████████▏               | 473/561 [00:25<00:04, 18.54it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▌               | 475/561 [00:25<00:04, 18.41it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▉               | 477/561 [00:25<00:04, 18.31it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▍              | 480/561 [00:25<00:04, 19.55it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▉              | 483/561 [00:25<00:03, 20.79it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▍             | 486/561 [00:26<00:03, 21.81it/s] 87%|████████████████████████████████████████████████████████████████████████████████████████             | 489/561 [00:26<00:03, 22.34it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▌            | 492/561 [00:26<00:03, 22.74it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████████            | 495/561 [00:26<00:02, 23.15it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▋           | 498/561 [00:26<00:02, 22.90it/s][2025-03-28 01:17:44,870] [INFO] [logging.py:128:log_dist] [Rank 0] step=500, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:17:44,871] [INFO] [timer.py:264:stop] epoch=0/micro_step=500/global_step=500, RunningAvgSamplesPerSec=20.093526886924234, CurrSamplesPerSec=21.005002572322756, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 89%|██████████████████████████████████████████████████████████████████████████████████████████▏          | 501/561 [00:26<00:02, 22.40it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▋          | 504/561 [00:26<00:02, 22.18it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████████▎         | 507/561 [00:26<00:02, 22.32it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▊         | 510/561 [00:27<00:02, 22.08it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████████▎        | 513/561 [00:27<00:02, 22.04it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████████▉        | 516/561 [00:27<00:02, 21.81it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▍       | 519/561 [00:27<00:01, 22.18it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▉       | 522/561 [00:27<00:01, 22.32it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▌      | 525/561 [00:27<00:01, 21.97it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████      | 528/561 [00:27<00:01, 21.94it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▌     | 531/561 [00:28<00:01, 21.93it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████████▏    | 534/561 [00:28<00:01, 21.90it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▋    | 537/561 [00:28<00:01, 21.39it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████▏   | 540/561 [00:28<00:00, 21.51it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████████▊   | 543/561 [00:28<00:00, 21.52it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████████▎  | 546/561 [00:28<00:00, 21.27it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▊  | 549/561 [00:28<00:00, 20.18it/s][2025-03-28 01:17:47,208] [INFO] [logging.py:128:log_dist] [Rank 0] step=550, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:17:47,211] [INFO] [timer.py:264:stop] epoch=0/micro_step=550/global_step=550, RunningAvgSamplesPerSec=20.20787829210372, CurrSamplesPerSec=18.128030209711753, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 98%|███████████████████████████████████████████████████████████████████████████████████████████████████▍ | 552/561 [00:29<00:00, 19.36it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▋ | 554/561 [00:29<00:00, 19.07it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████ | 556/561 [00:29<00:00, 19.22it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████████▋| 559/561 [00:29<00:00, 20.17it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:29<00:00, 18.96it/s]
/hpc2hdd/home/yli045/diffusion_noise_agent/train.py:189: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  df = pd.concat([df, pd.DataFrame([new_row])], ignore_index=True) # 使用 pd.concat 追加数据
  0%|                                                                                                               | 0/561 [00:00<?, ?it/s]  0%|▏                                                                                                      | 1/561 [00:00<02:39,  3.51it/s]  1%|▌                                                                                                      | 3/561 [00:00<01:02,  8.94it/s]  1%|█                                                                                                      | 6/561 [00:00<00:39, 13.96it/s]  2%|█▋                                                                                                     | 9/561 [00:00<00:33, 16.65it/s]  2%|██▏                                                                                                   | 12/561 [00:00<00:30, 18.23it/s]  3%|██▋                                                                                                   | 15/561 [00:00<00:27, 19.64it/s]  3%|███▎                                                                                                  | 18/561 [00:01<00:26, 20.16it/s]  4%|███▊                                                                                                  | 21/561 [00:01<00:26, 20.30it/s]  4%|████▎                                                                                                 | 24/561 [00:01<00:25, 20.68it/s]  5%|████▉                                                                                                 | 27/561 [00:01<00:26, 20.54it/s]  5%|█████▍                                                                                                | 30/561 [00:01<00:25, 20.64it/s]  6%|██████                                                                                                | 33/561 [00:01<00:25, 20.84it/s]  6%|██████▌                                                                                               | 36/561 [00:01<00:24, 21.52it/s][2025-03-28 01:17:49,893] [INFO] [logging.py:128:log_dist] [Rank 0] step=600, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:17:49,894] [INFO] [timer.py:264:stop] epoch=0/micro_step=600/global_step=600, RunningAvgSamplesPerSec=20.158369467579995, CurrSamplesPerSec=21.37418895444978, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
  7%|███████                                                                                               | 39/561 [00:02<00:23, 21.76it/s]  7%|███████▋                                                                                              | 42/561 [00:02<00:23, 22.22it/s]  8%|████████▏                                                                                             | 45/561 [00:02<00:23, 22.28it/s]  9%|████████▋                                                                                             | 48/561 [00:02<00:23, 22.21it/s]  9%|█████████▎                                                                                            | 51/561 [00:02<00:23, 22.13it/s] 10%|█████████▊                                                                                            | 54/561 [00:02<00:23, 22.03it/s] 10%|██████████▎                                                                                           | 57/561 [00:02<00:22, 22.04it/s] 11%|██████████▉                                                                                           | 60/561 [00:03<00:22, 21.89it/s] 11%|███████████▍                                                                                          | 63/561 [00:03<00:22, 21.66it/s] 12%|████████████                                                                                          | 66/561 [00:03<00:23, 20.65it/s] 12%|████████████▌                                                                                         | 69/561 [00:03<00:23, 21.12it/s] 13%|█████████████                                                                                         | 72/561 [00:03<00:22, 21.45it/s] 13%|█████████████▋                                                                                        | 75/561 [00:03<00:22, 21.98it/s] 14%|██████████████▏                                                                                       | 78/561 [00:03<00:21, 22.46it/s] 14%|██████████████▋                                                                                       | 81/561 [00:03<00:21, 22.63it/s] 15%|███████████████▎                                                                                      | 84/561 [00:04<00:21, 22.28it/s] 16%|███████████████▊                                                                                      | 87/561 [00:04<00:21, 21.55it/s][2025-03-28 01:17:52,184] [INFO] [logging.py:128:log_dist] [Rank 0] step=650, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:17:52,185] [INFO] [timer.py:264:stop] epoch=0/micro_step=650/global_step=650, RunningAvgSamplesPerSec=20.281727796010387, CurrSamplesPerSec=21.99088616352445, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 16%|████████████████▎                                                                                     | 90/561 [00:04<00:21, 21.50it/s] 17%|████████████████▉                                                                                     | 93/561 [00:04<00:21, 21.79it/s] 17%|█████████████████▍                                                                                    | 96/561 [00:04<00:21, 21.28it/s] 18%|██████████████████                                                                                    | 99/561 [00:04<00:22, 20.79it/s] 18%|██████████████████▎                                                                                  | 102/561 [00:04<00:21, 21.14it/s] 19%|██████████████████▉                                                                                  | 105/561 [00:05<00:21, 21.59it/s] 19%|███████████████████▍                                                                                 | 108/561 [00:05<00:20, 22.45it/s] 20%|███████████████████▉                                                                                 | 111/561 [00:05<00:19, 22.54it/s] 20%|████████████████████▌                                                                                | 114/561 [00:05<00:19, 22.91it/s] 21%|█████████████████████                                                                                | 117/561 [00:05<00:19, 22.27it/s] 21%|█████████████████████▌                                                                               | 120/561 [00:05<00:19, 22.31it/s] 22%|██████████████████████▏                                                                              | 123/561 [00:05<00:19, 22.08it/s] 22%|██████████████████████▋                                                                              | 126/561 [00:06<00:20, 21.10it/s] 23%|███████████████████████▏                                                                             | 129/561 [00:06<00:20, 21.08it/s] 24%|███████████████████████▊                                                                             | 132/561 [00:06<00:20, 21.13it/s] 24%|████████████████████████▎                                                                            | 135/561 [00:06<00:19, 21.68it/s] 25%|████████████████████████▊                                                                            | 138/561 [00:06<00:19, 22.00it/s][2025-03-28 01:17:54,476] [INFO] [logging.py:128:log_dist] [Rank 0] step=700, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:17:54,476] [INFO] [timer.py:264:stop] epoch=0/micro_step=700/global_step=700, RunningAvgSamplesPerSec=20.38832283292778, CurrSamplesPerSec=21.870485039953667, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 25%|█████████████████████████▍                                                                           | 141/561 [00:06<00:19, 22.04it/s] 26%|█████████████████████████▉                                                                           | 144/561 [00:06<00:19, 21.81it/s] 26%|██████████████████████████▍                                                                          | 147/561 [00:07<00:19, 21.73it/s] 27%|███████████████████████████                                                                          | 150/561 [00:07<00:18, 21.67it/s] 27%|███████████████████████████▌                                                                         | 153/561 [00:07<00:18, 21.83it/s] 28%|████████████████████████████                                                                         | 156/561 [00:07<00:18, 21.86it/s] 28%|████████████████████████████▋                                                                        | 159/561 [00:07<00:18, 22.00it/s] 29%|█████████████████████████████▏                                                                       | 162/561 [00:07<00:18, 21.74it/s] 29%|█████████████████████████████▋                                                                       | 165/561 [00:07<00:18, 21.62it/s] 30%|██████████████████████████████▏                                                                      | 168/561 [00:07<00:18, 21.76it/s] 30%|██████████████████████████████▊                                                                      | 171/561 [00:08<00:17, 21.93it/s] 31%|███████████████████████████████▎                                                                     | 174/561 [00:08<00:17, 22.00it/s] 32%|███████████████████████████████▊                                                                     | 177/561 [00:08<00:17, 22.07it/s] 32%|████████████████████████████████▍                                                                    | 180/561 [00:08<00:17, 21.98it/s] 33%|████████████████████████████████▉                                                                    | 183/561 [00:08<00:17, 21.93it/s] 33%|█████████████████████████████████▍                                                                   | 186/561 [00:08<00:17, 21.91it/s][2025-03-28 01:17:56,766] [INFO] [logging.py:128:log_dist] [Rank 0] step=750, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:17:56,767] [INFO] [timer.py:264:stop] epoch=0/micro_step=750/global_step=750, RunningAvgSamplesPerSec=20.4818698231056, CurrSamplesPerSec=21.33830472767899, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 34%|██████████████████████████████████                                                                   | 189/561 [00:08<00:17, 21.74it/s] 34%|██████████████████████████████████▌                                                                  | 192/561 [00:09<00:16, 21.79it/s] 35%|███████████████████████████████████                                                                  | 195/561 [00:09<00:17, 20.86it/s] 35%|███████████████████████████████████▋                                                                 | 198/561 [00:09<00:17, 20.73it/s] 36%|████████████████████████████████████▏                                                                | 201/561 [00:09<00:17, 21.01it/s] 36%|████████████████████████████████████▋                                                                | 204/561 [00:09<00:16, 21.08it/s] 37%|█████████████████████████████████████▎                                                               | 207/561 [00:09<00:16, 21.33it/s] 37%|█████████████████████████████████████▊                                                               | 210/561 [00:09<00:16, 21.50it/s] 38%|██████████████████████████████████████▎                                                              | 213/561 [00:10<00:15, 21.78it/s] 39%|██████████████████████████████████████▉                                                              | 216/561 [00:10<00:16, 21.13it/s] 39%|███████████████████████████████████████▍                                                             | 219/561 [00:10<00:16, 21.25it/s] 40%|███████████████████████████████████████▉                                                             | 222/561 [00:10<00:16, 20.41it/s] 40%|████████████████████████████████████████▌                                                            | 225/561 [00:10<00:16, 20.71it/s] 41%|█████████████████████████████████████████                                                            | 228/561 [00:10<00:15, 21.22it/s] 41%|█████████████████████████████████████████▌                                                           | 231/561 [00:10<00:14, 23.15it/s] 42%|██████████████████████████████████████████▏                                                          | 234/561 [00:11<00:14, 23.09it/s] 42%|██████████████████████████████████████████▋                                                          | 237/561 [00:11<00:13, 23.17it/s][2025-03-28 01:17:59,064] [INFO] [logging.py:128:log_dist] [Rank 0] step=800, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:17:59,064] [INFO] [timer.py:264:stop] epoch=0/micro_step=800/global_step=800, RunningAvgSamplesPerSec=20.56070096263423, CurrSamplesPerSec=24.634527069692133, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 43%|███████████████████████████████████████████▏                                                         | 240/561 [00:11<00:13, 23.51it/s] 43%|███████████████████████████████████████████▋                                                         | 243/561 [00:11<00:13, 23.17it/s] 44%|████████████████████████████████████████████▎                                                        | 246/561 [00:11<00:13, 22.82it/s] 44%|████████████████████████████████████████████▊                                                        | 249/561 [00:11<00:13, 22.54it/s] 45%|█████████████████████████████████████████████▎                                                       | 252/561 [00:11<00:13, 22.67it/s] 45%|█████████████████████████████████████████████▉                                                       | 255/561 [00:11<00:13, 22.64it/s] 46%|██████████████████████████████████████████████▍                                                      | 258/561 [00:12<00:13, 22.30it/s] 47%|██████████████████████████████████████████████▉                                                      | 261/561 [00:12<00:13, 22.29it/s] 47%|███████████████████████████████████████████████▌                                                     | 264/561 [00:12<00:13, 22.11it/s] 48%|████████████████████████████████████████████████                                                     | 267/561 [00:12<00:13, 21.88it/s] 48%|████████████████████████████████████████████████▌                                                    | 270/561 [00:12<00:13, 21.91it/s] 49%|█████████████████████████████████████████████████▏                                                   | 273/561 [00:12<00:13, 22.03it/s] 49%|█████████████████████████████████████████████████▋                                                   | 276/561 [00:12<00:12, 22.35it/s] 50%|██████████████████████████████████████████████████▏                                                  | 279/561 [00:13<00:13, 21.09it/s] 50%|██████████████████████████████████████████████████▊                                                  | 282/561 [00:13<00:13, 21.37it/s] 51%|███████████████████████████████████████████████████▎                                                 | 285/561 [00:13<00:12, 22.26it/s] 51%|███████████████████████████████████████████████████▊                                                 | 288/561 [00:13<00:11, 22.81it/s][2025-03-28 01:18:01,317] [INFO] [logging.py:128:log_dist] [Rank 0] step=850, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:18:01,317] [INFO] [timer.py:264:stop] epoch=0/micro_step=850/global_step=850, RunningAvgSamplesPerSec=20.653140513848903, CurrSamplesPerSec=21.856467119680946, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 52%|████████████████████████████████████████████████████▍                                                | 291/561 [00:13<00:12, 22.21it/s] 52%|████████████████████████████████████████████████████▉                                                | 294/561 [00:13<00:12, 21.19it/s] 53%|█████████████████████████████████████████████████████▍                                               | 297/561 [00:13<00:12, 21.55it/s] 53%|██████████████████████████████████████████████████████                                               | 300/561 [00:14<00:12, 21.67it/s] 54%|██████████████████████████████████████████████████████▌                                              | 303/561 [00:14<00:11, 21.95it/s] 55%|███████████████████████████████████████████████████████                                              | 306/561 [00:14<00:11, 22.03it/s] 55%|███████████████████████████████████████████████████████▋                                             | 309/561 [00:14<00:11, 21.07it/s] 56%|████████████████████████████████████████████████████████▏                                            | 312/561 [00:14<00:11, 21.04it/s] 56%|████████████████████████████████████████████████████████▋                                            | 315/561 [00:14<00:11, 20.89it/s] 57%|█████████████████████████████████████████████████████████▎                                           | 318/561 [00:14<00:11, 20.53it/s] 57%|█████████████████████████████████████████████████████████▊                                           | 321/561 [00:15<00:11, 20.28it/s] 58%|██████████████████████████████████████████████████████████▎                                          | 324/561 [00:15<00:11, 20.55it/s] 58%|██████████████████████████████████████████████████████████▊                                          | 327/561 [00:15<00:11, 21.23it/s] 59%|███████████████████████████████████████████████████████████▍                                         | 330/561 [00:15<00:10, 21.54it/s] 59%|███████████████████████████████████████████████████████████▉                                         | 333/561 [00:15<00:10, 21.93it/s] 60%|████████████████████████████████████████████████████████████▍                                        | 336/561 [00:15<00:10, 21.85it/s][2025-03-28 01:18:03,678] [INFO] [logging.py:128:log_dist] [Rank 0] step=900, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:18:03,679] [INFO] [timer.py:264:stop] epoch=0/micro_step=900/global_step=900, RunningAvgSamplesPerSec=20.684450462677276, CurrSamplesPerSec=19.793958196654742, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 60%|█████████████████████████████████████████████████████████████                                        | 339/561 [00:15<00:10, 21.55it/s] 61%|█████████████████████████████████████████████████████████████▌                                       | 342/561 [00:15<00:10, 21.53it/s] 61%|██████████████████████████████████████████████████████████████                                       | 345/561 [00:16<00:09, 21.73it/s] 62%|██████████████████████████████████████████████████████████████▋                                      | 348/561 [00:16<00:09, 21.68it/s] 63%|███████████████████████████████████████████████████████████████▏                                     | 351/561 [00:16<00:09, 21.75it/s] 63%|███████████████████████████████████████████████████████████████▋                                     | 354/561 [00:16<00:09, 21.78it/s] 64%|████████████████████████████████████████████████████████████████▎                                    | 357/561 [00:16<00:09, 21.93it/s] 64%|████████████████████████████████████████████████████████████████▊                                    | 360/561 [00:16<00:09, 22.20it/s] 65%|█████████████████████████████████████████████████████████████████▎                                   | 363/561 [00:16<00:09, 21.86it/s] 65%|█████████████████████████████████████████████████████████████████▉                                   | 366/561 [00:17<00:09, 21.58it/s] 66%|██████████████████████████████████████████████████████████████████▍                                  | 369/561 [00:17<00:08, 21.68it/s] 66%|██████████████████████████████████████████████████████████████████▉                                  | 372/561 [00:17<00:08, 21.75it/s] 67%|███████████████████████████████████████████████████████████████████▌                                 | 375/561 [00:17<00:08, 21.69it/s] 67%|████████████████████████████████████████████████████████████████████                                 | 378/561 [00:17<00:08, 21.85it/s] 68%|████████████████████████████████████████████████████████████████████▌                                | 381/561 [00:17<00:08, 22.03it/s] 68%|█████████████████████████████████████████████████████████████████████▏                               | 384/561 [00:17<00:08, 21.84it/s] 69%|█████████████████████████████████████████████████████████████████████▋                               | 387/561 [00:18<00:07, 22.09it/s][2025-03-28 01:18:05,959] [INFO] [logging.py:128:log_dist] [Rank 0] step=950, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:18:05,960] [INFO] [timer.py:264:stop] epoch=0/micro_step=950/global_step=950, RunningAvgSamplesPerSec=20.748614006531707, CurrSamplesPerSec=23.003386808548758, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 70%|██████████████████████████████████████████████████████████████████████▏                              | 390/561 [00:18<00:07, 22.24it/s] 70%|██████████████████████████████████████████████████████████████████████▊                              | 393/561 [00:18<00:07, 22.36it/s] 71%|███████████████████████████████████████████████████████████████████████▎                             | 396/561 [00:18<00:07, 23.47it/s] 71%|███████████████████████████████████████████████████████████████████████▊                             | 399/561 [00:18<00:07, 23.06it/s] 72%|████████████████████████████████████████████████████████████████████████▎                            | 402/561 [00:18<00:07, 22.56it/s] 72%|████████████████████████████████████████████████████████████████████████▉                            | 405/561 [00:18<00:06, 22.80it/s] 73%|█████████████████████████████████████████████████████████████████████████▍                           | 408/561 [00:18<00:06, 22.97it/s] 73%|█████████████████████████████████████████████████████████████████████████▉                           | 411/561 [00:19<00:06, 22.63it/s] 74%|██████████████████████████████████████████████████████████████████████████▌                          | 414/561 [00:19<00:06, 22.13it/s] 74%|███████████████████████████████████████████████████████████████████████████                          | 417/561 [00:19<00:06, 22.00it/s] 75%|███████████████████████████████████████████████████████████████████████████▌                         | 420/561 [00:19<00:06, 21.98it/s] 75%|████████████████████████████████████████████████████████████████████████████▏                        | 423/561 [00:19<00:06, 21.96it/s] 76%|████████████████████████████████████████████████████████████████████████████▋                        | 426/561 [00:19<00:06, 22.44it/s] 76%|█████████████████████████████████████████████████████████████████████████████▏                       | 429/561 [00:19<00:05, 22.76it/s] 77%|█████████████████████████████████████████████████████████████████████████████▊                       | 432/561 [00:20<00:05, 23.02it/s] 78%|██████████████████████████████████████████████████████████████████████████████▎                      | 435/561 [00:20<00:05, 23.18it/s] 78%|██████████████████████████████████████████████████████████████████████████████▊                      | 438/561 [00:20<00:05, 22.77it/s][2025-03-28 01:18:08,168] [INFO] [logging.py:128:log_dist] [Rank 0] step=1000, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:18:08,169] [INFO] [timer.py:264:stop] epoch=0/micro_step=1000/global_step=1000, RunningAvgSamplesPerSec=20.838331636305817, CurrSamplesPerSec=20.334817120282427, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 79%|███████████████████████████████████████████████████████████████████████████████▍                     | 441/561 [00:20<00:05, 22.42it/s][2025-03-28 01:18:08,298] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2025-03-28 01:18:08,344] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
 79%|███████████████████████████████████████████████████████████████████████████████▉                     | 444/561 [00:20<00:05, 22.18it/s] 80%|████████████████████████████████████████████████████████████████████████████████▍                    | 447/561 [00:20<00:05, 22.16it/s] 80%|█████████████████████████████████████████████████████████████████████████████████                    | 450/561 [00:20<00:04, 22.68it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▌                   | 453/561 [00:20<00:04, 23.04it/s] 81%|██████████████████████████████████████████████████████████████████████████████████                   | 456/561 [00:21<00:04, 22.74it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▋                  | 459/561 [00:21<00:04, 22.77it/s] 82%|███████████████████████████████████████████████████████████████████████████████████▏                 | 462/561 [00:21<00:04, 22.67it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▋                 | 465/561 [00:21<00:04, 22.59it/s] 83%|████████████████████████████████████████████████████████████████████████████████████▎                | 468/561 [00:21<00:04, 22.39it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▊                | 471/561 [00:21<00:04, 22.08it/s] 84%|█████████████████████████████████████████████████████████████████████████████████████▎               | 474/561 [00:21<00:03, 21.92it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▉               | 477/561 [00:22<00:03, 21.74it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▍              | 480/561 [00:22<00:03, 21.81it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▉              | 483/561 [00:22<00:03, 21.65it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▍             | 486/561 [00:22<00:03, 21.73it/s][2025-03-28 01:18:10,426] [INFO] [logging.py:128:log_dist] [Rank 0] step=1050, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:18:10,427] [INFO] [timer.py:264:stop] epoch=0/micro_step=1050/global_step=1050, RunningAvgSamplesPerSec=20.89958534229413, CurrSamplesPerSec=21.48278951960697, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 87%|████████████████████████████████████████████████████████████████████████████████████████             | 489/561 [00:22<00:03, 21.69it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▌            | 492/561 [00:22<00:03, 22.15it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████████            | 495/561 [00:22<00:02, 22.39it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▋           | 498/561 [00:22<00:02, 22.22it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████▏          | 501/561 [00:23<00:02, 22.51it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▋          | 504/561 [00:23<00:02, 23.00it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████████▎         | 507/561 [00:23<00:02, 23.19it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▊         | 510/561 [00:23<00:02, 23.15it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████████▎        | 513/561 [00:23<00:02, 22.85it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████        | 517/561 [00:23<00:01, 24.73it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▌       | 520/561 [00:23<00:01, 24.01it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████████▏      | 523/561 [00:24<00:01, 23.37it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▋      | 526/561 [00:24<00:01, 22.95it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▏     | 529/561 [00:24<00:01, 22.73it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▊     | 532/561 [00:24<00:01, 22.56it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████████▎    | 535/561 [00:24<00:01, 22.45it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▊    | 538/561 [00:24<00:01, 22.40it/s][2025-03-28 01:18:12,602] [INFO] [logging.py:128:log_dist] [Rank 0] step=1100, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:18:12,603] [INFO] [timer.py:264:stop] epoch=0/micro_step=1100/global_step=1100, RunningAvgSamplesPerSec=20.98866198311775, CurrSamplesPerSec=21.620102057359226, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 96%|█████████████████████████████████████████████████████████████████████████████████████████████████▍   | 541/561 [00:24<00:00, 22.40it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████████▉   | 544/561 [00:24<00:00, 22.67it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▍  | 547/561 [00:25<00:00, 23.10it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████████  | 550/561 [00:25<00:00, 23.06it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▌ | 553/561 [00:25<00:00, 23.26it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████ | 556/561 [00:25<00:00, 22.81it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████████▋| 559/561 [00:25<00:00, 22.37it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:25<00:00, 21.75it/s]
  0%|                                                                                                               | 0/561 [00:00<?, ?it/s]  0%|▏                                                                                                      | 1/561 [00:00<02:00,  4.65it/s]  1%|▋                                                                                                      | 4/561 [00:00<00:43, 12.67it/s]  1%|█▎                                                                                                     | 7/561 [00:00<00:34, 15.99it/s]  2%|█▊                                                                                                    | 10/561 [00:00<00:30, 18.11it/s]  2%|██▎                                                                                                   | 13/561 [00:00<00:28, 19.24it/s]  3%|██▉                                                                                                   | 16/561 [00:00<00:27, 19.89it/s]  3%|███▍                                                                                                  | 19/561 [00:01<00:26, 20.46it/s]  4%|████                                                                                                  | 22/561 [00:01<00:25, 21.03it/s]  4%|████▌                                                                                                 | 25/561 [00:01<00:25, 21.23it/s][2025-03-28 01:18:15,120] [INFO] [logging.py:128:log_dist] [Rank 0] step=1150, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:18:15,121] [INFO] [timer.py:264:stop] epoch=0/micro_step=1150/global_step=1150, RunningAvgSamplesPerSec=20.99411372620672, CurrSamplesPerSec=22.49834856796966, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
  5%|█████                                                                                                 | 28/561 [00:01<00:24, 21.51it/s]  6%|█████▋                                                                                                | 31/561 [00:01<00:24, 21.51it/s]  6%|██████▏                                                                                               | 34/561 [00:01<00:24, 21.51it/s]  7%|██████▋                                                                                               | 37/561 [00:01<00:23, 22.13it/s]  7%|███████▎                                                                                              | 40/561 [00:01<00:22, 22.68it/s]  8%|███████▊                                                                                              | 43/561 [00:02<00:22, 23.04it/s]  8%|████████▎                                                                                             | 46/561 [00:02<00:22, 23.31it/s]  9%|████████▉                                                                                             | 49/561 [00:02<00:21, 23.49it/s]  9%|█████████▍                                                                                            | 52/561 [00:02<00:21, 23.54it/s] 10%|██████████                                                                                            | 55/561 [00:02<00:21, 23.59it/s] 10%|██████████▌                                                                                           | 58/561 [00:02<00:21, 23.78it/s] 11%|███████████                                                                                           | 61/561 [00:02<00:21, 23.64it/s] 11%|███████████▋                                                                                          | 64/561 [00:03<00:21, 23.63it/s] 12%|████████████▏                                                                                         | 67/561 [00:03<00:20, 23.69it/s] 12%|████████████▋                                                                                         | 70/561 [00:03<00:20, 23.67it/s] 13%|█████████████▎                                                                                        | 73/561 [00:03<00:20, 23.69it/s] 14%|█████████████▊                                                                                        | 76/561 [00:03<00:20, 23.68it/s][2025-03-28 01:18:17,249] [INFO] [logging.py:128:log_dist] [Rank 0] step=1200, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:18:17,249] [INFO] [timer.py:264:stop] epoch=0/micro_step=1200/global_step=1200, RunningAvgSamplesPerSec=21.089770147571798, CurrSamplesPerSec=24.4317674942615, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 14%|██████████████▎                                                                                       | 79/561 [00:03<00:20, 23.78it/s] 15%|██████████████▉                                                                                       | 82/561 [00:03<00:20, 23.77it/s] 15%|███████████████▍                                                                                      | 85/561 [00:03<00:20, 23.77it/s] 16%|████████████████                                                                                      | 88/561 [00:04<00:19, 23.81it/s] 16%|████████████████▌                                                                                     | 91/561 [00:04<00:19, 23.70it/s] 17%|█████████████████                                                                                     | 94/561 [00:04<00:19, 23.72it/s] 17%|█████████████████▋                                                                                    | 97/561 [00:04<00:19, 23.59it/s] 18%|██████████████████                                                                                   | 100/561 [00:04<00:19, 23.74it/s] 18%|██████████████████▌                                                                                  | 103/561 [00:04<00:19, 23.59it/s] 19%|███████████████████                                                                                  | 106/561 [00:04<00:19, 23.58it/s] 19%|███████████████████▌                                                                                 | 109/561 [00:04<00:19, 23.50it/s] 20%|████████████████████▏                                                                                | 112/561 [00:05<00:18, 24.52it/s] 20%|████████████████████▋                                                                                | 115/561 [00:05<00:20, 22.02it/s] 21%|█████████████████████▏                                                                               | 118/561 [00:05<00:20, 21.97it/s] 22%|█████████████████████▊                                                                               | 121/561 [00:05<00:20, 21.91it/s] 22%|██████████████████████▎                                                                              | 124/561 [00:05<00:19, 21.90it/s] 23%|██████████████████████▊                                                                              | 127/561 [00:05<00:20, 21.21it/s][2025-03-28 01:18:19,463] [INFO] [logging.py:128:log_dist] [Rank 0] step=1250, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:18:19,464] [INFO] [timer.py:264:stop] epoch=0/micro_step=1250/global_step=1250, RunningAvgSamplesPerSec=21.147858400995617, CurrSamplesPerSec=17.057560812098465, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 23%|███████████████████████▍                                                                             | 130/561 [00:05<00:20, 21.05it/s] 24%|███████████████████████▉                                                                             | 133/561 [00:06<00:20, 21.34it/s] 24%|████████████████████████▍                                                                            | 136/561 [00:06<00:19, 21.47it/s] 25%|█████████████████████████                                                                            | 139/561 [00:06<00:19, 21.64it/s] 25%|█████████████████████████▌                                                                           | 142/561 [00:06<00:18, 22.53it/s] 26%|██████████████████████████                                                                           | 145/561 [00:06<00:18, 21.94it/s] 26%|██████████████████████████▋                                                                          | 148/561 [00:06<00:18, 22.13it/s] 27%|███████████████████████████▏                                                                         | 151/561 [00:06<00:18, 22.21it/s] 27%|███████████████████████████▋                                                                         | 154/561 [00:06<00:18, 22.13it/s] 28%|████████████████████████████▎                                                                        | 157/561 [00:07<00:18, 22.02it/s] 29%|████████████████████████████▊                                                                        | 160/561 [00:07<00:18, 21.92it/s] 29%|█████████████████████████████▎                                                                       | 163/561 [00:07<00:17, 22.19it/s] 30%|█████████████████████████████▉                                                                       | 166/561 [00:07<00:17, 22.20it/s] 30%|██████████████████████████████▍                                                                      | 169/561 [00:07<00:17, 22.25it/s] 31%|██████████████████████████████▉                                                                      | 172/561 [00:07<00:17, 21.79it/s] 31%|███████████████████████████████▌                                                                     | 175/561 [00:07<00:17, 21.62it/s][2025-03-28 01:18:21,724] [INFO] [logging.py:128:log_dist] [Rank 0] step=1300, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:18:21,725] [INFO] [timer.py:264:stop] epoch=0/micro_step=1300/global_step=1300, RunningAvgSamplesPerSec=21.18568425408398, CurrSamplesPerSec=23.07679344656363, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 32%|████████████████████████████████                                                                     | 178/561 [00:08<00:17, 21.83it/s] 32%|████████████████████████████████▌                                                                    | 181/561 [00:08<00:17, 22.11it/s] 33%|█████████████████████████████████▏                                                                   | 184/561 [00:08<00:17, 22.12it/s] 33%|█████████████████████████████████▋                                                                   | 187/561 [00:08<00:16, 22.37it/s] 34%|██████████████████████████████████▏                                                                  | 190/561 [00:08<00:16, 22.72it/s] 34%|██████████████████████████████████▋                                                                  | 193/561 [00:08<00:16, 22.93it/s] 35%|███████████████████████████████████▎                                                                 | 196/561 [00:08<00:16, 22.67it/s] 35%|███████████████████████████████████▊                                                                 | 199/561 [00:09<00:16, 21.78it/s] 36%|████████████████████████████████████▎                                                                | 202/561 [00:09<00:16, 21.66it/s] 37%|████████████████████████████████████▉                                                                | 205/561 [00:09<00:16, 21.76it/s] 37%|█████████████████████████████████████▍                                                               | 208/561 [00:09<00:16, 21.78it/s] 38%|█████████████████████████████████████▉                                                               | 211/561 [00:09<00:16, 21.76it/s] 38%|██████████████████████████████████████▌                                                              | 214/561 [00:09<00:16, 21.53it/s] 39%|███████████████████████████████████████                                                              | 217/561 [00:09<00:15, 21.84it/s] 39%|███████████████████████████████████████▌                                                             | 220/561 [00:09<00:15, 21.57it/s] 40%|████████████████████████████████████████▏                                                            | 223/561 [00:10<00:15, 21.44it/s] 40%|████████████████████████████████████████▋                                                            | 226/561 [00:10<00:15, 21.33it/s][2025-03-28 01:18:24,009] [INFO] [logging.py:128:log_dist] [Rank 0] step=1350, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:18:24,010] [INFO] [timer.py:264:stop] epoch=0/micro_step=1350/global_step=1350, RunningAvgSamplesPerSec=21.212823658693086, CurrSamplesPerSec=22.45342418206567, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 41%|█████████████████████████████████████████▏                                                           | 229/561 [00:10<00:15, 21.45it/s] 41%|█████████████████████████████████████████▊                                                           | 232/561 [00:10<00:14, 21.97it/s] 42%|██████████████████████████████████████████▎                                                          | 235/561 [00:10<00:14, 22.36it/s] 42%|██████████████████████████████████████████▊                                                          | 238/561 [00:10<00:14, 21.93it/s] 43%|███████████████████████████████████████████▍                                                         | 241/561 [00:10<00:15, 21.21it/s] 43%|███████████████████████████████████████████▉                                                         | 244/561 [00:11<00:15, 20.72it/s] 44%|████████████████████████████████████████████▍                                                        | 247/561 [00:11<00:15, 20.62it/s] 45%|█████████████████████████████████████████████                                                        | 250/561 [00:11<00:15, 20.67it/s] 45%|█████████████████████████████████████████████▌                                                       | 253/561 [00:11<00:14, 20.54it/s] 46%|██████████████████████████████████████████████                                                       | 256/561 [00:11<00:15, 20.28it/s] 46%|██████████████████████████████████████████████▋                                                      | 259/561 [00:11<00:14, 20.55it/s] 47%|███████████████████████████████████████████████▏                                                     | 262/561 [00:11<00:14, 20.34it/s] 47%|███████████████████████████████████████████████▋                                                     | 265/561 [00:12<00:14, 19.85it/s] 48%|████████████████████████████████████████████████                                                     | 267/561 [00:12<00:15, 18.76it/s] 48%|████████████████████████████████████████████████▌                                                    | 270/561 [00:12<00:15, 19.09it/s] 49%|█████████████████████████████████████████████████▏                                                   | 273/561 [00:12<00:14, 19.80it/s] 49%|█████████████████████████████████████████████████▋                                                   | 276/561 [00:12<00:14, 20.08it/s][2025-03-28 01:18:26,463] [INFO] [logging.py:128:log_dist] [Rank 0] step=1400, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:18:26,466] [INFO] [timer.py:264:stop] epoch=0/micro_step=1400/global_step=1400, RunningAvgSamplesPerSec=21.18273038332715, CurrSamplesPerSec=19.48281888132942, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 50%|██████████████████████████████████████████████████▏                                                  | 279/561 [00:12<00:13, 20.16it/s] 50%|██████████████████████████████████████████████████▊                                                  | 282/561 [00:13<00:13, 20.02it/s] 51%|███████████████████████████████████████████████████▎                                                 | 285/561 [00:13<00:13, 20.25it/s] 51%|███████████████████████████████████████████████████▊                                                 | 288/561 [00:13<00:13, 20.29it/s] 52%|████████████████████████████████████████████████████▍                                                | 291/561 [00:13<00:13, 20.36it/s] 52%|████████████████████████████████████████████████████▉                                                | 294/561 [00:13<00:12, 20.54it/s] 53%|█████████████████████████████████████████████████████▍                                               | 297/561 [00:13<00:13, 20.13it/s] 53%|██████████████████████████████████████████████████████                                               | 300/561 [00:13<00:13, 19.96it/s] 54%|██████████████████████████████████████████████████████▌                                              | 303/561 [00:14<00:12, 20.25it/s] 55%|███████████████████████████████████████████████████████                                              | 306/561 [00:14<00:12, 19.74it/s] 55%|███████████████████████████████████████████████████████▍                                             | 308/561 [00:14<00:12, 19.69it/s] 55%|███████████████████████████████████████████████████████▊                                             | 310/561 [00:14<00:12, 19.39it/s] 56%|████████████████████████████████████████████████████████▏                                            | 312/561 [00:14<00:13, 18.95it/s] 56%|████████████████████████████████████████████████████████▌                                            | 314/561 [00:14<00:13, 18.86it/s] 56%|████████████████████████████████████████████████████████▉                                            | 316/561 [00:14<00:13, 18.76it/s] 57%|█████████████████████████████████████████████████████████▎                                           | 318/561 [00:14<00:13, 18.62it/s] 57%|█████████████████████████████████████████████████████████▌                                           | 320/561 [00:14<00:12, 18.79it/s] 57%|█████████████████████████████████████████████████████████▉                                           | 322/561 [00:15<00:12, 18.44it/s] 58%|██████████████████████████████████████████████████████████▎                                          | 324/561 [00:15<00:12, 18.46it/s] 58%|██████████████████████████████████████████████████████████▋                                          | 326/561 [00:15<00:12, 18.42it/s][2025-03-28 01:18:29,049] [INFO] [logging.py:128:log_dist] [Rank 0] step=1450, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:18:29,053] [INFO] [timer.py:264:stop] epoch=0/micro_step=1450/global_step=1450, RunningAvgSamplesPerSec=21.114675971984408, CurrSamplesPerSec=19.23946818510756, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 58%|███████████████████████████████████████████████████████████                                          | 328/561 [00:15<00:12, 18.45it/s] 59%|███████████████████████████████████████████████████████████▍                                         | 330/561 [00:15<00:12, 18.48it/s] 59%|███████████████████████████████████████████████████████████▊                                         | 332/561 [00:15<00:12, 18.51it/s] 60%|████████████████████████████████████████████████████████████▏                                        | 334/561 [00:15<00:12, 18.51it/s] 60%|████████████████████████████████████████████████████████████▍                                        | 336/561 [00:15<00:12, 18.51it/s] 60%|████████████████████████████████████████████████████████████▊                                        | 338/561 [00:15<00:12, 18.14it/s] 61%|█████████████████████████████████████████████████████████████▏                                       | 340/561 [00:16<00:11, 18.62it/s] 61%|█████████████████████████████████████████████████████████████▌                                       | 342/561 [00:16<00:11, 18.59it/s] 61%|█████████████████████████████████████████████████████████████▉                                       | 344/561 [00:16<00:11, 18.40it/s] 62%|██████████████████████████████████████████████████████████████▎                                      | 346/561 [00:16<00:12, 17.48it/s] 62%|██████████████████████████████████████████████████████████████▋                                      | 348/561 [00:16<00:11, 18.04it/s] 63%|███████████████████████████████████████████████████████████████▏                                     | 351/561 [00:16<00:11, 18.78it/s] 63%|███████████████████████████████████████████████████████████████▌                                     | 353/561 [00:16<00:11, 18.85it/s] 63%|███████████████████████████████████████████████████████████████▉                                     | 355/561 [00:16<00:10, 18.93it/s] 64%|████████████████████████████████████████████████████████████████▎                                    | 357/561 [00:16<00:10, 18.80it/s] 64%|████████████████████████████████████████████████████████████████▋                                    | 359/561 [00:17<00:10, 18.73it/s] 64%|████████████████████████████████████████████████████████████████▉                                    | 361/561 [00:17<00:10, 18.70it/s] 65%|█████████████████████████████████████████████████████████████████▎                                   | 363/561 [00:17<00:10, 18.68it/s] 65%|█████████████████████████████████████████████████████████████████▋                                   | 365/561 [00:17<00:10, 18.37it/s] 65%|██████████████████████████████████████████████████████████████████                                   | 367/561 [00:17<00:10, 18.48it/s] 66%|██████████████████████████████████████████████████████████████████▍                                  | 369/561 [00:17<00:10, 18.62it/s] 66%|██████████████████████████████████████████████████████████████████▊                                  | 371/561 [00:17<00:10, 18.62it/s] 66%|███████████████████████████████████████████████████████████████████▏                                 | 373/561 [00:17<00:10, 18.79it/s] 67%|███████████████████████████████████████████████████████████████████▌                                 | 375/561 [00:17<00:09, 18.91it/s][2025-03-28 01:18:31,714] [INFO] [logging.py:128:log_dist] [Rank 0] step=1500, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:18:31,715] [INFO] [timer.py:264:stop] epoch=0/micro_step=1500/global_step=1500, RunningAvgSamplesPerSec=21.02950408446124, CurrSamplesPerSec=22.4399698244313, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 67%|████████████████████████████████████████████████████████████████████                                 | 378/561 [00:18<00:09, 20.16it/s] 68%|████████████████████████████████████████████████████████████████████▌                                | 381/561 [00:18<00:08, 20.78it/s] 68%|█████████████████████████████████████████████████████████████████████▏                               | 384/561 [00:18<00:08, 20.64it/s] 69%|█████████████████████████████████████████████████████████████████████▋                               | 387/561 [00:18<00:08, 21.10it/s] 70%|██████████████████████████████████████████████████████████████████████▏                              | 390/561 [00:18<00:08, 20.99it/s] 70%|██████████████████████████████████████████████████████████████████████▊                              | 393/561 [00:18<00:08, 20.02it/s] 71%|███████████████████████████████████████████████████████████████████████▎                             | 396/561 [00:18<00:08, 19.39it/s] 71%|███████████████████████████████████████████████████████████████████████▋                             | 398/561 [00:19<00:08, 19.08it/s] 71%|████████████████████████████████████████████████████████████████████████                             | 400/561 [00:19<00:08, 18.82it/s] 72%|████████████████████████████████████████████████████████████████████████▎                            | 402/561 [00:19<00:08, 18.61it/s] 72%|████████████████████████████████████████████████████████████████████████▋                            | 404/561 [00:19<00:08, 18.45it/s] 72%|█████████████████████████████████████████████████████████████████████████                            | 406/561 [00:19<00:08, 18.35it/s] 73%|█████████████████████████████████████████████████████████████████████████▍                           | 408/561 [00:19<00:08, 18.28it/s] 73%|█████████████████████████████████████████████████████████████████████████▉                           | 411/561 [00:19<00:07, 19.59it/s] 74%|██████████████████████████████████████████████████████████████████████████▌                          | 414/561 [00:19<00:07, 20.33it/s] 74%|███████████████████████████████████████████████████████████████████████████                          | 417/561 [00:20<00:06, 20.75it/s] 75%|███████████████████████████████████████████████████████████████████████████▌                         | 420/561 [00:20<00:06, 21.14it/s] 75%|████████████████████████████████████████████████████████████████████████████▏                        | 423/561 [00:20<00:06, 20.57it/s] 76%|████████████████████████████████████████████████████████████████████████████▋                        | 426/561 [00:20<00:06, 20.99it/s][2025-03-28 01:18:34,197] [INFO] [logging.py:128:log_dist] [Rank 0] step=1550, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:18:34,198] [INFO] [timer.py:264:stop] epoch=0/micro_step=1550/global_step=1550, RunningAvgSamplesPerSec=21.000974273414087, CurrSamplesPerSec=23.47183435086991, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 76%|█████████████████████████████████████████████████████████████████████████████▏                       | 429/561 [00:20<00:06, 21.65it/s] 77%|█████████████████████████████████████████████████████████████████████████████▊                       | 432/561 [00:20<00:05, 21.99it/s] 78%|██████████████████████████████████████████████████████████████████████████████▎                      | 435/561 [00:20<00:06, 20.89it/s] 78%|██████████████████████████████████████████████████████████████████████████████▊                      | 438/561 [00:21<00:06, 19.99it/s] 79%|███████████████████████████████████████████████████████████████████████████████▍                     | 441/561 [00:21<00:06, 19.39it/s] 79%|███████████████████████████████████████████████████████████████████████████████▊                     | 443/561 [00:21<00:06, 19.09it/s] 79%|████████████████████████████████████████████████████████████████████████████████                     | 445/561 [00:21<00:06, 18.85it/s] 80%|████████████████████████████████████████████████████████████████████████████████▍                    | 447/561 [00:21<00:06, 18.64it/s] 80%|████████████████████████████████████████████████████████████████████████████████▊                    | 449/561 [00:21<00:06, 18.49it/s] 80%|█████████████████████████████████████████████████████████████████████████████████▏                   | 451/561 [00:21<00:05, 18.37it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▋                   | 454/561 [00:21<00:05, 19.10it/s] 81%|██████████████████████████████████████████████████████████████████████████████████▎                  | 457/561 [00:22<00:05, 20.09it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▊                  | 460/561 [00:22<00:04, 20.69it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▎                 | 463/561 [00:22<00:04, 21.03it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▉                 | 466/561 [00:22<00:04, 20.05it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▍                | 469/561 [00:22<00:04, 19.31it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▊                | 471/561 [00:22<00:04, 18.89it/s] 84%|█████████████████████████████████████████████████████████████████████████████████████▏               | 473/561 [00:22<00:04, 18.72it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▌               | 475/561 [00:22<00:04, 18.57it/s][2025-03-28 01:18:36,773] [INFO] [logging.py:128:log_dist] [Rank 0] step=1600, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:18:36,776] [INFO] [timer.py:264:stop] epoch=0/micro_step=1600/global_step=1600, RunningAvgSamplesPerSec=20.948183422160692, CurrSamplesPerSec=22.796840903561275, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 85%|██████████████████████████████████████████████████████████████████████████████████████               | 478/561 [00:23<00:04, 19.52it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▌              | 481/561 [00:23<00:04, 19.65it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▉              | 483/561 [00:23<00:04, 19.24it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▍             | 486/561 [00:23<00:03, 19.65it/s] 87%|████████████████████████████████████████████████████████████████████████████████████████             | 489/561 [00:23<00:03, 20.34it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▌            | 492/561 [00:23<00:03, 20.72it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████████            | 495/561 [00:23<00:03, 21.06it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▋           | 498/561 [00:24<00:02, 21.31it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████▏          | 501/561 [00:24<00:02, 21.68it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▋          | 504/561 [00:24<00:02, 20.34it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████████▎         | 507/561 [00:24<00:02, 19.66it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▋         | 509/561 [00:24<00:02, 19.32it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▉         | 511/561 [00:24<00:02, 18.89it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████████▎        | 513/561 [00:24<00:02, 18.69it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████████▋        | 515/561 [00:24<00:02, 18.53it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████        | 517/561 [00:25<00:02, 18.41it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▍       | 519/561 [00:25<00:02, 18.53it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▉       | 522/561 [00:25<00:01, 20.32it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▌      | 525/561 [00:25<00:01, 20.76it/s][2025-03-28 01:18:39,262] [INFO] [logging.py:128:log_dist] [Rank 0] step=1650, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:18:39,262] [INFO] [timer.py:264:stop] epoch=0/micro_step=1650/global_step=1650, RunningAvgSamplesPerSec=20.923369967899173, CurrSamplesPerSec=22.71252666590071, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 94%|███████████████████████████████████████████████████████████████████████████████████████████████      | 528/561 [00:25<00:01, 21.03it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▌     | 531/561 [00:25<00:01, 21.32it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████████▏    | 534/561 [00:25<00:01, 21.93it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▋    | 537/561 [00:26<00:01, 21.81it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████▏   | 540/561 [00:26<00:00, 21.10it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████████▊   | 543/561 [00:26<00:00, 20.10it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████████▎  | 546/561 [00:26<00:00, 19.47it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▋  | 548/561 [00:26<00:00, 19.14it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████████  | 550/561 [00:26<00:00, 18.88it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████████▍ | 552/561 [00:26<00:00, 18.68it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▋ | 554/561 [00:26<00:00, 18.51it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████ | 556/561 [00:27<00:00, 18.40it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████▍| 558/561 [00:27<00:00, 18.32it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:27<00:00, 19.55it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:27<00:00, 20.51it/s]
  0%|                                                                                                               | 0/561 [00:00<?, ?it/s]  0%|▏                                                                                                      | 1/561 [00:00<02:10,  4.28it/s]  1%|▋                                                                                                      | 4/561 [00:00<00:46, 12.03it/s]  1%|█                                                                                                      | 6/561 [00:00<00:39, 14.23it/s]  2%|█▋                                                                                                     | 9/561 [00:00<00:32, 17.12it/s]  2%|██▏                                                                                                   | 12/561 [00:00<00:28, 19.38it/s]  3%|██▋                                                                                                   | 15/561 [00:00<00:26, 20.77it/s][2025-03-28 01:18:41,991] [INFO] [logging.py:128:log_dist] [Rank 0] step=1700, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:18:41,992] [INFO] [timer.py:264:stop] epoch=0/micro_step=1700/global_step=1700, RunningAvgSamplesPerSec=20.87302281140764, CurrSamplesPerSec=23.35434069154975, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
  3%|███▎                                                                                                  | 18/561 [00:01<00:25, 21.55it/s]  4%|███▊                                                                                                  | 21/561 [00:01<00:24, 22.39it/s]  4%|████▎                                                                                                 | 24/561 [00:01<00:25, 21.11it/s]  5%|████▉                                                                                                 | 27/561 [00:01<00:26, 20.12it/s]  5%|█████▍                                                                                                | 30/561 [00:01<00:27, 19.50it/s]  6%|█████▊                                                                                                | 32/561 [00:01<00:27, 19.18it/s]  6%|██████▏                                                                                               | 34/561 [00:01<00:27, 18.93it/s]  6%|██████▌                                                                                               | 36/561 [00:01<00:28, 18.72it/s]  7%|██████▉                                                                                               | 38/561 [00:02<00:28, 18.54it/s]  7%|███████▎                                                                                              | 40/561 [00:02<00:28, 18.41it/s]  7%|███████▋                                                                                              | 42/561 [00:02<00:28, 18.32it/s]  8%|████████▏                                                                                             | 45/561 [00:02<00:26, 19.49it/s]  9%|████████▋                                                                                             | 48/561 [00:02<00:25, 20.27it/s]  9%|█████████▎                                                                                            | 51/561 [00:02<00:24, 21.00it/s] 10%|█████████▊                                                                                            | 54/561 [00:02<00:23, 21.39it/s] 10%|██████████▎                                                                                           | 57/561 [00:02<00:23, 21.56it/s] 11%|██████████▉                                                                                           | 60/561 [00:03<00:23, 21.34it/s] 11%|███████████▍                                                                                          | 63/561 [00:03<00:23, 21.62it/s] 12%|████████████                                                                                          | 66/561 [00:03<00:22, 21.67it/s][2025-03-28 01:18:44,451] [INFO] [logging.py:128:log_dist] [Rank 0] step=1750, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:18:44,452] [INFO] [timer.py:264:stop] epoch=0/micro_step=1750/global_step=1750, RunningAvgSamplesPerSec=20.85855202726836, CurrSamplesPerSec=20.475781438736995, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 12%|████████████▌                                                                                         | 69/561 [00:03<00:23, 21.26it/s] 13%|█████████████                                                                                         | 72/561 [00:03<00:24, 19.93it/s] 13%|█████████████▋                                                                                        | 75/561 [00:03<00:25, 19.22it/s] 14%|██████████████                                                                                        | 77/561 [00:03<00:25, 18.97it/s] 14%|██████████████▎                                                                                       | 79/561 [00:04<00:25, 18.77it/s] 14%|██████████████▋                                                                                       | 81/561 [00:04<00:25, 18.59it/s] 15%|███████████████                                                                                       | 83/561 [00:04<00:25, 18.45it/s] 15%|███████████████▍                                                                                      | 85/561 [00:04<00:25, 18.34it/s] 16%|███████████████▊                                                                                      | 87/561 [00:04<00:25, 18.28it/s] 16%|████████████████▎                                                                                     | 90/561 [00:04<00:24, 19.57it/s] 17%|████████████████▉                                                                                     | 93/561 [00:04<00:23, 19.96it/s] 17%|█████████████████▍                                                                                    | 96/561 [00:04<00:22, 20.35it/s] 18%|██████████████████                                                                                    | 99/561 [00:05<00:21, 21.04it/s] 18%|██████████████████▎                                                                                  | 102/561 [00:05<00:21, 21.26it/s] 19%|██████████████████▉                                                                                  | 105/561 [00:05<00:21, 21.33it/s] 19%|███████████████████▍                                                                                 | 108/561 [00:05<00:20, 21.69it/s] 20%|███████████████████▉                                                                                 | 111/561 [00:05<00:20, 21.77it/s] 20%|████████████████████▌                                                                                | 114/561 [00:05<00:20, 21.80it/s][2025-03-28 01:18:46,927] [INFO] [logging.py:128:log_dist] [Rank 0] step=1800, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:18:46,928] [INFO] [timer.py:264:stop] epoch=0/micro_step=1800/global_step=1800, RunningAvgSamplesPerSec=20.840861879246923, CurrSamplesPerSec=22.162628962132523, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 21%|█████████████████████                                                                                | 117/561 [00:05<00:20, 21.87it/s] 21%|█████████████████████▌                                                                               | 120/561 [00:06<00:20, 21.53it/s] 22%|██████████████████████▏                                                                              | 123/561 [00:06<00:21, 20.43it/s] 22%|██████████████████████▋                                                                              | 126/561 [00:06<00:22, 19.56it/s] 23%|███████████████████████                                                                              | 128/561 [00:06<00:22, 19.24it/s] 23%|███████████████████████▍                                                                             | 130/561 [00:06<00:22, 18.98it/s] 24%|███████████████████████▊                                                                             | 132/561 [00:06<00:22, 18.74it/s] 24%|████████████████████████                                                                             | 134/561 [00:06<00:23, 18.56it/s] 24%|████████████████████████▍                                                                            | 136/561 [00:06<00:23, 18.42it/s] 25%|████████████████████████▊                                                                            | 138/561 [00:07<00:23, 18.31it/s] 25%|█████████████████████████▍                                                                           | 141/561 [00:07<00:20, 20.84it/s] 26%|█████████████████████████▉                                                                           | 144/561 [00:07<00:19, 21.87it/s] 26%|██████████████████████████▍                                                                          | 147/561 [00:07<00:18, 22.38it/s] 27%|███████████████████████████                                                                          | 150/561 [00:07<00:18, 22.78it/s] 27%|███████████████████████████▌                                                                         | 153/561 [00:07<00:17, 23.93it/s] 28%|████████████████████████████                                                                         | 156/561 [00:07<00:16, 24.41it/s] 28%|████████████████████████████▋                                                                        | 159/561 [00:07<00:16, 24.12it/s] 29%|█████████████████████████████▏                                                                       | 162/561 [00:08<00:16, 24.04it/s] 29%|█████████████████████████████▋                                                                       | 165/561 [00:08<00:16, 23.94it/s][2025-03-28 01:18:49,252] [INFO] [logging.py:128:log_dist] [Rank 0] step=1850, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:18:49,253] [INFO] [timer.py:264:stop] epoch=0/micro_step=1850/global_step=1850, RunningAvgSamplesPerSec=20.859741472460897, CurrSamplesPerSec=23.72555994902706, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 30%|██████████████████████████████▏                                                                      | 168/561 [00:08<00:16, 23.94it/s] 30%|██████████████████████████████▊                                                                      | 171/561 [00:08<00:16, 23.84it/s] 31%|███████████████████████████████▎                                                                     | 174/561 [00:08<00:16, 23.68it/s] 32%|███████████████████████████████▊                                                                     | 177/561 [00:08<00:16, 23.69it/s] 32%|████████████████████████████████▍                                                                    | 180/561 [00:08<00:15, 23.83it/s] 33%|████████████████████████████████▉                                                                    | 183/561 [00:08<00:17, 22.10it/s] 33%|█████████████████████████████████▍                                                                   | 186/561 [00:09<00:17, 21.88it/s] 34%|██████████████████████████████████                                                                   | 189/561 [00:09<00:18, 20.58it/s] 34%|██████████████████████████████████▌                                                                  | 192/561 [00:09<00:18, 19.81it/s] 35%|███████████████████████████████████                                                                  | 195/561 [00:09<00:18, 19.28it/s] 35%|███████████████████████████████████▍                                                                 | 197/561 [00:09<00:19, 19.02it/s] 35%|███████████████████████████████████▊                                                                 | 199/561 [00:09<00:19, 18.78it/s] 36%|████████████████████████████████████▏                                                                | 201/561 [00:09<00:19, 18.59it/s] 36%|████████████████████████████████████▌                                                                | 203/561 [00:10<00:19, 18.44it/s] 37%|████████████████████████████████████▉                                                                | 205/561 [00:10<00:19, 18.70it/s] 37%|█████████████████████████████████████▍                                                               | 208/561 [00:10<00:17, 20.14it/s] 38%|█████████████████████████████████████▉                                                               | 211/561 [00:10<00:16, 21.43it/s] 38%|██████████████████████████████████████▌                                                              | 214/561 [00:10<00:15, 22.17it/s][2025-03-28 01:18:51,647] [INFO] [logging.py:128:log_dist] [Rank 0] step=1900, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:18:51,647] [INFO] [timer.py:264:stop] epoch=0/micro_step=1900/global_step=1900, RunningAvgSamplesPerSec=20.861490640000827, CurrSamplesPerSec=23.272960448617223, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 39%|███████████████████████████████████████                                                              | 217/561 [00:10<00:15, 22.48it/s] 39%|███████████████████████████████████████▌                                                             | 220/561 [00:10<00:15, 22.57it/s] 40%|████████████████████████████████████████▏                                                            | 223/561 [00:10<00:15, 22.19it/s] 40%|████████████████████████████████████████▋                                                            | 226/561 [00:11<00:14, 22.34it/s] 41%|█████████████████████████████████████████▏                                                           | 229/561 [00:11<00:14, 22.33it/s] 41%|█████████████████████████████████████████▊                                                           | 232/561 [00:11<00:14, 22.32it/s] 42%|██████████████████████████████████████████▎                                                          | 235/561 [00:11<00:14, 22.09it/s] 42%|██████████████████████████████████████████▊                                                          | 238/561 [00:11<00:14, 22.10it/s] 43%|███████████████████████████████████████████▍                                                         | 241/561 [00:11<00:14, 21.79it/s] 43%|███████████████████████████████████████████▉                                                         | 244/561 [00:11<00:14, 21.74it/s] 44%|████████████████████████████████████████████▍                                                        | 247/561 [00:11<00:14, 21.75it/s] 45%|█████████████████████████████████████████████                                                        | 250/561 [00:12<00:14, 22.12it/s] 45%|█████████████████████████████████████████████▌                                                       | 253/561 [00:12<00:13, 22.76it/s] 46%|██████████████████████████████████████████████                                                       | 256/561 [00:12<00:13, 22.25it/s] 46%|██████████████████████████████████████████████▋                                                      | 259/561 [00:12<00:14, 20.86it/s] 47%|███████████████████████████████████████████████▏                                                     | 262/561 [00:12<00:14, 19.95it/s] 47%|███████████████████████████████████████████████▋                                                     | 265/561 [00:12<00:15, 19.36it/s][2025-03-28 01:18:54,013] [INFO] [logging.py:128:log_dist] [Rank 0] step=1950, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:18:54,016] [INFO] [timer.py:264:stop] epoch=0/micro_step=1950/global_step=1950, RunningAvgSamplesPerSec=20.869138022924187, CurrSamplesPerSec=18.094714272077024, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 48%|████████████████████████████████████████████████                                                     | 267/561 [00:12<00:15, 19.06it/s] 48%|████████████████████████████████████████████████▍                                                    | 269/561 [00:13<00:15, 18.84it/s] 48%|████████████████████████████████████████████████▊                                                    | 271/561 [00:13<00:15, 18.64it/s] 49%|█████████████████████████████████████████████████▏                                                   | 273/561 [00:13<00:15, 18.49it/s] 49%|█████████████████████████████████████████████████▋                                                   | 276/561 [00:13<00:14, 19.69it/s] 50%|██████████████████████████████████████████████████▏                                                  | 279/561 [00:13<00:13, 20.48it/s] 50%|██████████████████████████████████████████████████▊                                                  | 282/561 [00:13<00:13, 21.05it/s] 51%|███████████████████████████████████████████████████▎                                                 | 285/561 [00:13<00:12, 21.83it/s] 51%|███████████████████████████████████████████████████▊                                                 | 288/561 [00:14<00:13, 20.35it/s] 52%|████████████████████████████████████████████████████▍                                                | 291/561 [00:14<00:13, 20.70it/s] 52%|████████████████████████████████████████████████████▉                                                | 294/561 [00:14<00:12, 21.04it/s] 53%|█████████████████████████████████████████████████████▍                                               | 297/561 [00:14<00:12, 20.93it/s] 53%|██████████████████████████████████████████████████████                                               | 300/561 [00:14<00:12, 20.98it/s] 54%|██████████████████████████████████████████████████████▌                                              | 303/561 [00:14<00:11, 21.52it/s] 55%|███████████████████████████████████████████████████████                                              | 306/561 [00:14<00:11, 22.06it/s] 55%|███████████████████████████████████████████████████████▋                                             | 309/561 [00:14<00:11, 22.04it/s] 56%|████████████████████████████████████████████████████████▏                                            | 312/561 [00:15<00:11, 22.03it/s] 56%|████████████████████████████████████████████████████████▋                                            | 315/561 [00:15<00:11, 22.03it/s][2025-03-28 01:18:56,372] [INFO] [logging.py:128:log_dist] [Rank 0] step=2000, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:18:56,372] [INFO] [timer.py:264:stop] epoch=0/micro_step=2000/global_step=2000, RunningAvgSamplesPerSec=20.879069923674447, CurrSamplesPerSec=21.967965576219395, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 57%|█████████████████████████████████████████████████████████▎                                           | 318/561 [00:15<00:11, 21.94it/s] 57%|█████████████████████████████████████████████████████████▊                                           | 321/561 [00:15<00:11, 21.19it/s][2025-03-28 01:18:56,629] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2025-03-28 01:18:56,676] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
 58%|██████████████████████████████████████████████████████████▎                                          | 324/561 [00:15<00:11, 20.64it/s] 58%|██████████████████████████████████████████████████████████▊                                          | 327/561 [00:15<00:11, 20.76it/s] 59%|███████████████████████████████████████████████████████████▍                                         | 330/561 [00:15<00:10, 21.10it/s] 59%|███████████████████████████████████████████████████████████▉                                         | 333/561 [00:16<00:10, 21.36it/s] 60%|████████████████████████████████████████████████████████████▍                                        | 336/561 [00:16<00:10, 21.26it/s] 60%|█████████████████████████████████████████████████████████████                                        | 339/561 [00:16<00:10, 20.53it/s] 61%|█████████████████████████████████████████████████████████████▌                                       | 342/561 [00:16<00:10, 21.04it/s] 61%|██████████████████████████████████████████████████████████████                                       | 345/561 [00:16<00:10, 21.27it/s] 62%|██████████████████████████████████████████████████████████████▋                                      | 348/561 [00:16<00:10, 21.21it/s] 63%|███████████████████████████████████████████████████████████████▏                                     | 351/561 [00:16<00:09, 21.18it/s] 63%|███████████████████████████████████████████████████████████████▋                                     | 354/561 [00:17<00:10, 20.22it/s] 64%|████████████████████████████████████████████████████████████████▎                                    | 357/561 [00:17<00:10, 19.43it/s] 64%|████████████████████████████████████████████████████████████████▋                                    | 359/561 [00:17<00:10, 19.13it/s] 64%|████████████████████████████████████████████████████████████████▉                                    | 361/561 [00:17<00:10, 18.88it/s] 65%|█████████████████████████████████████████████████████████████████▎                                   | 363/561 [00:17<00:10, 18.68it/s] 65%|█████████████████████████████████████████████████████████████████▋                                   | 365/561 [00:17<00:10, 18.51it/s][2025-03-28 01:18:58,880] [INFO] [logging.py:128:log_dist] [Rank 0] step=2050, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:18:58,883] [INFO] [timer.py:264:stop] epoch=0/micro_step=2050/global_step=2050, RunningAvgSamplesPerSec=20.8558678987135, CurrSamplesPerSec=18.075842801388735, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 65%|██████████████████████████████████████████████████████████████████                                   | 367/561 [00:17<00:10, 18.36it/s] 66%|██████████████████████████████████████████████████████████████████▍                                  | 369/561 [00:17<00:10, 18.31it/s] 66%|██████████████████████████████████████████████████████████████████▊                                  | 371/561 [00:18<00:10, 18.61it/s] 67%|███████████████████████████████████████████████████████████████████▎                                 | 374/561 [00:18<00:09, 20.15it/s] 67%|███████████████████████████████████████████████████████████████████▊                                 | 377/561 [00:18<00:08, 20.76it/s] 68%|████████████████████████████████████████████████████████████████████▍                                | 380/561 [00:18<00:08, 21.09it/s] 68%|████████████████████████████████████████████████████████████████████▉                                | 383/561 [00:18<00:08, 20.99it/s] 69%|█████████████████████████████████████████████████████████████████████▍                               | 386/561 [00:18<00:08, 20.99it/s] 69%|██████████████████████████████████████████████████████████████████████                               | 389/561 [00:18<00:08, 21.40it/s] 70%|██████████████████████████████████████████████████████████████████████▌                              | 392/561 [00:19<00:07, 21.68it/s] 70%|███████████████████████████████████████████████████████████████████████                              | 395/561 [00:19<00:07, 22.01it/s] 71%|███████████████████████████████████████████████████████████████████████▋                             | 398/561 [00:19<00:07, 22.17it/s] 71%|████████████████████████████████████████████████████████████████████████▏                            | 401/561 [00:19<00:07, 22.20it/s] 72%|████████████████████████████████████████████████████████████████████████▋                            | 404/561 [00:19<00:07, 22.02it/s] 73%|█████████████████████████████████████████████████████████████████████████▎                           | 407/561 [00:19<00:07, 21.83it/s] 73%|█████████████████████████████████████████████████████████████████████████▊                           | 410/561 [00:19<00:06, 22.14it/s] 74%|██████████████████████████████████████████████████████████████████████████▎                          | 413/561 [00:19<00:06, 22.15it/s] 74%|██████████████████████████████████████████████████████████████████████████▉                          | 416/561 [00:20<00:06, 22.11it/s][2025-03-28 01:19:01,180] [INFO] [logging.py:128:log_dist] [Rank 0] step=2100, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:19:01,181] [INFO] [timer.py:264:stop] epoch=0/micro_step=2100/global_step=2100, RunningAvgSamplesPerSec=20.87771269519226, CurrSamplesPerSec=22.384879547255537, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 75%|███████████████████████████████████████████████████████████████████████████▍                         | 419/561 [00:20<00:06, 21.93it/s] 75%|███████████████████████████████████████████████████████████████████████████▉                         | 422/561 [00:20<00:06, 21.67it/s] 76%|████████████████████████████████████████████████████████████████████████████▌                        | 425/561 [00:20<00:06, 21.86it/s] 76%|█████████████████████████████████████████████████████████████████████████████                        | 428/561 [00:20<00:06, 21.97it/s] 77%|█████████████████████████████████████████████████████████████████████████████▌                       | 431/561 [00:20<00:05, 21.99it/s] 77%|██████████████████████████████████████████████████████████████████████████████▏                      | 434/561 [00:20<00:05, 21.79it/s] 78%|██████████████████████████████████████████████████████████████████████████████▋                      | 437/561 [00:21<00:05, 21.72it/s] 78%|███████████████████████████████████████████████████████████████████████████████▏                     | 440/561 [00:21<00:05, 21.41it/s] 79%|███████████████████████████████████████████████████████████████████████████████▊                     | 443/561 [00:21<00:05, 21.31it/s] 80%|████████████████████████████████████████████████████████████████████████████████▎                    | 446/561 [00:21<00:05, 21.53it/s] 80%|████████████████████████████████████████████████████████████████████████████████▊                    | 449/561 [00:21<00:05, 21.56it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▍                   | 452/561 [00:21<00:04, 22.42it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▉                   | 455/561 [00:21<00:04, 22.19it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▍                  | 458/561 [00:22<00:04, 22.08it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▉                  | 461/561 [00:22<00:04, 22.28it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▌                 | 464/561 [00:22<00:04, 22.06it/s][2025-03-28 01:19:03,467] [INFO] [logging.py:128:log_dist] [Rank 0] step=2150, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:19:03,467] [INFO] [timer.py:264:stop] epoch=0/micro_step=2150/global_step=2150, RunningAvgSamplesPerSec=20.900890461569425, CurrSamplesPerSec=21.60473375698633, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 83%|████████████████████████████████████████████████████████████████████████████████████                 | 467/561 [00:22<00:04, 22.11it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▌                | 470/561 [00:22<00:04, 22.21it/s] 84%|█████████████████████████████████████████████████████████████████████████████████████▏               | 473/561 [00:22<00:03, 22.31it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▋               | 476/561 [00:22<00:03, 22.26it/s] 85%|██████████████████████████████████████████████████████████████████████████████████████▏              | 479/561 [00:22<00:03, 22.08it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▊              | 482/561 [00:23<00:03, 22.10it/s] 86%|███████████████████████████████████████████████████████████████████████████████████████▎             | 485/561 [00:23<00:03, 22.61it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▊             | 488/561 [00:23<00:03, 22.42it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▍            | 491/561 [00:23<00:03, 22.16it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▉            | 494/561 [00:23<00:02, 22.55it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▍           | 497/561 [00:23<00:02, 21.76it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████           | 500/561 [00:23<00:02, 20.55it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▌          | 503/561 [00:24<00:02, 20.59it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████████          | 506/561 [00:24<00:02, 21.38it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▋         | 509/561 [00:24<00:02, 22.14it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████████▏        | 512/561 [00:24<00:02, 22.70it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████████▋        | 515/561 [00:24<00:01, 23.01it/s][2025-03-28 01:19:05,719] [INFO] [logging.py:128:log_dist] [Rank 0] step=2200, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:19:05,720] [INFO] [timer.py:264:stop] epoch=0/micro_step=2200/global_step=2200, RunningAvgSamplesPerSec=20.929822090590523, CurrSamplesPerSec=23.486028863078765, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 92%|█████████████████████████████████████████████████████████████████████████████████████████████▎       | 518/561 [00:24<00:01, 23.15it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▊       | 521/561 [00:24<00:01, 23.36it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████████▎      | 524/561 [00:24<00:01, 22.89it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▉      | 527/561 [00:25<00:01, 22.37it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▍     | 530/561 [00:25<00:01, 22.11it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▉     | 533/561 [00:25<00:01, 22.01it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▍    | 536/561 [00:25<00:01, 21.98it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████    | 539/561 [00:25<00:01, 21.87it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████████▌   | 542/561 [00:25<00:00, 22.68it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████████   | 545/561 [00:25<00:00, 23.97it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▋  | 548/561 [00:26<00:00, 23.35it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████████▏ | 551/561 [00:26<00:00, 23.00it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▋ | 554/561 [00:26<00:00, 22.76it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████▎| 557/561 [00:26<00:00, 22.51it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████████▊| 560/561 [00:26<00:00, 22.64it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:26<00:00, 21.01it/s]
  0%|                                                                                                               | 0/561 [00:00<?, ?it/s]  0%|▏                                                                                                      | 1/561 [00:00<03:25,  2.72it/s]  1%|▋                                                                                                      | 4/561 [00:00<01:00,  9.20it/s][2025-03-28 01:19:08,355] [INFO] [logging.py:128:log_dist] [Rank 0] step=2250, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:19:08,356] [INFO] [timer.py:264:stop] epoch=0/micro_step=2250/global_step=2250, RunningAvgSamplesPerSec=20.91115531772195, CurrSamplesPerSec=22.63738302407103, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
  1%|█▎                                                                                                     | 7/561 [00:00<00:42, 12.89it/s]  2%|█▊                                                                                                    | 10/561 [00:00<00:35, 15.45it/s]  2%|██▎                                                                                                   | 13/561 [00:00<00:31, 17.59it/s]  3%|██▉                                                                                                   | 16/561 [00:01<00:28, 19.01it/s]  3%|███▍                                                                                                  | 19/561 [00:01<00:27, 19.95it/s]  4%|████                                                                                                  | 22/561 [00:01<00:26, 20.51it/s]  4%|████▌                                                                                                 | 25/561 [00:01<00:25, 20.76it/s]  5%|█████                                                                                                 | 28/561 [00:01<00:25, 21.15it/s]  6%|█████▋                                                                                                | 31/561 [00:01<00:24, 21.84it/s]  6%|██████▏                                                                                               | 34/561 [00:01<00:24, 21.77it/s]  7%|██████▋                                                                                               | 37/561 [00:02<00:23, 21.86it/s]  7%|███████▎                                                                                              | 40/561 [00:02<00:23, 22.29it/s]  8%|███████▊                                                                                              | 43/561 [00:02<00:23, 22.27it/s]  8%|████████▎                                                                                             | 46/561 [00:02<00:23, 22.18it/s]  9%|████████▉                                                                                             | 49/561 [00:02<00:23, 22.20it/s]  9%|█████████▍                                                                                            | 52/561 [00:02<00:23, 22.04it/s] 10%|██████████                                                                                            | 55/561 [00:02<00:23, 21.99it/s][2025-03-28 01:19:10,639] [INFO] [logging.py:128:log_dist] [Rank 0] step=2300, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:19:10,640] [INFO] [timer.py:264:stop] epoch=0/micro_step=2300/global_step=2300, RunningAvgSamplesPerSec=20.932646535949644, CurrSamplesPerSec=20.841449109671014, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 10%|██████████▌                                                                                           | 58/561 [00:02<00:22, 21.96it/s] 11%|███████████                                                                                           | 61/561 [00:03<00:22, 22.47it/s] 11%|███████████▋                                                                                          | 64/561 [00:03<00:22, 22.26it/s] 12%|████████████▏                                                                                         | 67/561 [00:03<00:22, 22.30it/s] 12%|████████████▋                                                                                         | 70/561 [00:03<00:21, 22.52it/s] 13%|█████████████▎                                                                                        | 73/561 [00:03<00:21, 22.38it/s] 14%|█████████████▊                                                                                        | 76/561 [00:03<00:21, 22.19it/s] 14%|██████████████▎                                                                                       | 79/561 [00:03<00:21, 22.12it/s] 15%|██████████████▉                                                                                       | 82/561 [00:04<00:21, 22.26it/s] 15%|███████████████▍                                                                                      | 85/561 [00:04<00:21, 22.12it/s] 16%|████████████████                                                                                      | 88/561 [00:04<00:21, 22.23it/s] 16%|████████████████▌                                                                                     | 91/561 [00:04<00:21, 22.05it/s] 17%|█████████████████                                                                                     | 94/561 [00:04<00:21, 21.94it/s] 17%|█████████████████▋                                                                                    | 97/561 [00:04<00:21, 21.84it/s] 18%|██████████████████                                                                                   | 100/561 [00:04<00:21, 20.99it/s] 18%|██████████████████▌                                                                                  | 103/561 [00:05<00:21, 21.02it/s][2025-03-28 01:19:12,921] [INFO] [logging.py:128:log_dist] [Rank 0] step=2350, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:19:12,922] [INFO] [timer.py:264:stop] epoch=0/micro_step=2350/global_step=2350, RunningAvgSamplesPerSec=20.95369155867655, CurrSamplesPerSec=21.955086547523365, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 19%|███████████████████                                                                                  | 106/561 [00:05<00:21, 21.27it/s] 19%|███████████████████▌                                                                                 | 109/561 [00:05<00:20, 21.61it/s] 20%|████████████████████▏                                                                                | 112/561 [00:05<00:20, 21.76it/s] 20%|████████████████████▋                                                                                | 115/561 [00:05<00:20, 21.84it/s] 21%|█████████████████████▏                                                                               | 118/561 [00:05<00:20, 21.22it/s] 22%|█████████████████████▊                                                                               | 121/561 [00:05<00:20, 21.18it/s] 22%|██████████████████████▎                                                                              | 124/561 [00:06<00:20, 21.46it/s] 23%|██████████████████████▊                                                                              | 127/561 [00:06<00:19, 22.15it/s] 23%|███████████████████████▍                                                                             | 130/561 [00:06<00:19, 21.94it/s] 24%|███████████████████████▉                                                                             | 133/561 [00:06<00:19, 21.77it/s] 24%|████████████████████████▍                                                                            | 136/561 [00:06<00:19, 22.10it/s] 25%|█████████████████████████                                                                            | 139/561 [00:06<00:19, 21.69it/s] 25%|█████████████████████████▌                                                                           | 142/561 [00:06<00:19, 21.07it/s] 26%|██████████████████████████                                                                           | 145/561 [00:06<00:19, 21.27it/s] 26%|██████████████████████████▋                                                                          | 148/561 [00:07<00:19, 21.64it/s] 27%|███████████████████████████▏                                                                         | 151/561 [00:07<00:18, 21.92it/s] 27%|███████████████████████████▋                                                                         | 154/561 [00:07<00:18, 21.82it/s][2025-03-28 01:19:15,220] [INFO] [logging.py:128:log_dist] [Rank 0] step=2400, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:19:15,220] [INFO] [timer.py:264:stop] epoch=0/micro_step=2400/global_step=2400, RunningAvgSamplesPerSec=20.97088514536817, CurrSamplesPerSec=22.549028098972325, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 28%|████████████████████████████▎                                                                        | 157/561 [00:07<00:18, 21.99it/s] 29%|████████████████████████████▊                                                                        | 160/561 [00:07<00:18, 21.78it/s] 29%|█████████████████████████████▎                                                                       | 163/561 [00:07<00:18, 21.76it/s] 30%|█████████████████████████████▉                                                                       | 166/561 [00:07<00:17, 22.21it/s] 30%|██████████████████████████████▍                                                                      | 169/561 [00:08<00:17, 22.65it/s] 31%|██████████████████████████████▉                                                                      | 172/561 [00:08<00:17, 22.73it/s] 31%|███████████████████████████████▌                                                                     | 175/561 [00:08<00:17, 22.53it/s] 32%|████████████████████████████████                                                                     | 178/561 [00:08<00:17, 22.37it/s] 32%|████████████████████████████████▌                                                                    | 181/561 [00:08<00:17, 21.97it/s] 33%|█████████████████████████████████▏                                                                   | 184/561 [00:08<00:17, 20.95it/s] 33%|█████████████████████████████████▋                                                                   | 187/561 [00:08<00:17, 21.66it/s] 34%|██████████████████████████████████▏                                                                  | 190/561 [00:09<00:16, 22.03it/s] 34%|██████████████████████████████████▋                                                                  | 193/561 [00:09<00:16, 21.99it/s] 35%|███████████████████████████████████▎                                                                 | 196/561 [00:09<00:16, 22.09it/s] 35%|███████████████████████████████████▊                                                                 | 199/561 [00:09<00:16, 22.18it/s] 36%|████████████████████████████████████▎                                                                | 202/561 [00:09<00:16, 22.21it/s] 37%|████████████████████████████████████▉                                                                | 205/561 [00:09<00:16, 21.78it/s][2025-03-28 01:19:17,489] [INFO] [logging.py:128:log_dist] [Rank 0] step=2450, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:19:17,489] [INFO] [timer.py:264:stop] epoch=0/micro_step=2450/global_step=2450, RunningAvgSamplesPerSec=20.99266187442206, CurrSamplesPerSec=23.00288217731894, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 37%|█████████████████████████████████████▍                                                               | 208/561 [00:09<00:15, 22.33it/s] 38%|█████████████████████████████████████▉                                                               | 211/561 [00:09<00:15, 22.76it/s] 38%|██████████████████████████████████████▌                                                              | 214/561 [00:10<00:15, 22.69it/s] 39%|███████████████████████████████████████                                                              | 217/561 [00:10<00:15, 22.40it/s] 39%|███████████████████████████████████████▌                                                             | 220/561 [00:10<00:15, 22.29it/s] 40%|████████████████████████████████████████▏                                                            | 223/561 [00:10<00:15, 22.32it/s] 40%|████████████████████████████████████████▋                                                            | 226/561 [00:10<00:14, 22.40it/s] 41%|█████████████████████████████████████████▏                                                           | 229/561 [00:10<00:15, 21.80it/s] 41%|█████████████████████████████████████████▊                                                           | 232/561 [00:10<00:16, 20.44it/s] 42%|██████████████████████████████████████████▎                                                          | 235/561 [00:11<00:15, 20.85it/s] 42%|██████████████████████████████████████████▊                                                          | 238/561 [00:11<00:15, 21.17it/s] 43%|███████████████████████████████████████████▍                                                         | 241/561 [00:11<00:14, 21.54it/s] 43%|███████████████████████████████████████████▉                                                         | 244/561 [00:11<00:14, 21.54it/s] 44%|████████████████████████████████████████████▍                                                        | 247/561 [00:11<00:14, 21.46it/s] 45%|█████████████████████████████████████████████                                                        | 250/561 [00:11<00:14, 21.55it/s] 45%|█████████████████████████████████████████████▌                                                       | 253/561 [00:11<00:14, 21.87it/s][2025-03-28 01:19:19,784] [INFO] [logging.py:128:log_dist] [Rank 0] step=2500, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:19:19,785] [INFO] [timer.py:264:stop] epoch=0/micro_step=2500/global_step=2500, RunningAvgSamplesPerSec=21.008891310552734, CurrSamplesPerSec=22.689059782672985, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 46%|██████████████████████████████████████████████                                                       | 256/561 [00:12<00:14, 21.68it/s] 46%|██████████████████████████████████████████████▋                                                      | 259/561 [00:12<00:32,  9.23it/s] 47%|██████████████████████████████████████████████▉                                                      | 261/561 [00:14<01:15,  3.97it/s] 47%|███████████████████████████████████████████████▎                                                     | 263/561 [00:14<01:02,  4.76it/s] 47%|███████████████████████████████████████████████▉                                                     | 266/561 [00:14<00:45,  6.48it/s] 48%|████████████████████████████████████████████████▍                                                    | 269/561 [00:14<00:34,  8.36it/s] 48%|████████████████████████████████████████████████▉                                                    | 272/561 [00:14<00:27, 10.51it/s] 49%|█████████████████████████████████████████████████▌                                                   | 275/561 [00:15<00:22, 12.59it/s] 50%|██████████████████████████████████████████████████                                                   | 278/561 [00:15<00:19, 14.52it/s] 50%|██████████████████████████████████████████████████▌                                                  | 281/561 [00:15<00:17, 16.11it/s] 51%|███████████████████████████████████████████████████▏                                                 | 284/561 [00:15<00:15, 17.38it/s] 51%|███████████████████████████████████████████████████▋                                                 | 287/561 [00:15<00:14, 18.39it/s] 52%|████████████████████████████████████████████████████▏                                                | 290/561 [00:15<00:14, 19.06it/s] 52%|████████████████████████████████████████████████████▊                                                | 293/561 [00:15<00:13, 19.67it/s] 53%|█████████████████████████████████████████████████████▎                                               | 296/561 [00:16<00:21, 12.52it/s] 53%|█████████████████████████████████████████████████████▋                                               | 298/561 [00:17<00:52,  5.05it/s] 53%|██████████████████████████████████████████████████████                                               | 300/561 [00:18<00:55,  4.70it/s] 54%|██████████████████████████████████████████████████████▌                                              | 303/561 [00:18<00:40,  6.37it/s][2025-03-28 01:19:26,067] [INFO] [logging.py:128:log_dist] [Rank 0] step=2550, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:19:26,068] [INFO] [timer.py:264:stop] epoch=0/micro_step=2550/global_step=2550, RunningAvgSamplesPerSec=20.360289719374194, CurrSamplesPerSec=22.396234712869227, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 55%|███████████████████████████████████████████████████████                                              | 306/561 [00:18<00:30,  8.29it/s] 55%|███████████████████████████████████████████████████████▋                                             | 309/561 [00:18<00:24, 10.35it/s] 56%|████████████████████████████████████████████████████████▏                                            | 312/561 [00:18<00:20, 12.42it/s] 56%|████████████████████████████████████████████████████████▋                                            | 315/561 [00:18<00:17, 14.39it/s] 57%|█████████████████████████████████████████████████████████▎                                           | 318/561 [00:18<00:15, 15.89it/s] 57%|█████████████████████████████████████████████████████████▊                                           | 321/561 [00:18<00:13, 17.43it/s] 58%|██████████████████████████████████████████████████████████▎                                          | 324/561 [00:19<00:12, 18.42it/s] 58%|██████████████████████████████████████████████████████████▊                                          | 327/561 [00:19<00:11, 19.80it/s] 59%|███████████████████████████████████████████████████████████▍                                         | 330/561 [00:20<00:29,  7.78it/s] 59%|███████████████████████████████████████████████████████████▊                                         | 332/561 [00:21<00:48,  4.71it/s] 60%|████████████████████████████████████████████████████████████▏                                        | 334/561 [00:21<00:41,  5.46it/s] 60%|████████████████████████████████████████████████████████████▍                                        | 336/561 [00:21<00:33,  6.63it/s] 60%|████████████████████████████████████████████████████████████▊                                        | 338/561 [00:21<00:27,  8.05it/s] 61%|█████████████████████████████████████████████████████████████▍                                       | 341/561 [00:21<00:21, 10.42it/s] 61%|█████████████████████████████████████████████████████████████▉                                       | 344/561 [00:21<00:17, 12.61it/s] 62%|██████████████████████████████████████████████████████████████▍                                      | 347/561 [00:22<00:14, 15.00it/s] 62%|███████████████████████████████████████████████████████████████                                      | 350/561 [00:22<00:12, 16.59it/s] 63%|███████████████████████████████████████████████████████████████▌                                     | 353/561 [00:22<00:11, 17.96it/s][2025-03-28 01:19:30,173] [INFO] [logging.py:128:log_dist] [Rank 0] step=2600, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:19:30,175] [INFO] [timer.py:264:stop] epoch=0/micro_step=2600/global_step=2600, RunningAvgSamplesPerSec=20.101287413200986, CurrSamplesPerSec=20.607165297271017, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 63%|████████████████████████████████████████████████████████████████                                     | 356/561 [00:22<00:10, 19.08it/s] 64%|████████████████████████████████████████████████████████████████▋                                    | 359/561 [00:22<00:10, 18.73it/s] 65%|█████████████████████████████████████████████████████████████████▏                                   | 362/561 [00:22<00:10, 19.04it/s] 65%|█████████████████████████████████████████████████████████████████▋                                   | 365/561 [00:22<00:09, 19.94it/s] 66%|██████████████████████████████████████████████████████████████████▎                                  | 368/561 [00:24<00:40,  4.80it/s] 66%|██████████████████████████████████████████████████████████████████▌                                  | 370/561 [00:25<00:42,  4.54it/s] 66%|██████████████████████████████████████████████████████████████████▉                                  | 372/561 [00:25<00:38,  4.90it/s] 67%|███████████████████████████████████████████████████████████████████▎                                 | 374/561 [00:25<00:31,  5.87it/s] 67%|███████████████████████████████████████████████████████████████████▊                                 | 377/561 [00:25<00:23,  7.89it/s] 68%|████████████████████████████████████████████████████████████████████▍                                | 380/561 [00:25<00:18, 10.04it/s] 68%|████████████████████████████████████████████████████████████████████▉                                | 383/561 [00:25<00:14, 12.16it/s] 69%|█████████████████████████████████████████████████████████████████████▍                               | 386/561 [00:26<00:12, 14.04it/s] 69%|██████████████████████████████████████████████████████████████████████                               | 389/561 [00:26<00:10, 15.87it/s] 70%|██████████████████████████████████████████████████████████████████████▌                              | 392/561 [00:26<00:09, 17.64it/s] 70%|███████████████████████████████████████████████████████████████████████                              | 395/561 [00:26<00:08, 19.24it/s] 71%|███████████████████████████████████████████████████████████████████████▋                             | 398/561 [00:26<00:08, 20.32it/s] 71%|████████████████████████████████████████████████████████████████████████▏                            | 401/561 [00:26<00:07, 20.57it/s] 72%|████████████████████████████████████████████████████████████████████████▋                            | 404/561 [00:26<00:07, 20.81it/s][2025-03-28 01:19:34,782] [INFO] [logging.py:128:log_dist] [Rank 0] step=2650, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:19:34,783] [INFO] [timer.py:264:stop] epoch=0/micro_step=2650/global_step=2650, RunningAvgSamplesPerSec=19.81193800502047, CurrSamplesPerSec=19.388166543253632, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 73%|█████████████████████████████████████████████████████████████████████████▎                           | 407/561 [00:27<00:07, 20.89it/s] 73%|█████████████████████████████████████████████████████████████████████████▊                           | 410/561 [00:27<00:17,  8.64it/s] 73%|██████████████████████████████████████████████████████████████████████████▏                          | 412/561 [00:29<00:39,  3.74it/s] 74%|██████████████████████████████████████████████████████████████████████████▌                          | 414/561 [00:29<00:33,  4.40it/s] 74%|██████████████████████████████████████████████████████████████████████████▉                          | 416/561 [00:29<00:26,  5.44it/s] 75%|███████████████████████████████████████████████████████████████████████████▍                         | 419/561 [00:29<00:19,  7.42it/s] 75%|███████████████████████████████████████████████████████████████████████████▉                         | 422/561 [00:30<00:14,  9.59it/s] 76%|████████████████████████████████████████████████████████████████████████████▌                        | 425/561 [00:30<00:11, 11.76it/s] 76%|████████████████████████████████████████████████████████████████████████████▉                        | 427/561 [00:30<00:10, 12.75it/s] 77%|█████████████████████████████████████████████████████████████████████████████▍                       | 430/561 [00:30<00:08, 14.66it/s] 77%|█████████████████████████████████████████████████████████████████████████████▊                       | 432/561 [00:30<00:08, 15.38it/s] 77%|██████████████████████████████████████████████████████████████████████████████▏                      | 434/561 [00:30<00:07, 16.27it/s] 78%|██████████████████████████████████████████████████████████████████████████████▋                      | 437/561 [00:30<00:07, 17.64it/s] 78%|███████████████████████████████████████████████████████████████████████████████▏                     | 440/561 [00:30<00:06, 18.85it/s] 79%|███████████████████████████████████████████████████████████████████████████████▊                     | 443/561 [00:31<00:05, 19.72it/s] 80%|████████████████████████████████████████████████████████████████████████████████▎                    | 446/561 [00:31<00:05, 20.27it/s] 80%|████████████████████████████████████████████████████████████████████████████████▊                    | 449/561 [00:31<00:05, 20.53it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▍                   | 452/561 [00:31<00:05, 20.92it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▉                   | 455/561 [00:33<00:28,  3.78it/s][2025-03-28 01:19:41,840] [INFO] [logging.py:128:log_dist] [Rank 0] step=2700, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:19:41,841] [INFO] [timer.py:264:stop] epoch=0/micro_step=2700/global_step=2700, RunningAvgSamplesPerSec=19.17456602193404, CurrSamplesPerSec=3.3330658112670624, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 81%|██████████████████████████████████████████████████████████████████████████████████▎                  | 457/561 [00:34<00:26,  3.94it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▋                  | 459/561 [00:34<00:23,  4.38it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▉                  | 461/561 [00:34<00:19,  5.01it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▌                 | 464/561 [00:34<00:13,  6.94it/s] 83%|████████████████████████████████████████████████████████████████████████████████████                 | 467/561 [00:35<00:10,  9.02it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▌                | 470/561 [00:35<00:08, 11.14it/s] 84%|█████████████████████████████████████████████████████████████████████████████████████▏               | 473/561 [00:35<00:06, 13.17it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▋               | 476/561 [00:35<00:05, 14.95it/s] 85%|██████████████████████████████████████████████████████████████████████████████████████▏              | 479/561 [00:35<00:04, 16.89it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▊              | 482/561 [00:35<00:04, 18.50it/s] 86%|███████████████████████████████████████████████████████████████████████████████████████▎             | 485/561 [00:35<00:03, 19.83it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▊             | 488/561 [00:35<00:03, 20.78it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▍            | 491/561 [00:36<00:03, 21.13it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▉            | 494/561 [00:36<00:03, 21.43it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▍           | 497/561 [00:36<00:02, 21.50it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████           | 500/561 [00:36<00:02, 21.45it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▌          | 503/561 [00:36<00:02, 21.40it/s][2025-03-28 01:19:44,528] [INFO] [logging.py:128:log_dist] [Rank 0] step=2750, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:19:44,529] [INFO] [timer.py:264:stop] epoch=0/micro_step=2750/global_step=2750, RunningAvgSamplesPerSec=19.164844495274764, CurrSamplesPerSec=22.067596057042373, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 90%|███████████████████████████████████████████████████████████████████████████████████████████          | 506/561 [00:36<00:02, 21.48it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▋         | 509/561 [00:36<00:02, 21.71it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████████▏        | 512/561 [00:37<00:02, 22.20it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████████▋        | 515/561 [00:37<00:02, 22.20it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████▎       | 518/561 [00:37<00:01, 22.13it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▊       | 521/561 [00:37<00:01, 21.89it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████████▎      | 524/561 [00:37<00:01, 21.59it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▉      | 527/561 [00:37<00:01, 22.15it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▍     | 530/561 [00:37<00:01, 20.68it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▉     | 533/561 [00:38<00:01, 20.70it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▍    | 536/561 [00:38<00:01, 21.07it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████    | 539/561 [00:38<00:01, 21.05it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████████▌   | 542/561 [00:38<00:00, 21.07it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████████   | 545/561 [00:38<00:00, 21.36it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▋  | 548/561 [00:38<00:00, 21.28it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████████▏ | 551/561 [00:38<00:00, 21.42it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▋ | 554/561 [00:39<00:00, 21.52it/s][2025-03-28 01:19:47,748] [INFO] [logging.py:128:log_dist] [Rank 0] step=2800, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:19:47,749] [INFO] [timer.py:264:stop] epoch=0/micro_step=2800/global_step=2800, RunningAvgSamplesPerSec=19.085697899495948, CurrSamplesPerSec=1.4256379124899987, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 99%|████████████████████████████████████████████████████████████████████████████████████████████████████▎| 557/561 [00:40<00:00,  4.97it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████████▋| 559/561 [00:41<00:00,  5.25it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:41<00:00,  5.53it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:41<00:00, 13.56it/s]
  0%|                                                                                                               | 0/561 [00:00<?, ?it/s]  0%|▏                                                                                                      | 1/561 [00:00<01:54,  4.89it/s]  1%|▌                                                                                                      | 3/561 [00:00<00:50, 11.06it/s]  1%|█                                                                                                      | 6/561 [00:00<00:35, 15.85it/s]  2%|█▋                                                                                                     | 9/561 [00:00<00:30, 17.88it/s]  2%|██▏                                                                                                   | 12/561 [00:00<00:28, 18.95it/s]  3%|██▋                                                                                                   | 15/561 [00:00<00:27, 19.89it/s]  3%|███▎                                                                                                  | 18/561 [00:01<00:26, 20.55it/s]  4%|███▊                                                                                                  | 21/561 [00:01<00:25, 20.95it/s]  4%|████▎                                                                                                 | 24/561 [00:01<00:25, 20.92it/s]  5%|████▉                                                                                                 | 27/561 [00:01<00:24, 21.56it/s]  5%|█████▍                                                                                                | 30/561 [00:01<00:23, 22.21it/s]  6%|██████                                                                                                | 33/561 [00:01<00:23, 22.79it/s]  6%|██████▌                                                                                               | 36/561 [00:01<00:22, 22.97it/s]  7%|███████                                                                                               | 39/561 [00:01<00:22, 23.06it/s]  7%|███████▋                                                                                              | 42/561 [00:02<00:22, 23.25it/s][2025-03-28 01:19:51,319] [INFO] [logging.py:128:log_dist] [Rank 0] step=2850, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:19:51,320] [INFO] [timer.py:264:stop] epoch=0/micro_step=2850/global_step=2850, RunningAvgSamplesPerSec=18.995500338074226, CurrSamplesPerSec=22.866065655005364, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
  8%|████████▏                                                                                             | 45/561 [00:02<00:22, 23.20it/s]  9%|████████▋                                                                                             | 48/561 [00:02<00:22, 23.26it/s]  9%|█████████▎                                                                                            | 51/561 [00:02<00:22, 22.83it/s] 10%|█████████▊                                                                                            | 54/561 [00:02<00:22, 22.43it/s] 10%|██████████▎                                                                                           | 57/561 [00:02<00:22, 22.44it/s] 11%|██████████▉                                                                                           | 60/561 [00:02<00:22, 22.27it/s] 11%|███████████▍                                                                                          | 63/561 [00:02<00:22, 22.11it/s] 12%|████████████                                                                                          | 66/561 [00:03<00:22, 22.12it/s] 12%|████████████▌                                                                                         | 69/561 [00:03<00:21, 22.41it/s] 13%|█████████████                                                                                         | 72/561 [00:03<00:22, 22.17it/s] 13%|█████████████▋                                                                                        | 75/561 [00:03<00:22, 22.04it/s] 14%|██████████████▏                                                                                       | 78/561 [00:03<00:21, 22.05it/s] 14%|██████████████▋                                                                                       | 81/561 [00:04<00:31, 15.44it/s] 15%|███████████████                                                                                       | 83/561 [00:05<01:28,  5.42it/s] 15%|███████████████▍                                                                                      | 85/561 [00:06<02:09,  3.67it/s] 15%|███████████████▋                                                                                      | 86/561 [00:06<01:58,  4.01it/s] 16%|███████████████▊                                                                                      | 87/561 [00:06<01:47,  4.42it/s] 16%|████████████████                                                                                      | 88/561 [00:06<01:42,  4.63it/s] 16%|████████████████▎                                                                                     | 90/561 [00:06<01:13,  6.38it/s] 17%|████████████████▉                                                                                     | 93/561 [00:06<00:50,  9.20it/s][2025-03-28 01:19:56,187] [INFO] [logging.py:128:log_dist] [Rank 0] step=2900, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:19:56,188] [INFO] [timer.py:264:stop] epoch=0/micro_step=2900/global_step=2900, RunningAvgSamplesPerSec=18.722061673492664, CurrSamplesPerSec=21.482349398156064, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 17%|█████████████████▍                                                                                    | 96/561 [00:07<00:39, 11.88it/s] 18%|██████████████████                                                                                    | 99/561 [00:07<00:32, 14.42it/s] 18%|██████████████████▎                                                                                  | 102/561 [00:07<00:27, 16.62it/s] 19%|██████████████████▉                                                                                  | 105/561 [00:07<00:24, 18.34it/s] 19%|███████████████████▍                                                                                 | 108/561 [00:07<00:24, 18.36it/s] 20%|███████████████████▉                                                                                 | 111/561 [00:07<00:23, 19.08it/s] 20%|████████████████████▌                                                                                | 114/561 [00:07<00:22, 19.80it/s] 21%|█████████████████████                                                                                | 117/561 [00:08<00:21, 20.46it/s] 21%|█████████████████████▌                                                                               | 120/561 [00:08<00:20, 21.38it/s] 22%|██████████████████████▏                                                                              | 123/561 [00:08<00:19, 22.01it/s] 22%|██████████████████████▋                                                                              | 126/561 [00:08<00:19, 22.41it/s] 23%|███████████████████████▏                                                                             | 129/561 [00:08<00:18, 23.02it/s] 24%|███████████████████████▊                                                                             | 132/561 [00:08<00:18, 22.92it/s] 24%|████████████████████████▎                                                                            | 135/561 [00:08<00:18, 22.63it/s] 25%|████████████████████████▊                                                                            | 138/561 [00:08<00:18, 22.44it/s] 25%|█████████████████████████▍                                                                           | 141/561 [00:09<00:18, 22.14it/s] 26%|█████████████████████████▉                                                                           | 144/561 [00:09<00:18, 21.97it/s][2025-03-28 01:19:58,429] [INFO] [logging.py:128:log_dist] [Rank 0] step=2950, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:19:58,430] [INFO] [timer.py:264:stop] epoch=0/micro_step=2950/global_step=2950, RunningAvgSamplesPerSec=18.773976247659206, CurrSamplesPerSec=20.580673024725016, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 26%|██████████████████████████▍                                                                          | 147/561 [00:09<00:18, 21.96it/s] 27%|███████████████████████████                                                                          | 150/561 [00:09<00:18, 22.70it/s] 27%|███████████████████████████▌                                                                         | 153/561 [00:09<00:18, 22.38it/s] 28%|████████████████████████████                                                                         | 156/561 [00:09<00:18, 22.36it/s] 28%|████████████████████████████▋                                                                        | 159/561 [00:09<00:18, 22.08it/s] 29%|█████████████████████████████▏                                                                       | 162/561 [00:10<00:18, 22.10it/s] 29%|█████████████████████████████▋                                                                       | 165/561 [00:10<00:17, 22.19it/s] 30%|██████████████████████████████▏                                                                      | 168/561 [00:10<00:18, 21.33it/s] 30%|██████████████████████████████▊                                                                      | 171/561 [00:10<00:18, 20.70it/s] 31%|███████████████████████████████▎                                                                     | 174/561 [00:10<00:18, 21.44it/s] 32%|███████████████████████████████▊                                                                     | 177/561 [00:10<00:18, 20.58it/s] 32%|████████████████████████████████▍                                                                    | 180/561 [00:10<00:18, 21.00it/s] 33%|████████████████████████████████▉                                                                    | 183/561 [00:11<00:17, 21.34it/s] 33%|█████████████████████████████████▍                                                                   | 186/561 [00:11<00:16, 22.16it/s] 34%|██████████████████████████████████                                                                   | 189/561 [00:11<00:16, 22.27it/s] 34%|██████████████████████████████████▌                                                                  | 192/561 [00:11<00:16, 22.25it/s][2025-03-28 01:20:00,718] [INFO] [logging.py:128:log_dist] [Rank 0] step=3000, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:20:00,719] [INFO] [timer.py:264:stop] epoch=0/micro_step=3000/global_step=3000, RunningAvgSamplesPerSec=18.818811372471583, CurrSamplesPerSec=21.16676282310977, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 35%|███████████████████████████████████                                                                  | 195/561 [00:11<00:16, 22.06it/s] 35%|███████████████████████████████████▋                                                                 | 198/561 [00:11<00:16, 22.33it/s] 36%|████████████████████████████████████▏                                                                | 201/561 [00:11<00:16, 22.15it/s][2025-03-28 01:20:01,026] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2025-03-28 01:20:01,070] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
 36%|████████████████████████████████████▋                                                                | 204/561 [00:11<00:16, 22.28it/s] 37%|█████████████████████████████████████▎                                                               | 207/561 [00:12<00:16, 21.91it/s] 37%|█████████████████████████████████████▊                                                               | 210/561 [00:12<00:16, 21.57it/s] 38%|██████████████████████████████████████▎                                                              | 213/561 [00:12<00:16, 21.61it/s] 39%|██████████████████████████████████████▉                                                              | 216/561 [00:12<00:16, 21.48it/s] 39%|███████████████████████████████████████▍                                                             | 219/561 [00:12<00:15, 21.80it/s] 40%|███████████████████████████████████████▉                                                             | 222/561 [00:12<00:15, 21.67it/s] 40%|████████████████████████████████████████▌                                                            | 225/561 [00:12<00:15, 21.47it/s] 41%|█████████████████████████████████████████                                                            | 228/561 [00:13<00:15, 21.40it/s] 41%|█████████████████████████████████████████▌                                                           | 231/561 [00:13<00:15, 21.10it/s] 42%|██████████████████████████████████████████▏                                                          | 234/561 [00:13<00:15, 21.24it/s] 42%|██████████████████████████████████████████▋                                                          | 237/561 [00:13<00:14, 22.03it/s] 43%|███████████████████████████████████████████▏                                                         | 240/561 [00:13<00:14, 22.63it/s] 43%|███████████████████████████████████████████▋                                                         | 243/561 [00:13<00:13, 22.84it/s][2025-03-28 01:20:02,991] [INFO] [logging.py:128:log_dist] [Rank 0] step=3050, skipped=8, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:20:02,992] [INFO] [timer.py:264:stop] epoch=0/micro_step=3050/global_step=3050, RunningAvgSamplesPerSec=18.86427696722826, CurrSamplesPerSec=23.96304300862066, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 44%|████████████████████████████████████████████▎                                                        | 246/561 [00:13<00:13, 23.07it/s] 44%|████████████████████████████████████████████▊                                                        | 249/561 [00:14<00:13, 23.16it/s] 45%|█████████████████████████████████████████████▎                                                       | 252/561 [00:14<00:13, 22.72it/s] 45%|█████████████████████████████████████████████▉                                                       | 255/561 [00:14<00:13, 22.30it/s] 46%|██████████████████████████████████████████████▍                                                      | 258/561 [00:14<00:14, 20.91it/s] 47%|██████████████████████████████████████████████▉                                                      | 261/561 [00:14<00:14, 21.25it/s] 47%|███████████████████████████████████████████████▌                                                     | 264/561 [00:14<00:13, 21.84it/s] 48%|████████████████████████████████████████████████                                                     | 267/561 [00:14<00:13, 22.29it/s] 48%|████████████████████████████████████████████████▌                                                    | 270/561 [00:14<00:12, 22.69it/s] 49%|█████████████████████████████████████████████████▏                                                   | 273/561 [00:15<00:12, 22.66it/s] 49%|█████████████████████████████████████████████████▋                                                   | 276/561 [00:15<00:12, 22.56it/s] 50%|██████████████████████████████████████████████████▏                                                  | 279/561 [00:15<00:12, 22.34it/s] 50%|██████████████████████████████████████████████████▊                                                  | 282/561 [00:15<00:12, 22.00it/s] 51%|███████████████████████████████████████████████████▎                                                 | 285/561 [00:15<00:12, 22.05it/s] 51%|███████████████████████████████████████████████████▊                                                 | 288/561 [00:15<00:12, 22.09it/s] 52%|████████████████████████████████████████████████████▍                                                | 291/561 [00:15<00:12, 22.01it/s] 52%|████████████████████████████████████████████████████▉                                                | 294/561 [00:16<00:12, 21.60it/s][2025-03-28 01:20:05,269] [INFO] [logging.py:128:log_dist] [Rank 0] step=3100, skipped=8, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:20:05,270] [INFO] [timer.py:264:stop] epoch=0/micro_step=3100/global_step=3100, RunningAvgSamplesPerSec=18.907849416135278, CurrSamplesPerSec=21.204966075441973, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 53%|█████████████████████████████████████████████████████▍                                               | 297/561 [00:16<00:12, 21.59it/s] 53%|██████████████████████████████████████████████████████                                               | 300/561 [00:16<00:11, 22.04it/s] 54%|██████████████████████████████████████████████████████▌                                              | 303/561 [00:16<00:11, 22.18it/s] 55%|███████████████████████████████████████████████████████                                              | 306/561 [00:16<00:11, 22.18it/s] 55%|███████████████████████████████████████████████████████▋                                             | 309/561 [00:16<00:11, 22.36it/s] 56%|████████████████████████████████████████████████████████▏                                            | 312/561 [00:16<00:11, 22.22it/s] 56%|████████████████████████████████████████████████████████▋                                            | 315/561 [00:17<00:10, 22.49it/s] 57%|█████████████████████████████████████████████████████████▎                                           | 318/561 [00:17<00:10, 22.16it/s] 57%|█████████████████████████████████████████████████████████▊                                           | 321/561 [00:17<00:10, 22.58it/s] 58%|██████████████████████████████████████████████████████████▎                                          | 324/561 [00:17<00:10, 22.78it/s] 58%|██████████████████████████████████████████████████████████▊                                          | 327/561 [00:17<00:10, 23.11it/s] 59%|███████████████████████████████████████████████████████████▍                                         | 330/561 [00:17<00:10, 21.88it/s] 59%|███████████████████████████████████████████████████████████▉                                         | 333/561 [00:17<00:10, 21.63it/s] 60%|████████████████████████████████████████████████████████████▍                                        | 336/561 [00:17<00:10, 21.80it/s] 60%|█████████████████████████████████████████████████████████████                                        | 339/561 [00:18<00:10, 22.19it/s] 61%|█████████████████████████████████████████████████████████████▌                                       | 342/561 [00:18<00:09, 22.18it/s][2025-03-28 01:20:07,507] [INFO] [logging.py:128:log_dist] [Rank 0] step=3150, skipped=8, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:20:07,507] [INFO] [timer.py:264:stop] epoch=0/micro_step=3150/global_step=3150, RunningAvgSamplesPerSec=18.954868897689707, CurrSamplesPerSec=22.619559100724747, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 61%|██████████████████████████████████████████████████████████████                                       | 345/561 [00:18<00:09, 22.33it/s] 62%|██████████████████████████████████████████████████████████████▋                                      | 348/561 [00:18<00:09, 21.53it/s] 63%|███████████████████████████████████████████████████████████████▏                                     | 351/561 [00:18<00:10, 20.83it/s] 63%|███████████████████████████████████████████████████████████████▋                                     | 354/561 [00:18<00:09, 20.90it/s] 64%|████████████████████████████████████████████████████████████████▎                                    | 357/561 [00:18<00:09, 21.34it/s] 64%|████████████████████████████████████████████████████████████████▊                                    | 360/561 [00:19<00:09, 21.95it/s] 65%|█████████████████████████████████████████████████████████████████▎                                   | 363/561 [00:19<00:08, 22.42it/s] 65%|█████████████████████████████████████████████████████████████████▉                                   | 366/561 [00:19<00:09, 21.21it/s] 66%|██████████████████████████████████████████████████████████████████▍                                  | 369/561 [00:19<00:08, 21.61it/s] 66%|██████████████████████████████████████████████████████████████████▉                                  | 372/561 [00:19<00:08, 21.61it/s] 67%|███████████████████████████████████████████████████████████████████▌                                 | 375/561 [00:19<00:08, 21.46it/s] 67%|████████████████████████████████████████████████████████████████████                                 | 378/561 [00:19<00:08, 21.58it/s] 68%|████████████████████████████████████████████████████████████████████▌                                | 381/561 [00:20<00:08, 21.23it/s] 68%|█████████████████████████████████████████████████████████████████████▏                               | 384/561 [00:20<00:08, 21.54it/s] 69%|█████████████████████████████████████████████████████████████████████▋                               | 387/561 [00:20<00:08, 21.60it/s] 70%|██████████████████████████████████████████████████████████████████████▏                              | 390/561 [00:20<00:07, 21.78it/s] 70%|██████████████████████████████████████████████████████████████████████▊                              | 393/561 [00:20<00:07, 22.28it/s][2025-03-28 01:20:09,820] [INFO] [logging.py:128:log_dist] [Rank 0] step=3200, skipped=8, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:20:09,821] [INFO] [timer.py:264:stop] epoch=0/micro_step=3200/global_step=3200, RunningAvgSamplesPerSec=18.992044794036573, CurrSamplesPerSec=23.50366445587343, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 71%|███████████████████████████████████████████████████████████████████████▎                             | 396/561 [00:20<00:07, 22.66it/s] 71%|███████████████████████████████████████████████████████████████████████▊                             | 399/561 [00:20<00:07, 22.87it/s] 72%|████████████████████████████████████████████████████████████████████████▎                            | 402/561 [00:20<00:07, 22.48it/s] 72%|████████████████████████████████████████████████████████████████████████▉                            | 405/561 [00:21<00:06, 22.31it/s] 73%|█████████████████████████████████████████████████████████████████████████▍                           | 408/561 [00:21<00:06, 22.05it/s] 73%|█████████████████████████████████████████████████████████████████████████▉                           | 411/561 [00:21<00:06, 22.07it/s] 74%|██████████████████████████████████████████████████████████████████████████▌                          | 414/561 [00:21<00:07, 20.82it/s] 74%|███████████████████████████████████████████████████████████████████████████                          | 417/561 [00:21<00:06, 20.93it/s] 75%|███████████████████████████████████████████████████████████████████████████▌                         | 420/561 [00:21<00:06, 21.00it/s] 75%|████████████████████████████████████████████████████████████████████████████▏                        | 423/561 [00:21<00:06, 21.55it/s] 76%|████████████████████████████████████████████████████████████████████████████▋                        | 426/561 [00:22<00:06, 21.46it/s] 76%|█████████████████████████████████████████████████████████████████████████████▏                       | 429/561 [00:22<00:05, 22.03it/s] 77%|█████████████████████████████████████████████████████████████████████████████▊                       | 432/561 [00:22<00:05, 22.41it/s] 78%|██████████████████████████████████████████████████████████████████████████████▎                      | 435/561 [00:22<00:05, 22.89it/s] 78%|██████████████████████████████████████████████████████████████████████████████▊                      | 438/561 [00:22<00:05, 23.09it/s] 79%|███████████████████████████████████████████████████████████████████████████████▍                     | 441/561 [00:22<00:05, 23.34it/s] 79%|███████████████████████████████████████████████████████████████████████████████▉                     | 444/561 [00:22<00:04, 23.59it/s][2025-03-28 01:20:12,062] [INFO] [logging.py:128:log_dist] [Rank 0] step=3250, skipped=8, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:20:12,063] [INFO] [timer.py:264:stop] epoch=0/micro_step=3250/global_step=3250, RunningAvgSamplesPerSec=19.03621570226771, CurrSamplesPerSec=22.44573400282612, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 80%|████████████████████████████████████████████████████████████████████████████████▍                    | 447/561 [00:23<00:04, 23.41it/s] 80%|█████████████████████████████████████████████████████████████████████████████████                    | 450/561 [00:23<00:04, 22.50it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▌                   | 453/561 [00:23<00:04, 21.95it/s] 81%|██████████████████████████████████████████████████████████████████████████████████                   | 456/561 [00:23<00:04, 21.98it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▋                  | 459/561 [00:23<00:04, 21.62it/s] 82%|███████████████████████████████████████████████████████████████████████████████████▏                 | 462/561 [00:23<00:04, 21.60it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▋                 | 465/561 [00:23<00:04, 21.71it/s] 83%|████████████████████████████████████████████████████████████████████████████████████▎                | 468/561 [00:23<00:04, 21.56it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▊                | 471/561 [00:24<00:04, 21.62it/s] 84%|█████████████████████████████████████████████████████████████████████████████████████▎               | 474/561 [00:24<00:04, 21.27it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▉               | 477/561 [00:24<00:03, 21.42it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▍              | 480/561 [00:24<00:03, 22.20it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▉              | 483/561 [00:24<00:03, 22.42it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▍             | 486/561 [00:24<00:03, 22.81it/s] 87%|████████████████████████████████████████████████████████████████████████████████████████             | 489/561 [00:24<00:03, 22.60it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▌            | 492/561 [00:25<00:03, 22.50it/s][2025-03-28 01:20:14,354] [INFO] [logging.py:128:log_dist] [Rank 0] step=3300, skipped=8, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:20:14,355] [INFO] [timer.py:264:stop] epoch=0/micro_step=3300/global_step=3300, RunningAvgSamplesPerSec=19.07377693505599, CurrSamplesPerSec=17.787081515732904, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 88%|█████████████████████████████████████████████████████████████████████████████████████████            | 495/561 [00:25<00:03, 21.83it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▋           | 498/561 [00:25<00:02, 21.83it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████▏          | 501/561 [00:25<00:02, 22.00it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▋          | 504/561 [00:25<00:02, 22.06it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████████▎         | 507/561 [00:25<00:02, 22.12it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▊         | 510/561 [00:25<00:02, 22.24it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████████▎        | 513/561 [00:26<00:02, 22.15it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████████▉        | 516/561 [00:26<00:02, 22.14it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▍       | 519/561 [00:26<00:01, 21.83it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▉       | 522/561 [00:26<00:01, 22.36it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▌      | 525/561 [00:26<00:01, 22.79it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████      | 528/561 [00:26<00:01, 22.90it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▌     | 531/561 [00:26<00:01, 22.71it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████████▏    | 534/561 [00:26<00:01, 23.09it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▋    | 537/561 [00:27<00:01, 23.10it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████▏   | 540/561 [00:27<00:00, 22.25it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████████▊   | 543/561 [00:27<00:00, 22.18it/s][2025-03-28 01:20:16,589] [INFO] [logging.py:128:log_dist] [Rank 0] step=3350, skipped=8, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:20:16,590] [INFO] [timer.py:264:stop] epoch=0/micro_step=3350/global_step=3350, RunningAvgSamplesPerSec=19.11654265748305, CurrSamplesPerSec=22.808493943284063, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 97%|██████████████████████████████████████████████████████████████████████████████████████████████████▎  | 546/561 [00:27<00:00, 22.27it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▊  | 549/561 [00:27<00:00, 22.55it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████████▍ | 552/561 [00:27<00:00, 22.45it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▉ | 555/561 [00:27<00:00, 22.03it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████▍| 558/561 [00:28<00:00, 22.14it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:28<00:00, 22.79it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:28<00:00, 19.89it/s]
  0%|                                                                                                               | 0/561 [00:00<?, ?it/s]  0%|▏                                                                                                      | 1/561 [00:00<03:17,  2.83it/s]  1%|▋                                                                                                      | 4/561 [00:00<00:58,  9.58it/s]  1%|█▎                                                                                                     | 7/561 [00:00<00:40, 13.79it/s]  2%|█▊                                                                                                    | 10/561 [00:00<00:33, 16.66it/s]  2%|██▎                                                                                                   | 13/561 [00:00<00:29, 18.43it/s]  3%|██▉                                                                                                   | 16/561 [00:01<00:27, 19.64it/s]  3%|███▍                                                                                                  | 19/561 [00:01<00:26, 20.25it/s]  4%|████                                                                                                  | 22/561 [00:01<00:25, 20.90it/s]  4%|████▌                                                                                                 | 25/561 [00:01<00:24, 21.76it/s]  5%|█████                                                                                                 | 28/561 [00:01<00:24, 22.07it/s]  6%|█████▋                                                                                                | 31/561 [00:01<00:23, 22.61it/s][2025-03-28 01:20:19,176] [INFO] [logging.py:128:log_dist] [Rank 0] step=3400, skipped=8, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:20:19,178] [INFO] [timer.py:264:stop] epoch=0/micro_step=3400/global_step=3400, RunningAvgSamplesPerSec=19.135578618579736, CurrSamplesPerSec=24.4403093637473, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
  6%|██████▏                                                                                               | 34/561 [00:01<00:22, 22.93it/s]  7%|██████▋                                                                                               | 37/561 [00:01<00:22, 23.31it/s]  7%|███████▎                                                                                              | 40/561 [00:02<00:22, 23.42it/s]  8%|███████▊                                                                                              | 43/561 [00:02<00:21, 23.99it/s]  8%|████████▎                                                                                             | 46/561 [00:02<00:21, 23.45it/s]  9%|████████▉                                                                                             | 49/561 [00:02<00:22, 22.99it/s]  9%|█████████▍                                                                                            | 52/561 [00:02<00:22, 22.65it/s] 10%|██████████                                                                                            | 55/561 [00:02<00:22, 22.31it/s] 10%|██████████▌                                                                                           | 58/561 [00:02<00:22, 22.06it/s] 11%|███████████                                                                                           | 61/561 [00:03<00:22, 22.06it/s] 11%|███████████▋                                                                                          | 64/561 [00:03<00:22, 22.02it/s] 12%|████████████▏                                                                                         | 67/561 [00:03<00:22, 21.90it/s] 12%|████████████▋                                                                                         | 70/561 [00:03<00:22, 21.93it/s] 13%|█████████████▎                                                                                        | 73/561 [00:03<00:22, 22.00it/s] 14%|█████████████▊                                                                                        | 76/561 [00:03<00:21, 22.24it/s] 14%|██████████████▎                                                                                       | 79/561 [00:03<00:21, 22.32it/s] 15%|██████████████▉                                                                                       | 82/561 [00:03<00:21, 22.37it/s][2025-03-28 01:20:21,407] [INFO] [logging.py:128:log_dist] [Rank 0] step=3450, skipped=8, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:20:21,407] [INFO] [timer.py:264:stop] epoch=0/micro_step=3450/global_step=3450, RunningAvgSamplesPerSec=19.176996053445034, CurrSamplesPerSec=21.292915878695272, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 15%|███████████████▍                                                                                      | 85/561 [00:04<00:21, 22.13it/s] 16%|████████████████                                                                                      | 88/561 [00:04<00:21, 22.29it/s] 16%|████████████████▌                                                                                     | 91/561 [00:04<00:21, 22.06it/s] 17%|█████████████████                                                                                     | 94/561 [00:04<00:21, 21.94it/s] 17%|█████████████████▋                                                                                    | 97/561 [00:04<00:21, 21.85it/s] 18%|██████████████████                                                                                   | 100/561 [00:04<00:21, 21.77it/s] 18%|██████████████████▌                                                                                  | 103/561 [00:04<00:22, 20.71it/s] 19%|███████████████████                                                                                  | 106/561 [00:05<00:22, 20.35it/s] 19%|███████████████████▌                                                                                 | 109/561 [00:05<00:22, 20.26it/s] 20%|████████████████████▏                                                                                | 112/561 [00:05<00:22, 20.32it/s] 20%|████████████████████▋                                                                                | 115/561 [00:05<00:22, 20.06it/s] 21%|█████████████████████▏                                                                               | 118/561 [00:05<00:21, 20.26it/s] 22%|█████████████████████▊                                                                               | 121/561 [00:05<00:21, 20.81it/s] 22%|██████████████████████▎                                                                              | 124/561 [00:05<00:20, 21.18it/s] 23%|██████████████████████▊                                                                              | 127/561 [00:06<00:20, 20.88it/s] 23%|███████████████████████▍                                                                             | 130/561 [00:06<00:21, 20.42it/s] 24%|███████████████████████▉                                                                             | 133/561 [00:06<00:20, 20.40it/s][2025-03-28 01:20:23,816] [INFO] [logging.py:128:log_dist] [Rank 0] step=3500, skipped=8, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:20:23,819] [INFO] [timer.py:264:stop] epoch=0/micro_step=3500/global_step=3500, RunningAvgSamplesPerSec=19.198197808341412, CurrSamplesPerSec=21.334614410258, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 24%|████████████████████████▍                                                                            | 136/561 [00:06<00:20, 20.83it/s] 25%|█████████████████████████                                                                            | 139/561 [00:06<00:20, 20.72it/s] 25%|█████████████████████████▌                                                                           | 142/561 [00:06<00:20, 20.70it/s] 26%|██████████████████████████                                                                           | 145/561 [00:06<00:20, 20.78it/s] 26%|██████████████████████████▋                                                                          | 148/561 [00:07<00:20, 20.53it/s] 27%|███████████████████████████▏                                                                         | 151/561 [00:07<00:19, 20.64it/s] 27%|███████████████████████████▋                                                                         | 154/561 [00:07<00:20, 20.23it/s] 28%|████████████████████████████▎                                                                        | 157/561 [00:07<00:19, 20.38it/s] 29%|████████████████████████████▊                                                                        | 160/561 [00:07<00:19, 20.46it/s] 29%|█████████████████████████████▎                                                                       | 163/561 [00:07<00:19, 20.34it/s] 30%|█████████████████████████████▉                                                                       | 166/561 [00:08<00:19, 20.59it/s] 30%|██████████████████████████████▍                                                                      | 169/561 [00:08<00:19, 20.48it/s] 31%|██████████████████████████████▉                                                                      | 172/561 [00:08<00:19, 20.22it/s] 31%|███████████████████████████████▌                                                                     | 175/561 [00:08<00:18, 20.69it/s] 32%|████████████████████████████████                                                                     | 178/561 [00:08<00:18, 20.22it/s] 32%|████████████████████████████████▌                                                                    | 181/561 [00:08<00:19, 19.69it/s] 33%|████████████████████████████████▉                                                                    | 183/561 [00:08<00:19, 19.44it/s][2025-03-28 01:20:26,287] [INFO] [logging.py:128:log_dist] [Rank 0] step=3550, skipped=8, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:20:26,290] [INFO] [timer.py:264:stop] epoch=0/micro_step=3550/global_step=3550, RunningAvgSamplesPerSec=19.21268175475485, CurrSamplesPerSec=19.24723752706195, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 33%|█████████████████████████████████▎                                                                   | 185/561 [00:08<00:19, 19.24it/s] 33%|█████████████████████████████████▋                                                                   | 187/561 [00:09<00:19, 18.97it/s] 34%|██████████████████████████████████                                                                   | 189/561 [00:09<00:19, 18.87it/s] 34%|██████████████████████████████████▍                                                                  | 191/561 [00:09<00:19, 18.65it/s] 34%|██████████████████████████████████▋                                                                  | 193/561 [00:09<00:19, 18.64it/s] 35%|███████████████████████████████████                                                                  | 195/561 [00:09<00:19, 18.81it/s] 35%|███████████████████████████████████▍                                                                 | 197/561 [00:09<00:19, 18.77it/s] 35%|███████████████████████████████████▊                                                                 | 199/561 [00:09<00:19, 18.71it/s] 36%|████████████████████████████████████▏                                                                | 201/561 [00:09<00:19, 18.62it/s] 36%|████████████████████████████████████▌                                                                | 203/561 [00:09<00:19, 18.60it/s] 37%|████████████████████████████████████▉                                                                | 205/561 [00:10<00:19, 18.59it/s] 37%|█████████████████████████████████████▎                                                               | 207/561 [00:10<00:19, 18.60it/s] 37%|█████████████████████████████████████▋                                                               | 209/561 [00:10<00:18, 18.66it/s] 38%|█████████████████████████████████████▉                                                               | 211/561 [00:10<00:18, 18.69it/s] 38%|██████████████████████████████████████▎                                                              | 213/561 [00:10<00:18, 18.68it/s] 38%|██████████████████████████████████████▋                                                              | 215/561 [00:10<00:18, 18.59it/s] 39%|███████████████████████████████████████                                                              | 217/561 [00:10<00:18, 18.20it/s] 39%|███████████████████████████████████████▍                                                             | 219/561 [00:10<00:18, 18.55it/s] 39%|███████████████████████████████████████▊                                                             | 221/561 [00:10<00:18, 18.67it/s] 40%|████████████████████████████████████████▏                                                            | 223/561 [00:11<00:18, 18.69it/s] 40%|████████████████████████████████████████▌                                                            | 225/561 [00:11<00:17, 18.82it/s] 40%|████████████████████████████████████████▊                                                            | 227/561 [00:11<00:17, 18.77it/s] 41%|█████████████████████████████████████████▏                                                           | 229/561 [00:11<00:17, 18.74it/s] 41%|█████████████████████████████████████████▌                                                           | 231/561 [00:11<00:17, 18.70it/s] 42%|█████████████████████████████████████████▉                                                           | 233/561 [00:11<00:17, 18.69it/s][2025-03-28 01:20:28,972] [INFO] [logging.py:128:log_dist] [Rank 0] step=3600, skipped=8, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:20:28,975] [INFO] [timer.py:264:stop] epoch=0/micro_step=3600/global_step=3600, RunningAvgSamplesPerSec=19.204787820956923, CurrSamplesPerSec=19.268989695265912, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 42%|██████████████████████████████████████████▎                                                          | 235/561 [00:11<00:17, 18.67it/s] 42%|██████████████████████████████████████████▋                                                          | 237/561 [00:11<00:17, 18.70it/s] 43%|███████████████████████████████████████████                                                          | 239/561 [00:11<00:17, 18.69it/s] 43%|███████████████████████████████████████████▍                                                         | 241/561 [00:11<00:17, 18.65it/s] 43%|███████████████████████████████████████████▋                                                         | 243/561 [00:12<00:17, 18.47it/s] 44%|████████████████████████████████████████████                                                         | 245/561 [00:12<00:17, 17.71it/s] 44%|████████████████████████████████████████████▋                                                        | 248/561 [00:12<00:16, 19.25it/s] 45%|█████████████████████████████████████████████▏                                                       | 251/561 [00:12<00:15, 20.15it/s] 45%|█████████████████████████████████████████████▋                                                       | 254/561 [00:12<00:14, 20.66it/s] 46%|██████████████████████████████████████████████▎                                                      | 257/561 [00:12<00:14, 20.92it/s] 46%|██████████████████████████████████████████████▊                                                      | 260/561 [00:12<00:14, 20.25it/s] 47%|███████████████████████████████████████████████▎                                                     | 263/561 [00:13<00:15, 19.54it/s] 47%|███████████████████████████████████████████████▋                                                     | 265/561 [00:13<00:15, 19.19it/s] 48%|████████████████████████████████████████████████                                                     | 267/561 [00:13<00:15, 18.91it/s] 48%|████████████████████████████████████████████████▍                                                    | 269/561 [00:13<00:15, 18.70it/s] 48%|████████████████████████████████████████████████▊                                                    | 271/561 [00:13<00:15, 18.53it/s] 49%|█████████████████████████████████████████████████▏                                                   | 273/561 [00:13<00:15, 18.22it/s] 49%|█████████████████████████████████████████████████▌                                                   | 275/561 [00:13<00:15, 18.01it/s] 49%|█████████████████████████████████████████████████▊                                                   | 277/561 [00:13<00:15, 18.07it/s] 50%|██████████████████████████████████████████████████▍                                                  | 280/561 [00:14<00:14, 19.28it/s] 50%|██████████████████████████████████████████████████▉                                                  | 283/561 [00:14<00:13, 20.03it/s][2025-03-28 01:20:31,562] [INFO] [logging.py:128:log_dist] [Rank 0] step=3650, skipped=8, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:20:31,563] [INFO] [timer.py:264:stop] epoch=0/micro_step=3650/global_step=3650, RunningAvgSamplesPerSec=19.207047183079528, CurrSamplesPerSec=22.22581211382259, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 51%|███████████████████████████████████████████████████▍                                                 | 286/561 [00:14<00:13, 20.86it/s] 52%|████████████████████████████████████████████████████                                                 | 289/561 [00:14<00:12, 21.25it/s] 52%|████████████████████████████████████████████████████▌                                                | 292/561 [00:14<00:12, 21.38it/s] 53%|█████████████████████████████████████████████████████                                                | 295/561 [00:14<00:12, 20.73it/s] 53%|█████████████████████████████████████████████████████▋                                               | 298/561 [00:14<00:13, 19.84it/s] 53%|██████████████████████████████████████████████████████                                               | 300/561 [00:14<00:13, 19.57it/s] 54%|██████████████████████████████████████████████████████▎                                              | 302/561 [00:15<00:13, 19.18it/s] 54%|██████████████████████████████████████████████████████▋                                              | 304/561 [00:15<00:13, 18.92it/s] 55%|███████████████████████████████████████████████████████                                              | 306/561 [00:15<00:13, 18.72it/s] 55%|███████████████████████████████████████████████████████▍                                             | 308/561 [00:15<00:13, 18.54it/s] 55%|███████████████████████████████████████████████████████▊                                             | 310/561 [00:15<00:14, 17.87it/s] 56%|████████████████████████████████████████████████████████▏                                            | 312/561 [00:15<00:13, 17.92it/s] 56%|████████████████████████████████████████████████████████▋                                            | 315/561 [00:15<00:12, 19.22it/s] 57%|█████████████████████████████████████████████████████████▎                                           | 318/561 [00:15<00:11, 20.63it/s] 57%|█████████████████████████████████████████████████████████▊                                           | 321/561 [00:16<00:11, 20.98it/s] 58%|██████████████████████████████████████████████████████████▎                                          | 324/561 [00:16<00:11, 21.10it/s] 58%|██████████████████████████████████████████████████████████▊                                          | 327/561 [00:16<00:11, 20.08it/s] 59%|███████████████████████████████████████████████████████████▍                                         | 330/561 [00:16<00:11, 19.43it/s] 59%|███████████████████████████████████████████████████████████▊                                         | 332/561 [00:16<00:11, 19.12it/s][2025-03-28 01:20:34,134] [INFO] [logging.py:128:log_dist] [Rank 0] step=3700, skipped=8, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:20:34,137] [INFO] [timer.py:264:stop] epoch=0/micro_step=3700/global_step=3700, RunningAvgSamplesPerSec=19.210569699772993, CurrSamplesPerSec=17.063320496194486, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 60%|████████████████████████████████████████████████████████████▏                                        | 334/561 [00:16<00:12, 18.07it/s] 60%|████████████████████████████████████████████████████████████▍                                        | 336/561 [00:16<00:12, 18.11it/s] 60%|████████████████████████████████████████████████████████████▊                                        | 338/561 [00:16<00:12, 18.08it/s] 61%|█████████████████████████████████████████████████████████████▏                                       | 340/561 [00:17<00:12, 18.07it/s] 61%|█████████████████████████████████████████████████████████████▌                                       | 342/561 [00:17<00:12, 18.07it/s] 61%|█████████████████████████████████████████████████████████████▉                                       | 344/561 [00:17<00:11, 18.52it/s] 62%|██████████████████████████████████████████████████████████████▍                                      | 347/561 [00:17<00:10, 19.68it/s] 62%|███████████████████████████████████████████████████████████████                                      | 350/561 [00:17<00:10, 20.46it/s] 63%|███████████████████████████████████████████████████████████████▌                                     | 353/561 [00:17<00:09, 20.93it/s] 63%|████████████████████████████████████████████████████████████████                                     | 356/561 [00:17<00:10, 20.16it/s] 64%|████████████████████████████████████████████████████████████████▋                                    | 359/561 [00:18<00:10, 19.47it/s] 64%|████████████████████████████████████████████████████████████████▉                                    | 361/561 [00:18<00:10, 19.14it/s] 65%|█████████████████████████████████████████████████████████████████▎                                   | 363/561 [00:18<00:10, 18.87it/s] 65%|█████████████████████████████████████████████████████████████████▋                                   | 365/561 [00:18<00:10, 18.69it/s] 65%|██████████████████████████████████████████████████████████████████                                   | 367/561 [00:18<00:10, 18.50it/s] 66%|██████████████████████████████████████████████████████████████████▍                                  | 369/561 [00:18<00:10, 18.36it/s] 66%|██████████████████████████████████████████████████████████████████▊                                  | 371/561 [00:18<00:10, 18.26it/s] 66%|███████████████████████████████████████████████████████████████████▏                                 | 373/561 [00:18<00:10, 18.20it/s] 67%|███████████████████████████████████████████████████████████████████▋                                 | 376/561 [00:18<00:09, 19.52it/s] 68%|████████████████████████████████████████████████████████████████████▏                                | 379/561 [00:19<00:08, 20.36it/s] 68%|████████████████████████████████████████████████████████████████████▊                                | 382/561 [00:19<00:08, 20.80it/s][2025-03-28 01:20:36,688] [INFO] [logging.py:128:log_dist] [Rank 0] step=3750, skipped=8, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:20:36,689] [INFO] [timer.py:264:stop] epoch=0/micro_step=3750/global_step=3750, RunningAvgSamplesPerSec=19.216158291281545, CurrSamplesPerSec=22.774312447656456, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 69%|█████████████████████████████████████████████████████████████████████▎                               | 385/561 [00:19<00:08, 20.89it/s] 69%|█████████████████████████████████████████████████████████████████████▊                               | 388/561 [00:19<00:08, 19.91it/s] 70%|██████████████████████████████████████████████████████████████████████▏                              | 390/561 [00:19<00:08, 19.46it/s] 70%|██████████████████████████████████████████████████████████████████████▌                              | 392/561 [00:19<00:08, 19.10it/s] 70%|██████████████████████████████████████████████████████████████████████▉                              | 394/561 [00:19<00:08, 18.85it/s] 71%|███████████████████████████████████████████████████████████████████████▎                             | 396/561 [00:19<00:08, 18.66it/s] 71%|███████████████████████████████████████████████████████████████████████▋                             | 398/561 [00:20<00:08, 18.48it/s] 71%|████████████████████████████████████████████████████████████████████████                             | 400/561 [00:20<00:08, 18.34it/s] 72%|████████████████████████████████████████████████████████████████████████▎                            | 402/561 [00:20<00:08, 18.26it/s] 72%|████████████████████████████████████████████████████████████████████████▋                            | 404/561 [00:20<00:08, 18.48it/s] 73%|█████████████████████████████████████████████████████████████████████████▎                           | 407/561 [00:20<00:07, 19.84it/s] 73%|█████████████████████████████████████████████████████████████████████████▋                           | 409/561 [00:20<00:07, 19.64it/s] 73%|██████████████████████████████████████████████████████████████████████████▏                          | 412/561 [00:20<00:07, 20.17it/s] 74%|██████████████████████████████████████████████████████████████████████████▋                          | 415/561 [00:20<00:06, 20.97it/s] 75%|███████████████████████████████████████████████████████████████████████████▎                         | 418/561 [00:21<00:06, 20.54it/s] 75%|███████████████████████████████████████████████████████████████████████████▊                         | 421/561 [00:21<00:07, 19.59it/s] 75%|████████████████████████████████████████████████████████████████████████████▏                        | 423/561 [00:21<00:07, 19.23it/s] 76%|████████████████████████████████████████████████████████████████████████████▌                        | 425/561 [00:21<00:07, 18.97it/s] 76%|████████████████████████████████████████████████████████████████████████████▉                        | 427/561 [00:21<00:07, 18.77it/s] 76%|█████████████████████████████████████████████████████████████████████████████▏                       | 429/561 [00:21<00:07, 18.57it/s] 77%|█████████████████████████████████████████████████████████████████████████████▌                       | 431/561 [00:21<00:06, 18.79it/s] 77%|█████████████████████████████████████████████████████████████████████████████▉                       | 433/561 [00:21<00:06, 18.39it/s][2025-03-28 01:20:39,330] [INFO] [logging.py:128:log_dist] [Rank 0] step=3800, skipped=8, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:20:39,334] [INFO] [timer.py:264:stop] epoch=0/micro_step=3800/global_step=3800, RunningAvgSamplesPerSec=19.21258245445906, CurrSamplesPerSec=18.139868849368234, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 78%|██████████████████████████████████████████████████████████████████████████████▎                      | 435/561 [00:22<00:06, 18.30it/s] 78%|██████████████████████████████████████████████████████████████████████████████▋                      | 437/561 [00:22<00:06, 18.29it/s] 78%|███████████████████████████████████████████████████████████████████████████████▏                     | 440/561 [00:22<00:06, 19.54it/s] 79%|███████████████████████████████████████████████████████████████████████████████▊                     | 443/561 [00:22<00:05, 20.33it/s] 80%|████████████████████████████████████████████████████████████████████████████████▎                    | 446/561 [00:22<00:05, 20.75it/s] 80%|████████████████████████████████████████████████████████████████████████████████▊                    | 449/561 [00:22<00:05, 21.60it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▍                   | 452/561 [00:22<00:05, 20.36it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▉                   | 455/561 [00:23<00:05, 19.19it/s] 81%|██████████████████████████████████████████████████████████████████████████████████▎                  | 457/561 [00:23<00:05, 18.96it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▋                  | 459/561 [00:23<00:05, 18.77it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▉                  | 461/561 [00:23<00:05, 18.59it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▎                 | 463/561 [00:23<00:05, 18.45it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▋                 | 465/561 [00:23<00:05, 18.35it/s] 83%|████████████████████████████████████████████████████████████████████████████████████                 | 467/561 [00:23<00:05, 18.26it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▌                | 470/561 [00:23<00:04, 19.30it/s] 84%|█████████████████████████████████████████████████████████████████████████████████████▏               | 473/561 [00:23<00:04, 20.04it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▋               | 476/561 [00:24<00:04, 20.60it/s] 85%|██████████████████████████████████████████████████████████████████████████████████████▏              | 479/561 [00:24<00:03, 20.96it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▊              | 482/561 [00:24<00:03, 20.95it/s][2025-03-28 01:20:41,831] [INFO] [logging.py:128:log_dist] [Rank 0] step=3850, skipped=8, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:20:41,832] [INFO] [timer.py:264:stop] epoch=0/micro_step=3850/global_step=3850, RunningAvgSamplesPerSec=19.22314711878761, CurrSamplesPerSec=22.090725126977013, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 86%|███████████████████████████████████████████████████████████████████████████████████████▎             | 485/561 [00:24<00:03, 21.22it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▊             | 488/561 [00:24<00:03, 21.32it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▍            | 491/561 [00:24<00:03, 21.03it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▉            | 494/561 [00:24<00:03, 20.05it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▍           | 497/561 [00:25<00:03, 19.43it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▊           | 499/561 [00:25<00:03, 19.11it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████▏          | 501/561 [00:25<00:03, 18.87it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▌          | 503/561 [00:25<00:03, 18.66it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▉          | 505/561 [00:25<00:03, 18.49it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████████▎         | 507/561 [00:25<00:02, 18.36it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▋         | 509/561 [00:25<00:02, 18.09it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████████▏        | 512/561 [00:25<00:02, 19.25it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████████▋        | 515/561 [00:26<00:02, 20.04it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████▎       | 518/561 [00:26<00:02, 20.62it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▊       | 521/561 [00:26<00:01, 21.32it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████████▎      | 524/561 [00:26<00:01, 21.54it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▉      | 527/561 [00:26<00:01, 21.69it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▍     | 530/561 [00:26<00:01, 21.79it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▉     | 533/561 [00:26<00:01, 21.41it/s][2025-03-28 01:20:44,315] [INFO] [logging.py:128:log_dist] [Rank 0] step=3900, skipped=8, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:20:44,318] [INFO] [timer.py:264:stop] epoch=0/micro_step=3900/global_step=3900, RunningAvgSamplesPerSec=19.234695624091707, CurrSamplesPerSec=18.273907954316712, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 96%|████████████████████████████████████████████████████████████████████████████████████████████████▍    | 536/561 [00:27<00:01, 19.85it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████    | 539/561 [00:27<00:01, 19.30it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████▍   | 541/561 [00:27<00:01, 19.02it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████████▊   | 543/561 [00:27<00:00, 18.79it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████████   | 545/561 [00:27<00:00, 18.60it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▍  | 547/561 [00:27<00:00, 18.28it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▊  | 549/561 [00:27<00:00, 18.22it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████████▏ | 551/561 [00:27<00:00, 18.18it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▋ | 554/561 [00:28<00:00, 18.64it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████ | 556/561 [00:28<00:00, 18.87it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████████▋| 559/561 [00:28<00:00, 19.85it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:28<00:00, 19.73it/s]
  0%|                                                                                                               | 0/561 [00:00<?, ?it/s]  0%|▏                                                                                                      | 1/561 [00:00<02:26,  3.82it/s]  1%|▋                                                                                                      | 4/561 [00:00<00:49, 11.31it/s]  1%|█                                                                                                      | 6/561 [00:00<00:40, 13.62it/s]  1%|█▍                                                                                                     | 8/561 [00:00<00:36, 15.06it/s]  2%|█▊                                                                                                    | 10/561 [00:00<00:34, 15.87it/s]  2%|██▏                                                                                                   | 12/561 [00:00<00:33, 16.58it/s]  2%|██▌                                                                                                   | 14/561 [00:00<00:32, 17.06it/s]  3%|██▉                                                                                                   | 16/561 [00:01<00:31, 17.39it/s]  3%|███▎                                                                                                  | 18/561 [00:01<00:30, 17.60it/s]  4%|███▋                                                                                                  | 20/561 [00:01<00:30, 17.74it/s]  4%|████                                                                                                  | 22/561 [00:01<00:30, 17.83it/s][2025-03-28 01:20:47,281] [INFO] [logging.py:128:log_dist] [Rank 0] step=3950, skipped=8, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:20:47,284] [INFO] [timer.py:264:stop] epoch=0/micro_step=3950/global_step=3950, RunningAvgSamplesPerSec=19.21323904357731, CurrSamplesPerSec=18.08121949711914, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
  4%|████▎                                                                                                 | 24/561 [00:01<00:29, 18.38it/s]  5%|████▉                                                                                                 | 27/561 [00:01<00:26, 20.08it/s]  5%|█████▍                                                                                                | 30/561 [00:01<00:25, 21.13it/s]  6%|██████                                                                                                | 33/561 [00:01<00:24, 21.21it/s]  6%|██████▌                                                                                               | 36/561 [00:02<00:24, 21.68it/s]  7%|███████                                                                                               | 39/561 [00:02<00:24, 21.68it/s]  7%|███████▋                                                                                              | 42/561 [00:02<00:23, 21.80it/s]  8%|████████▏                                                                                             | 45/561 [00:02<00:24, 20.66it/s]  9%|████████▋                                                                                             | 48/561 [00:02<00:24, 20.69it/s]  9%|█████████▎                                                                                            | 51/561 [00:02<00:25, 19.84it/s]  9%|█████████▋                                                                                            | 53/561 [00:02<00:26, 19.43it/s] 10%|██████████                                                                                            | 55/561 [00:02<00:26, 19.09it/s] 10%|██████████▎                                                                                           | 57/561 [00:03<00:26, 18.84it/s] 11%|██████████▋                                                                                           | 59/561 [00:03<00:26, 18.64it/s] 11%|███████████                                                                                           | 61/561 [00:03<00:27, 18.47it/s] 11%|███████████▍                                                                                          | 63/561 [00:03<00:27, 18.35it/s] 12%|███████████▊                                                                                          | 65/561 [00:03<00:27, 18.27it/s] 12%|████████████▏                                                                                         | 67/561 [00:03<00:26, 18.51it/s] 12%|████████████▋                                                                                         | 70/561 [00:03<00:24, 19.67it/s][2025-03-28 01:20:49,770] [INFO] [logging.py:128:log_dist] [Rank 0] step=4000, skipped=8, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:20:49,771] [INFO] [timer.py:264:stop] epoch=0/micro_step=4000/global_step=4000, RunningAvgSamplesPerSec=19.224448278192067, CurrSamplesPerSec=17.39550843162624, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 13%|█████████████▎                                                                                        | 73/561 [00:03<00:24, 19.77it/s] 14%|█████████████▊                                                                                        | 76/561 [00:04<00:23, 20.71it/s] 14%|██████████████▎                                                                                       | 79/561 [00:04<00:22, 21.39it/s][2025-03-28 01:20:50,156] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
 15%|██████████████▉                                                                                       | 82/561 [00:04<00:21, 22.22it/s][2025-03-28 01:20:50,197] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
 15%|███████████████▍                                                                                      | 85/561 [00:04<00:21, 22.41it/s] 16%|████████████████                                                                                      | 88/561 [00:04<00:20, 23.14it/s] 16%|████████████████▌                                                                                     | 91/561 [00:04<00:19, 23.94it/s] 17%|█████████████████                                                                                     | 94/561 [00:04<00:20, 23.35it/s] 17%|█████████████████▋                                                                                    | 97/561 [00:04<00:20, 22.96it/s] 18%|██████████████████                                                                                   | 100/561 [00:05<00:21, 21.22it/s] 18%|██████████████████▌                                                                                  | 103/561 [00:05<00:21, 21.34it/s] 19%|███████████████████                                                                                  | 106/561 [00:05<00:22, 20.29it/s] 19%|███████████████████▌                                                                                 | 109/561 [00:05<00:23, 19.61it/s] 20%|███████████████████▉                                                                                 | 111/561 [00:05<00:23, 19.28it/s] 20%|████████████████████▎                                                                                | 113/561 [00:05<00:23, 19.15it/s] 20%|████████████████████▋                                                                                | 115/561 [00:05<00:23, 18.86it/s] 21%|█████████████████████                                                                                | 117/561 [00:06<00:23, 18.64it/s] 21%|█████████████████████▍                                                                               | 119/561 [00:06<00:23, 18.48it/s] 22%|█████████████████████▉                                                                               | 122/561 [00:06<00:22, 19.85it/s][2025-03-28 01:20:52,153] [INFO] [logging.py:128:log_dist] [Rank 0] step=4050, skipped=10, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:20:52,154] [INFO] [timer.py:264:stop] epoch=0/micro_step=4050/global_step=4050, RunningAvgSamplesPerSec=19.244930949647745, CurrSamplesPerSec=23.443496737678565, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 22%|██████████████████████▌                                                                              | 125/561 [00:06<00:20, 21.04it/s] 23%|███████████████████████                                                                              | 128/561 [00:06<00:19, 22.00it/s] 23%|███████████████████████▌                                                                             | 131/561 [00:06<00:19, 22.47it/s] 24%|████████████████████████                                                                             | 134/561 [00:06<00:18, 22.92it/s] 24%|████████████████████████▋                                                                            | 137/561 [00:06<00:18, 23.08it/s] 25%|█████████████████████████▏                                                                           | 140/561 [00:07<00:18, 23.14it/s] 25%|█████████████████████████▋                                                                           | 143/561 [00:07<00:17, 23.42it/s] 26%|██████████████████████████▎                                                                          | 146/561 [00:07<00:17, 23.67it/s] 27%|██████████████████████████▊                                                                          | 149/561 [00:07<00:17, 24.13it/s] 27%|███████████████████████████▎                                                                         | 152/561 [00:07<00:17, 23.59it/s] 28%|███████████████████████████▉                                                                         | 155/561 [00:07<00:16, 24.33it/s] 28%|████████████████████████████▍                                                                        | 158/561 [00:07<00:17, 23.00it/s] 29%|████████████████████████████▉                                                                        | 161/561 [00:07<00:17, 22.84it/s] 29%|█████████████████████████████▌                                                                       | 164/561 [00:08<00:17, 22.21it/s] 30%|██████████████████████████████                                                                       | 167/561 [00:08<00:18, 20.78it/s] 30%|██████████████████████████████▌                                                                      | 170/561 [00:08<00:19, 19.61it/s] 31%|██████████████████████████████▉                                                                      | 172/561 [00:08<00:20, 19.13it/s][2025-03-28 01:20:54,414] [INFO] [logging.py:128:log_dist] [Rank 0] step=4100, skipped=10, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:20:54,417] [INFO] [timer.py:264:stop] epoch=0/micro_step=4100/global_step=4100, RunningAvgSamplesPerSec=19.27573273266918, CurrSamplesPerSec=18.37349058155461, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 31%|███████████████████████████████▎                                                                     | 174/561 [00:08<00:20, 18.92it/s] 31%|███████████████████████████████▋                                                                     | 176/561 [00:08<00:20, 18.71it/s] 32%|████████████████████████████████                                                                     | 178/561 [00:08<00:20, 18.53it/s] 32%|████████████████████████████████▍                                                                    | 180/561 [00:09<00:22, 17.23it/s] 32%|████████████████████████████████▊                                                                    | 182/561 [00:09<00:21, 17.45it/s] 33%|█████████████████████████████████▎                                                                   | 185/561 [00:09<00:18, 20.08it/s] 34%|██████████████████████████████████                                                                   | 189/561 [00:09<00:16, 22.77it/s] 34%|██████████████████████████████████▌                                                                  | 192/561 [00:09<00:16, 22.56it/s] 35%|███████████████████████████████████                                                                  | 195/561 [00:09<00:16, 22.68it/s] 35%|███████████████████████████████████▋                                                                 | 198/561 [00:09<00:16, 22.11it/s] 36%|████████████████████████████████████▏                                                                | 201/561 [00:09<00:16, 22.01it/s] 36%|████████████████████████████████████▋                                                                | 204/561 [00:10<00:17, 20.73it/s] 37%|█████████████████████████████████████▎                                                               | 207/561 [00:10<00:16, 20.99it/s] 37%|█████████████████████████████████████▊                                                               | 210/561 [00:10<00:16, 21.38it/s] 38%|██████████████████████████████████████▎                                                              | 213/561 [00:10<00:16, 21.34it/s] 39%|██████████████████████████████████████▉                                                              | 216/561 [00:10<00:16, 21.54it/s] 39%|███████████████████████████████████████▍                                                             | 219/561 [00:10<00:16, 20.84it/s] 40%|███████████████████████████████████████▉                                                             | 222/561 [00:10<00:16, 20.77it/s][2025-03-28 01:20:56,804] [INFO] [logging.py:128:log_dist] [Rank 0] step=4150, skipped=10, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:20:56,804] [INFO] [timer.py:264:stop] epoch=0/micro_step=4150/global_step=4150, RunningAvgSamplesPerSec=19.2947989906908, CurrSamplesPerSec=22.175518217668873, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 40%|████████████████████████████████████████▌                                                            | 225/561 [00:11<00:15, 21.34it/s] 41%|█████████████████████████████████████████                                                            | 228/561 [00:11<00:16, 20.68it/s] 41%|█████████████████████████████████████████▌                                                           | 231/561 [00:11<00:15, 20.87it/s] 42%|██████████████████████████████████████████▏                                                          | 234/561 [00:11<00:15, 20.82it/s] 42%|██████████████████████████████████████████▋                                                          | 237/561 [00:11<00:16, 19.93it/s] 43%|███████████████████████████████████████████▏                                                         | 240/561 [00:11<00:16, 19.22it/s] 43%|███████████████████████████████████████████▌                                                         | 242/561 [00:11<00:16, 18.94it/s] 43%|███████████████████████████████████████████▉                                                         | 244/561 [00:12<00:16, 18.71it/s] 44%|████████████████████████████████████████████▍                                                        | 247/561 [00:12<00:16, 19.57it/s] 45%|█████████████████████████████████████████████                                                        | 250/561 [00:12<00:15, 20.70it/s] 45%|█████████████████████████████████████████████▌                                                       | 253/561 [00:12<00:15, 20.35it/s] 46%|██████████████████████████████████████████████                                                       | 256/561 [00:12<00:14, 20.80it/s] 46%|██████████████████████████████████████████████▋                                                      | 259/561 [00:12<00:14, 21.05it/s] 47%|███████████████████████████████████████████████▏                                                     | 262/561 [00:12<00:13, 21.38it/s] 47%|███████████████████████████████████████████████▋                                                     | 265/561 [00:13<00:13, 21.52it/s] 48%|████████████████████████████████████████████████▏                                                    | 268/561 [00:13<00:13, 21.59it/s] 48%|████████████████████████████████████████████████▊                                                    | 271/561 [00:13<00:13, 21.58it/s][2025-03-28 01:20:59,226] [INFO] [logging.py:128:log_dist] [Rank 0] step=4200, skipped=10, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:20:59,227] [INFO] [timer.py:264:stop] epoch=0/micro_step=4200/global_step=4200, RunningAvgSamplesPerSec=19.31032434761245, CurrSamplesPerSec=21.035236329926878, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 49%|█████████████████████████████████████████████████▎                                                   | 274/561 [00:13<00:13, 21.63it/s] 49%|█████████████████████████████████████████████████▊                                                   | 277/561 [00:13<00:13, 21.83it/s] 50%|██████████████████████████████████████████████████▍                                                  | 280/561 [00:13<00:12, 21.90it/s] 50%|██████████████████████████████████████████████████▉                                                  | 283/561 [00:13<00:13, 21.27it/s] 51%|███████████████████████████████████████████████████▍                                                 | 286/561 [00:14<00:13, 21.02it/s] 52%|████████████████████████████████████████████████████                                                 | 289/561 [00:14<00:12, 21.26it/s] 52%|████████████████████████████████████████████████████▌                                                | 292/561 [00:14<00:12, 21.49it/s] 53%|█████████████████████████████████████████████████████                                                | 295/561 [00:14<00:12, 21.65it/s] 53%|█████████████████████████████████████████████████████▋                                               | 298/561 [00:14<00:12, 21.81it/s] 54%|██████████████████████████████████████████████████████▏                                              | 301/561 [00:14<00:12, 21.00it/s] 54%|██████████████████████████████████████████████████████▋                                              | 304/561 [00:14<00:12, 20.78it/s] 55%|███████████████████████████████████████████████████████▎                                             | 307/561 [00:15<00:13, 19.25it/s] 55%|███████████████████████████████████████████████████████▊                                             | 310/561 [00:15<00:12, 19.38it/s] 56%|████████████████████████████████████████████████████████▎                                            | 313/561 [00:15<00:12, 19.81it/s] 56%|████████████████████████████████████████████████████████▉                                            | 316/561 [00:15<00:12, 20.20it/s] 57%|█████████████████████████████████████████████████████████▍                                           | 319/561 [00:15<00:11, 20.72it/s] 57%|█████████████████████████████████████████████████████████▉                                           | 322/561 [00:15<00:11, 21.13it/s][2025-03-28 01:21:01,621] [INFO] [logging.py:128:log_dist] [Rank 0] step=4250, skipped=10, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:21:01,622] [INFO] [timer.py:264:stop] epoch=0/micro_step=4250/global_step=4250, RunningAvgSamplesPerSec=19.327926898946625, CurrSamplesPerSec=23.55580441773455, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 58%|██████████████████████████████████████████████████████████▌                                          | 325/561 [00:15<00:10, 21.51it/s] 58%|███████████████████████████████████████████████████████████                                          | 328/561 [00:16<00:10, 21.86it/s] 59%|███████████████████████████████████████████████████████████▌                                         | 331/561 [00:16<00:10, 21.01it/s] 60%|████████████████████████████████████████████████████████████▏                                        | 334/561 [00:16<00:10, 21.14it/s] 60%|████████████████████████████████████████████████████████████▋                                        | 337/561 [00:16<00:10, 21.25it/s] 61%|█████████████████████████████████████████████████████████████▏                                       | 340/561 [00:16<00:10, 21.47it/s] 61%|█████████████████████████████████████████████████████████████▊                                       | 343/561 [00:16<00:10, 21.64it/s] 62%|██████████████████████████████████████████████████████████████▎                                      | 346/561 [00:16<00:10, 20.78it/s] 62%|██████████████████████████████████████████████████████████████▊                                      | 349/561 [00:17<00:10, 20.80it/s] 63%|███████████████████████████████████████████████████████████████▎                                     | 352/561 [00:17<00:09, 20.93it/s] 63%|███████████████████████████████████████████████████████████████▉                                     | 355/561 [00:17<00:09, 21.19it/s] 64%|████████████████████████████████████████████████████████████████▍                                    | 358/561 [00:17<00:09, 21.77it/s] 64%|████████████████████████████████████████████████████████████████▉                                    | 361/561 [00:17<00:09, 22.06it/s] 65%|█████████████████████████████████████████████████████████████████▌                                   | 364/561 [00:17<00:08, 22.51it/s] 65%|██████████████████████████████████████████████████████████████████                                   | 367/561 [00:17<00:08, 22.88it/s] 66%|██████████████████████████████████████████████████████████████████▌                                  | 370/561 [00:17<00:08, 22.24it/s][2025-03-28 01:21:03,933] [INFO] [logging.py:128:log_dist] [Rank 0] step=4300, skipped=10, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:21:03,934] [INFO] [timer.py:264:stop] epoch=0/micro_step=4300/global_step=4300, RunningAvgSamplesPerSec=19.35244478260324, CurrSamplesPerSec=22.252933559875412, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 66%|███████████████████████████████████████████████████████████████████▏                                 | 373/561 [00:18<00:08, 21.82it/s] 67%|███████████████████████████████████████████████████████████████████▋                                 | 376/561 [00:18<00:19,  9.61it/s] 67%|████████████████████████████████████████████████████████████████████                                 | 378/561 [00:20<00:41,  4.44it/s] 68%|████████████████████████████████████████████████████████████████████▍                                | 380/561 [00:20<00:39,  4.64it/s] 68%|████████████████████████████████████████████████████████████████████▉                                | 383/561 [00:20<00:28,  6.33it/s] 69%|█████████████████████████████████████████████████████████████████████▍                               | 386/561 [00:20<00:21,  8.21it/s] 69%|█████████████████████████████████████████████████████████████████████▊                               | 388/561 [00:21<00:31,  5.54it/s] 70%|██████████████████████████████████████████████████████████████████████▏                              | 390/561 [00:22<00:53,  3.19it/s] 70%|██████████████████████████████████████████████████████████████████████▌                              | 392/561 [00:23<00:54,  3.10it/s] 70%|██████████████████████████████████████████████████████████████████████▊                              | 393/561 [00:24<01:04,  2.61it/s] 70%|██████████████████████████████████████████████████████████████████████▉                              | 394/561 [00:25<01:16,  2.17it/s] 70%|███████████████████████████████████████████████████████████████████████                              | 395/561 [00:25<01:08,  2.43it/s] 71%|███████████████████████████████████████████████████████████████████████▋                             | 398/561 [00:25<00:38,  4.18it/s] 71%|████████████████████████████████████████████████████████████████████████▏                            | 401/561 [00:25<00:25,  6.23it/s] 72%|████████████████████████████████████████████████████████████████████████▋                            | 404/561 [00:25<00:18,  8.45it/s] 73%|█████████████████████████████████████████████████████████████████████████▎                           | 407/561 [00:25<00:14, 10.70it/s] 73%|█████████████████████████████████████████████████████████████████████████▋                           | 409/561 [00:26<00:12, 11.90it/s] 73%|██████████████████████████████████████████████████████████████████████████▏                          | 412/561 [00:26<00:10, 14.00it/s] 74%|██████████████████████████████████████████████████████████████████████████▌                          | 414/561 [00:26<00:09, 14.76it/s] 74%|██████████████████████████████████████████████████████████████████████████▉                          | 416/561 [00:27<00:32,  4.39it/s] 75%|███████████████████████████████████████████████████████████████████████████▎                         | 418/561 [00:28<00:34,  4.13it/s] 75%|███████████████████████████████████████████████████████████████████████████▊                         | 421/561 [00:28<00:23,  5.85it/s][2025-03-28 01:21:14,250] [INFO] [logging.py:128:log_dist] [Rank 0] step=4350, skipped=10, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:21:14,250] [INFO] [timer.py:264:stop] epoch=0/micro_step=4350/global_step=4350, RunningAvgSamplesPerSec=18.72475593610642, CurrSamplesPerSec=21.532860760419243, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 76%|████████████████████████████████████████████████████████████████████████████▎                        | 424/561 [00:28<00:17,  7.78it/s] 76%|████████████████████████████████████████████████████████████████████████████▋                        | 426/561 [00:29<00:22,  6.09it/s] 76%|█████████████████████████████████████████████████████████████████████████████                        | 428/561 [00:30<00:42,  3.15it/s] 76%|█████████████████████████████████████████████████████████████████████████████▏                       | 429/561 [00:30<00:41,  3.16it/s] 77%|█████████████████████████████████████████████████████████████████████████████▌                       | 431/561 [00:30<00:30,  4.20it/s] 77%|██████████████████████████████████████████████████████████████████████████████▏                      | 434/561 [00:31<00:20,  6.09it/s] 78%|██████████████████████████████████████████████████████████████████████████████▍                      | 436/561 [00:32<00:35,  3.51it/s] 78%|██████████████████████████████████████████████████████████████████████████████▋                      | 437/561 [00:33<00:49,  2.49it/s] 78%|██████████████████████████████████████████████████████████████████████████████▊                      | 438/561 [00:33<00:47,  2.60it/s] 78%|███████████████████████████████████████████████████████████████████████████████▏                     | 440/561 [00:33<00:32,  3.73it/s] 79%|███████████████████████████████████████████████████████████████████████████████▌                     | 442/561 [00:33<00:23,  5.13it/s] 79%|████████████████████████████████████████████████████████████████████████████████                     | 445/561 [00:33<00:15,  7.57it/s] 80%|████████████████████████████████████████████████████████████████████████████████▍                    | 447/561 [00:34<00:12,  9.12it/s] 80%|████████████████████████████████████████████████████████████████████████████████▊                    | 449/561 [00:34<00:10, 10.81it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▍                   | 452/561 [00:34<00:08, 13.36it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▉                   | 455/561 [00:34<00:06, 15.62it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▍                  | 458/561 [00:34<00:05, 17.36it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▉                  | 461/561 [00:34<00:05, 18.75it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▌                 | 464/561 [00:34<00:04, 19.79it/s] 83%|████████████████████████████████████████████████████████████████████████████████████                 | 467/561 [00:34<00:04, 20.46it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▌                | 470/561 [00:35<00:04, 20.84it/s][2025-03-28 01:21:22,345] [INFO] [logging.py:128:log_dist] [Rank 0] step=4400, skipped=10, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:21:22,346] [INFO] [timer.py:264:stop] epoch=0/micro_step=4400/global_step=4400, RunningAvgSamplesPerSec=18.309724013155595, CurrSamplesPerSec=1.422465225586959, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 84%|█████████████████████████████████████████████████████████████████████████████████████▏               | 473/561 [00:36<00:15,  5.70it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▌               | 475/561 [00:37<00:16,  5.13it/s] 85%|██████████████████████████████████████████████████████████████████████████████████████               | 478/561 [00:37<00:12,  6.84it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▌              | 481/561 [00:37<00:09,  8.82it/s] 86%|███████████████████████████████████████████████████████████████████████████████████████▏             | 484/561 [00:38<00:11,  6.55it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▍             | 486/561 [00:39<00:22,  3.32it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▋             | 487/561 [00:39<00:20,  3.62it/s] 87%|████████████████████████████████████████████████████████████████████████████████████████             | 489/561 [00:39<00:15,  4.71it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▌            | 492/561 [00:40<00:10,  6.67it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████████            | 495/561 [00:40<00:07,  8.80it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▍           | 497/561 [00:40<00:08,  7.97it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▊           | 499/561 [00:42<00:20,  2.96it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████▏          | 501/561 [00:42<00:15,  3.82it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▋          | 504/561 [00:42<00:10,  5.49it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████████▎         | 507/561 [00:42<00:07,  7.40it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▋         | 509/561 [00:44<00:14,  3.48it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▉         | 511/561 [00:45<00:16,  3.11it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████████▎        | 513/561 [00:45<00:11,  4.03it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████████▋        | 515/561 [00:45<00:08,  5.12it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████▎       | 518/561 [00:45<00:05,  7.18it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▌       | 520/561 [00:46<00:11,  3.65it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▉       | 522/561 [00:47<00:11,  3.50it/s][2025-03-28 01:21:33,231] [INFO] [logging.py:128:log_dist] [Rank 0] step=4450, skipped=10, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:21:33,232] [INFO] [timer.py:264:stop] epoch=0/micro_step=4450/global_step=4450, RunningAvgSamplesPerSec=17.722012453863396, CurrSamplesPerSec=19.022546515926372, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 93%|██████████████████████████████████████████████████████████████████████████████████████████████▎      | 524/561 [00:47<00:08,  4.54it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▉      | 527/561 [00:47<00:05,  6.41it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▏     | 529/561 [00:48<00:09,  3.46it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▌     | 531/561 [00:49<00:08,  3.73it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▉     | 533/561 [00:49<00:05,  4.82it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████████▎    | 535/561 [00:50<00:07,  3.31it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▍    | 536/561 [00:51<00:08,  2.85it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▋    | 537/561 [00:51<00:08,  2.76it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████    | 539/561 [00:51<00:05,  3.91it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████████▌   | 542/561 [00:51<00:03,  6.03it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████████▉   | 544/561 [00:52<00:03,  5.60it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████████   | 545/561 [00:53<00:04,  3.32it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████████▎  | 546/561 [00:53<00:05,  2.76it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▍  | 547/561 [00:54<00:05,  2.54it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▋  | 548/561 [00:54<00:04,  3.02it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████████▏ | 551/561 [00:54<00:01,  5.33it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▋ | 554/561 [00:54<00:00,  7.74it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████▎| 557/561 [00:54<00:00, 10.19it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████████▊| 560/561 [00:54<00:00, 12.54it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:55<00:00, 10.19it/s]
  0%|                                                                                                               | 0/561 [00:00<?, ?it/s]  0%|▏                                                                                                      | 1/561 [00:00<01:45,  5.30it/s]  1%|▌                                                                                                      | 3/561 [00:00<00:48, 11.56it/s]  1%|█                                                                                                      | 6/561 [00:00<00:34, 15.97it/s]  2%|█▋                                                                                                     | 9/561 [00:00<00:29, 18.72it/s][2025-03-28 01:21:41,570] [INFO] [logging.py:128:log_dist] [Rank 0] step=4500, skipped=10, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:21:41,571] [INFO] [timer.py:264:stop] epoch=0/micro_step=4500/global_step=4500, RunningAvgSamplesPerSec=17.355314216356874, CurrSamplesPerSec=23.773299065079428, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
  2%|██▏                                                                                                   | 12/561 [00:00<00:26, 20.40it/s]  3%|██▋                                                                                                   | 15/561 [00:00<00:26, 20.86it/s]  3%|███▎                                                                                                  | 18/561 [00:00<00:25, 21.18it/s]  4%|███▊                                                                                                  | 21/561 [00:01<00:25, 21.42it/s]  4%|████▎                                                                                                 | 24/561 [00:01<00:24, 22.00it/s]  5%|████▉                                                                                                 | 27/561 [00:01<00:23, 22.28it/s]  5%|█████▍                                                                                                | 30/561 [00:01<00:24, 22.02it/s]  6%|██████                                                                                                | 33/561 [00:01<00:24, 21.77it/s]  6%|██████▌                                                                                               | 36/561 [00:01<00:24, 21.31it/s]  7%|███████                                                                                               | 39/561 [00:02<01:18,  6.61it/s]  7%|███████▍                                                                                              | 41/561 [00:03<01:37,  5.32it/s]  8%|████████                                                                                              | 44/561 [00:03<01:13,  7.02it/s]  8%|████████▌                                                                                             | 47/561 [00:03<00:57,  8.90it/s]  9%|█████████                                                                                             | 50/561 [00:04<00:46, 10.88it/s]  9%|█████████▋                                                                                            | 53/561 [00:04<00:39, 12.80it/s] 10%|██████████▏                                                                                           | 56/561 [00:04<00:34, 14.66it/s] 11%|██████████▋                                                                                           | 59/561 [00:04<00:30, 16.46it/s][2025-03-28 01:21:45,458] [INFO] [logging.py:128:log_dist] [Rank 0] step=4550, skipped=10, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:21:45,459] [INFO] [timer.py:264:stop] epoch=0/micro_step=4550/global_step=4550, RunningAvgSamplesPerSec=17.295402771440454, CurrSamplesPerSec=18.238785107933776, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 11%|███████████▎                                                                                          | 62/561 [00:04<00:28, 17.46it/s] 12%|███████████▊                                                                                          | 65/561 [00:04<00:27, 18.16it/s] 12%|████████████▎                                                                                         | 68/561 [00:04<00:26, 18.56it/s] 13%|████████████▉                                                                                         | 71/561 [00:05<00:25, 19.37it/s] 13%|█████████████▍                                                                                        | 74/561 [00:05<00:25, 19.22it/s] 14%|██████████████                                                                                        | 77/561 [00:05<00:25, 18.83it/s] 14%|██████████████▎                                                                                       | 79/561 [00:05<00:47, 10.12it/s] 14%|██████████████▋                                                                                       | 81/561 [00:07<01:57,  4.10it/s] 15%|███████████████                                                                                       | 83/561 [00:07<01:45,  4.54it/s] 15%|███████████████▎                                                                                      | 84/561 [00:07<01:37,  4.89it/s] 16%|███████████████▊                                                                                      | 87/561 [00:07<01:07,  7.05it/s] 16%|████████████████▎                                                                                     | 90/561 [00:07<00:50,  9.35it/s] 17%|████████████████▉                                                                                     | 93/561 [00:08<00:40, 11.60it/s] 17%|█████████████████▍                                                                                    | 96/561 [00:08<00:33, 13.74it/s] 18%|██████████████████                                                                                    | 99/561 [00:08<00:29, 15.59it/s] 18%|██████████████████▎                                                                                  | 102/561 [00:08<00:26, 17.10it/s] 19%|██████████████████▉                                                                                  | 105/561 [00:08<00:25, 18.02it/s] 19%|███████████████████▍                                                                                 | 108/561 [00:08<00:23, 19.40it/s] 20%|███████████████████▉                                                                                 | 111/561 [00:08<00:20, 21.59it/s][2025-03-28 01:21:49,820] [INFO] [logging.py:128:log_dist] [Rank 0] step=4600, skipped=10, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:21:49,821] [INFO] [timer.py:264:stop] epoch=0/micro_step=4600/global_step=4600, RunningAvgSamplesPerSec=17.200685673527957, CurrSamplesPerSec=21.241155837144834, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 20%|████████████████████▌                                                                                | 114/561 [00:09<00:20, 21.52it/s] 21%|█████████████████████                                                                                | 117/561 [00:09<00:20, 21.65it/s] 21%|█████████████████████▌                                                                               | 120/561 [00:09<00:19, 22.16it/s] 22%|██████████████████████▏                                                                              | 123/561 [00:09<00:19, 22.79it/s] 22%|██████████████████████▋                                                                              | 126/561 [00:09<00:18, 23.05it/s] 23%|███████████████████████▏                                                                             | 129/561 [00:09<00:18, 23.71it/s] 24%|███████████████████████▊                                                                             | 132/561 [00:09<00:18, 23.12it/s] 24%|████████████████████████▎                                                                            | 135/561 [00:09<00:18, 22.72it/s] 25%|████████████████████████▊                                                                            | 138/561 [00:10<00:18, 22.49it/s] 25%|█████████████████████████▍                                                                           | 141/561 [00:10<00:18, 22.33it/s] 26%|█████████████████████████▉                                                                           | 144/561 [00:10<00:18, 22.08it/s] 26%|██████████████████████████▍                                                                          | 147/561 [00:10<00:18, 22.15it/s] 27%|███████████████████████████                                                                          | 150/561 [00:10<00:18, 22.56it/s] 27%|███████████████████████████▌                                                                         | 153/561 [00:10<00:17, 22.86it/s] 28%|████████████████████████████                                                                         | 156/561 [00:10<00:17, 23.25it/s] 28%|████████████████████████████▋                                                                        | 159/561 [00:10<00:17, 23.20it/s][2025-03-28 01:21:52,010] [INFO] [logging.py:128:log_dist] [Rank 0] step=4650, skipped=10, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:21:52,011] [INFO] [timer.py:264:stop] epoch=0/micro_step=4650/global_step=4650, RunningAvgSamplesPerSec=17.24682074702072, CurrSamplesPerSec=22.003922674643306, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 29%|█████████████████████████████▏                                                                       | 162/561 [00:11<00:17, 22.89it/s] 29%|█████████████████████████████▋                                                                       | 165/561 [00:11<00:17, 22.54it/s] 30%|██████████████████████████████▏                                                                      | 168/561 [00:11<00:17, 22.29it/s] 30%|██████████████████████████████▊                                                                      | 171/561 [00:11<00:17, 22.29it/s] 31%|███████████████████████████████▎                                                                     | 174/561 [00:11<00:17, 22.20it/s] 32%|███████████████████████████████▊                                                                     | 177/561 [00:11<00:17, 22.06it/s] 32%|████████████████████████████████▍                                                                    | 180/561 [00:11<00:17, 22.37it/s] 33%|████████████████████████████████▉                                                                    | 183/561 [00:12<00:16, 22.27it/s] 33%|█████████████████████████████████▍                                                                   | 186/561 [00:12<00:16, 22.17it/s] 34%|██████████████████████████████████                                                                   | 189/561 [00:12<00:16, 22.29it/s] 34%|██████████████████████████████████▌                                                                  | 192/561 [00:12<00:16, 22.28it/s] 35%|███████████████████████████████████                                                                  | 195/561 [00:12<00:16, 22.30it/s] 35%|███████████████████████████████████▋                                                                 | 198/561 [00:12<00:17, 21.18it/s] 36%|████████████████████████████████████▏                                                                | 201/561 [00:12<00:17, 20.95it/s] 36%|████████████████████████████████████▋                                                                | 204/561 [00:13<00:16, 21.15it/s] 37%|█████████████████████████████████████▎                                                               | 207/561 [00:13<00:16, 21.32it/s] 37%|█████████████████████████████████████▊                                                               | 210/561 [00:13<00:16, 21.47it/s][2025-03-28 01:21:54,312] [INFO] [logging.py:128:log_dist] [Rank 0] step=4700, skipped=10, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:21:54,313] [INFO] [timer.py:264:stop] epoch=0/micro_step=4700/global_step=4700, RunningAvgSamplesPerSec=17.2851012529443, CurrSamplesPerSec=21.320732891240095, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 38%|██████████████████████████████████████▎                                                              | 213/561 [00:13<00:16, 21.56it/s] 39%|██████████████████████████████████████▉                                                              | 216/561 [00:13<00:16, 20.91it/s] 39%|███████████████████████████████████████▍                                                             | 219/561 [00:13<00:16, 21.01it/s] 40%|███████████████████████████████████████▉                                                             | 222/561 [00:13<00:15, 21.46it/s] 40%|████████████████████████████████████████▌                                                            | 225/561 [00:14<00:15, 21.41it/s] 41%|█████████████████████████████████████████                                                            | 228/561 [00:14<00:15, 21.48it/s] 41%|█████████████████████████████████████████▌                                                           | 231/561 [00:14<00:15, 21.68it/s] 42%|██████████████████████████████████████████▏                                                          | 234/561 [00:14<00:15, 21.69it/s] 42%|██████████████████████████████████████████▋                                                          | 237/561 [00:14<00:14, 21.61it/s] 43%|███████████████████████████████████████████▏                                                         | 240/561 [00:14<00:14, 21.65it/s] 43%|███████████████████████████████████████████▋                                                         | 243/561 [00:14<00:14, 21.78it/s] 44%|████████████████████████████████████████████▎                                                        | 246/561 [00:15<00:14, 21.87it/s] 44%|████████████████████████████████████████████▊                                                        | 249/561 [00:15<00:14, 21.85it/s] 45%|█████████████████████████████████████████████▎                                                       | 252/561 [00:15<00:14, 21.98it/s] 45%|█████████████████████████████████████████████▉                                                       | 255/561 [00:15<00:13, 22.16it/s] 46%|██████████████████████████████████████████████▍                                                      | 258/561 [00:15<00:13, 22.30it/s] 47%|██████████████████████████████████████████████▉                                                      | 261/561 [00:15<00:13, 22.79it/s][2025-03-28 01:21:56,611] [INFO] [logging.py:128:log_dist] [Rank 0] step=4750, skipped=10, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:21:56,612] [INFO] [timer.py:264:stop] epoch=0/micro_step=4750/global_step=4750, RunningAvgSamplesPerSec=17.322934705830995, CurrSamplesPerSec=16.290761208863085, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 47%|███████████████████████████████████████████████▌                                                     | 264/561 [00:15<00:13, 21.64it/s] 48%|████████████████████████████████████████████████                                                     | 267/561 [00:15<00:13, 21.26it/s] 48%|████████████████████████████████████████████████▌                                                    | 270/561 [00:16<00:13, 21.03it/s] 49%|█████████████████████████████████████████████████▏                                                   | 273/561 [00:16<00:13, 21.27it/s] 49%|█████████████████████████████████████████████████▋                                                   | 276/561 [00:16<00:13, 21.34it/s] 50%|██████████████████████████████████████████████████▏                                                  | 279/561 [00:16<00:13, 21.49it/s] 50%|██████████████████████████████████████████████████▊                                                  | 282/561 [00:16<00:12, 21.67it/s] 51%|███████████████████████████████████████████████████▎                                                 | 285/561 [00:16<00:12, 21.69it/s] 51%|███████████████████████████████████████████████████▊                                                 | 288/561 [00:16<00:12, 21.67it/s] 52%|████████████████████████████████████████████████████▍                                                | 291/561 [00:17<00:12, 21.99it/s] 52%|████████████████████████████████████████████████████▉                                                | 294/561 [00:17<00:12, 21.77it/s] 53%|█████████████████████████████████████████████████████▍                                               | 297/561 [00:17<00:12, 21.76it/s] 53%|██████████████████████████████████████████████████████                                               | 300/561 [00:17<00:12, 21.64it/s] 54%|██████████████████████████████████████████████████████▌                                              | 303/561 [00:17<00:11, 22.04it/s] 55%|███████████████████████████████████████████████████████                                              | 306/561 [00:17<00:11, 21.95it/s] 55%|███████████████████████████████████████████████████████▋                                             | 309/561 [00:17<00:11, 21.93it/s][2025-03-28 01:21:58,920] [INFO] [logging.py:128:log_dist] [Rank 0] step=4800, skipped=10, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:21:58,921] [INFO] [timer.py:264:stop] epoch=0/micro_step=4800/global_step=4800, RunningAvgSamplesPerSec=17.359535429055285, CurrSamplesPerSec=21.3310338520503, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 56%|████████████████████████████████████████████████████████▏                                            | 312/561 [00:18<00:11, 21.79it/s] 56%|████████████████████████████████████████████████████████▋                                            | 315/561 [00:18<00:11, 21.82it/s] 57%|█████████████████████████████████████████████████████████▎                                           | 318/561 [00:18<00:10, 22.10it/s] 57%|█████████████████████████████████████████████████████████▊                                           | 321/561 [00:18<00:11, 21.27it/s] 58%|██████████████████████████████████████████████████████████▎                                          | 324/561 [00:18<00:10, 21.79it/s] 58%|██████████████████████████████████████████████████████████▊                                          | 327/561 [00:18<00:10, 22.53it/s] 59%|███████████████████████████████████████████████████████████▍                                         | 330/561 [00:18<00:10, 22.84it/s] 59%|███████████████████████████████████████████████████████████▉                                         | 333/561 [00:18<00:09, 22.96it/s] 60%|████████████████████████████████████████████████████████████▍                                        | 336/561 [00:19<00:09, 23.19it/s] 60%|█████████████████████████████████████████████████████████████                                        | 339/561 [00:19<00:09, 22.88it/s] 61%|█████████████████████████████████████████████████████████████▌                                       | 342/561 [00:19<00:09, 22.62it/s] 61%|██████████████████████████████████████████████████████████████                                       | 345/561 [00:19<00:09, 22.62it/s] 62%|██████████████████████████████████████████████████████████████▋                                      | 348/561 [00:19<00:09, 22.09it/s] 63%|███████████████████████████████████████████████████████████████▏                                     | 351/561 [00:19<00:09, 21.87it/s] 63%|███████████████████████████████████████████████████████████████▋                                     | 354/561 [00:19<00:09, 21.06it/s] 64%|████████████████████████████████████████████████████████████████▎                                    | 357/561 [00:20<00:09, 21.25it/s] 64%|████████████████████████████████████████████████████████████████▊                                    | 360/561 [00:20<00:09, 21.55it/s][2025-03-28 01:22:01,181] [INFO] [logging.py:128:log_dist] [Rank 0] step=4850, skipped=10, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:22:01,181] [INFO] [timer.py:264:stop] epoch=0/micro_step=4850/global_step=4850, RunningAvgSamplesPerSec=17.39853633696864, CurrSamplesPerSec=23.366440631568178, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 65%|█████████████████████████████████████████████████████████████████▎                                   | 363/561 [00:20<00:09, 21.97it/s] 65%|█████████████████████████████████████████████████████████████████▉                                   | 366/561 [00:20<00:08, 22.71it/s] 66%|██████████████████████████████████████████████████████████████████▍                                  | 369/561 [00:20<00:08, 22.95it/s] 66%|██████████████████████████████████████████████████████████████████▉                                  | 372/561 [00:20<00:08, 21.47it/s] 67%|███████████████████████████████████████████████████████████████████▌                                 | 375/561 [00:20<00:08, 21.61it/s] 67%|████████████████████████████████████████████████████████████████████                                 | 378/561 [00:21<00:08, 21.67it/s] 68%|████████████████████████████████████████████████████████████████████▌                                | 381/561 [00:21<00:08, 21.70it/s] 68%|█████████████████████████████████████████████████████████████████████▏                               | 384/561 [00:21<00:08, 21.67it/s] 69%|█████████████████████████████████████████████████████████████████████▋                               | 387/561 [00:21<00:08, 21.54it/s] 70%|██████████████████████████████████████████████████████████████████████▏                              | 390/561 [00:21<00:07, 22.17it/s] 70%|██████████████████████████████████████████████████████████████████████▊                              | 393/561 [00:21<00:07, 22.54it/s] 71%|███████████████████████████████████████████████████████████████████████▎                             | 396/561 [00:21<00:07, 22.79it/s] 71%|███████████████████████████████████████████████████████████████████████▊                             | 399/561 [00:21<00:07, 22.70it/s] 72%|████████████████████████████████████████████████████████████████████████▎                            | 402/561 [00:22<00:07, 22.52it/s] 72%|████████████████████████████████████████████████████████████████████████▉                            | 405/561 [00:22<00:07, 22.26it/s] 73%|█████████████████████████████████████████████████████████████████████████▍                           | 408/561 [00:22<00:07, 21.56it/s] 73%|█████████████████████████████████████████████████████████████████████████▉                           | 411/561 [00:22<00:06, 21.58it/s][2025-03-28 01:22:03,449] [INFO] [logging.py:128:log_dist] [Rank 0] step=4900, skipped=10, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:22:03,450] [INFO] [timer.py:264:stop] epoch=0/micro_step=4900/global_step=4900, RunningAvgSamplesPerSec=17.436406888038082, CurrSamplesPerSec=22.032935250243213, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 74%|██████████████████████████████████████████████████████████████████████████▌                          | 414/561 [00:22<00:06, 21.66it/s] 74%|███████████████████████████████████████████████████████████████████████████                          | 417/561 [00:22<00:06, 21.58it/s] 75%|███████████████████████████████████████████████████████████████████████████▌                         | 420/561 [00:22<00:06, 21.73it/s] 75%|████████████████████████████████████████████████████████████████████████████▏                        | 423/561 [00:23<00:06, 21.25it/s] 76%|████████████████████████████████████████████████████████████████████████████▋                        | 426/561 [00:23<00:06, 21.30it/s] 76%|█████████████████████████████████████████████████████████████████████████████▏                       | 429/561 [00:23<00:06, 21.40it/s] 77%|█████████████████████████████████████████████████████████████████████████████▊                       | 432/561 [00:23<00:05, 21.52it/s] 78%|██████████████████████████████████████████████████████████████████████████████▎                      | 435/561 [00:23<00:05, 21.81it/s] 78%|██████████████████████████████████████████████████████████████████████████████▊                      | 438/561 [00:23<00:05, 21.70it/s] 79%|███████████████████████████████████████████████████████████████████████████████▍                     | 441/561 [00:23<00:05, 22.06it/s] 79%|███████████████████████████████████████████████████████████████████████████████▉                     | 444/561 [00:24<00:05, 22.03it/s] 80%|████████████████████████████████████████████████████████████████████████████████▍                    | 447/561 [00:24<00:05, 21.79it/s] 80%|█████████████████████████████████████████████████████████████████████████████████                    | 450/561 [00:24<00:05, 21.93it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▌                   | 453/561 [00:24<00:04, 22.03it/s] 81%|██████████████████████████████████████████████████████████████████████████████████                   | 456/561 [00:24<00:04, 22.50it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▋                  | 459/561 [00:24<00:04, 22.82it/s][2025-03-28 01:22:05,713] [INFO] [logging.py:128:log_dist] [Rank 0] step=4950, skipped=10, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:22:05,713] [INFO] [timer.py:264:stop] epoch=0/micro_step=4950/global_step=4950, RunningAvgSamplesPerSec=17.473951403420894, CurrSamplesPerSec=22.535822204310204, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 82%|███████████████████████████████████████████████████████████████████████████████████▏                 | 462/561 [00:24<00:04, 23.05it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▋                 | 465/561 [00:24<00:04, 23.12it/s] 83%|████████████████████████████████████████████████████████████████████████████████████▎                | 468/561 [00:25<00:04, 22.73it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▊                | 471/561 [00:25<00:03, 22.64it/s] 84%|█████████████████████████████████████████████████████████████████████████████████████▎               | 474/561 [00:25<00:03, 22.31it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▉               | 477/561 [00:25<00:03, 22.23it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▍              | 480/561 [00:25<00:03, 21.76it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▉              | 483/561 [00:25<00:03, 21.61it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▍             | 486/561 [00:25<00:03, 21.78it/s] 87%|████████████████████████████████████████████████████████████████████████████████████████             | 489/561 [00:26<00:03, 21.98it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▌            | 492/561 [00:26<00:03, 21.70it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████████            | 495/561 [00:26<00:03, 21.81it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▋           | 498/561 [00:26<00:02, 21.75it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████▏          | 501/561 [00:26<00:02, 21.91it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▋          | 504/561 [00:26<00:02, 22.56it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████████▎         | 507/561 [00:26<00:02, 23.02it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▊         | 510/561 [00:26<00:02, 23.36it/s][2025-03-28 01:22:07,972] [INFO] [logging.py:128:log_dist] [Rank 0] step=5000, skipped=10, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:22:07,973] [INFO] [timer.py:264:stop] epoch=0/micro_step=5000/global_step=5000, RunningAvgSamplesPerSec=17.51117652377727, CurrSamplesPerSec=15.63783144681244, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 91%|████████████████████████████████████████████████████████████████████████████████████████████▎        | 513/561 [00:27<00:02, 21.96it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████████▉        | 516/561 [00:27<00:02, 21.62it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▍       | 519/561 [00:27<00:01, 21.30it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▉       | 522/561 [00:27<00:01, 21.47it/s][2025-03-28 01:22:08,488] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2025-03-28 01:22:08,534] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
 94%|██████████████████████████████████████████████████████████████████████████████████████████████▌      | 525/561 [00:27<00:01, 21.57it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████      | 528/561 [00:27<00:01, 21.47it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▌     | 531/561 [00:27<00:01, 21.97it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████████▏    | 534/561 [00:28<00:01, 22.44it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▋    | 537/561 [00:28<00:01, 21.44it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████▏   | 540/561 [00:28<00:00, 21.64it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████████▊   | 543/561 [00:28<00:00, 21.67it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████████▎  | 546/561 [00:28<00:00, 21.67it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▊  | 549/561 [00:28<00:00, 21.77it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████████▍ | 552/561 [00:28<00:00, 20.82it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▉ | 555/561 [00:29<00:00, 21.27it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████▍| 558/561 [00:29<00:00, 21.49it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:29<00:00, 21.92it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:29<00:00, 19.07it/s]
  0%|                                                                                                               | 0/561 [00:00<?, ?it/s][2025-03-28 01:22:10,710] [INFO] [logging.py:128:log_dist] [Rank 0] step=5050, skipped=12, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:22:10,711] [INFO] [timer.py:264:stop] epoch=0/micro_step=5050/global_step=5050, RunningAvgSamplesPerSec=17.52721714922437, CurrSamplesPerSec=3.0829335886629696, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
  0%|▏                                                                                                      | 1/561 [00:00<03:33,  2.62it/s]  1%|▋                                                                                                      | 4/561 [00:00<01:02,  8.85it/s]  1%|█                                                                                                      | 6/561 [00:00<00:48, 11.40it/s]  2%|█▋                                                                                                     | 9/561 [00:00<00:37, 14.75it/s]  2%|██▏                                                                                                   | 12/561 [00:00<00:31, 17.16it/s]  3%|██▋                                                                                                   | 15/561 [00:01<00:29, 18.20it/s]  3%|███▎                                                                                                  | 18/561 [00:01<00:27, 19.50it/s]  4%|███▊                                                                                                  | 21/561 [00:01<00:28, 19.22it/s]  4%|████▎                                                                                                 | 24/561 [00:01<00:26, 20.11it/s]  5%|████▉                                                                                                 | 27/561 [00:01<00:26, 19.87it/s]  5%|█████▍                                                                                                | 30/561 [00:01<00:26, 20.29it/s]  6%|██████                                                                                                | 33/561 [00:01<00:25, 20.75it/s]  6%|██████▌                                                                                               | 36/561 [00:02<00:24, 21.14it/s]  7%|███████                                                                                               | 39/561 [00:02<00:24, 21.31it/s]  7%|███████▋                                                                                              | 42/561 [00:02<00:24, 21.34it/s]  8%|████████▏                                                                                             | 45/561 [00:02<00:23, 21.85it/s]  9%|████████▋                                                                                             | 48/561 [00:02<00:22, 22.33it/s][2025-03-28 01:22:13,048] [INFO] [logging.py:128:log_dist] [Rank 0] step=5100, skipped=12, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:22:13,049] [INFO] [timer.py:264:stop] epoch=0/micro_step=5100/global_step=5100, RunningAvgSamplesPerSec=17.55870273241678, CurrSamplesPerSec=24.101428611629316, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
  9%|█████████▎                                                                                            | 51/561 [00:02<00:22, 22.86it/s] 10%|█████████▊                                                                                            | 54/561 [00:02<00:21, 23.11it/s] 10%|██████████▎                                                                                           | 57/561 [00:02<00:22, 22.70it/s] 11%|██████████▉                                                                                           | 60/561 [00:03<00:22, 22.42it/s] 11%|███████████▍                                                                                          | 63/561 [00:03<00:22, 22.60it/s] 12%|████████████                                                                                          | 66/561 [00:03<00:22, 22.29it/s] 12%|████████████▌                                                                                         | 69/561 [00:03<00:22, 22.17it/s] 13%|█████████████                                                                                         | 72/561 [00:03<00:22, 22.01it/s] 13%|█████████████▋                                                                                        | 75/561 [00:03<00:22, 21.70it/s] 14%|██████████████▏                                                                                       | 78/561 [00:03<00:22, 21.82it/s] 14%|██████████████▋                                                                                       | 81/561 [00:04<00:21, 22.00it/s] 15%|███████████████▎                                                                                      | 84/561 [00:04<00:21, 22.02it/s] 16%|███████████████▊                                                                                      | 87/561 [00:04<00:21, 21.91it/s] 16%|████████████████▎                                                                                     | 90/561 [00:04<00:21, 22.29it/s] 17%|████████████████▉                                                                                     | 93/561 [00:04<00:20, 22.83it/s] 17%|█████████████████▍                                                                                    | 96/561 [00:04<00:20, 23.16it/s] 18%|██████████████████                                                                                    | 99/561 [00:04<00:19, 23.26it/s][2025-03-28 01:22:15,274] [INFO] [logging.py:128:log_dist] [Rank 0] step=5150, skipped=12, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:22:15,275] [INFO] [timer.py:264:stop] epoch=0/micro_step=5150/global_step=5150, RunningAvgSamplesPerSec=17.59638252875603, CurrSamplesPerSec=23.197661000966097, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 18%|██████████████████▎                                                                                  | 102/561 [00:04<00:19, 23.21it/s] 19%|██████████████████▉                                                                                  | 105/561 [00:05<00:20, 22.61it/s] 19%|███████████████████▍                                                                                 | 108/561 [00:05<00:20, 21.64it/s] 20%|███████████████████▉                                                                                 | 111/561 [00:05<00:21, 21.18it/s] 20%|████████████████████▌                                                                                | 114/561 [00:05<00:20, 21.37it/s] 21%|█████████████████████                                                                                | 117/561 [00:05<00:20, 21.60it/s] 21%|█████████████████████▌                                                                               | 120/561 [00:05<00:20, 21.84it/s] 22%|██████████████████████▏                                                                              | 123/561 [00:05<00:20, 21.65it/s] 22%|██████████████████████▋                                                                              | 126/561 [00:06<00:20, 21.18it/s] 23%|███████████████████████▏                                                                             | 129/561 [00:06<00:21, 20.35it/s] 24%|███████████████████████▊                                                                             | 132/561 [00:06<00:20, 20.68it/s] 24%|████████████████████████▎                                                                            | 135/561 [00:06<00:20, 20.85it/s] 25%|████████████████████████▊                                                                            | 138/561 [00:06<00:19, 21.44it/s] 25%|█████████████████████████▍                                                                           | 141/561 [00:06<00:19, 21.07it/s] 26%|█████████████████████████▉                                                                           | 144/561 [00:07<00:20, 20.36it/s] 26%|██████████████████████████▍                                                                          | 147/561 [00:07<00:20, 20.44it/s] 27%|███████████████████████████                                                                          | 150/561 [00:07<00:19, 20.72it/s][2025-03-28 01:22:17,667] [INFO] [logging.py:128:log_dist] [Rank 0] step=5200, skipped=12, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:22:17,668] [INFO] [timer.py:264:stop] epoch=0/micro_step=5200/global_step=5200, RunningAvgSamplesPerSec=17.62355955792702, CurrSamplesPerSec=22.177980598189816, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 27%|███████████████████████████▌                                                                         | 153/561 [00:07<00:19, 21.26it/s] 28%|████████████████████████████                                                                         | 156/561 [00:07<00:17, 22.73it/s] 28%|████████████████████████████▋                                                                        | 159/561 [00:07<00:17, 23.39it/s] 29%|█████████████████████████████▏                                                                       | 162/561 [00:07<00:16, 23.50it/s] 29%|█████████████████████████████▋                                                                       | 165/561 [00:07<00:16, 23.59it/s] 30%|██████████████████████████████▏                                                                      | 168/561 [00:08<00:16, 23.64it/s] 30%|██████████████████████████████▊                                                                      | 171/561 [00:08<00:16, 23.72it/s] 31%|███████████████████████████████▎                                                                     | 174/561 [00:08<00:16, 23.60it/s] 32%|███████████████████████████████▊                                                                     | 177/561 [00:08<00:16, 23.47it/s] 32%|████████████████████████████████▍                                                                    | 180/561 [00:08<00:16, 22.73it/s] 33%|████████████████████████████████▉                                                                    | 183/561 [00:08<00:16, 22.88it/s] 33%|█████████████████████████████████▍                                                                   | 186/561 [00:08<00:16, 22.78it/s] 34%|██████████████████████████████████                                                                   | 189/561 [00:08<00:16, 23.11it/s] 34%|██████████████████████████████████▌                                                                  | 192/561 [00:09<00:16, 22.31it/s] 35%|███████████████████████████████████                                                                  | 195/561 [00:09<00:16, 22.35it/s] 35%|███████████████████████████████████▋                                                                 | 198/561 [00:09<00:15, 23.03it/s][2025-03-28 01:22:19,804] [INFO] [logging.py:128:log_dist] [Rank 0] step=5250, skipped=12, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:22:19,804] [INFO] [timer.py:264:stop] epoch=0/micro_step=5250/global_step=5250, RunningAvgSamplesPerSec=17.665449532687834, CurrSamplesPerSec=23.63891184715763, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 36%|████████████████████████████████████▏                                                                | 201/561 [00:09<00:15, 23.14it/s] 36%|████████████████████████████████████▋                                                                | 204/561 [00:09<00:15, 23.49it/s] 37%|█████████████████████████████████████▎                                                               | 207/561 [00:09<00:15, 23.40it/s] 37%|█████████████████████████████████████▊                                                               | 210/561 [00:09<00:14, 23.54it/s] 38%|██████████████████████████████████████▎                                                              | 213/561 [00:09<00:14, 23.50it/s] 39%|██████████████████████████████████████▉                                                              | 216/561 [00:10<00:14, 23.60it/s] 39%|███████████████████████████████████████▍                                                             | 219/561 [00:10<00:14, 23.65it/s] 40%|███████████████████████████████████████▉                                                             | 222/561 [00:10<00:14, 23.65it/s] 40%|████████████████████████████████████████▌                                                            | 225/561 [00:10<00:14, 23.52it/s] 41%|█████████████████████████████████████████                                                            | 228/561 [00:10<00:14, 23.28it/s] 41%|█████████████████████████████████████████▌                                                           | 231/561 [00:10<00:14, 22.79it/s] 42%|██████████████████████████████████████████▏                                                          | 234/561 [00:10<00:15, 21.42it/s] 42%|██████████████████████████████████████████▋                                                          | 237/561 [00:11<00:14, 22.14it/s] 43%|███████████████████████████████████████████▏                                                         | 240/561 [00:11<00:14, 22.61it/s] 43%|███████████████████████████████████████████▋                                                         | 243/561 [00:11<00:13, 22.79it/s] 44%|████████████████████████████████████████████▎                                                        | 246/561 [00:11<00:14, 22.11it/s] 44%|████████████████████████████████████████████▊                                                        | 249/561 [00:11<00:14, 21.81it/s][2025-03-28 01:22:22,007] [INFO] [logging.py:128:log_dist] [Rank 0] step=5300, skipped=12, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:22:22,008] [INFO] [timer.py:264:stop] epoch=0/micro_step=5300/global_step=5300, RunningAvgSamplesPerSec=17.702809640817293, CurrSamplesPerSec=21.1715707752214, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 45%|█████████████████████████████████████████████▎                                                       | 252/561 [00:11<00:14, 21.84it/s] 45%|█████████████████████████████████████████████▉                                                       | 255/561 [00:11<00:13, 21.92it/s] 46%|██████████████████████████████████████████████▍                                                      | 258/561 [00:11<00:13, 21.92it/s] 47%|██████████████████████████████████████████████▉                                                      | 261/561 [00:12<00:13, 21.54it/s] 47%|███████████████████████████████████████████████▌                                                     | 264/561 [00:12<00:13, 21.40it/s] 48%|████████████████████████████████████████████████                                                     | 267/561 [00:12<00:13, 21.86it/s] 48%|████████████████████████████████████████████████▌                                                    | 270/561 [00:12<00:13, 21.98it/s] 49%|█████████████████████████████████████████████████▏                                                   | 273/561 [00:12<00:13, 22.02it/s] 49%|█████████████████████████████████████████████████▋                                                   | 276/561 [00:12<00:12, 22.01it/s] 50%|██████████████████████████████████████████████████▏                                                  | 279/561 [00:12<00:12, 21.84it/s] 50%|██████████████████████████████████████████████████▊                                                  | 282/561 [00:13<00:12, 21.84it/s] 51%|███████████████████████████████████████████████████▎                                                 | 285/561 [00:13<00:12, 21.91it/s] 51%|███████████████████████████████████████████████████▊                                                 | 288/561 [00:13<00:12, 22.00it/s] 52%|████████████████████████████████████████████████████▍                                                | 291/561 [00:13<00:12, 22.04it/s] 52%|████████████████████████████████████████████████████▉                                                | 294/561 [00:13<00:11, 22.56it/s] 53%|█████████████████████████████████████████████████████▍                                               | 297/561 [00:13<00:12, 21.52it/s] 53%|██████████████████████████████████████████████████████                                               | 300/561 [00:13<00:12, 21.66it/s][2025-03-28 01:22:24,296] [INFO] [logging.py:128:log_dist] [Rank 0] step=5350, skipped=12, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:22:24,297] [INFO] [timer.py:264:stop] epoch=0/micro_step=5350/global_step=5350, RunningAvgSamplesPerSec=17.734629132762365, CurrSamplesPerSec=21.767763646366344, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 54%|██████████████████████████████████████████████████████▌                                              | 303/561 [00:14<00:11, 21.62it/s] 55%|███████████████████████████████████████████████████████                                              | 306/561 [00:14<00:11, 21.42it/s] 55%|███████████████████████████████████████████████████████▋                                             | 309/561 [00:14<00:12, 20.85it/s] 56%|████████████████████████████████████████████████████████▏                                            | 312/561 [00:14<00:12, 20.22it/s] 56%|████████████████████████████████████████████████████████▋                                            | 315/561 [00:14<00:12, 20.32it/s] 57%|█████████████████████████████████████████████████████████▎                                           | 318/561 [00:14<00:12, 20.17it/s] 57%|█████████████████████████████████████████████████████████▊                                           | 321/561 [00:14<00:11, 20.04it/s] 58%|██████████████████████████████████████████████████████████▎                                          | 324/561 [00:15<00:11, 19.87it/s] 58%|██████████████████████████████████████████████████████████▋                                          | 326/561 [00:15<00:12, 19.09it/s] 58%|███████████████████████████████████████████████████████████                                          | 328/561 [00:15<00:12, 19.05it/s] 59%|███████████████████████████████████████████████████████████▌                                         | 331/561 [00:15<00:11, 19.74it/s] 59%|███████████████████████████████████████████████████████████▉                                         | 333/561 [00:15<00:11, 19.65it/s] 60%|████████████████████████████████████████████████████████████▎                                        | 335/561 [00:15<00:11, 19.62it/s] 60%|████████████████████████████████████████████████████████████▊                                        | 338/561 [00:15<00:11, 19.89it/s] 61%|█████████████████████████████████████████████████████████████▏                                       | 340/561 [00:15<00:11, 19.85it/s] 61%|█████████████████████████████████████████████████████████████▌                                       | 342/561 [00:16<00:11, 19.52it/s] 61%|█████████████████████████████████████████████████████████████▉                                       | 344/561 [00:16<00:11, 19.28it/s] 62%|██████████████████████████████████████████████████████████████▎                                      | 346/561 [00:16<00:11, 19.13it/s] 62%|██████████████████████████████████████████████████████████████▋                                      | 348/561 [00:16<00:11, 18.84it/s] 62%|███████████████████████████████████████████████████████████████                                      | 350/561 [00:16<00:11, 18.78it/s][2025-03-28 01:22:26,855] [INFO] [logging.py:128:log_dist] [Rank 0] step=5400, skipped=12, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:22:26,859] [INFO] [timer.py:264:stop] epoch=0/micro_step=5400/global_step=5400, RunningAvgSamplesPerSec=17.749995486230176, CurrSamplesPerSec=19.124024986779418, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 63%|███████████████████████████████████████████████████████████████▎                                     | 352/561 [00:16<00:11, 18.74it/s] 63%|███████████████████████████████████████████████████████████████▋                                     | 354/561 [00:16<00:11, 18.05it/s] 63%|████████████████████████████████████████████████████████████████                                     | 356/561 [00:16<00:11, 18.38it/s] 64%|████████████████████████████████████████████████████████████████▋                                    | 359/561 [00:16<00:10, 19.10it/s] 64%|████████████████████████████████████████████████████████████████▉                                    | 361/561 [00:17<00:10, 18.44it/s] 65%|█████████████████████████████████████████████████████████████████▌                                   | 364/561 [00:17<00:10, 18.94it/s] 65%|██████████████████████████████████████████████████████████████████                                   | 367/561 [00:17<00:09, 20.57it/s] 66%|██████████████████████████████████████████████████████████████████▌                                  | 370/561 [00:17<00:08, 21.49it/s] 66%|███████████████████████████████████████████████████████████████████▏                                 | 373/561 [00:17<00:08, 21.67it/s] 67%|███████████████████████████████████████████████████████████████████▋                                 | 376/561 [00:17<00:09, 20.40it/s] 68%|████████████████████████████████████████████████████████████████████▏                                | 379/561 [00:17<00:09, 19.64it/s] 68%|████████████████████████████████████████████████████████████████████▌                                | 381/561 [00:18<00:09, 19.26it/s] 68%|████████████████████████████████████████████████████████████████████▉                                | 383/561 [00:18<00:09, 18.97it/s] 69%|█████████████████████████████████████████████████████████████████████▎                               | 385/561 [00:18<00:09, 18.56it/s] 69%|█████████████████████████████████████████████████████████████████████▋                               | 387/561 [00:18<00:09, 18.48it/s] 69%|██████████████████████████████████████████████████████████████████████                               | 389/561 [00:18<00:09, 18.36it/s] 70%|██████████████████████████████████████████████████████████████████████▍                              | 391/561 [00:18<00:09, 18.28it/s] 70%|██████████████████████████████████████████████████████████████████████▉                              | 394/561 [00:18<00:08, 19.49it/s] 71%|███████████████████████████████████████████████████████████████████████▍                             | 397/561 [00:18<00:08, 20.32it/s] 71%|████████████████████████████████████████████████████████████████████████                             | 400/561 [00:19<00:07, 20.90it/s][2025-03-28 01:22:29,392] [INFO] [logging.py:128:log_dist] [Rank 0] step=5450, skipped=12, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:22:29,395] [INFO] [timer.py:264:stop] epoch=0/micro_step=5450/global_step=5450, RunningAvgSamplesPerSec=17.76659140205191, CurrSamplesPerSec=20.539854992453662, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 72%|████████████████████████████████████████████████████████████████████████▌                            | 403/561 [00:19<00:07, 20.16it/s] 72%|█████████████████████████████████████████████████████████████████████████                            | 406/561 [00:19<00:07, 19.44it/s] 73%|█████████████████████████████████████████████████████████████████████████▍                           | 408/561 [00:19<00:07, 19.27it/s] 73%|█████████████████████████████████████████████████████████████████████████▊                           | 410/561 [00:19<00:07, 18.96it/s] 73%|██████████████████████████████████████████████████████████████████████████▏                          | 412/561 [00:19<00:07, 18.72it/s] 74%|██████████████████████████████████████████████████████████████████████████▌                          | 414/561 [00:19<00:07, 18.54it/s] 74%|██████████████████████████████████████████████████████████████████████████▉                          | 416/561 [00:19<00:07, 18.41it/s] 75%|███████████████████████████████████████████████████████████████████████████▎                         | 418/561 [00:20<00:07, 18.30it/s] 75%|███████████████████████████████████████████████████████████████████████████▌                         | 420/561 [00:20<00:07, 18.24it/s] 75%|████████████████████████████████████████████████████████████████████████████▏                        | 423/561 [00:20<00:07, 19.47it/s] 76%|████████████████████████████████████████████████████████████████████████████▋                        | 426/561 [00:20<00:06, 20.89it/s] 76%|█████████████████████████████████████████████████████████████████████████████▏                       | 429/561 [00:20<00:06, 21.73it/s] 77%|█████████████████████████████████████████████████████████████████████████████▊                       | 432/561 [00:20<00:05, 22.47it/s] 78%|██████████████████████████████████████████████████████████████████████████████▎                      | 435/561 [00:20<00:05, 22.80it/s] 78%|██████████████████████████████████████████████████████████████████████████████▊                      | 438/561 [00:20<00:05, 21.95it/s] 79%|███████████████████████████████████████████████████████████████████████████████▍                     | 441/561 [00:21<00:05, 20.58it/s] 79%|███████████████████████████████████████████████████████████████████████████████▉                     | 444/561 [00:21<00:06, 18.73it/s] 80%|████████████████████████████████████████████████████████████████████████████████▎                    | 446/561 [00:21<00:06, 18.57it/s] 80%|████████████████████████████████████████████████████████████████████████████████▋                    | 448/561 [00:21<00:06, 18.45it/s] 80%|█████████████████████████████████████████████████████████████████████████████████                    | 450/561 [00:21<00:06, 18.35it/s][2025-03-28 01:22:31,975] [INFO] [logging.py:128:log_dist] [Rank 0] step=5500, skipped=12, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:22:31,978] [INFO] [timer.py:264:stop] epoch=0/micro_step=5500/global_step=5500, RunningAvgSamplesPerSec=17.780212398835566, CurrSamplesPerSec=18.14041803550931, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 81%|█████████████████████████████████████████████████████████████████████████████████▍                   | 452/561 [00:21<00:05, 18.27it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▋                   | 454/561 [00:21<00:05, 18.21it/s] 81%|██████████████████████████████████████████████████████████████████████████████████▎                  | 457/561 [00:21<00:05, 19.56it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▊                  | 460/561 [00:22<00:04, 20.20it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▎                 | 463/561 [00:22<00:04, 20.71it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▉                 | 466/561 [00:22<00:04, 21.08it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▍                | 469/561 [00:22<00:04, 21.13it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▉                | 472/561 [00:22<00:04, 21.62it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▌               | 475/561 [00:22<00:03, 22.20it/s] 85%|██████████████████████████████████████████████████████████████████████████████████████               | 478/561 [00:22<00:03, 21.53it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▌              | 481/561 [00:23<00:03, 20.32it/s] 86%|███████████████████████████████████████████████████████████████████████████████████████▏             | 484/561 [00:23<00:03, 19.56it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▍             | 486/561 [00:23<00:03, 19.19it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▊             | 488/561 [00:23<00:03, 18.90it/s] 87%|████████████████████████████████████████████████████████████████████████████████████████▏            | 490/561 [00:23<00:03, 18.67it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▌            | 492/561 [00:23<00:03, 18.51it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▉            | 494/561 [00:23<00:03, 18.37it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████████▎           | 496/561 [00:23<00:03, 18.54it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▊           | 499/561 [00:24<00:03, 20.24it/s][2025-03-28 01:22:34,446] [INFO] [logging.py:128:log_dist] [Rank 0] step=5550, skipped=12, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:22:34,447] [INFO] [timer.py:264:stop] epoch=0/micro_step=5550/global_step=5550, RunningAvgSamplesPerSec=17.800098533916252, CurrSamplesPerSec=23.206131928869166, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 89%|██████████████████████████████████████████████████████████████████████████████████████████▍          | 502/561 [00:24<00:02, 21.15it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▉          | 505/561 [00:24<00:02, 21.47it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▍         | 508/561 [00:24<00:02, 21.53it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▉         | 511/561 [00:24<00:02, 21.61it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████████▌        | 514/561 [00:24<00:02, 21.55it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████        | 517/561 [00:24<00:02, 21.57it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▌       | 520/561 [00:24<00:01, 21.84it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████████▏      | 523/561 [00:25<00:01, 21.84it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▋      | 526/561 [00:25<00:01, 22.12it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▏     | 529/561 [00:25<00:01, 20.98it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▊     | 532/561 [00:25<00:01, 20.63it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████████▎    | 535/561 [00:25<00:01, 19.77it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▋    | 537/561 [00:25<00:01, 19.35it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████    | 539/561 [00:25<00:01, 19.02it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████▍   | 541/561 [00:26<00:01, 18.75it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████████▊   | 543/561 [00:26<00:00, 18.57it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████████   | 545/561 [00:26<00:00, 18.43it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▋  | 548/561 [00:26<00:00, 19.68it/s][2025-03-28 01:22:36,879] [INFO] [logging.py:128:log_dist] [Rank 0] step=5600, skipped=12, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:22:36,879] [INFO] [timer.py:264:stop] epoch=0/micro_step=5600/global_step=5600, RunningAvgSamplesPerSec=17.821743969775095, CurrSamplesPerSec=22.303223826661974, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 98%|███████████████████████████████████████████████████████████████████████████████████████████████████▏ | 551/561 [00:26<00:00, 20.71it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▋ | 554/561 [00:26<00:00, 21.24it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████▎| 557/561 [00:26<00:00, 21.53it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████████▊| 560/561 [00:26<00:00, 22.36it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:27<00:00, 20.75it/s]
  0%|                                                                                                               | 0/561 [00:00<?, ?it/s]  0%|▏                                                                                                      | 1/561 [00:00<04:20,  2.15it/s]  1%|▋                                                                                                      | 4/561 [00:00<01:10,  7.87it/s]  1%|█▎                                                                                                     | 7/561 [00:00<00:45, 12.07it/s]  2%|█▊                                                                                                    | 10/561 [00:00<00:36, 14.93it/s]  2%|██▎                                                                                                   | 13/561 [00:01<00:32, 16.79it/s]  3%|██▋                                                                                                   | 15/561 [00:01<00:31, 17.10it/s]  3%|███                                                                                                   | 17/561 [00:01<00:31, 17.35it/s]  3%|███▍                                                                                                  | 19/561 [00:01<00:30, 17.53it/s]  4%|███▊                                                                                                  | 21/561 [00:01<00:30, 17.67it/s]  4%|████▏                                                                                                 | 23/561 [00:01<00:30, 17.78it/s]  4%|████▌                                                                                                 | 25/561 [00:01<00:30, 17.86it/s]  5%|████▉                                                                                                 | 27/561 [00:01<00:29, 17.92it/s]  5%|█████▎                                                                                                | 29/561 [00:01<00:29, 17.97it/s]  6%|█████▋                                                                                                | 31/561 [00:02<00:29, 18.00it/s]  6%|██████▏                                                                                               | 34/561 [00:02<00:26, 19.72it/s]  7%|██████▋                                                                                               | 37/561 [00:02<00:25, 20.83it/s][2025-03-28 01:22:39,807] [INFO] [logging.py:128:log_dist] [Rank 0] step=5650, skipped=12, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:22:39,808] [INFO] [timer.py:264:stop] epoch=0/micro_step=5650/global_step=5650, RunningAvgSamplesPerSec=17.822783430218234, CurrSamplesPerSec=21.129548494963373, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
  7%|███████▎                                                                                              | 40/561 [00:02<00:24, 21.23it/s]  8%|███████▊                                                                                              | 43/561 [00:02<00:24, 21.53it/s]  8%|████████▎                                                                                             | 46/561 [00:02<00:23, 21.56it/s]  9%|████████▉                                                                                             | 49/561 [00:02<00:23, 21.60it/s]  9%|█████████▍                                                                                            | 52/561 [00:02<00:23, 21.61it/s] 10%|██████████                                                                                            | 55/561 [00:03<00:23, 21.74it/s] 10%|██████████▌                                                                                           | 58/561 [00:03<00:23, 21.83it/s] 11%|███████████                                                                                           | 61/561 [00:03<00:22, 21.97it/s] 11%|███████████▋                                                                                          | 64/561 [00:03<00:22, 22.06it/s] 12%|████████████▏                                                                                         | 67/561 [00:03<00:22, 21.88it/s] 12%|████████████▋                                                                                         | 70/561 [00:03<00:22, 21.80it/s] 13%|█████████████▎                                                                                        | 73/561 [00:03<00:22, 22.02it/s] 14%|█████████████▊                                                                                        | 76/561 [00:04<00:21, 22.60it/s] 14%|██████████████▎                                                                                       | 79/561 [00:04<00:21, 22.92it/s] 15%|██████████████▉                                                                                       | 82/561 [00:04<00:22, 21.50it/s] 15%|███████████████▍                                                                                      | 85/561 [00:04<00:23, 20.31it/s] 16%|████████████████                                                                                      | 88/561 [00:04<00:24, 19.41it/s][2025-03-28 01:22:42,168] [INFO] [logging.py:128:log_dist] [Rank 0] step=5700, skipped=12, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:22:42,171] [INFO] [timer.py:264:stop] epoch=0/micro_step=5700/global_step=5700, RunningAvgSamplesPerSec=17.847776622963707, CurrSamplesPerSec=18.037131705118586, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 16%|████████████████▎                                                                                     | 90/561 [00:04<00:24, 19.07it/s] 16%|████████████████▋                                                                                     | 92/561 [00:04<00:24, 18.82it/s] 17%|█████████████████                                                                                     | 94/561 [00:05<00:25, 18.61it/s] 17%|█████████████████▍                                                                                    | 96/561 [00:05<00:25, 18.44it/s] 17%|█████████████████▊                                                                                    | 98/561 [00:05<00:25, 18.33it/s] 18%|██████████████████▏                                                                                  | 101/561 [00:05<00:23, 19.76it/s] 19%|██████████████████▋                                                                                  | 104/561 [00:05<00:21, 20.81it/s] 19%|███████████████████▎                                                                                 | 107/561 [00:05<00:20, 21.73it/s] 20%|███████████████████▊                                                                                 | 110/561 [00:05<00:20, 22.29it/s] 20%|████████████████████▎                                                                                | 113/561 [00:05<00:19, 22.48it/s] 21%|████████████████████▉                                                                                | 116/561 [00:05<00:19, 23.06it/s] 21%|█████████████████████▍                                                                               | 119/561 [00:06<00:19, 22.23it/s] 22%|█████████████████████▉                                                                               | 122/561 [00:06<00:20, 21.84it/s] 22%|██████████████████████▌                                                                              | 125/561 [00:06<00:20, 21.00it/s] 23%|███████████████████████                                                                              | 128/561 [00:06<00:20, 21.33it/s] 23%|███████████████████████▌                                                                             | 131/561 [00:06<00:20, 21.50it/s] 24%|████████████████████████                                                                             | 134/561 [00:06<00:19, 21.85it/s] 24%|████████████████████████▋                                                                            | 137/561 [00:06<00:19, 21.99it/s][2025-03-28 01:22:44,501] [INFO] [logging.py:128:log_dist] [Rank 0] step=5750, skipped=12, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:22:44,503] [INFO] [timer.py:264:stop] epoch=0/micro_step=5750/global_step=5750, RunningAvgSamplesPerSec=17.874246021071322, CurrSamplesPerSec=22.61053577148741, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 25%|█████████████████████████▏                                                                           | 140/561 [00:07<00:19, 22.00it/s] 25%|█████████████████████████▋                                                                           | 143/561 [00:07<00:18, 22.09it/s] 26%|██████████████████████████▎                                                                          | 146/561 [00:07<00:18, 22.11it/s] 27%|██████████████████████████▊                                                                          | 149/561 [00:07<00:18, 22.30it/s] 27%|███████████████████████████▎                                                                         | 152/561 [00:07<00:18, 22.18it/s] 28%|███████████████████████████▉                                                                         | 155/561 [00:07<00:18, 22.04it/s] 28%|████████████████████████████▍                                                                        | 158/561 [00:07<00:18, 21.82it/s] 29%|████████████████████████████▉                                                                        | 161/561 [00:08<00:18, 21.96it/s] 29%|█████████████████████████████▌                                                                       | 164/561 [00:08<00:18, 21.72it/s] 30%|██████████████████████████████                                                                       | 167/561 [00:08<00:17, 22.20it/s] 30%|██████████████████████████████▌                                                                      | 170/561 [00:08<00:19, 20.23it/s] 31%|███████████████████████████████▏                                                                     | 173/561 [00:08<00:19, 20.34it/s] 31%|███████████████████████████████▋                                                                     | 176/561 [00:08<00:18, 20.86it/s] 32%|████████████████████████████████▏                                                                    | 179/561 [00:08<00:17, 21.30it/s] 32%|████████████████████████████████▊                                                                    | 182/561 [00:09<00:17, 21.68it/s] 33%|█████████████████████████████████▎                                                                   | 185/561 [00:09<00:17, 21.94it/s] 34%|█████████████████████████████████▊                                                                   | 188/561 [00:09<00:16, 22.38it/s][2025-03-28 01:22:46,795] [INFO] [logging.py:128:log_dist] [Rank 0] step=5800, skipped=12, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:22:46,796] [INFO] [timer.py:264:stop] epoch=0/micro_step=5800/global_step=5800, RunningAvgSamplesPerSec=17.902397965719622, CurrSamplesPerSec=24.273127176753494, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 34%|██████████████████████████████████▍                                                                  | 191/561 [00:09<00:16, 22.84it/s] 35%|██████████████████████████████████▉                                                                  | 194/561 [00:09<00:15, 23.02it/s] 35%|███████████████████████████████████▍                                                                 | 197/561 [00:09<00:15, 23.07it/s] 36%|████████████████████████████████████                                                                 | 200/561 [00:09<00:15, 22.72it/s] 36%|████████████████████████████████████▌                                                                | 203/561 [00:09<00:15, 22.47it/s] 37%|█████████████████████████████████████                                                                | 206/561 [00:10<00:17, 20.87it/s] 37%|█████████████████████████████████████▋                                                               | 209/561 [00:10<00:16, 21.17it/s] 38%|██████████████████████████████████████▏                                                              | 212/561 [00:10<00:16, 21.49it/s] 38%|██████████████████████████████████████▋                                                              | 215/561 [00:10<00:16, 21.53it/s] 39%|███████████████████████████████████████▏                                                             | 218/561 [00:10<00:16, 21.43it/s] 39%|███████████████████████████████████████▊                                                             | 221/561 [00:10<00:16, 20.74it/s] 40%|████████████████████████████████████████▎                                                            | 224/561 [00:10<00:15, 21.67it/s] 40%|████████████████████████████████████████▊                                                            | 227/561 [00:11<00:15, 21.41it/s] 41%|█████████████████████████████████████████▍                                                           | 230/561 [00:11<00:15, 21.60it/s] 42%|█████████████████████████████████████████▉                                                           | 233/561 [00:11<00:15, 21.47it/s] 42%|██████████████████████████████████████████▍                                                          | 236/561 [00:11<00:15, 21.58it/s] 43%|███████████████████████████████████████████                                                          | 239/561 [00:11<00:15, 20.72it/s][2025-03-28 01:22:49,135] [INFO] [logging.py:128:log_dist] [Rank 0] step=5850, skipped=12, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:22:49,136] [INFO] [timer.py:264:stop] epoch=0/micro_step=5850/global_step=5850, RunningAvgSamplesPerSec=17.927575510298208, CurrSamplesPerSec=19.602739658866046, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 43%|███████████████████████████████████████████▌                                                         | 242/561 [00:11<00:15, 20.62it/s] 44%|████████████████████████████████████████████                                                         | 245/561 [00:11<00:15, 21.03it/s] 44%|████████████████████████████████████████████▋                                                        | 248/561 [00:12<00:15, 20.23it/s] 45%|█████████████████████████████████████████████▏                                                       | 251/561 [00:12<00:14, 20.79it/s] 45%|█████████████████████████████████████████████▋                                                       | 254/561 [00:12<00:14, 21.22it/s] 46%|██████████████████████████████████████████████▎                                                      | 257/561 [00:12<00:14, 21.41it/s] 46%|██████████████████████████████████████████████▊                                                      | 260/561 [00:12<00:13, 21.66it/s] 47%|███████████████████████████████████████████████▎                                                     | 263/561 [00:12<00:13, 22.11it/s] 47%|███████████████████████████████████████████████▉                                                     | 266/561 [00:12<00:14, 21.03it/s] 48%|████████████████████████████████████████████████▍                                                    | 269/561 [00:13<00:13, 21.11it/s] 48%|████████████████████████████████████████████████▉                                                    | 272/561 [00:13<00:13, 21.26it/s] 49%|█████████████████████████████████████████████████▌                                                   | 275/561 [00:13<00:13, 20.71it/s] 50%|██████████████████████████████████████████████████                                                   | 278/561 [00:13<00:13, 20.99it/s] 50%|██████████████████████████████████████████████████▌                                                  | 281/561 [00:13<00:13, 21.47it/s] 51%|███████████████████████████████████████████████████▏                                                 | 284/561 [00:13<00:12, 22.03it/s] 51%|███████████████████████████████████████████████████▋                                                 | 287/561 [00:13<00:12, 22.66it/s][2025-03-28 01:22:51,443] [INFO] [logging.py:128:log_dist] [Rank 0] step=5900, skipped=12, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:22:51,444] [INFO] [timer.py:264:stop] epoch=0/micro_step=5900/global_step=5900, RunningAvgSamplesPerSec=17.954128078586745, CurrSamplesPerSec=23.322913478194685, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 52%|████████████████████████████████████████████████████▏                                                | 290/561 [00:14<00:11, 22.74it/s] 52%|████████████████████████████████████████████████████▊                                                | 293/561 [00:14<00:12, 21.41it/s] 53%|█████████████████████████████████████████████████████▎                                               | 296/561 [00:14<00:13, 19.86it/s] 53%|█████████████████████████████████████████████████████▊                                               | 299/561 [00:14<00:12, 20.21it/s] 54%|██████████████████████████████████████████████████████▎                                              | 302/561 [00:14<00:12, 20.53it/s] 54%|██████████████████████████████████████████████████████▉                                              | 305/561 [00:14<00:12, 21.26it/s] 55%|███████████████████████████████████████████████████████▍                                             | 308/561 [00:14<00:11, 21.96it/s] 55%|███████████████████████████████████████████████████████▉                                             | 311/561 [00:15<00:11, 22.40it/s] 56%|████████████████████████████████████████████████████████▌                                            | 314/561 [00:15<00:10, 22.93it/s] 57%|█████████████████████████████████████████████████████████                                            | 317/561 [00:15<00:10, 22.99it/s] 57%|█████████████████████████████████████████████████████████▌                                           | 320/561 [00:15<00:10, 22.79it/s] 58%|██████████████████████████████████████████████████████████▏                                          | 323/561 [00:15<00:10, 22.45it/s] 58%|██████████████████████████████████████████████████████████▋                                          | 326/561 [00:15<00:10, 22.54it/s] 59%|███████████████████████████████████████████████████████████▏                                         | 329/561 [00:15<00:10, 22.36it/s] 59%|███████████████████████████████████████████████████████████▊                                         | 332/561 [00:15<00:10, 22.11it/s] 60%|████████████████████████████████████████████████████████████▎                                        | 335/561 [00:16<00:10, 22.01it/s] 60%|████████████████████████████████████████████████████████████▊                                        | 338/561 [00:16<00:10, 21.98it/s][2025-03-28 01:22:53,742] [INFO] [logging.py:128:log_dist] [Rank 0] step=5950, skipped=12, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:22:53,743] [INFO] [timer.py:264:stop] epoch=0/micro_step=5950/global_step=5950, RunningAvgSamplesPerSec=17.98083161021945, CurrSamplesPerSec=22.677773658126796, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 61%|█████████████████████████████████████████████████████████████▍                                       | 341/561 [00:16<00:09, 22.14it/s] 61%|█████████████████████████████████████████████████████████████▉                                       | 344/561 [00:16<00:09, 22.24it/s] 62%|██████████████████████████████████████████████████████████████▍                                      | 347/561 [00:16<00:09, 22.09it/s] 62%|███████████████████████████████████████████████████████████████                                      | 350/561 [00:16<00:09, 22.33it/s] 63%|███████████████████████████████████████████████████████████████▌                                     | 353/561 [00:16<00:09, 22.82it/s] 63%|████████████████████████████████████████████████████████████████                                     | 356/561 [00:17<00:08, 23.16it/s] 64%|████████████████████████████████████████████████████████████████▋                                    | 359/561 [00:17<00:08, 23.11it/s] 65%|█████████████████████████████████████████████████████████████████▏                                   | 362/561 [00:17<00:08, 22.70it/s] 65%|█████████████████████████████████████████████████████████████████▋                                   | 365/561 [00:17<00:08, 22.48it/s] 66%|██████████████████████████████████████████████████████████████████▎                                  | 368/561 [00:17<00:08, 22.13it/s] 66%|██████████████████████████████████████████████████████████████████▊                                  | 371/561 [00:17<00:08, 22.10it/s] 67%|███████████████████████████████████████████████████████████████████▎                                 | 374/561 [00:17<00:08, 22.09it/s] 67%|███████████████████████████████████████████████████████████████████▊                                 | 377/561 [00:18<00:08, 21.73it/s] 68%|████████████████████████████████████████████████████████████████████▍                                | 380/561 [00:18<00:08, 21.62it/s] 68%|████████████████████████████████████████████████████████████████████▉                                | 383/561 [00:18<00:08, 22.17it/s] 69%|█████████████████████████████████████████████████████████████████████▍                               | 386/561 [00:18<00:07, 22.66it/s] 69%|██████████████████████████████████████████████████████████████████████                               | 389/561 [00:18<00:07, 22.97it/s][2025-03-28 01:22:55,963] [INFO] [logging.py:128:log_dist] [Rank 0] step=6000, skipped=12, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:22:55,963] [INFO] [timer.py:264:stop] epoch=0/micro_step=6000/global_step=6000, RunningAvgSamplesPerSec=18.011394374912147, CurrSamplesPerSec=23.297910187374583, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 70%|██████████████████████████████████████████████████████████████████████▌                              | 392/561 [00:18<00:07, 23.08it/s] 70%|███████████████████████████████████████████████████████████████████████                              | 395/561 [00:18<00:07, 23.11it/s] 71%|███████████████████████████████████████████████████████████████████████▋                             | 398/561 [00:18<00:07, 22.86it/s] 71%|████████████████████████████████████████████████████████████████████████▏                            | 401/561 [00:19<00:07, 22.59it/s][2025-03-28 01:22:56,539] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2025-03-28 01:22:56,586] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
 72%|████████████████████████████████████████████████████████████████████████▋                            | 404/561 [00:19<00:07, 22.31it/s] 73%|█████████████████████████████████████████████████████████████████████████▎                           | 407/561 [00:19<00:06, 22.07it/s] 73%|█████████████████████████████████████████████████████████████████████████▊                           | 410/561 [00:19<00:06, 22.16it/s] 74%|██████████████████████████████████████████████████████████████████████████▎                          | 413/561 [00:19<00:06, 22.15it/s] 74%|██████████████████████████████████████████████████████████████████████████▉                          | 416/561 [00:19<00:06, 22.19it/s] 75%|███████████████████████████████████████████████████████████████████████████▍                         | 419/561 [00:19<00:06, 22.13it/s] 75%|███████████████████████████████████████████████████████████████████████████▉                         | 422/561 [00:20<00:06, 21.95it/s] 76%|████████████████████████████████████████████████████████████████████████████▌                        | 425/561 [00:20<00:06, 22.16it/s] 76%|█████████████████████████████████████████████████████████████████████████████                        | 428/561 [00:20<00:05, 22.46it/s] 77%|█████████████████████████████████████████████████████████████████████████████▌                       | 431/561 [00:20<00:05, 22.39it/s] 77%|██████████████████████████████████████████████████████████████████████████████▏                      | 434/561 [00:20<00:05, 22.57it/s] 78%|██████████████████████████████████████████████████████████████████████████████▋                      | 437/561 [00:20<00:05, 22.05it/s][2025-03-28 01:22:58,217] [INFO] [logging.py:128:log_dist] [Rank 0] step=6050, skipped=14, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:22:58,220] [INFO] [timer.py:264:stop] epoch=0/micro_step=6050/global_step=6050, RunningAvgSamplesPerSec=18.039601660737475, CurrSamplesPerSec=20.148243208095955, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 78%|███████████████████████████████████████████████████████████████████████████████▏                     | 440/561 [00:20<00:05, 21.70it/s] 79%|███████████████████████████████████████████████████████████████████████████████▊                     | 443/561 [00:20<00:05, 22.18it/s] 80%|████████████████████████████████████████████████████████████████████████████████▎                    | 446/561 [00:21<00:05, 22.38it/s] 80%|████████████████████████████████████████████████████████████████████████████████▊                    | 449/561 [00:21<00:05, 22.30it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▍                   | 452/561 [00:21<00:04, 22.59it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▉                   | 455/561 [00:21<00:04, 22.39it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▍                  | 458/561 [00:21<00:04, 22.21it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▉                  | 461/561 [00:21<00:04, 22.73it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▌                 | 464/561 [00:21<00:04, 23.24it/s] 83%|████████████████████████████████████████████████████████████████████████████████████                 | 467/561 [00:22<00:04, 23.19it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▌                | 470/561 [00:22<00:03, 22.93it/s] 84%|█████████████████████████████████████████████████████████████████████████████████████▏               | 473/561 [00:22<00:03, 22.71it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▋               | 476/561 [00:22<00:03, 22.36it/s] 85%|██████████████████████████████████████████████████████████████████████████████████████▏              | 479/561 [00:22<00:03, 22.13it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▊              | 482/561 [00:22<00:03, 22.21it/s] 86%|███████████████████████████████████████████████████████████████████████████████████████▎             | 485/561 [00:22<00:03, 22.72it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▊             | 488/561 [00:22<00:03, 23.03it/s][2025-03-28 01:23:00,413] [INFO] [logging.py:128:log_dist] [Rank 0] step=6100, skipped=14, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:23:00,414] [INFO] [timer.py:264:stop] epoch=0/micro_step=6100/global_step=6100, RunningAvgSamplesPerSec=18.07081299695893, CurrSamplesPerSec=23.121700031208192, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 88%|████████████████████████████████████████████████████████████████████████████████████████▍            | 491/561 [00:23<00:03, 23.13it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▉            | 494/561 [00:23<00:02, 22.74it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▍           | 497/561 [00:23<00:02, 22.82it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████           | 500/561 [00:23<00:02, 22.56it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▌          | 503/561 [00:23<00:02, 22.66it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████████          | 506/561 [00:23<00:02, 22.92it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▋         | 509/561 [00:23<00:02, 23.19it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████████▏        | 512/561 [00:23<00:02, 22.82it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████████▋        | 515/561 [00:24<00:02, 22.62it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████▎       | 518/561 [00:24<00:01, 22.49it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▊       | 521/561 [00:24<00:01, 22.37it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████████▎      | 524/561 [00:24<00:01, 22.44it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▉      | 527/561 [00:24<00:01, 21.38it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▍     | 530/561 [00:24<00:01, 21.73it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▉     | 533/561 [00:24<00:01, 20.73it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▍    | 536/561 [00:25<00:01, 21.27it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████    | 539/561 [00:25<00:01, 21.60it/s][2025-03-28 01:23:02,679] [INFO] [logging.py:128:log_dist] [Rank 0] step=6150, skipped=14, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:23:02,680] [INFO] [timer.py:264:stop] epoch=0/micro_step=6150/global_step=6150, RunningAvgSamplesPerSec=18.097768623408147, CurrSamplesPerSec=22.554242021996387, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 97%|█████████████████████████████████████████████████████████████████████████████████████████████████▌   | 542/561 [00:25<00:00, 21.74it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████████   | 545/561 [00:25<00:00, 22.17it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▋  | 548/561 [00:25<00:00, 22.62it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████████▏ | 551/561 [00:25<00:00, 22.42it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▋ | 554/561 [00:25<00:00, 22.33it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████▎| 557/561 [00:26<00:00, 22.22it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████████▊| 560/561 [00:26<00:00, 22.57it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:26<00:00, 21.35it/s]
  0%|                                                                                                               | 0/561 [00:00<?, ?it/s]  0%|▏                                                                                                      | 1/561 [00:00<02:03,  4.53it/s]  1%|▋                                                                                                      | 4/561 [00:00<00:44, 12.53it/s]  1%|█▎                                                                                                     | 7/561 [00:00<00:33, 16.33it/s]  2%|█▊                                                                                                    | 10/561 [00:00<00:29, 18.52it/s]  2%|██▎                                                                                                   | 13/561 [00:00<00:27, 19.75it/s]  3%|██▉                                                                                                   | 16/561 [00:00<00:26, 20.19it/s]  3%|███▍                                                                                                  | 19/561 [00:01<00:26, 20.66it/s]  4%|████                                                                                                  | 22/561 [00:01<00:25, 21.18it/s]  4%|████▌                                                                                                 | 25/561 [00:01<00:24, 21.70it/s]  5%|█████                                                                                                 | 28/561 [00:01<00:24, 21.84it/s][2025-03-28 01:23:05,183] [INFO] [logging.py:128:log_dist] [Rank 0] step=6200, skipped=14, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:23:05,184] [INFO] [timer.py:264:stop] epoch=0/micro_step=6200/global_step=6200, RunningAvgSamplesPerSec=18.119342930327694, CurrSamplesPerSec=21.07857870154306, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
  6%|█████▋                                                                                                | 31/561 [00:01<00:24, 21.79it/s]  6%|██████▏                                                                                               | 34/561 [00:01<00:24, 21.72it/s]  7%|██████▋                                                                                               | 37/561 [00:01<00:24, 21.41it/s]  7%|███████▎                                                                                              | 40/561 [00:02<00:24, 21.62it/s]  8%|███████▊                                                                                              | 43/561 [00:02<00:23, 22.30it/s]  8%|████████▎                                                                                             | 46/561 [00:02<00:22, 22.79it/s]  9%|████████▉                                                                                             | 49/561 [00:02<00:22, 22.97it/s]  9%|█████████▍                                                                                            | 52/561 [00:02<00:22, 22.66it/s] 10%|██████████                                                                                            | 55/561 [00:02<00:22, 22.39it/s] 10%|██████████▌                                                                                           | 58/561 [00:02<00:22, 22.16it/s] 11%|███████████                                                                                           | 61/561 [00:02<00:22, 22.10it/s] 11%|███████████▋                                                                                          | 64/561 [00:03<00:21, 22.66it/s] 12%|████████████▏                                                                                         | 67/561 [00:03<00:21, 22.72it/s] 12%|████████████▋                                                                                         | 70/561 [00:03<00:21, 22.92it/s] 13%|█████████████▎                                                                                        | 73/561 [00:03<00:20, 23.34it/s] 14%|█████████████▊                                                                                        | 76/561 [00:03<00:20, 23.35it/s][2025-03-28 01:23:07,382] [INFO] [logging.py:128:log_dist] [Rank 0] step=6250, skipped=14, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:23:07,383] [INFO] [timer.py:264:stop] epoch=0/micro_step=6250/global_step=6250, RunningAvgSamplesPerSec=18.149133858518454, CurrSamplesPerSec=22.752445572751174, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 14%|██████████████▎                                                                                       | 79/561 [00:03<00:20, 23.45it/s] 15%|██████████████▉                                                                                       | 82/561 [00:03<00:20, 22.88it/s] 15%|███████████████▍                                                                                      | 85/561 [00:03<00:21, 22.46it/s] 16%|████████████████                                                                                      | 88/561 [00:04<00:21, 22.35it/s] 16%|████████████████▌                                                                                     | 91/561 [00:04<00:21, 22.18it/s] 17%|█████████████████                                                                                     | 94/561 [00:04<00:21, 22.12it/s] 17%|█████████████████▋                                                                                    | 97/561 [00:04<00:20, 22.20it/s] 18%|██████████████████                                                                                   | 100/561 [00:04<00:20, 22.23it/s] 18%|██████████████████▌                                                                                  | 103/561 [00:04<00:20, 22.19it/s] 19%|███████████████████                                                                                  | 106/561 [00:04<00:21, 21.66it/s] 19%|███████████████████▌                                                                                 | 109/561 [00:05<00:20, 21.94it/s] 20%|████████████████████▏                                                                                | 112/561 [00:05<00:19, 22.62it/s] 20%|████████████████████▋                                                                                | 115/561 [00:05<00:19, 22.81it/s] 21%|█████████████████████▏                                                                               | 118/561 [00:05<00:19, 22.95it/s] 22%|█████████████████████▊                                                                               | 121/561 [00:05<00:19, 23.13it/s] 22%|██████████████████████▎                                                                              | 124/561 [00:05<00:18, 23.43it/s] 23%|██████████████████████▊                                                                              | 127/561 [00:05<00:19, 22.52it/s][2025-03-28 01:23:09,626] [INFO] [logging.py:128:log_dist] [Rank 0] step=6300, skipped=14, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:23:09,626] [INFO] [timer.py:264:stop] epoch=0/micro_step=6300/global_step=6300, RunningAvgSamplesPerSec=18.176228235194124, CurrSamplesPerSec=21.20550211426146, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 23%|███████████████████████▍                                                                             | 130/561 [00:05<00:19, 22.16it/s] 24%|███████████████████████▉                                                                             | 133/561 [00:06<00:19, 22.15it/s] 24%|████████████████████████▍                                                                            | 136/561 [00:06<00:19, 22.17it/s] 25%|█████████████████████████                                                                            | 139/561 [00:06<00:19, 21.84it/s] 25%|█████████████████████████▌                                                                           | 142/561 [00:06<00:18, 22.16it/s] 26%|██████████████████████████                                                                           | 145/561 [00:06<00:19, 21.06it/s] 26%|██████████████████████████▋                                                                          | 148/561 [00:06<00:19, 21.28it/s] 27%|███████████████████████████▏                                                                         | 151/561 [00:06<00:19, 20.64it/s] 27%|███████████████████████████▋                                                                         | 154/561 [00:07<00:19, 21.34it/s] 28%|████████████████████████████▎                                                                        | 157/561 [00:07<00:18, 21.98it/s] 29%|████████████████████████████▊                                                                        | 160/561 [00:07<00:17, 22.45it/s] 29%|█████████████████████████████▎                                                                       | 163/561 [00:07<00:17, 23.01it/s] 30%|█████████████████████████████▉                                                                       | 166/561 [00:07<00:17, 23.11it/s] 30%|██████████████████████████████▍                                                                      | 169/561 [00:07<00:16, 23.39it/s] 31%|██████████████████████████████▉                                                                      | 172/561 [00:07<00:16, 23.50it/s] 31%|███████████████████████████████▌                                                                     | 175/561 [00:08<00:17, 22.30it/s] 32%|████████████████████████████████                                                                     | 178/561 [00:08<00:17, 22.24it/s][2025-03-28 01:23:11,882] [INFO] [logging.py:128:log_dist] [Rank 0] step=6350, skipped=14, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:23:11,883] [INFO] [timer.py:264:stop] epoch=0/micro_step=6350/global_step=6350, RunningAvgSamplesPerSec=18.202305711556317, CurrSamplesPerSec=23.269216141370794, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 32%|████████████████████████████████▌                                                                    | 181/561 [00:08<00:17, 22.29it/s] 33%|█████████████████████████████████▏                                                                   | 184/561 [00:08<00:16, 22.25it/s] 33%|█████████████████████████████████▋                                                                   | 187/561 [00:08<00:16, 22.05it/s] 34%|██████████████████████████████████▏                                                                  | 190/561 [00:08<00:16, 22.45it/s] 34%|██████████████████████████████████▋                                                                  | 193/561 [00:08<00:16, 22.67it/s] 35%|███████████████████████████████████▎                                                                 | 196/561 [00:08<00:15, 22.88it/s] 35%|███████████████████████████████████▊                                                                 | 199/561 [00:09<00:15, 23.17it/s] 36%|████████████████████████████████████▎                                                                | 202/561 [00:09<00:15, 23.23it/s] 37%|████████████████████████████████████▉                                                                | 205/561 [00:09<00:15, 23.36it/s] 37%|█████████████████████████████████████▍                                                               | 208/561 [00:09<00:14, 23.57it/s] 38%|█████████████████████████████████████▉                                                               | 211/561 [00:09<00:14, 23.58it/s] 38%|██████████████████████████████████████▌                                                              | 214/561 [00:09<00:15, 22.14it/s] 39%|███████████████████████████████████████                                                              | 217/561 [00:09<00:15, 21.63it/s] 39%|███████████████████████████████████████▌                                                             | 220/561 [00:10<00:15, 21.33it/s] 40%|████████████████████████████████████████▏                                                            | 223/561 [00:10<00:16, 21.06it/s] 40%|████████████████████████████████████████▋                                                            | 226/561 [00:10<00:16, 20.52it/s][2025-03-28 01:23:14,159] [INFO] [logging.py:128:log_dist] [Rank 0] step=6400, skipped=14, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:23:14,159] [INFO] [timer.py:264:stop] epoch=0/micro_step=6400/global_step=6400, RunningAvgSamplesPerSec=18.2269747829829, CurrSamplesPerSec=21.65571115498526, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 41%|█████████████████████████████████████████▏                                                           | 229/561 [00:10<00:16, 20.52it/s] 41%|█████████████████████████████████████████▊                                                           | 232/561 [00:10<00:16, 20.53it/s] 42%|██████████████████████████████████████████▎                                                          | 235/561 [00:10<00:15, 20.53it/s] 42%|██████████████████████████████████████████▊                                                          | 238/561 [00:10<00:15, 20.29it/s] 43%|███████████████████████████████████████████▍                                                         | 241/561 [00:11<00:15, 20.37it/s] 43%|███████████████████████████████████████████▉                                                         | 244/561 [00:11<00:15, 20.36it/s] 44%|████████████████████████████████████████████▍                                                        | 247/561 [00:11<00:15, 19.95it/s] 44%|████████████████████████████████████████████▊                                                        | 249/561 [00:11<00:15, 19.65it/s] 45%|█████████████████████████████████████████████▏                                                       | 251/561 [00:11<00:16, 19.37it/s] 45%|█████████████████████████████████████████████▌                                                       | 253/561 [00:11<00:16, 19.18it/s] 45%|█████████████████████████████████████████████▉                                                       | 255/561 [00:11<00:16, 19.03it/s] 46%|██████████████████████████████████████████████▎                                                      | 257/561 [00:11<00:16, 18.73it/s] 46%|██████████████████████████████████████████████▋                                                      | 259/561 [00:12<00:15, 18.90it/s] 47%|██████████████████████████████████████████████▉                                                      | 261/561 [00:12<00:15, 18.83it/s] 47%|███████████████████████████████████████████████▎                                                     | 263/561 [00:12<00:15, 18.79it/s] 47%|███████████████████████████████████████████████▋                                                     | 265/561 [00:12<00:15, 18.77it/s] 48%|████████████████████████████████████████████████                                                     | 267/561 [00:12<00:15, 18.74it/s] 48%|████████████████████████████████████████████████▍                                                    | 269/561 [00:12<00:15, 18.72it/s] 48%|████████████████████████████████████████████████▊                                                    | 271/561 [00:12<00:15, 18.71it/s] 49%|█████████████████████████████████████████████████▏                                                   | 273/561 [00:12<00:15, 18.69it/s] 49%|█████████████████████████████████████████████████▌                                                   | 275/561 [00:12<00:15, 18.70it/s] 49%|█████████████████████████████████████████████████▊                                                   | 277/561 [00:12<00:15, 18.13it/s][2025-03-28 01:23:16,768] [INFO] [logging.py:128:log_dist] [Rank 0] step=6450, skipped=14, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:23:16,769] [INFO] [timer.py:264:stop] epoch=0/micro_step=6450/global_step=6450, RunningAvgSamplesPerSec=18.234189096492255, CurrSamplesPerSec=20.870382719728696, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 50%|██████████████████████████████████████████████████▍                                                  | 280/561 [00:13<00:14, 19.24it/s] 50%|██████████████████████████████████████████████████▉                                                  | 283/561 [00:13<00:13, 20.13it/s] 51%|███████████████████████████████████████████████████▍                                                 | 286/561 [00:13<00:13, 19.91it/s] 51%|███████████████████████████████████████████████████▊                                                 | 288/561 [00:13<00:14, 19.42it/s] 52%|████████████████████████████████████████████████████▏                                                | 290/561 [00:13<00:14, 19.06it/s] 52%|████████████████████████████████████████████████████▌                                                | 292/561 [00:13<00:14, 18.78it/s] 52%|████████████████████████████████████████████████████▉                                                | 294/561 [00:13<00:14, 18.57it/s] 53%|█████████████████████████████████████████████████████▎                                               | 296/561 [00:13<00:14, 18.42it/s] 53%|█████████████████████████████████████████████████████▋                                               | 298/561 [00:14<00:14, 18.32it/s] 53%|██████████████████████████████████████████████████████                                               | 300/561 [00:14<00:14, 18.24it/s] 54%|██████████████████████████████████████████████████████▎                                              | 302/561 [00:14<00:14, 18.20it/s] 54%|██████████████████████████████████████████████████████▋                                              | 304/561 [00:14<00:13, 18.52it/s] 55%|███████████████████████████████████████████████████████▎                                             | 307/561 [00:14<00:12, 19.93it/s] 55%|███████████████████████████████████████████████████████▊                                             | 310/561 [00:14<00:12, 20.37it/s] 56%|████████████████████████████████████████████████████████▎                                            | 313/561 [00:14<00:12, 20.59it/s] 56%|████████████████████████████████████████████████████████▉                                            | 316/561 [00:14<00:11, 21.16it/s] 57%|█████████████████████████████████████████████████████████▍                                           | 319/561 [00:15<00:11, 21.12it/s] 57%|█████████████████████████████████████████████████████████▉                                           | 322/561 [00:15<00:11, 21.67it/s] 58%|██████████████████████████████████████████████████████████▌                                          | 325/561 [00:15<00:10, 22.32it/s] 58%|███████████████████████████████████████████████████████████                                          | 328/561 [00:15<00:10, 22.62it/s][2025-03-28 01:23:19,213] [INFO] [logging.py:128:log_dist] [Rank 0] step=6500, skipped=14, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:23:19,214] [INFO] [timer.py:264:stop] epoch=0/micro_step=6500/global_step=6500, RunningAvgSamplesPerSec=18.249700260958996, CurrSamplesPerSec=23.36188541959393, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 59%|███████████████████████████████████████████████████████████▌                                         | 331/561 [00:15<00:10, 21.57it/s] 60%|████████████████████████████████████████████████████████████▏                                        | 334/561 [00:15<00:11, 20.36it/s] 60%|████████████████████████████████████████████████████████████▋                                        | 337/561 [00:15<00:11, 19.60it/s] 60%|█████████████████████████████████████████████████████████████                                        | 339/561 [00:16<00:11, 19.22it/s] 61%|█████████████████████████████████████████████████████████████▍                                       | 341/561 [00:16<00:11, 18.92it/s] 61%|█████████████████████████████████████████████████████████████▊                                       | 343/561 [00:16<00:11, 18.53it/s] 61%|██████████████████████████████████████████████████████████████                                       | 345/561 [00:16<00:11, 18.41it/s] 62%|██████████████████████████████████████████████████████████████▍                                      | 347/561 [00:16<00:11, 18.31it/s] 62%|██████████████████████████████████████████████████████████████▊                                      | 349/561 [00:16<00:11, 18.62it/s] 63%|███████████████████████████████████████████████████████████████▎                                     | 352/561 [00:16<00:10, 20.26it/s] 63%|███████████████████████████████████████████████████████████████▉                                     | 355/561 [00:16<00:09, 21.01it/s] 64%|████████████████████████████████████████████████████████████████▍                                    | 358/561 [00:17<00:09, 21.23it/s] 64%|████████████████████████████████████████████████████████████████▉                                    | 361/561 [00:17<00:09, 21.16it/s] 65%|█████████████████████████████████████████████████████████████████▌                                   | 364/561 [00:17<00:09, 20.05it/s] 65%|██████████████████████████████████████████████████████████████████                                   | 367/561 [00:17<00:10, 19.37it/s] 66%|██████████████████████████████████████████████████████████████████▍                                  | 369/561 [00:17<00:10, 19.05it/s] 66%|██████████████████████████████████████████████████████████████████▊                                  | 371/561 [00:17<00:10, 18.79it/s] 66%|███████████████████████████████████████████████████████████████████▏                                 | 373/561 [00:17<00:10, 18.59it/s] 67%|███████████████████████████████████████████████████████████████████▌                                 | 375/561 [00:17<00:10, 18.43it/s] 67%|███████████████████████████████████████████████████████████████████▊                                 | 377/561 [00:18<00:10, 18.32it/s][2025-03-28 01:23:21,854] [INFO] [logging.py:128:log_dist] [Rank 0] step=6550, skipped=14, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:23:21,857] [INFO] [timer.py:264:stop] epoch=0/micro_step=6550/global_step=6550, RunningAvgSamplesPerSec=18.254897775024798, CurrSamplesPerSec=18.067044391179085, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 68%|████████████████████████████████████████████████████████████████████▏                                | 379/561 [00:18<00:09, 18.22it/s] 68%|████████████████████████████████████████████████████████████████████▊                                | 382/561 [00:18<00:09, 19.60it/s] 69%|█████████████████████████████████████████████████████████████████████▎                               | 385/561 [00:18<00:08, 20.41it/s] 69%|█████████████████████████████████████████████████████████████████████▊                               | 388/561 [00:18<00:08, 21.05it/s] 70%|██████████████████████████████████████████████████████████████████████▍                              | 391/561 [00:18<00:07, 21.34it/s] 70%|██████████████████████████████████████████████████████████████████████▉                              | 394/561 [00:18<00:07, 21.73it/s] 71%|███████████████████████████████████████████████████████████████████████▍                             | 397/561 [00:19<00:07, 20.55it/s] 71%|████████████████████████████████████████████████████████████████████████                             | 400/561 [00:19<00:08, 19.71it/s] 72%|████████████████████████████████████████████████████████████████████████▎                            | 402/561 [00:19<00:08, 19.31it/s] 72%|████████████████████████████████████████████████████████████████████████▋                            | 404/561 [00:19<00:08, 18.99it/s] 72%|█████████████████████████████████████████████████████████████████████████                            | 406/561 [00:19<00:08, 18.73it/s] 73%|█████████████████████████████████████████████████████████████████████████▍                           | 408/561 [00:19<00:08, 18.54it/s] 73%|█████████████████████████████████████████████████████████████████████████▊                           | 410/561 [00:19<00:08, 18.41it/s] 73%|██████████████████████████████████████████████████████████████████████████▏                          | 412/561 [00:19<00:08, 18.31it/s] 74%|██████████████████████████████████████████████████████████████████████████▌                          | 414/561 [00:19<00:07, 18.57it/s] 74%|███████████████████████████████████████████████████████████████████████████                          | 417/561 [00:20<00:07, 19.90it/s] 75%|███████████████████████████████████████████████████████████████████████████▌                         | 420/561 [00:20<00:06, 20.63it/s] 75%|████████████████████████████████████████████████████████████████████████████▏                        | 423/561 [00:20<00:06, 21.00it/s] 76%|████████████████████████████████████████████████████████████████████████████▋                        | 426/561 [00:20<00:06, 21.30it/s][2025-03-28 01:23:24,305] [INFO] [logging.py:128:log_dist] [Rank 0] step=6600, skipped=14, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:23:24,306] [INFO] [timer.py:264:stop] epoch=0/micro_step=6600/global_step=6600, RunningAvgSamplesPerSec=18.269871224313846, CurrSamplesPerSec=22.52638160548859, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 76%|█████████████████████████████████████████████████████████████████████████████▏                       | 429/561 [00:20<00:06, 21.61it/s] 77%|█████████████████████████████████████████████████████████████████████████████▊                       | 432/561 [00:20<00:05, 21.79it/s] 78%|██████████████████████████████████████████████████████████████████████████████▎                      | 435/561 [00:20<00:05, 21.95it/s] 78%|██████████████████████████████████████████████████████████████████████████████▊                      | 438/561 [00:21<00:05, 21.01it/s] 79%|███████████████████████████████████████████████████████████████████████████████▍                     | 441/561 [00:21<00:05, 20.01it/s] 79%|███████████████████████████████████████████████████████████████████████████████▉                     | 444/561 [00:21<00:06, 19.38it/s] 80%|████████████████████████████████████████████████████████████████████████████████▎                    | 446/561 [00:21<00:06, 19.07it/s] 80%|████████████████████████████████████████████████████████████████████████████████▋                    | 448/561 [00:21<00:06, 18.81it/s] 80%|█████████████████████████████████████████████████████████████████████████████████                    | 450/561 [00:21<00:05, 18.63it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▍                   | 452/561 [00:21<00:05, 18.49it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▋                   | 454/561 [00:21<00:05, 18.38it/s] 81%|██████████████████████████████████████████████████████████████████████████████████                   | 456/561 [00:22<00:05, 18.60it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▋                  | 459/561 [00:22<00:05, 20.19it/s] 82%|███████████████████████████████████████████████████████████████████████████████████▏                 | 462/561 [00:22<00:04, 20.61it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▋                 | 465/561 [00:22<00:04, 21.14it/s] 83%|████████████████████████████████████████████████████████████████████████████████████▎                | 468/561 [00:22<00:04, 21.61it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▊                | 471/561 [00:22<00:04, 22.17it/s] 84%|█████████████████████████████████████████████████████████████████████████████████████▎               | 474/561 [00:22<00:04, 21.62it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▉               | 477/561 [00:23<00:04, 20.39it/s][2025-03-28 01:23:26,804] [INFO] [logging.py:128:log_dist] [Rank 0] step=6650, skipped=14, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:23:26,807] [INFO] [timer.py:264:stop] epoch=0/micro_step=6650/global_step=6650, RunningAvgSamplesPerSec=18.281993365956808, CurrSamplesPerSec=18.15352991480711, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 86%|██████████████████████████████████████████████████████████████████████████████████████▍              | 480/561 [00:23<00:04, 20.25it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▉              | 483/561 [00:23<00:03, 19.53it/s] 86%|███████████████████████████████████████████████████████████████████████████████████████▎             | 485/561 [00:23<00:03, 19.18it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▋             | 487/561 [00:23<00:03, 18.89it/s] 87%|████████████████████████████████████████████████████████████████████████████████████████             | 489/561 [00:23<00:03, 18.73it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▍            | 491/561 [00:23<00:03, 18.56it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▊            | 493/561 [00:23<00:03, 18.43it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████████▎           | 496/561 [00:24<00:03, 19.66it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▊           | 499/561 [00:24<00:03, 20.30it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████▍          | 502/561 [00:24<00:02, 21.19it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▉          | 505/561 [00:24<00:02, 22.07it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▍         | 508/561 [00:24<00:02, 22.61it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▉         | 511/561 [00:24<00:02, 22.80it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████████▌        | 514/561 [00:24<00:02, 22.52it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████        | 517/561 [00:24<00:01, 22.36it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▌       | 520/561 [00:25<00:01, 22.20it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████████▏      | 523/561 [00:25<00:01, 20.87it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▋      | 526/561 [00:25<00:01, 19.92it/s][2025-03-28 01:23:29,251] [INFO] [logging.py:128:log_dist] [Rank 0] step=6700, skipped=14, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:23:29,254] [INFO] [timer.py:264:stop] epoch=0/micro_step=6700/global_step=6700, RunningAvgSamplesPerSec=18.29664184456864, CurrSamplesPerSec=18.057788063510074, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 94%|███████████████████████████████████████████████████████████████████████████████████████████████▏     | 529/561 [00:25<00:01, 19.30it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▌     | 531/561 [00:25<00:01, 19.01it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▉     | 533/561 [00:25<00:01, 18.76it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████████▎    | 535/561 [00:25<00:01, 18.08it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▋    | 537/561 [00:26<00:01, 18.07it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████    | 539/561 [00:26<00:01, 18.06it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████████▌   | 542/561 [00:26<00:00, 19.40it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████████▉   | 544/561 [00:26<00:00, 19.30it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▍  | 547/561 [00:26<00:00, 20.09it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████████  | 550/561 [00:26<00:00, 20.71it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▌ | 553/561 [00:26<00:00, 21.18it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████ | 556/561 [00:26<00:00, 21.47it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████████▋| 559/561 [00:27<00:00, 21.69it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:27<00:00, 20.62it/s]
  0%|                                                                                                               | 0/561 [00:00<?, ?it/s]  0%|▏                                                                                                      | 1/561 [00:00<01:48,  5.15it/s]  1%|▋                                                                                                      | 4/561 [00:00<00:41, 13.42it/s]  1%|█▎                                                                                                     | 7/561 [00:00<00:34, 16.11it/s]  2%|█▋                                                                                                     | 9/561 [00:00<00:33, 16.70it/s]  2%|██                                                                                                    | 11/561 [00:00<00:32, 17.10it/s]  2%|██▎                                                                                                   | 13/561 [00:00<00:31, 17.37it/s]  3%|██▋                                                                                                   | 15/561 [00:00<00:31, 17.57it/s]  3%|███                                                                                                   | 17/561 [00:01<00:30, 17.70it/s][2025-03-28 01:23:32,015] [INFO] [logging.py:128:log_dist] [Rank 0] step=6750, skipped=14, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:23:32,019] [INFO] [timer.py:264:stop] epoch=0/micro_step=6750/global_step=6750, RunningAvgSamplesPerSec=18.302716985112173, CurrSamplesPerSec=18.0933873035385, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
  3%|███▍                                                                                                  | 19/561 [00:01<00:30, 17.80it/s]  4%|███▊                                                                                                  | 21/561 [00:01<00:30, 17.88it/s]  4%|████▏                                                                                                 | 23/561 [00:01<00:30, 17.92it/s]  4%|████▌                                                                                                 | 25/561 [00:01<00:29, 17.95it/s]  5%|█████                                                                                                 | 28/561 [00:01<00:27, 19.72it/s]  5%|█████▍                                                                                                | 30/561 [00:01<00:27, 19.63it/s]  6%|██████                                                                                                | 33/561 [00:01<00:26, 20.26it/s]  6%|██████▌                                                                                               | 36/561 [00:01<00:25, 20.91it/s]  7%|███████                                                                                               | 39/561 [00:02<00:25, 20.16it/s]  7%|███████▋                                                                                              | 42/561 [00:02<00:24, 20.76it/s]  8%|████████▏                                                                                             | 45/561 [00:02<00:24, 21.20it/s]  9%|████████▋                                                                                             | 48/561 [00:02<00:23, 21.78it/s]  9%|█████████▎                                                                                            | 51/561 [00:02<00:22, 22.22it/s] 10%|█████████▊                                                                                            | 54/561 [00:02<00:22, 22.76it/s] 10%|██████████▎                                                                                           | 57/561 [00:02<00:21, 23.13it/s] 11%|██████████▉                                                                                           | 60/561 [00:03<00:21, 23.19it/s] 11%|███████████▍                                                                                          | 63/561 [00:03<00:21, 23.19it/s] 12%|████████████                                                                                          | 66/561 [00:03<00:23, 21.46it/s][2025-03-28 01:23:34,381] [INFO] [logging.py:128:log_dist] [Rank 0] step=6800, skipped=14, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:23:34,384] [INFO] [timer.py:264:stop] epoch=0/micro_step=6800/global_step=6800, RunningAvgSamplesPerSec=18.321090648831632, CurrSamplesPerSec=18.026511330775, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 12%|████████████▌                                                                                         | 69/561 [00:03<00:24, 20.30it/s] 13%|█████████████                                                                                         | 72/561 [00:03<00:25, 19.55it/s] 13%|█████████████▍                                                                                        | 74/561 [00:03<00:25, 19.19it/s] 14%|█████████████▊                                                                                        | 76/561 [00:03<00:25, 18.90it/s] 14%|██████████████▏                                                                                       | 78/561 [00:04<00:25, 18.68it/s] 14%|██████████████▌                                                                                       | 80/561 [00:04<00:25, 18.52it/s] 15%|██████████████▉                                                                                       | 82/561 [00:04<00:26, 18.38it/s] 15%|███████████████▍                                                                                      | 85/561 [00:04<00:24, 19.51it/s] 16%|████████████████                                                                                      | 88/561 [00:04<00:23, 20.23it/s] 16%|████████████████▌                                                                                     | 91/561 [00:04<00:22, 20.63it/s] 17%|█████████████████                                                                                     | 94/561 [00:04<00:21, 21.29it/s] 17%|█████████████████▋                                                                                    | 97/561 [00:04<00:21, 21.51it/s] 18%|██████████████████                                                                                   | 100/561 [00:05<00:21, 21.64it/s] 18%|██████████████████▌                                                                                  | 103/561 [00:05<00:21, 21.78it/s] 19%|███████████████████                                                                                  | 106/561 [00:05<00:20, 21.95it/s] 19%|███████████████████▌                                                                                 | 109/561 [00:05<00:20, 22.01it/s] 20%|████████████████████▏                                                                                | 112/561 [00:05<00:19, 22.47it/s] 20%|████████████████████▋                                                                                | 115/561 [00:05<00:19, 22.93it/s][2025-03-28 01:23:36,764] [INFO] [logging.py:128:log_dist] [Rank 0] step=6850, skipped=14, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:23:36,764] [INFO] [timer.py:264:stop] epoch=0/micro_step=6850/global_step=6850, RunningAvgSamplesPerSec=18.338464425202453, CurrSamplesPerSec=23.810277162543816, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 21%|█████████████████████▏                                                                               | 118/561 [00:05<00:19, 23.09it/s] 22%|█████████████████████▊                                                                               | 121/561 [00:05<00:18, 23.38it/s] 22%|██████████████████████▎                                                                              | 124/561 [00:06<00:18, 23.31it/s] 23%|██████████████████████▊                                                                              | 127/561 [00:06<00:20, 21.42it/s] 23%|███████████████████████▍                                                                             | 130/561 [00:06<00:21, 20.29it/s] 24%|███████████████████████▉                                                                             | 133/561 [00:06<00:21, 19.55it/s] 24%|████████████████████████▎                                                                            | 135/561 [00:06<00:22, 19.20it/s] 24%|████████████████████████▋                                                                            | 137/561 [00:06<00:22, 18.92it/s] 25%|█████████████████████████                                                                            | 139/561 [00:06<00:22, 18.68it/s] 25%|█████████████████████████▍                                                                           | 141/561 [00:07<00:22, 18.50it/s] 25%|█████████████████████████▋                                                                           | 143/561 [00:07<00:22, 18.36it/s] 26%|██████████████████████████▎                                                                          | 146/561 [00:07<00:20, 19.88it/s] 27%|██████████████████████████▊                                                                          | 149/561 [00:07<00:19, 21.27it/s] 27%|███████████████████████████▎                                                                         | 152/561 [00:07<00:18, 21.97it/s] 28%|███████████████████████████▉                                                                         | 155/561 [00:07<00:18, 22.45it/s] 28%|████████████████████████████▍                                                                        | 158/561 [00:07<00:17, 22.87it/s] 29%|████████████████████████████▉                                                                        | 161/561 [00:07<00:17, 23.19it/s] 29%|█████████████████████████████▌                                                                       | 164/561 [00:08<00:17, 23.29it/s] 30%|██████████████████████████████                                                                       | 167/561 [00:08<00:16, 23.56it/s][2025-03-28 01:23:39,124] [INFO] [logging.py:128:log_dist] [Rank 0] step=6900, skipped=14, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:23:39,125] [INFO] [timer.py:264:stop] epoch=0/micro_step=6900/global_step=6900, RunningAvgSamplesPerSec=18.356609028762882, CurrSamplesPerSec=23.742482008970867, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 30%|██████████████████████████████▌                                                                      | 170/561 [00:08<00:16, 23.62it/s] 31%|███████████████████████████████▏                                                                     | 173/561 [00:08<00:16, 23.68it/s] 31%|███████████████████████████████▋                                                                     | 176/561 [00:08<00:16, 23.73it/s] 32%|████████████████████████████████▏                                                                    | 179/561 [00:08<00:16, 23.66it/s] 32%|████████████████████████████████▊                                                                    | 182/561 [00:08<00:16, 22.99it/s] 33%|█████████████████████████████████▎                                                                   | 185/561 [00:08<00:16, 22.50it/s] 34%|█████████████████████████████████▊                                                                   | 188/561 [00:09<00:16, 22.26it/s] 34%|██████████████████████████████████▍                                                                  | 191/561 [00:09<00:16, 22.28it/s] 35%|██████████████████████████████████▉                                                                  | 194/561 [00:09<00:16, 22.19it/s] 35%|███████████████████████████████████▍                                                                 | 197/561 [00:09<00:16, 22.17it/s] 36%|████████████████████████████████████                                                                 | 200/561 [00:09<00:16, 22.22it/s] 36%|████████████████████████████████████▌                                                                | 203/561 [00:09<00:15, 22.43it/s] 37%|█████████████████████████████████████                                                                | 206/561 [00:09<00:16, 21.17it/s] 37%|█████████████████████████████████████▋                                                               | 209/561 [00:10<00:17, 20.12it/s] 38%|██████████████████████████████████████▏                                                              | 212/561 [00:10<00:17, 19.74it/s] 38%|██████████████████████████████████████▋                                                              | 215/561 [00:10<00:16, 20.78it/s][2025-03-28 01:23:41,413] [INFO] [logging.py:128:log_dist] [Rank 0] step=6950, skipped=14, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:23:41,414] [INFO] [timer.py:264:stop] epoch=0/micro_step=6950/global_step=6950, RunningAvgSamplesPerSec=18.377965128447418, CurrSamplesPerSec=23.216408018106044, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 39%|███████████████████████████████████████▏                                                             | 218/561 [00:10<00:15, 21.61it/s] 39%|███████████████████████████████████████▊                                                             | 221/561 [00:10<00:15, 22.01it/s] 40%|████████████████████████████████████████▎                                                            | 224/561 [00:10<00:15, 22.08it/s] 40%|████████████████████████████████████████▊                                                            | 227/561 [00:10<00:14, 22.28it/s] 41%|█████████████████████████████████████████▍                                                           | 230/561 [00:11<00:14, 22.14it/s] 42%|█████████████████████████████████████████▉                                                           | 233/561 [00:11<00:14, 21.92it/s] 42%|██████████████████████████████████████████▍                                                          | 236/561 [00:11<00:14, 22.14it/s] 43%|███████████████████████████████████████████                                                          | 239/561 [00:11<00:14, 22.62it/s] 43%|███████████████████████████████████████████▌                                                         | 242/561 [00:11<00:14, 22.64it/s] 44%|████████████████████████████████████████████                                                         | 245/561 [00:11<00:14, 22.55it/s] 44%|████████████████████████████████████████████▋                                                        | 248/561 [00:11<00:13, 22.40it/s] 45%|█████████████████████████████████████████████▏                                                       | 251/561 [00:11<00:13, 22.53it/s] 45%|█████████████████████████████████████████████▋                                                       | 254/561 [00:12<00:13, 22.46it/s] 46%|██████████████████████████████████████████████▎                                                      | 257/561 [00:12<00:13, 22.39it/s] 46%|██████████████████████████████████████████████▊                                                      | 260/561 [00:12<00:13, 22.22it/s] 47%|███████████████████████████████████████████████▎                                                     | 263/561 [00:12<00:13, 22.06it/s] 47%|███████████████████████████████████████████████▉                                                     | 266/561 [00:12<00:13, 21.76it/s][2025-03-28 01:23:43,661] [INFO] [logging.py:128:log_dist] [Rank 0] step=7000, skipped=14, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:23:43,661] [INFO] [timer.py:264:stop] epoch=0/micro_step=7000/global_step=7000, RunningAvgSamplesPerSec=18.401127803049622, CurrSamplesPerSec=21.869344700159274, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 48%|████████████████████████████████████████████████▍                                                    | 269/561 [00:12<00:13, 21.69it/s] 48%|████████████████████████████████████████████████▉                                                    | 272/561 [00:12<00:13, 21.76it/s] 49%|█████████████████████████████████████████████████▌                                                   | 275/561 [00:13<00:13, 21.89it/s] 50%|██████████████████████████████████████████████████                                                   | 278/561 [00:13<00:12, 21.94it/s] 50%|██████████████████████████████████████████████████▌                                                  | 281/561 [00:13<00:12, 21.96it/s][2025-03-28 01:23:44,338] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2025-03-28 01:23:44,380] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
 51%|███████████████████████████████████████████████████▏                                                 | 284/561 [00:13<00:12, 22.36it/s] 51%|███████████████████████████████████████████████████▋                                                 | 287/561 [00:13<00:12, 22.19it/s] 52%|████████████████████████████████████████████████████▏                                                | 290/561 [00:13<00:12, 22.20it/s] 52%|████████████████████████████████████████████████████▊                                                | 293/561 [00:13<00:12, 22.16it/s] 53%|█████████████████████████████████████████████████████▎                                               | 296/561 [00:14<00:12, 22.06it/s] 53%|█████████████████████████████████████████████████████▊                                               | 299/561 [00:14<00:11, 21.91it/s] 54%|██████████████████████████████████████████████████████▎                                              | 302/561 [00:14<00:11, 21.76it/s] 54%|██████████████████████████████████████████████████████▉                                              | 305/561 [00:14<00:11, 21.92it/s] 55%|███████████████████████████████████████████████████████▍                                             | 308/561 [00:14<00:11, 22.04it/s] 55%|███████████████████████████████████████████████████████▉                                             | 311/561 [00:14<00:11, 21.96it/s] 56%|████████████████████████████████████████████████████████▌                                            | 314/561 [00:14<00:11, 21.96it/s] 57%|█████████████████████████████████████████████████████████                                            | 317/561 [00:14<00:11, 21.94it/s][2025-03-28 01:23:45,931] [INFO] [logging.py:128:log_dist] [Rank 0] step=7050, skipped=16, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:23:45,932] [INFO] [timer.py:264:stop] epoch=0/micro_step=7050/global_step=7050, RunningAvgSamplesPerSec=18.422902594967674, CurrSamplesPerSec=21.886119678564206, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 57%|█████████████████████████████████████████████████████████▌                                           | 320/561 [00:15<00:10, 22.02it/s] 58%|██████████████████████████████████████████████████████████▏                                          | 323/561 [00:15<00:10, 21.97it/s] 58%|██████████████████████████████████████████████████████████▋                                          | 326/561 [00:15<00:10, 22.20it/s] 59%|███████████████████████████████████████████████████████████▏                                         | 329/561 [00:15<00:10, 22.06it/s] 59%|███████████████████████████████████████████████████████████▊                                         | 332/561 [00:15<00:10, 22.14it/s] 60%|████████████████████████████████████████████████████████████▎                                        | 335/561 [00:15<00:10, 22.07it/s] 60%|████████████████████████████████████████████████████████████▊                                        | 338/561 [00:15<00:10, 22.13it/s] 61%|█████████████████████████████████████████████████████████████▍                                       | 341/561 [00:16<00:10, 21.40it/s] 61%|█████████████████████████████████████████████████████████████▉                                       | 344/561 [00:16<00:10, 21.23it/s] 62%|██████████████████████████████████████████████████████████████▍                                      | 347/561 [00:16<00:09, 21.47it/s] 62%|███████████████████████████████████████████████████████████████                                      | 350/561 [00:16<00:09, 21.74it/s] 63%|███████████████████████████████████████████████████████████████▌                                     | 353/561 [00:16<00:09, 21.66it/s] 63%|████████████████████████████████████████████████████████████████                                     | 356/561 [00:16<00:09, 21.66it/s] 64%|████████████████████████████████████████████████████████████████▋                                    | 359/561 [00:16<00:09, 21.81it/s] 65%|█████████████████████████████████████████████████████████████████▏                                   | 362/561 [00:17<00:09, 20.79it/s] 65%|█████████████████████████████████████████████████████████████████▋                                   | 365/561 [00:17<00:09, 20.96it/s][2025-03-28 01:23:48,251] [INFO] [logging.py:128:log_dist] [Rank 0] step=7100, skipped=16, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:23:48,252] [INFO] [timer.py:264:stop] epoch=0/micro_step=7100/global_step=7100, RunningAvgSamplesPerSec=18.442056825694618, CurrSamplesPerSec=21.830189287144325, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 66%|██████████████████████████████████████████████████████████████████▎                                  | 368/561 [00:17<00:09, 21.14it/s] 66%|██████████████████████████████████████████████████████████████████▊                                  | 371/561 [00:17<00:08, 21.55it/s] 67%|███████████████████████████████████████████████████████████████████▎                                 | 374/561 [00:17<00:08, 21.61it/s] 67%|███████████████████████████████████████████████████████████████████▊                                 | 377/561 [00:17<00:08, 21.79it/s] 68%|████████████████████████████████████████████████████████████████████▍                                | 380/561 [00:17<00:08, 21.73it/s] 68%|████████████████████████████████████████████████████████████████████▉                                | 383/561 [00:18<00:08, 21.93it/s] 69%|█████████████████████████████████████████████████████████████████████▍                               | 386/561 [00:18<00:08, 21.87it/s] 69%|██████████████████████████████████████████████████████████████████████                               | 389/561 [00:18<00:07, 22.01it/s] 70%|██████████████████████████████████████████████████████████████████████▌                              | 392/561 [00:18<00:07, 21.88it/s] 70%|███████████████████████████████████████████████████████████████████████                              | 395/561 [00:18<00:07, 22.05it/s] 71%|███████████████████████████████████████████████████████████████████████▋                             | 398/561 [00:18<00:07, 21.80it/s] 71%|████████████████████████████████████████████████████████████████████████▏                            | 401/561 [00:18<00:07, 21.87it/s] 72%|████████████████████████████████████████████████████████████████████████▋                            | 404/561 [00:18<00:07, 21.90it/s] 73%|█████████████████████████████████████████████████████████████████████████▎                           | 407/561 [00:19<00:06, 22.28it/s] 73%|█████████████████████████████████████████████████████████████████████████▊                           | 410/561 [00:19<00:06, 22.65it/s] 74%|██████████████████████████████████████████████████████████████████████████▎                          | 413/561 [00:19<00:06, 22.86it/s] 74%|██████████████████████████████████████████████████████████████████████████▉                          | 416/561 [00:19<00:06, 22.86it/s][2025-03-28 01:23:50,497] [INFO] [logging.py:128:log_dist] [Rank 0] step=7150, skipped=16, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:23:50,497] [INFO] [timer.py:264:stop] epoch=0/micro_step=7150/global_step=7150, RunningAvgSamplesPerSec=18.46452723022887, CurrSamplesPerSec=22.16649416525657, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 75%|███████████████████████████████████████████████████████████████████████████▍                         | 419/561 [00:19<00:06, 22.46it/s] 75%|███████████████████████████████████████████████████████████████████████████▉                         | 422/561 [00:19<00:06, 22.26it/s] 76%|████████████████████████████████████████████████████████████████████████████▌                        | 425/561 [00:19<00:06, 22.26it/s] 76%|█████████████████████████████████████████████████████████████████████████████                        | 428/561 [00:20<00:05, 22.74it/s] 77%|█████████████████████████████████████████████████████████████████████████████▌                       | 431/561 [00:20<00:05, 22.80it/s] 77%|██████████████████████████████████████████████████████████████████████████████▏                      | 434/561 [00:20<00:05, 21.80it/s] 78%|██████████████████████████████████████████████████████████████████████████████▋                      | 437/561 [00:20<00:05, 21.85it/s] 78%|███████████████████████████████████████████████████████████████████████████████▏                     | 440/561 [00:20<00:05, 21.91it/s] 79%|███████████████████████████████████████████████████████████████████████████████▊                     | 443/561 [00:20<00:05, 21.86it/s] 80%|████████████████████████████████████████████████████████████████████████████████▎                    | 446/561 [00:20<00:05, 21.65it/s] 80%|████████████████████████████████████████████████████████████████████████████████▊                    | 449/561 [00:20<00:05, 21.78it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▍                   | 452/561 [00:21<00:04, 22.13it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▉                   | 455/561 [00:21<00:04, 22.23it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▍                  | 458/561 [00:21<00:04, 22.57it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▉                  | 461/561 [00:21<00:04, 22.49it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▌                 | 464/561 [00:21<00:04, 22.30it/s] 83%|████████████████████████████████████████████████████████████████████████████████████                 | 467/561 [00:21<00:04, 21.13it/s][2025-03-28 01:23:52,786] [INFO] [logging.py:128:log_dist] [Rank 0] step=7200, skipped=16, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:23:52,787] [INFO] [timer.py:264:stop] epoch=0/micro_step=7200/global_step=7200, RunningAvgSamplesPerSec=18.484643597389223, CurrSamplesPerSec=19.89054880132597, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 84%|████████████████████████████████████████████████████████████████████████████████████▌                | 470/561 [00:21<00:04, 21.30it/s] 84%|█████████████████████████████████████████████████████████████████████████████████████▏               | 473/561 [00:22<00:04, 21.54it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▋               | 476/561 [00:22<00:03, 22.27it/s] 85%|██████████████████████████████████████████████████████████████████████████████████████▏              | 479/561 [00:22<00:03, 23.45it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▊              | 482/561 [00:22<00:03, 22.81it/s] 86%|███████████████████████████████████████████████████████████████████████████████████████▎             | 485/561 [00:22<00:03, 22.64it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▊             | 488/561 [00:22<00:03, 22.41it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▍            | 491/561 [00:22<00:03, 22.37it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▉            | 494/561 [00:23<00:02, 22.34it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▍           | 497/561 [00:23<00:02, 22.28it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████           | 500/561 [00:23<00:02, 20.85it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▌          | 503/561 [00:23<00:02, 21.12it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████████          | 506/561 [00:23<00:02, 21.40it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▋         | 509/561 [00:23<00:02, 21.48it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████████▏        | 512/561 [00:23<00:02, 21.88it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████████▋        | 515/561 [00:23<00:02, 21.95it/s][2025-03-28 01:23:55,044] [INFO] [logging.py:128:log_dist] [Rank 0] step=7250, skipped=16, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:23:55,045] [INFO] [timer.py:264:stop] epoch=0/micro_step=7250/global_step=7250, RunningAvgSamplesPerSec=18.505993060150498, CurrSamplesPerSec=21.772057398555688, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 92%|█████████████████████████████████████████████████████████████████████████████████████████████▎       | 518/561 [00:24<00:01, 21.89it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▊       | 521/561 [00:24<00:01, 21.86it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████████▎      | 524/561 [00:24<00:01, 21.90it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▉      | 527/561 [00:24<00:01, 21.92it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▍     | 530/561 [00:24<00:01, 22.01it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▉     | 533/561 [00:24<00:01, 21.93it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▍    | 536/561 [00:24<00:01, 21.91it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████    | 539/561 [00:25<00:01, 21.82it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████████▌   | 542/561 [00:25<00:00, 21.77it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████████   | 545/561 [00:25<00:00, 21.59it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▋  | 548/561 [00:25<00:00, 21.48it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████████▏ | 551/561 [00:25<00:00, 21.53it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▋ | 554/561 [00:25<00:00, 21.56it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████▎| 557/561 [00:25<00:00, 21.58it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████████▊| 560/561 [00:26<00:00, 21.96it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:26<00:00, 21.45it/s]
  0%|                                                                                                               | 0/561 [00:00<?, ?it/s]  0%|▏                                                                                                      | 1/561 [00:00<01:39,  5.63it/s]  1%|▌                                                                                                      | 3/561 [00:00<00:48, 11.40it/s]  1%|▉                                                                                                      | 5/561 [00:00<00:39, 13.97it/s][2025-03-28 01:23:57,612] [INFO] [logging.py:128:log_dist] [Rank 0] step=7300, skipped=16, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:23:57,614] [INFO] [timer.py:264:stop] epoch=0/micro_step=7300/global_step=7300, RunningAvgSamplesPerSec=18.519302955405482, CurrSamplesPerSec=18.671707631135625, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
  1%|█▎                                                                                                     | 7/561 [00:00<00:35, 15.59it/s]  2%|█▋                                                                                                     | 9/561 [00:00<00:32, 16.87it/s]  2%|██                                                                                                    | 11/561 [00:00<00:31, 17.62it/s]  2%|██▌                                                                                                   | 14/561 [00:00<00:29, 18.79it/s]  3%|███                                                                                                   | 17/561 [00:01<00:28, 19.24it/s]  4%|███▋                                                                                                  | 20/561 [00:01<00:26, 20.07it/s]  4%|████▏                                                                                                 | 23/561 [00:01<00:26, 20.49it/s]  5%|████▋                                                                                                 | 26/561 [00:01<00:25, 20.60it/s]  5%|█████▎                                                                                                | 29/561 [00:01<00:25, 20.74it/s]  6%|█████▊                                                                                                | 32/561 [00:01<00:26, 19.77it/s]  6%|██████▏                                                                                               | 34/561 [00:01<00:26, 19.57it/s]  6%|██████▌                                                                                               | 36/561 [00:01<00:26, 19.47it/s]  7%|██████▉                                                                                               | 38/561 [00:02<00:26, 19.57it/s]  7%|███████▍                                                                                              | 41/561 [00:02<00:26, 19.90it/s]  8%|███████▊                                                                                              | 43/561 [00:02<00:26, 19.82it/s]  8%|████████▏                                                                                             | 45/561 [00:02<00:26, 19.73it/s]  9%|████████▋                                                                                             | 48/561 [00:02<00:25, 19.84it/s]  9%|█████████                                                                                             | 50/561 [00:02<00:25, 19.85it/s]  9%|█████████▋                                                                                            | 53/561 [00:02<00:25, 19.77it/s] 10%|██████████                                                                                            | 55/561 [00:02<00:25, 19.76it/s][2025-03-28 01:24:00,112] [INFO] [logging.py:128:log_dist] [Rank 0] step=7350, skipped=16, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:24:00,114] [INFO] [timer.py:264:stop] epoch=0/micro_step=7350/global_step=7350, RunningAvgSamplesPerSec=18.52887516799469, CurrSamplesPerSec=20.946782446495053, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 10%|██████████▎                                                                                           | 57/561 [00:03<00:25, 19.79it/s] 11%|██████████▉                                                                                           | 60/561 [00:03<00:25, 19.87it/s] 11%|███████████▍                                                                                          | 63/561 [00:03<00:25, 19.87it/s] 12%|███████████▊                                                                                          | 65/561 [00:03<00:25, 19.79it/s] 12%|████████████▏                                                                                         | 67/561 [00:03<00:25, 19.73it/s] 12%|████████████▋                                                                                         | 70/561 [00:03<00:24, 20.34it/s] 13%|█████████████▍                                                                                        | 74/561 [00:03<00:20, 23.52it/s] 14%|██████████████                                                                                        | 77/561 [00:03<00:20, 23.52it/s] 14%|██████████████▌                                                                                       | 80/561 [00:04<00:20, 23.43it/s] 15%|███████████████                                                                                       | 83/561 [00:04<00:20, 23.00it/s] 15%|███████████████▋                                                                                      | 86/561 [00:04<00:20, 22.73it/s] 16%|████████████████▏                                                                                     | 89/561 [00:04<00:21, 22.27it/s] 16%|████████████████▋                                                                                     | 92/561 [00:04<00:21, 22.15it/s] 17%|█████████████████▎                                                                                    | 95/561 [00:04<00:20, 22.29it/s] 17%|█████████████████▊                                                                                    | 98/561 [00:04<00:20, 22.47it/s] 18%|██████████████████▏                                                                                  | 101/561 [00:04<00:20, 22.63it/s] 19%|██████████████████▋                                                                                  | 104/561 [00:05<00:19, 23.01it/s][2025-03-28 01:24:02,344] [INFO] [logging.py:128:log_dist] [Rank 0] step=7400, skipped=16, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:24:02,345] [INFO] [timer.py:264:stop] epoch=0/micro_step=7400/global_step=7400, RunningAvgSamplesPerSec=18.550874377143426, CurrSamplesPerSec=23.178431872422582, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 19%|███████████████████▎                                                                                 | 107/561 [00:05<00:19, 23.08it/s] 20%|███████████████████▊                                                                                 | 110/561 [00:05<00:19, 23.38it/s] 20%|████████████████████▎                                                                                | 113/561 [00:05<00:19, 23.47it/s] 21%|████████████████████▉                                                                                | 116/561 [00:05<00:18, 23.52it/s] 21%|█████████████████████▍                                                                               | 119/561 [00:05<00:18, 23.51it/s] 22%|█████████████████████▉                                                                               | 122/561 [00:05<00:19, 22.42it/s] 22%|██████████████████████▌                                                                              | 125/561 [00:06<00:20, 21.40it/s] 23%|███████████████████████                                                                              | 128/561 [00:06<00:20, 21.41it/s] 23%|███████████████████████▌                                                                             | 131/561 [00:06<00:19, 21.65it/s] 24%|████████████████████████                                                                             | 134/561 [00:06<00:19, 21.79it/s] 24%|████████████████████████▋                                                                            | 137/561 [00:06<00:19, 21.97it/s] 25%|█████████████████████████▏                                                                           | 140/561 [00:08<01:22,  5.09it/s] 25%|█████████████████████████▌                                                                           | 142/561 [00:09<01:46,  3.93it/s] 26%|█████████████████████████▉                                                                           | 144/561 [00:09<01:28,  4.70it/s] 26%|██████████████████████████▍                                                                          | 147/561 [00:09<01:04,  6.40it/s] 27%|███████████████████████████                                                                          | 150/561 [00:09<00:49,  8.31it/s] 27%|███████████████████████████▌                                                                         | 153/561 [00:09<00:39, 10.34it/s] 28%|███████████████████████████▉                                                                         | 155/561 [00:11<01:50,  3.66it/s][2025-03-28 01:24:09,065] [INFO] [logging.py:128:log_dist] [Rank 0] step=7450, skipped=16, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:24:09,066] [INFO] [timer.py:264:stop] epoch=0/micro_step=7450/global_step=7450, RunningAvgSamplesPerSec=18.37105579827555, CurrSamplesPerSec=5.2198006884211265, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 28%|████████████████████████████▎                                                                        | 157/561 [00:11<01:48,  3.71it/s] 28%|████████████████████████████▋                                                                        | 159/561 [00:12<01:28,  4.55it/s] 29%|█████████████████████████████▏                                                                       | 162/561 [00:12<01:03,  6.32it/s] 29%|█████████████████████████████▋                                                                       | 165/561 [00:12<00:48,  8.18it/s] 30%|██████████████████████████████▏                                                                      | 168/561 [00:12<00:38, 10.26it/s] 30%|██████████████████████████████▊                                                                      | 171/561 [00:12<00:31, 12.29it/s] 31%|███████████████████████████████▏                                                                     | 173/561 [00:12<00:29, 13.30it/s] 31%|███████████████████████████████▋                                                                     | 176/561 [00:12<00:25, 15.13it/s] 32%|████████████████████████████████▏                                                                    | 179/561 [00:13<00:22, 16.81it/s] 32%|████████████████████████████████▊                                                                    | 182/561 [00:13<00:20, 18.11it/s] 33%|█████████████████████████████████▎                                                                   | 185/561 [00:13<00:19, 19.03it/s] 34%|█████████████████████████████████▊                                                                   | 188/561 [00:13<00:18, 19.83it/s] 34%|██████████████████████████████████▍                                                                  | 191/561 [00:13<00:18, 20.28it/s] 35%|██████████████████████████████████▉                                                                  | 194/561 [00:13<00:17, 20.75it/s] 35%|███████████████████████████████████▍                                                                 | 197/561 [00:13<00:17, 21.28it/s] 36%|████████████████████████████████████                                                                 | 200/561 [00:14<00:16, 21.90it/s] 36%|████████████████████████████████████▌                                                                | 203/561 [00:14<00:16, 22.13it/s] 37%|█████████████████████████████████████                                                                | 206/561 [00:14<00:16, 21.82it/s][2025-03-28 01:24:11,473] [INFO] [logging.py:128:log_dist] [Rank 0] step=7500, skipped=16, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:24:11,474] [INFO] [timer.py:264:stop] epoch=0/micro_step=7500/global_step=7500, RunningAvgSamplesPerSec=18.385491686385937, CurrSamplesPerSec=21.99319238543932, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 37%|█████████████████████████████████████▋                                                               | 209/561 [00:14<00:16, 21.73it/s] 38%|██████████████████████████████████████▏                                                              | 212/561 [00:14<00:15, 21.95it/s] 38%|██████████████████████████████████████▋                                                              | 215/561 [00:14<00:16, 21.53it/s] 39%|███████████████████████████████████████▏                                                             | 218/561 [00:14<00:15, 21.47it/s] 39%|███████████████████████████████████████▊                                                             | 221/561 [00:15<00:15, 21.68it/s] 40%|████████████████████████████████████████▎                                                            | 224/561 [00:15<00:15, 22.02it/s] 40%|████████████████████████████████████████▊                                                            | 227/561 [00:15<00:15, 21.98it/s] 41%|█████████████████████████████████████████▍                                                           | 230/561 [00:15<00:15, 21.83it/s] 42%|█████████████████████████████████████████▉                                                           | 233/561 [00:15<00:14, 22.00it/s] 42%|██████████████████████████████████████████▍                                                          | 236/561 [00:15<00:14, 22.18it/s] 43%|███████████████████████████████████████████                                                          | 239/561 [00:15<00:14, 22.19it/s] 43%|███████████████████████████████████████████▌                                                         | 242/561 [00:15<00:15, 21.15it/s] 44%|████████████████████████████████████████████                                                         | 245/561 [00:16<00:14, 21.11it/s] 44%|████████████████████████████████████████████▋                                                        | 248/561 [00:16<00:14, 21.41it/s] 45%|█████████████████████████████████████████████▏                                                       | 251/561 [00:16<00:14, 21.66it/s] 45%|█████████████████████████████████████████████▋                                                       | 254/561 [00:16<00:13, 23.51it/s][2025-03-28 01:24:13,732] [INFO] [logging.py:128:log_dist] [Rank 0] step=7550, skipped=16, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:24:13,732] [INFO] [timer.py:264:stop] epoch=0/micro_step=7550/global_step=7550, RunningAvgSamplesPerSec=18.40643660929606, CurrSamplesPerSec=21.274987020775978, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 46%|██████████████████████████████████████████████▎                                                      | 257/561 [00:16<00:12, 23.47it/s] 46%|██████████████████████████████████████████████▊                                                      | 260/561 [00:16<00:13, 22.99it/s] 47%|███████████████████████████████████████████████▎                                                     | 263/561 [00:16<00:13, 22.68it/s] 47%|███████████████████████████████████████████████▉                                                     | 266/561 [00:17<00:13, 22.51it/s] 48%|████████████████████████████████████████████████▍                                                    | 269/561 [00:17<00:12, 22.81it/s] 48%|████████████████████████████████████████████████▉                                                    | 272/561 [00:17<00:12, 22.51it/s] 49%|█████████████████████████████████████████████████▌                                                   | 275/561 [00:17<00:12, 22.18it/s] 50%|██████████████████████████████████████████████████                                                   | 278/561 [00:17<00:12, 22.08it/s] 50%|██████████████████████████████████████████████████▌                                                  | 281/561 [00:17<00:12, 22.01it/s] 51%|███████████████████████████████████████████████████▏                                                 | 284/561 [00:17<00:12, 22.29it/s] 51%|███████████████████████████████████████████████████▋                                                 | 287/561 [00:17<00:12, 22.14it/s] 52%|████████████████████████████████████████████████████▏                                                | 290/561 [00:18<00:12, 22.03it/s] 52%|████████████████████████████████████████████████████▊                                                | 293/561 [00:18<00:12, 22.07it/s] 53%|█████████████████████████████████████████████████████▎                                               | 296/561 [00:18<00:12, 21.91it/s] 53%|█████████████████████████████████████████████████████▊                                               | 299/561 [00:18<00:11, 22.04it/s] 54%|██████████████████████████████████████████████████████▎                                              | 302/561 [00:18<00:11, 22.43it/s] 54%|██████████████████████████████████████████████████████▉                                              | 305/561 [00:18<00:11, 22.46it/s][2025-03-28 01:24:15,981] [INFO] [logging.py:128:log_dist] [Rank 0] step=7600, skipped=16, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:24:15,982] [INFO] [timer.py:264:stop] epoch=0/micro_step=7600/global_step=7600, RunningAvgSamplesPerSec=18.42754844322589, CurrSamplesPerSec=23.90513493489343, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 55%|███████████████████████████████████████████████████████▍                                             | 308/561 [00:18<00:11, 22.75it/s] 55%|███████████████████████████████████████████████████████▉                                             | 311/561 [00:19<00:10, 23.11it/s] 56%|████████████████████████████████████████████████████████▌                                            | 314/561 [00:19<00:10, 22.87it/s] 57%|█████████████████████████████████████████████████████████                                            | 317/561 [00:19<00:10, 22.44it/s] 57%|█████████████████████████████████████████████████████████▌                                           | 320/561 [00:19<00:10, 22.26it/s] 58%|██████████████████████████████████████████████████████████▏                                          | 323/561 [00:19<00:10, 21.95it/s] 58%|██████████████████████████████████████████████████████████▋                                          | 326/561 [00:19<00:10, 22.02it/s] 59%|███████████████████████████████████████████████████████████▏                                         | 329/561 [00:19<00:10, 22.04it/s] 59%|███████████████████████████████████████████████████████████▊                                         | 332/561 [00:20<00:10, 21.45it/s] 60%|████████████████████████████████████████████████████████████▎                                        | 335/561 [00:20<00:10, 20.77it/s] 60%|████████████████████████████████████████████████████████████▊                                        | 338/561 [00:20<00:10, 21.10it/s] 61%|█████████████████████████████████████████████████████████████▍                                       | 341/561 [00:20<00:10, 21.40it/s] 61%|█████████████████████████████████████████████████████████████▉                                       | 344/561 [00:20<00:10, 21.56it/s] 62%|██████████████████████████████████████████████████████████████▍                                      | 347/561 [00:20<00:10, 21.20it/s] 62%|███████████████████████████████████████████████████████████████                                      | 350/561 [00:20<00:10, 20.42it/s] 63%|███████████████████████████████████████████████████████████████▌                                     | 353/561 [00:21<00:10, 20.18it/s] 63%|████████████████████████████████████████████████████████████████                                     | 356/561 [00:21<00:10, 20.12it/s][2025-03-28 01:24:18,347] [INFO] [logging.py:128:log_dist] [Rank 0] step=7650, skipped=16, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:24:18,348] [INFO] [timer.py:264:stop] epoch=0/micro_step=7650/global_step=7650, RunningAvgSamplesPerSec=18.44326827696528, CurrSamplesPerSec=19.288041039366465, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 64%|████████████████████████████████████████████████████████████████▋                                    | 359/561 [00:21<00:10, 19.96it/s] 65%|█████████████████████████████████████████████████████████████████▏                                   | 362/561 [00:21<00:09, 20.58it/s] 65%|█████████████████████████████████████████████████████████████████▋                                   | 365/561 [00:21<00:09, 21.45it/s] 66%|██████████████████████████████████████████████████████████████████▎                                  | 368/561 [00:21<00:08, 22.25it/s] 66%|██████████████████████████████████████████████████████████████████▊                                  | 371/561 [00:21<00:08, 22.43it/s] 67%|███████████████████████████████████████████████████████████████████▎                                 | 374/561 [00:21<00:08, 22.47it/s] 67%|███████████████████████████████████████████████████████████████████▊                                 | 377/561 [00:22<00:08, 22.32it/s] 68%|████████████████████████████████████████████████████████████████████▍                                | 380/561 [00:22<00:08, 22.14it/s] 68%|████████████████████████████████████████████████████████████████████▉                                | 383/561 [00:22<00:08, 22.06it/s] 69%|█████████████████████████████████████████████████████████████████████▍                               | 386/561 [00:22<00:07, 21.99it/s] 69%|██████████████████████████████████████████████████████████████████████                               | 389/561 [00:22<00:07, 22.26it/s] 70%|██████████████████████████████████████████████████████████████████████▌                              | 392/561 [00:22<00:07, 22.11it/s] 70%|███████████████████████████████████████████████████████████████████████                              | 395/561 [00:22<00:07, 22.01it/s] 71%|███████████████████████████████████████████████████████████████████████▋                             | 398/561 [00:23<00:07, 22.05it/s] 71%|████████████████████████████████████████████████████████████████████████▏                            | 401/561 [00:23<00:07, 22.17it/s] 72%|████████████████████████████████████████████████████████████████████████▋                            | 404/561 [00:23<00:06, 22.60it/s][2025-03-28 01:24:20,577] [INFO] [logging.py:128:log_dist] [Rank 0] step=7700, skipped=16, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:24:20,578] [INFO] [timer.py:264:stop] epoch=0/micro_step=7700/global_step=7700, RunningAvgSamplesPerSec=18.464823348839438, CurrSamplesPerSec=22.943867258446428, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 73%|█████████████████████████████████████████████████████████████████████████▎                           | 407/561 [00:23<00:06, 22.79it/s] 73%|█████████████████████████████████████████████████████████████████████████▊                           | 410/561 [00:23<00:06, 22.90it/s] 74%|██████████████████████████████████████████████████████████████████████████▎                          | 413/561 [00:23<00:06, 23.04it/s] 74%|██████████████████████████████████████████████████████████████████████████▉                          | 416/561 [00:23<00:06, 22.62it/s] 75%|███████████████████████████████████████████████████████████████████████████▍                         | 419/561 [00:24<00:06, 22.44it/s] 75%|███████████████████████████████████████████████████████████████████████████▉                         | 422/561 [00:24<00:06, 22.32it/s] 76%|████████████████████████████████████████████████████████████████████████████▌                        | 425/561 [00:24<00:06, 21.39it/s] 76%|█████████████████████████████████████████████████████████████████████████████                        | 428/561 [00:24<00:06, 20.83it/s] 77%|█████████████████████████████████████████████████████████████████████████████▌                       | 431/561 [00:24<00:06, 21.20it/s] 77%|██████████████████████████████████████████████████████████████████████████████▏                      | 434/561 [00:24<00:05, 21.28it/s] 78%|██████████████████████████████████████████████████████████████████████████████▋                      | 437/561 [00:24<00:05, 21.78it/s] 78%|███████████████████████████████████████████████████████████████████████████████▏                     | 440/561 [00:24<00:05, 22.49it/s] 79%|███████████████████████████████████████████████████████████████████████████████▊                     | 443/561 [00:25<00:05, 22.75it/s] 80%|████████████████████████████████████████████████████████████████████████████████▎                    | 446/561 [00:25<00:04, 23.12it/s] 80%|████████████████████████████████████████████████████████████████████████████████▊                    | 449/561 [00:25<00:04, 23.18it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▍                   | 452/561 [00:25<00:04, 22.22it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▉                   | 455/561 [00:25<00:04, 22.22it/s][2025-03-28 01:24:22,837] [INFO] [logging.py:128:log_dist] [Rank 0] step=7750, skipped=16, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:24:22,838] [INFO] [timer.py:264:stop] epoch=0/micro_step=7750/global_step=7750, RunningAvgSamplesPerSec=18.484802225736352, CurrSamplesPerSec=22.515861033691596, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 82%|██████████████████████████████████████████████████████████████████████████████████▍                  | 458/561 [00:25<00:04, 22.15it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▉                  | 461/561 [00:25<00:04, 21.98it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▌                 | 464/561 [00:26<00:04, 22.07it/s] 83%|████████████████████████████████████████████████████████████████████████████████████                 | 467/561 [00:26<00:04, 22.18it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▌                | 470/561 [00:26<00:03, 22.98it/s] 84%|█████████████████████████████████████████████████████████████████████████████████████▏               | 473/561 [00:26<00:03, 23.27it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▋               | 476/561 [00:26<00:03, 23.05it/s] 85%|██████████████████████████████████████████████████████████████████████████████████████▏              | 479/561 [00:26<00:03, 22.92it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▊              | 482/561 [00:26<00:03, 22.55it/s] 86%|███████████████████████████████████████████████████████████████████████████████████████▎             | 485/561 [00:26<00:03, 21.61it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▊             | 488/561 [00:27<00:03, 21.74it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▍            | 491/561 [00:27<00:03, 21.80it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▉            | 494/561 [00:27<00:03, 22.00it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▍           | 497/561 [00:27<00:02, 21.97it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████           | 500/561 [00:27<00:02, 22.54it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▌          | 503/561 [00:27<00:02, 22.86it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████████          | 506/561 [00:27<00:02, 22.44it/s][2025-03-28 01:24:25,075] [INFO] [logging.py:128:log_dist] [Rank 0] step=7800, skipped=16, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:24:25,076] [INFO] [timer.py:264:stop] epoch=0/micro_step=7800/global_step=7800, RunningAvgSamplesPerSec=18.505568261418112, CurrSamplesPerSec=20.23846320079542, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 91%|███████████████████████████████████████████████████████████████████████████████████████████▋         | 509/561 [00:28<00:02, 22.14it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████████▏        | 512/561 [00:28<00:02, 22.10it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████████▋        | 515/561 [00:28<00:02, 22.06it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████▎       | 518/561 [00:28<00:01, 21.95it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▊       | 521/561 [00:28<00:01, 22.02it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████████▎      | 524/561 [00:28<00:01, 22.03it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▉      | 527/561 [00:28<00:01, 22.13it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▍     | 530/561 [00:29<00:01, 21.47it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▉     | 533/561 [00:29<00:01, 20.55it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▍    | 536/561 [00:29<00:01, 20.91it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████    | 539/561 [00:29<00:01, 21.28it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████████▌   | 542/561 [00:29<00:00, 21.85it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████████   | 545/561 [00:29<00:00, 22.48it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▋  | 548/561 [00:29<00:00, 22.85it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████████▏ | 551/561 [00:29<00:00, 23.17it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▋ | 554/561 [00:30<00:00, 22.93it/s][2025-03-28 01:24:27,331] [INFO] [logging.py:128:log_dist] [Rank 0] step=7850, skipped=16, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:24:27,332] [INFO] [timer.py:264:stop] epoch=0/micro_step=7850/global_step=7850, RunningAvgSamplesPerSec=18.52528321417328, CurrSamplesPerSec=23.067274845795932, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 99%|████████████████████████████████████████████████████████████████████████████████████████████████████▎| 557/561 [00:30<00:00, 23.03it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████████▊| 560/561 [00:30<00:00, 23.11it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:30<00:00, 18.42it/s]
  0%|                                                                                                               | 0/561 [00:00<?, ?it/s]  0%|▏                                                                                                      | 1/561 [00:00<04:00,  2.33it/s]  1%|▋                                                                                                      | 4/561 [00:00<01:06,  8.41it/s]  1%|█▎                                                                                                     | 7/561 [00:00<00:44, 12.55it/s]  2%|█▊                                                                                                    | 10/561 [00:00<00:35, 15.50it/s]  2%|██▎                                                                                                   | 13/561 [00:00<00:31, 17.58it/s]  3%|██▉                                                                                                   | 16/561 [00:01<00:28, 19.01it/s]  3%|███▍                                                                                                  | 19/561 [00:01<00:26, 20.13it/s]  4%|████                                                                                                  | 22/561 [00:01<00:26, 20.69it/s]  4%|████▌                                                                                                 | 25/561 [00:01<00:25, 21.00it/s]  5%|█████                                                                                                 | 28/561 [00:01<00:25, 21.27it/s]  6%|█████▋                                                                                                | 31/561 [00:01<00:24, 21.33it/s]  6%|██████▏                                                                                               | 34/561 [00:01<00:24, 21.49it/s]  7%|██████▋                                                                                               | 37/561 [00:02<00:23, 22.41it/s]  7%|███████▎                                                                                              | 40/561 [00:02<00:22, 22.90it/s]  8%|███████▊                                                                                              | 43/561 [00:02<00:23, 22.22it/s][2025-03-28 01:24:30,035] [INFO] [logging.py:128:log_dist] [Rank 0] step=7900, skipped=16, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:24:30,036] [INFO] [timer.py:264:stop] epoch=0/micro_step=7900/global_step=7900, RunningAvgSamplesPerSec=18.5309880004787, CurrSamplesPerSec=22.16743138723858, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
  8%|████████▎                                                                                             | 46/561 [00:02<00:23, 21.86it/s]  9%|████████▉                                                                                             | 49/561 [00:02<00:23, 22.07it/s]  9%|█████████▍                                                                                            | 52/561 [00:02<00:23, 22.03it/s] 10%|██████████                                                                                            | 55/561 [00:02<00:22, 22.04it/s] 10%|██████████▌                                                                                           | 58/561 [00:03<00:22, 22.03it/s] 11%|███████████                                                                                           | 61/561 [00:03<00:22, 22.02it/s] 11%|███████████▋                                                                                          | 64/561 [00:03<00:22, 22.01it/s] 12%|████████████▏                                                                                         | 67/561 [00:03<00:22, 22.00it/s] 12%|████████████▋                                                                                         | 70/561 [00:03<00:22, 21.99it/s] 13%|█████████████▎                                                                                        | 73/561 [00:03<00:22, 21.87it/s] 14%|█████████████▊                                                                                        | 76/561 [00:03<00:21, 22.07it/s] 14%|██████████████▎                                                                                       | 79/561 [00:03<00:21, 22.09it/s] 15%|██████████████▉                                                                                       | 82/561 [00:04<00:21, 21.84it/s] 15%|███████████████▍                                                                                      | 85/561 [00:04<00:21, 21.88it/s] 16%|████████████████                                                                                      | 88/561 [00:04<00:21, 21.95it/s] 16%|████████████████▌                                                                                     | 91/561 [00:04<00:21, 21.90it/s] 17%|█████████████████                                                                                     | 94/561 [00:04<00:21, 21.63it/s][2025-03-28 01:24:32,323] [INFO] [logging.py:128:log_dist] [Rank 0] step=7950, skipped=16, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:24:32,323] [INFO] [timer.py:264:stop] epoch=0/micro_step=7950/global_step=7950, RunningAvgSamplesPerSec=18.54903380522009, CurrSamplesPerSec=21.920434304919635, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 17%|█████████████████▋                                                                                    | 97/561 [00:04<00:21, 21.09it/s] 18%|██████████████████                                                                                   | 100/561 [00:04<00:22, 20.76it/s] 18%|██████████████████▌                                                                                  | 103/561 [00:05<00:22, 20.72it/s] 19%|███████████████████                                                                                  | 106/561 [00:05<00:22, 20.64it/s] 19%|███████████████████▌                                                                                 | 109/561 [00:05<00:22, 20.45it/s] 20%|████████████████████▏                                                                                | 112/561 [00:05<00:22, 20.33it/s] 20%|████████████████████▋                                                                                | 115/561 [00:05<00:22, 20.26it/s] 21%|█████████████████████▏                                                                               | 118/561 [00:05<00:22, 19.36it/s] 22%|█████████████████████▊                                                                               | 121/561 [00:06<00:22, 19.81it/s] 22%|██████████████████████▏                                                                              | 123/561 [00:06<00:22, 19.68it/s] 22%|██████████████████████▌                                                                              | 125/561 [00:06<00:22, 19.11it/s] 23%|██████████████████████▊                                                                              | 127/561 [00:06<00:22, 19.33it/s] 23%|███████████████████████▏                                                                             | 129/561 [00:06<00:22, 19.23it/s] 24%|███████████████████████▊                                                                             | 132/561 [00:06<00:21, 19.55it/s] 24%|████████████████████████                                                                             | 134/561 [00:06<00:21, 19.57it/s] 24%|████████████████████████▍                                                                            | 136/561 [00:06<00:21, 19.59it/s] 25%|████████████████████████▊                                                                            | 138/561 [00:06<00:21, 19.63it/s] 25%|█████████████████████████▍                                                                           | 141/561 [00:07<00:21, 19.98it/s] 26%|█████████████████████████▉                                                                           | 144/561 [00:07<00:20, 20.27it/s][2025-03-28 01:24:34,844] [INFO] [logging.py:128:log_dist] [Rank 0] step=8000, skipped=16, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:24:34,845] [INFO] [timer.py:264:stop] epoch=0/micro_step=8000/global_step=8000, RunningAvgSamplesPerSec=18.55676626556183, CurrSamplesPerSec=22.030042121302042, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 26%|██████████████████████████▍                                                                          | 147/561 [00:07<00:20, 20.21it/s] 27%|███████████████████████████                                                                          | 150/561 [00:07<00:20, 19.92it/s] 27%|███████████████████████████▌                                                                         | 153/561 [00:07<00:20, 20.34it/s] 28%|████████████████████████████                                                                         | 156/561 [00:07<00:20, 19.73it/s] 28%|████████████████████████████▍                                                                        | 158/561 [00:07<00:20, 19.60it/s] 29%|████████████████████████████▊                                                                        | 160/561 [00:08<00:21, 18.82it/s][2025-03-28 01:24:35,722] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
 29%|█████████████████████████████▎                                                                       | 163/561 [00:08<00:20, 19.51it/s][2025-03-28 01:24:35,763] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
 30%|█████████████████████████████▉                                                                       | 166/561 [00:08<00:19, 20.11it/s] 30%|██████████████████████████████▍                                                                      | 169/561 [00:08<00:19, 20.60it/s] 31%|██████████████████████████████▉                                                                      | 172/561 [00:08<00:18, 20.72it/s] 31%|███████████████████████████████▌                                                                     | 175/561 [00:08<00:18, 20.93it/s] 32%|████████████████████████████████                                                                     | 178/561 [00:08<00:19, 20.13it/s] 32%|████████████████████████████████▌                                                                    | 181/561 [00:09<00:19, 19.40it/s] 33%|████████████████████████████████▉                                                                    | 183/561 [00:09<00:19, 19.13it/s] 33%|█████████████████████████████████▎                                                                   | 185/561 [00:09<00:20, 18.77it/s] 33%|█████████████████████████████████▋                                                                   | 187/561 [00:09<00:20, 18.69it/s] 34%|██████████████████████████████████                                                                   | 189/561 [00:09<00:20, 18.51it/s] 34%|██████████████████████████████████▍                                                                  | 191/561 [00:09<00:19, 18.54it/s] 34%|██████████████████████████████████▋                                                                  | 193/561 [00:09<00:19, 18.57it/s] 35%|███████████████████████████████████                                                                  | 195/561 [00:09<00:19, 18.59it/s][2025-03-28 01:24:37,428] [INFO] [logging.py:128:log_dist] [Rank 0] step=8050, skipped=18, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:24:37,431] [INFO] [timer.py:264:stop] epoch=0/micro_step=8050/global_step=8050, RunningAvgSamplesPerSec=18.5616528393993, CurrSamplesPerSec=18.261496219602222, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 35%|███████████████████████████████████▍                                                                 | 197/561 [00:09<00:19, 18.63it/s] 35%|███████████████████████████████████▊                                                                 | 199/561 [00:10<00:19, 18.64it/s] 36%|████████████████████████████████████▏                                                                | 201/561 [00:10<00:19, 18.66it/s] 36%|████████████████████████████████████▌                                                                | 203/561 [00:10<00:19, 18.63it/s] 37%|████████████████████████████████████▉                                                                | 205/561 [00:10<00:19, 18.70it/s] 37%|█████████████████████████████████████▎                                                               | 207/561 [00:10<00:18, 18.68it/s] 37%|█████████████████████████████████████▋                                                               | 209/561 [00:10<00:18, 18.66it/s] 38%|█████████████████████████████████████▉                                                               | 211/561 [00:10<00:18, 18.67it/s] 38%|██████████████████████████████████████▎                                                              | 213/561 [00:10<00:18, 18.64it/s] 38%|██████████████████████████████████████▋                                                              | 215/561 [00:10<00:18, 18.61it/s] 39%|███████████████████████████████████████                                                              | 217/561 [00:10<00:18, 18.61it/s] 39%|███████████████████████████████████████▍                                                             | 219/561 [00:11<00:18, 18.62it/s] 39%|███████████████████████████████████████▊                                                             | 221/561 [00:11<00:18, 18.74it/s] 40%|████████████████████████████████████████▏                                                            | 223/561 [00:11<00:18, 18.49it/s] 40%|████████████████████████████████████████▌                                                            | 225/561 [00:11<00:18, 18.56it/s] 40%|████████████████████████████████████████▊                                                            | 227/561 [00:11<00:17, 18.57it/s] 41%|█████████████████████████████████████████▏                                                           | 229/561 [00:11<00:17, 18.57it/s] 41%|█████████████████████████████████████████▌                                                           | 231/561 [00:11<00:17, 18.60it/s] 42%|█████████████████████████████████████████▉                                                           | 233/561 [00:11<00:17, 18.57it/s] 42%|██████████████████████████████████████████▎                                                          | 235/561 [00:11<00:17, 18.57it/s] 42%|██████████████████████████████████████████▋                                                          | 237/561 [00:12<00:17, 18.47it/s] 43%|███████████████████████████████████████████                                                          | 239/561 [00:12<00:17, 18.51it/s] 43%|███████████████████████████████████████████▍                                                         | 241/561 [00:12<00:17, 18.55it/s] 43%|███████████████████████████████████████████▋                                                         | 243/561 [00:12<00:17, 18.55it/s] 44%|████████████████████████████████████████████                                                         | 245/561 [00:12<00:17, 18.55it/s][2025-03-28 01:24:40,117] [INFO] [logging.py:128:log_dist] [Rank 0] step=8100, skipped=18, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:24:40,120] [INFO] [timer.py:264:stop] epoch=0/micro_step=8100/global_step=8100, RunningAvgSamplesPerSec=18.562124514198842, CurrSamplesPerSec=18.12748177336558, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 44%|████████████████████████████████████████████▍                                                        | 247/561 [00:12<00:16, 18.55it/s] 44%|████████████████████████████████████████████▊                                                        | 249/561 [00:12<00:16, 18.58it/s] 45%|█████████████████████████████████████████████▏                                                       | 251/561 [00:12<00:16, 18.59it/s] 45%|█████████████████████████████████████████████▌                                                       | 253/561 [00:12<00:16, 18.57it/s] 45%|█████████████████████████████████████████████▉                                                       | 255/561 [00:13<00:16, 18.57it/s] 46%|██████████████████████████████████████████████▎                                                      | 257/561 [00:13<00:16, 18.60it/s] 46%|██████████████████████████████████████████████▋                                                      | 259/561 [00:13<00:16, 18.62it/s] 47%|██████████████████████████████████████████████▉                                                      | 261/561 [00:13<00:16, 18.60it/s] 47%|███████████████████████████████████████████████▎                                                     | 263/561 [00:13<00:15, 18.63it/s] 47%|███████████████████████████████████████████████▋                                                     | 265/561 [00:13<00:15, 18.60it/s] 48%|████████████████████████████████████████████████                                                     | 267/561 [00:13<00:15, 18.61it/s] 48%|████████████████████████████████████████████████▍                                                    | 269/561 [00:13<00:15, 18.59it/s] 48%|████████████████████████████████████████████████▉                                                    | 272/561 [00:13<00:14, 19.43it/s] 49%|█████████████████████████████████████████████████▌                                                   | 275/561 [00:14<00:13, 20.67it/s] 50%|██████████████████████████████████████████████████                                                   | 278/561 [00:14<00:13, 21.04it/s] 50%|██████████████████████████████████████████████████▌                                                  | 281/561 [00:14<00:13, 20.44it/s] 51%|███████████████████████████████████████████████████▏                                                 | 284/561 [00:14<00:13, 20.23it/s] 51%|███████████████████████████████████████████████████▋                                                 | 287/561 [00:14<00:14, 19.53it/s] 52%|████████████████████████████████████████████████████                                                 | 289/561 [00:14<00:14, 19.19it/s] 52%|████████████████████████████████████████████████████▍                                                | 291/561 [00:14<00:14, 18.91it/s] 52%|████████████████████████████████████████████████████▊                                                | 293/561 [00:14<00:14, 18.71it/s] 53%|█████████████████████████████████████████████████████                                                | 295/561 [00:15<00:14, 18.55it/s][2025-03-28 01:24:42,730] [INFO] [logging.py:128:log_dist] [Rank 0] step=8150, skipped=18, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:24:42,733] [INFO] [timer.py:264:stop] epoch=0/micro_step=8150/global_step=8150, RunningAvgSamplesPerSec=18.565774988671325, CurrSamplesPerSec=18.181307917011555, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 53%|█████████████████████████████████████████████████████▍                                               | 297/561 [00:15<00:14, 18.42it/s] 53%|█████████████████████████████████████████████████████▊                                               | 299/561 [00:15<00:14, 18.34it/s] 54%|██████████████████████████████████████████████████████▏                                              | 301/561 [00:15<00:14, 18.28it/s] 54%|██████████████████████████████████████████████████████▋                                              | 304/561 [00:15<00:13, 19.74it/s] 55%|███████████████████████████████████████████████████████▎                                             | 307/561 [00:15<00:12, 21.13it/s] 55%|███████████████████████████████████████████████████████▊                                             | 310/561 [00:15<00:12, 20.85it/s] 56%|████████████████████████████████████████████████████████▎                                            | 313/561 [00:15<00:11, 20.98it/s] 56%|████████████████████████████████████████████████████████▉                                            | 316/561 [00:16<00:12, 19.99it/s] 57%|█████████████████████████████████████████████████████████▍                                           | 319/561 [00:16<00:12, 19.36it/s] 57%|█████████████████████████████████████████████████████████▊                                           | 321/561 [00:16<00:12, 19.06it/s] 58%|██████████████████████████████████████████████████████████▏                                          | 323/561 [00:16<00:12, 18.84it/s] 58%|██████████████████████████████████████████████████████████▌                                          | 325/561 [00:16<00:12, 18.66it/s] 58%|██████████████████████████████████████████████████████████▊                                          | 327/561 [00:16<00:12, 18.00it/s] 59%|███████████████████████████████████████████████████████████▏                                         | 329/561 [00:16<00:13, 17.21it/s] 59%|███████████████████████████████████████████████████████████▌                                         | 331/561 [00:17<00:13, 17.48it/s] 60%|████████████████████████████████████████████████████████████▏                                        | 334/561 [00:17<00:11, 19.08it/s] 60%|████████████████████████████████████████████████████████████▋                                        | 337/561 [00:17<00:11, 19.97it/s] 61%|█████████████████████████████████████████████████████████████▏                                       | 340/561 [00:17<00:10, 20.90it/s] 61%|█████████████████████████████████████████████████████████████▊                                       | 343/561 [00:17<00:10, 21.40it/s][2025-03-28 01:24:45,273] [INFO] [logging.py:128:log_dist] [Rank 0] step=8200, skipped=18, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:24:45,276] [INFO] [timer.py:264:stop] epoch=0/micro_step=8200/global_step=8200, RunningAvgSamplesPerSec=18.57233858452668, CurrSamplesPerSec=18.167998500771972, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 62%|██████████████████████████████████████████████████████████████▎                                      | 346/561 [00:17<00:10, 20.24it/s] 62%|██████████████████████████████████████████████████████████████▊                                      | 349/561 [00:17<00:10, 19.55it/s] 63%|███████████████████████████████████████████████████████████████▏                                     | 351/561 [00:17<00:10, 19.23it/s] 63%|███████████████████████████████████████████████████████████████▌                                     | 353/561 [00:18<00:10, 18.98it/s] 63%|███████████████████████████████████████████████████████████████▉                                     | 355/561 [00:18<00:10, 18.75it/s] 64%|████████████████████████████████████████████████████████████████▎                                    | 357/561 [00:18<00:10, 18.58it/s] 64%|████████████████████████████████████████████████████████████████▋                                    | 359/561 [00:18<00:10, 18.44it/s] 64%|████████████████████████████████████████████████████████████████▉                                    | 361/561 [00:18<00:10, 18.35it/s] 65%|█████████████████████████████████████████████████████████████████▌                                   | 364/561 [00:18<00:10, 19.36it/s] 65%|██████████████████████████████████████████████████████████████████                                   | 367/561 [00:18<00:09, 19.80it/s] 66%|██████████████████████████████████████████████████████████████████▌                                  | 370/561 [00:18<00:09, 19.97it/s] 66%|██████████████████████████████████████████████████████████████████▉                                  | 372/561 [00:19<00:09, 19.97it/s] 67%|███████████████████████████████████████████████████████████████████▎                                 | 374/561 [00:19<00:09, 19.44it/s] 67%|███████████████████████████████████████████████████████████████████▋                                 | 376/561 [00:19<00:09, 19.07it/s] 67%|████████████████████████████████████████████████████████████████████                                 | 378/561 [00:19<00:09, 18.81it/s] 68%|████████████████████████████████████████████████████████████████████▍                                | 380/561 [00:19<00:09, 18.61it/s] 68%|████████████████████████████████████████████████████████████████████▊                                | 382/561 [00:19<00:09, 18.67it/s] 68%|█████████████████████████████████████████████████████████████████████▏                               | 384/561 [00:19<00:09, 18.51it/s] 69%|█████████████████████████████████████████████████████████████████████▍                               | 386/561 [00:19<00:09, 18.39it/s] 69%|█████████████████████████████████████████████████████████████████████▊                               | 388/561 [00:19<00:09, 18.11it/s] 70%|██████████████████████████████████████████████████████████████████████▏                              | 390/561 [00:20<00:09, 18.12it/s] 70%|██████████████████████████████████████████████████████████████████████▌                              | 392/561 [00:20<00:09, 18.57it/s] 70%|███████████████████████████████████████████████████████████████████████                              | 395/561 [00:20<00:08, 19.90it/s][2025-03-28 01:24:47,908] [INFO] [logging.py:128:log_dist] [Rank 0] step=8250, skipped=18, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:24:47,909] [INFO] [timer.py:264:stop] epoch=0/micro_step=8250/global_step=8250, RunningAvgSamplesPerSec=18.575106374339875, CurrSamplesPerSec=22.98901348955715, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 71%|███████████████████████████████████████████████████████████████████████▋                             | 398/561 [00:20<00:07, 20.77it/s] 71%|████████████████████████████████████████████████████████████████████████▏                            | 401/561 [00:20<00:07, 20.13it/s] 72%|████████████████████████████████████████████████████████████████████████▋                            | 404/561 [00:20<00:07, 19.96it/s] 72%|█████████████████████████████████████████████████████████████████████████                            | 406/561 [00:20<00:07, 19.51it/s] 73%|█████████████████████████████████████████████████████████████████████████▍                           | 408/561 [00:20<00:07, 19.15it/s] 73%|█████████████████████████████████████████████████████████████████████████▊                           | 410/561 [00:21<00:07, 18.88it/s] 73%|██████████████████████████████████████████████████████████████████████████▏                          | 412/561 [00:21<00:07, 18.67it/s] 74%|██████████████████████████████████████████████████████████████████████████▌                          | 414/561 [00:21<00:07, 18.51it/s] 74%|██████████████████████████████████████████████████████████████████████████▉                          | 416/561 [00:21<00:07, 18.40it/s] 75%|███████████████████████████████████████████████████████████████████████████▎                         | 418/561 [00:21<00:07, 18.30it/s] 75%|███████████████████████████████████████████████████████████████████████████▌                         | 420/561 [00:21<00:07, 18.22it/s] 75%|███████████████████████████████████████████████████████████████████████████▉                         | 422/561 [00:21<00:07, 18.55it/s] 76%|████████████████████████████████████████████████████████████████████████████▌                        | 425/561 [00:21<00:06, 19.81it/s] 76%|█████████████████████████████████████████████████████████████████████████████                        | 428/561 [00:21<00:06, 20.61it/s] 77%|█████████████████████████████████████████████████████████████████████████████▌                       | 431/561 [00:22<00:06, 21.10it/s] 77%|██████████████████████████████████████████████████████████████████████████████▏                      | 434/561 [00:22<00:05, 21.34it/s] 78%|██████████████████████████████████████████████████████████████████████████████▋                      | 437/561 [00:22<00:05, 20.78it/s] 78%|███████████████████████████████████████████████████████████████████████████████▏                     | 440/561 [00:22<00:06, 19.87it/s] 79%|███████████████████████████████████████████████████████████████████████████████▌                     | 442/561 [00:22<00:06, 19.45it/s] 79%|███████████████████████████████████████████████████████████████████████████████▉                     | 444/561 [00:22<00:06, 19.11it/s][2025-03-28 01:24:50,483] [INFO] [logging.py:128:log_dist] [Rank 0] step=8300, skipped=18, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:24:50,486] [INFO] [timer.py:264:stop] epoch=0/micro_step=8300/global_step=8300, RunningAvgSamplesPerSec=18.580118849392495, CurrSamplesPerSec=18.313323327284742, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 80%|████████████████████████████████████████████████████████████████████████████████▎                    | 446/561 [00:22<00:06, 18.87it/s] 80%|████████████████████████████████████████████████████████████████████████████████▋                    | 448/561 [00:23<00:06, 18.70it/s] 80%|█████████████████████████████████████████████████████████████████████████████████                    | 450/561 [00:23<00:05, 18.54it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▍                   | 452/561 [00:23<00:05, 18.42it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▋                   | 454/561 [00:23<00:05, 18.34it/s] 81%|██████████████████████████████████████████████████████████████████████████████████▎                  | 457/561 [00:23<00:05, 19.83it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▊                  | 460/561 [00:23<00:04, 20.86it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▎                 | 463/561 [00:23<00:04, 21.29it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▉                 | 466/561 [00:23<00:04, 21.11it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▍                | 469/561 [00:24<00:04, 20.07it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▉                | 472/561 [00:24<00:04, 19.43it/s] 84%|█████████████████████████████████████████████████████████████████████████████████████▎               | 474/561 [00:24<00:04, 19.12it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▋               | 476/561 [00:24<00:04, 18.90it/s] 85%|██████████████████████████████████████████████████████████████████████████████████████               | 478/561 [00:24<00:04, 18.71it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▍              | 480/561 [00:24<00:04, 18.55it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▊              | 482/561 [00:24<00:04, 18.43it/s] 86%|███████████████████████████████████████████████████████████████████████████████████████▏             | 484/561 [00:24<00:04, 18.35it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▋             | 487/561 [00:25<00:03, 19.51it/s] 87%|████████████████████████████████████████████████████████████████████████████████████████▏            | 490/561 [00:25<00:03, 20.34it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▊            | 493/561 [00:25<00:03, 21.37it/s][2025-03-28 01:24:52,996] [INFO] [logging.py:128:log_dist] [Rank 0] step=8350, skipped=18, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:24:52,999] [INFO] [timer.py:264:stop] epoch=0/micro_step=8350/global_step=8350, RunningAvgSamplesPerSec=18.58770498365587, CurrSamplesPerSec=19.043447642359098, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 88%|█████████████████████████████████████████████████████████████████████████████████████████▎           | 496/561 [00:25<00:03, 21.37it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▊           | 499/561 [00:25<00:03, 20.26it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████▍          | 502/561 [00:25<00:03, 19.56it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▋          | 504/561 [00:25<00:02, 19.22it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████████          | 506/561 [00:25<00:02, 18.96it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▍         | 508/561 [00:26<00:02, 18.77it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▊         | 510/561 [00:26<00:02, 18.60it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████████▏        | 512/561 [00:26<00:02, 18.49it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████████▌        | 514/561 [00:26<00:02, 18.38it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████        | 517/561 [00:26<00:02, 19.45it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▌       | 520/561 [00:26<00:02, 20.14it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████████▏      | 523/561 [00:26<00:01, 20.82it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▋      | 526/561 [00:26<00:01, 21.42it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▏     | 529/561 [00:27<00:01, 21.30it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▊     | 532/561 [00:27<00:01, 20.05it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████████▎    | 535/561 [00:27<00:01, 19.41it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▋    | 537/561 [00:27<00:01, 19.14it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████    | 539/561 [00:27<00:01, 18.94it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████▍   | 541/561 [00:27<00:01, 18.73it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████████▊   | 543/561 [00:27<00:00, 18.56it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████████   | 545/561 [00:27<00:00, 18.43it/s][2025-03-28 01:24:55,613] [INFO] [logging.py:128:log_dist] [Rank 0] step=8400, skipped=18, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:24:55,616] [INFO] [timer.py:264:stop] epoch=0/micro_step=8400/global_step=8400, RunningAvgSamplesPerSec=18.59094544054657, CurrSamplesPerSec=18.1758715401819, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▍  | 547/561 [00:28<00:00, 18.34it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████████  | 550/561 [00:28<00:00, 20.59it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▌ | 553/561 [00:28<00:00, 21.29it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████ | 556/561 [00:28<00:00, 21.52it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████████▋| 559/561 [00:28<00:00, 22.21it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:28<00:00, 19.51it/s]
  0%|                                                                                                               | 0/561 [00:00<?, ?it/s]  0%|▏                                                                                                      | 1/561 [00:00<04:05,  2.28it/s]  1%|▌                                                                                                      | 3/561 [00:00<01:26,  6.42it/s]  1%|▉                                                                                                      | 5/561 [00:00<00:57,  9.60it/s]  1%|█▎                                                                                                     | 7/561 [00:00<00:46, 11.99it/s]  2%|█▋                                                                                                     | 9/561 [00:00<00:40, 13.73it/s]  2%|██                                                                                                    | 11/561 [00:00<00:36, 15.22it/s]  2%|██▌                                                                                                   | 14/561 [00:01<00:31, 17.55it/s]  3%|███                                                                                                   | 17/561 [00:01<00:28, 18.83it/s]  4%|███▋                                                                                                  | 20/561 [00:01<00:27, 19.89it/s]  4%|████▏                                                                                                 | 23/561 [00:01<00:25, 20.90it/s]  5%|████▋                                                                                                 | 26/561 [00:01<00:25, 21.30it/s]  5%|█████▎                                                                                                | 29/561 [00:01<00:24, 21.52it/s]  6%|█████▊                                                                                                | 32/561 [00:01<00:24, 21.44it/s][2025-03-28 01:24:58,446] [INFO] [logging.py:128:log_dist] [Rank 0] step=8450, skipped=18, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:24:58,449] [INFO] [timer.py:264:stop] epoch=0/micro_step=8450/global_step=8450, RunningAvgSamplesPerSec=18.591219449688136, CurrSamplesPerSec=18.248863135381278, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
  6%|██████▎                                                                                               | 35/561 [00:02<00:25, 20.69it/s]  7%|██████▉                                                                                               | 38/561 [00:02<00:26, 19.89it/s]  7%|███████▍                                                                                              | 41/561 [00:02<00:26, 19.35it/s]  8%|███████▊                                                                                              | 43/561 [00:02<00:27, 19.08it/s]  8%|████████▏                                                                                             | 45/561 [00:02<00:27, 18.84it/s]  8%|████████▌                                                                                             | 47/561 [00:02<00:27, 18.64it/s]  9%|████████▉                                                                                             | 49/561 [00:02<00:27, 18.50it/s]  9%|█████████▎                                                                                            | 51/561 [00:02<00:27, 18.39it/s]  9%|█████████▋                                                                                            | 53/561 [00:03<00:27, 18.64it/s] 10%|██████████                                                                                            | 55/561 [00:03<00:27, 18.50it/s] 10%|██████████▌                                                                                           | 58/561 [00:03<00:25, 19.48it/s] 11%|███████████                                                                                           | 61/561 [00:03<00:24, 20.21it/s] 11%|███████████▋                                                                                          | 64/561 [00:03<00:23, 20.71it/s] 12%|████████████▏                                                                                         | 67/561 [00:03<00:23, 21.46it/s] 12%|████████████▋                                                                                         | 70/561 [00:03<00:22, 21.59it/s] 13%|█████████████▎                                                                                        | 73/561 [00:04<00:23, 20.40it/s] 14%|█████████████▊                                                                                        | 76/561 [00:04<00:24, 19.67it/s] 14%|██████████████▏                                                                                       | 78/561 [00:04<00:25, 19.30it/s] 14%|██████████████▌                                                                                       | 80/561 [00:04<00:25, 19.01it/s] 15%|██████████████▉                                                                                       | 82/561 [00:04<00:25, 18.78it/s] 15%|███████████████▎                                                                                      | 84/561 [00:04<00:25, 18.58it/s][2025-03-28 01:25:01,050] [INFO] [logging.py:128:log_dist] [Rank 0] step=8500, skipped=18, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:25:01,053] [INFO] [timer.py:264:stop] epoch=0/micro_step=8500/global_step=8500, RunningAvgSamplesPerSec=18.594941791105736, CurrSamplesPerSec=18.14026112179012, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 15%|███████████████▋                                                                                      | 86/561 [00:04<00:25, 18.44it/s] 16%|████████████████                                                                                      | 88/561 [00:04<00:25, 18.36it/s] 16%|████████████████▎                                                                                     | 90/561 [00:04<00:25, 18.71it/s] 17%|████████████████▉                                                                                     | 93/561 [00:05<00:23, 20.03it/s] 17%|█████████████████▎                                                                                    | 95/561 [00:05<00:24, 19.26it/s] 17%|█████████████████▊                                                                                    | 98/561 [00:05<00:22, 20.23it/s] 18%|██████████████████▏                                                                                  | 101/561 [00:05<00:22, 20.71it/s] 19%|██████████████████▋                                                                                  | 104/561 [00:05<00:21, 20.82it/s] 19%|███████████████████▎                                                                                 | 107/561 [00:05<00:21, 20.95it/s] 20%|███████████████████▊                                                                                 | 110/561 [00:05<00:21, 21.20it/s] 20%|████████████████████▎                                                                                | 113/561 [00:06<00:22, 20.27it/s] 21%|████████████████████▉                                                                                | 116/561 [00:06<00:22, 19.56it/s] 21%|█████████████████████▏                                                                               | 118/561 [00:06<00:23, 19.23it/s] 21%|█████████████████████▌                                                                               | 120/561 [00:06<00:23, 18.96it/s] 22%|█████████████████████▉                                                                               | 122/561 [00:06<00:23, 18.76it/s] 22%|██████████████████████▎                                                                              | 124/561 [00:06<00:23, 18.59it/s] 22%|██████████████████████▋                                                                              | 126/561 [00:06<00:23, 18.45it/s] 23%|███████████████████████                                                                              | 128/561 [00:06<00:23, 18.36it/s] 23%|███████████████████████▍                                                                             | 130/561 [00:07<00:22, 18.77it/s] 24%|███████████████████████▉                                                                             | 133/561 [00:07<00:21, 19.99it/s][2025-03-28 01:25:03,580] [INFO] [logging.py:128:log_dist] [Rank 0] step=8550, skipped=18, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:25:03,581] [INFO] [timer.py:264:stop] epoch=0/micro_step=8550/global_step=8550, RunningAvgSamplesPerSec=18.601752551783214, CurrSamplesPerSec=21.16088940191991, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 24%|████████████████████████▍                                                                            | 136/561 [00:07<00:20, 20.43it/s] 25%|█████████████████████████                                                                            | 139/561 [00:07<00:20, 20.97it/s] 25%|█████████████████████████▌                                                                           | 142/561 [00:07<00:19, 21.38it/s] 26%|██████████████████████████                                                                           | 145/561 [00:07<00:19, 21.73it/s] 26%|██████████████████████████▋                                                                          | 148/561 [00:07<00:18, 21.91it/s] 27%|███████████████████████████▏                                                                         | 151/561 [00:07<00:18, 22.02it/s] 27%|███████████████████████████▋                                                                         | 154/561 [00:08<00:19, 21.19it/s] 28%|████████████████████████████▎                                                                        | 157/561 [00:08<00:19, 20.20it/s] 29%|████████████████████████████▊                                                                        | 160/561 [00:08<00:20, 19.56it/s] 29%|█████████████████████████████▏                                                                       | 162/561 [00:08<00:20, 19.24it/s] 29%|█████████████████████████████▌                                                                       | 164/561 [00:08<00:20, 18.98it/s] 30%|█████████████████████████████▉                                                                       | 166/561 [00:08<00:21, 18.74it/s] 30%|██████████████████████████████▏                                                                      | 168/561 [00:08<00:21, 18.55it/s] 30%|██████████████████████████████▌                                                                      | 170/561 [00:08<00:21, 18.43it/s] 31%|██████████████████████████████▉                                                                      | 172/561 [00:09<00:20, 18.71it/s] 31%|███████████████████████████████▌                                                                     | 175/561 [00:09<00:18, 20.38it/s] 32%|████████████████████████████████                                                                     | 178/561 [00:09<00:17, 21.41it/s] 32%|████████████████████████████████▌                                                                    | 181/561 [00:09<00:17, 21.93it/s] 33%|█████████████████████████████████▏                                                                   | 184/561 [00:09<00:17, 22.01it/s][2025-03-28 01:25:06,001] [INFO] [logging.py:128:log_dist] [Rank 0] step=8600, skipped=18, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:25:06,002] [INFO] [timer.py:264:stop] epoch=0/micro_step=8600/global_step=8600, RunningAvgSamplesPerSec=18.612763664883936, CurrSamplesPerSec=21.919632404286123, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 33%|█████████████████████████████████▋                                                                   | 187/561 [00:09<00:17, 21.88it/s] 34%|██████████████████████████████████▏                                                                  | 190/561 [00:09<00:16, 21.86it/s] 34%|██████████████████████████████████▋                                                                  | 193/561 [00:10<00:16, 21.83it/s] 35%|███████████████████████████████████▎                                                                 | 196/561 [00:10<00:16, 21.58it/s] 35%|███████████████████████████████████▊                                                                 | 199/561 [00:10<00:17, 20.42it/s] 36%|████████████████████████████████████▎                                                                | 202/561 [00:10<00:18, 19.89it/s] 37%|████████████████████████████████████▉                                                                | 205/561 [00:10<00:18, 19.33it/s] 37%|█████████████████████████████████████▎                                                               | 207/561 [00:10<00:18, 19.06it/s] 37%|█████████████████████████████████████▋                                                               | 209/561 [00:10<00:18, 18.83it/s] 38%|█████████████████████████████████████▉                                                               | 211/561 [00:10<00:18, 18.65it/s] 38%|██████████████████████████████████████▎                                                              | 213/561 [00:11<00:18, 18.51it/s] 38%|██████████████████████████████████████▋                                                              | 215/561 [00:11<00:18, 18.42it/s] 39%|███████████████████████████████████████▏                                                             | 218/561 [00:11<00:17, 19.34it/s] 39%|███████████████████████████████████████▊                                                             | 221/561 [00:11<00:16, 20.26it/s] 40%|████████████████████████████████████████▎                                                            | 224/561 [00:11<00:16, 20.86it/s] 40%|████████████████████████████████████████▊                                                            | 227/561 [00:11<00:16, 20.25it/s] 41%|█████████████████████████████████████████▍                                                           | 230/561 [00:11<00:15, 20.92it/s] 42%|█████████████████████████████████████████▉                                                           | 233/561 [00:12<00:15, 21.38it/s][2025-03-28 01:25:08,480] [INFO] [logging.py:128:log_dist] [Rank 0] step=8650, skipped=18, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:25:08,480] [INFO] [timer.py:264:stop] epoch=0/micro_step=8650/global_step=8650, RunningAvgSamplesPerSec=18.621321065765603, CurrSamplesPerSec=21.72795773955718, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 42%|██████████████████████████████████████████▍                                                          | 236/561 [00:12<00:15, 21.60it/s] 43%|███████████████████████████████████████████                                                          | 239/561 [00:12<00:14, 22.19it/s] 43%|███████████████████████████████████████████▌                                                         | 242/561 [00:12<00:14, 22.27it/s] 44%|████████████████████████████████████████████                                                         | 245/561 [00:12<00:15, 20.84it/s] 44%|████████████████████████████████████████████▋                                                        | 248/561 [00:12<00:15, 19.98it/s] 45%|█████████████████████████████████████████████▏                                                       | 251/561 [00:12<00:16, 19.29it/s] 45%|█████████████████████████████████████████████▌                                                       | 253/561 [00:13<00:16, 19.05it/s] 45%|█████████████████████████████████████████████▉                                                       | 255/561 [00:13<00:16, 18.82it/s] 46%|██████████████████████████████████████████████▎                                                      | 257/561 [00:13<00:16, 18.64it/s] 46%|██████████████████████████████████████████████▋                                                      | 259/561 [00:13<00:16, 18.49it/s] 47%|██████████████████████████████████████████████▉                                                      | 261/561 [00:13<00:16, 18.38it/s] 47%|███████████████████████████████████████████████▌                                                     | 264/561 [00:13<00:14, 20.21it/s] 48%|████████████████████████████████████████████████                                                     | 267/561 [00:13<00:14, 20.96it/s] 48%|████████████████████████████████████████████████▌                                                    | 270/561 [00:13<00:13, 21.18it/s] 49%|█████████████████████████████████████████████████▏                                                   | 273/561 [00:14<00:13, 21.35it/s] 49%|█████████████████████████████████████████████████▋                                                   | 276/561 [00:14<00:13, 21.64it/s] 50%|██████████████████████████████████████████████████▏                                                  | 279/561 [00:14<00:13, 21.58it/s] 50%|██████████████████████████████████████████████████▊                                                  | 282/561 [00:14<00:12, 21.58it/s][2025-03-28 01:25:10,909] [INFO] [logging.py:128:log_dist] [Rank 0] step=8700, skipped=18, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:25:10,910] [INFO] [timer.py:264:stop] epoch=0/micro_step=8700/global_step=8700, RunningAvgSamplesPerSec=18.631763956818666, CurrSamplesPerSec=23.566525005646376, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 51%|███████████████████████████████████████████████████▎                                                 | 285/561 [00:14<00:12, 22.09it/s] 51%|███████████████████████████████████████████████████▊                                                 | 288/561 [00:14<00:12, 22.02it/s] 52%|████████████████████████████████████████████████████▍                                                | 291/561 [00:14<00:12, 21.15it/s] 52%|████████████████████████████████████████████████████▉                                                | 294/561 [00:15<00:13, 20.02it/s] 53%|█████████████████████████████████████████████████████▍                                               | 297/561 [00:15<00:13, 19.43it/s] 53%|█████████████████████████████████████████████████████▊                                               | 299/561 [00:15<00:13, 19.13it/s] 54%|██████████████████████████████████████████████████████▏                                              | 301/561 [00:15<00:13, 18.88it/s] 54%|██████████████████████████████████████████████████████▌                                              | 303/561 [00:15<00:13, 18.67it/s] 54%|██████████████████████████████████████████████████████▉                                              | 305/561 [00:15<00:14, 17.67it/s] 55%|███████████████████████████████████████████████████████▎                                             | 307/561 [00:15<00:14, 17.79it/s] 55%|███████████████████████████████████████████████████████▊                                             | 310/561 [00:15<00:13, 18.72it/s] 56%|████████████████████████████████████████████████████████▎                                            | 313/561 [00:16<00:12, 19.49it/s] 56%|████████████████████████████████████████████████████████▉                                            | 316/561 [00:16<00:11, 20.42it/s] 57%|█████████████████████████████████████████████████████████▍                                           | 319/561 [00:16<00:11, 21.45it/s] 57%|█████████████████████████████████████████████████████████▉                                           | 322/561 [00:16<00:10, 21.97it/s] 58%|██████████████████████████████████████████████████████████▌                                          | 325/561 [00:16<00:10, 22.00it/s] 58%|███████████████████████████████████████████████████████████                                          | 328/561 [00:16<00:10, 22.10it/s] 59%|███████████████████████████████████████████████████████████▌                                         | 331/561 [00:16<00:10, 22.18it/s] 60%|████████████████████████████████████████████████████████████▏                                        | 334/561 [00:16<00:10, 22.42it/s][2025-03-28 01:25:13,358] [INFO] [logging.py:128:log_dist] [Rank 0] step=8750, skipped=18, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:25:13,359] [INFO] [timer.py:264:stop] epoch=0/micro_step=8750/global_step=8750, RunningAvgSamplesPerSec=18.641304344479575, CurrSamplesPerSec=23.897916098543725, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 60%|████████████████████████████████████████████████████████████▋                                        | 337/561 [00:17<00:09, 22.99it/s] 61%|█████████████████████████████████████████████████████████████▏                                       | 340/561 [00:17<00:09, 23.23it/s] 61%|█████████████████████████████████████████████████████████████▊                                       | 343/561 [00:17<00:09, 23.35it/s] 62%|██████████████████████████████████████████████████████████████▎                                      | 346/561 [00:17<00:09, 22.20it/s] 62%|██████████████████████████████████████████████████████████████▊                                      | 349/561 [00:17<00:09, 22.09it/s] 63%|███████████████████████████████████████████████████████████████▎                                     | 352/561 [00:17<00:09, 21.72it/s] 63%|███████████████████████████████████████████████████████████████▉                                     | 355/561 [00:17<00:10, 20.38it/s] 64%|████████████████████████████████████████████████████████████████▍                                    | 358/561 [00:18<00:10, 19.67it/s] 64%|████████████████████████████████████████████████████████████████▊                                    | 360/561 [00:18<00:10, 19.32it/s] 65%|█████████████████████████████████████████████████████████████████▏                                   | 362/561 [00:18<00:10, 18.88it/s] 65%|█████████████████████████████████████████████████████████████████▌                                   | 364/561 [00:18<00:10, 18.67it/s] 65%|█████████████████████████████████████████████████████████████████▉                                   | 366/561 [00:18<00:10, 18.51it/s] 66%|██████████████████████████████████████████████████████████████████▎                                  | 368/561 [00:18<00:10, 18.39it/s] 66%|██████████████████████████████████████████████████████████████████▌                                  | 370/561 [00:18<00:10, 18.30it/s] 66%|███████████████████████████████████████████████████████████████████▏                                 | 373/561 [00:18<00:09, 19.83it/s] 67%|███████████████████████████████████████████████████████████████████▋                                 | 376/561 [00:19<00:08, 20.95it/s] 68%|████████████████████████████████████████████████████████████████████▏                                | 379/561 [00:19<00:08, 21.17it/s] 68%|████████████████████████████████████████████████████████████████████▊                                | 382/561 [00:19<00:08, 21.32it/s][2025-03-28 01:25:15,798] [INFO] [logging.py:128:log_dist] [Rank 0] step=8800, skipped=18, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:25:15,798] [INFO] [timer.py:264:stop] epoch=0/micro_step=8800/global_step=8800, RunningAvgSamplesPerSec=18.651122695796282, CurrSamplesPerSec=21.40680661538305, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 69%|█████████████████████████████████████████████████████████████████████▎                               | 385/561 [00:19<00:08, 21.38it/s] 69%|█████████████████████████████████████████████████████████████████████▊                               | 388/561 [00:19<00:07, 21.69it/s] 70%|██████████████████████████████████████████████████████████████████████▍                              | 391/561 [00:19<00:07, 22.25it/s] 70%|██████████████████████████████████████████████████████████████████████▉                              | 394/561 [00:19<00:07, 22.55it/s] 71%|███████████████████████████████████████████████████████████████████████▍                             | 397/561 [00:19<00:07, 22.54it/s] 71%|████████████████████████████████████████████████████████████████████████                             | 400/561 [00:20<00:07, 22.92it/s] 72%|████████████████████████████████████████████████████████████████████████▌                            | 403/561 [00:20<00:06, 23.31it/s] 72%|█████████████████████████████████████████████████████████████████████████                            | 406/561 [00:20<00:06, 23.42it/s] 73%|█████████████████████████████████████████████████████████████████████████▋                           | 409/561 [00:20<00:06, 23.29it/s] 73%|██████████████████████████████████████████████████████████████████████████▏                          | 412/561 [00:20<00:06, 22.70it/s] 74%|██████████████████████████████████████████████████████████████████████████▋                          | 415/561 [00:20<00:06, 21.16it/s] 75%|███████████████████████████████████████████████████████████████████████████▎                         | 418/561 [00:20<00:07, 20.17it/s] 75%|███████████████████████████████████████████████████████████████████████████▊                         | 421/561 [00:21<00:07, 19.52it/s] 75%|████████████████████████████████████████████████████████████████████████████▏                        | 423/561 [00:21<00:07, 19.20it/s] 76%|████████████████████████████████████████████████████████████████████████████▌                        | 425/561 [00:21<00:07, 18.92it/s] 76%|████████████████████████████████████████████████████████████████████████████▉                        | 427/561 [00:21<00:07, 18.70it/s] 76%|█████████████████████████████████████████████████████████████████████████████▏                       | 429/561 [00:21<00:07, 18.53it/s] 77%|█████████████████████████████████████████████████████████████████████████████▌                       | 431/561 [00:21<00:06, 18.84it/s] 77%|██████████████████████████████████████████████████████████████████████████████▏                      | 434/561 [00:21<00:06, 20.44it/s][2025-03-28 01:25:18,173] [INFO] [logging.py:128:log_dist] [Rank 0] step=8850, skipped=18, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:25:18,173] [INFO] [timer.py:264:stop] epoch=0/micro_step=8850/global_step=8850, RunningAvgSamplesPerSec=18.66338493011299, CurrSamplesPerSec=24.35148205068295, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 78%|██████████████████████████████████████████████████████████████████████████████▋                      | 437/561 [00:21<00:05, 21.54it/s] 78%|███████████████████████████████████████████████████████████████████████████████▏                     | 440/561 [00:22<00:05, 22.08it/s] 79%|███████████████████████████████████████████████████████████████████████████████▊                     | 443/561 [00:22<00:05, 22.24it/s] 80%|████████████████████████████████████████████████████████████████████████████████▎                    | 446/561 [00:22<00:05, 22.39it/s] 80%|████████████████████████████████████████████████████████████████████████████████▊                    | 449/561 [00:22<00:04, 22.82it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▍                   | 452/561 [00:22<00:04, 23.07it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▉                   | 455/561 [00:22<00:04, 23.28it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▍                  | 458/561 [00:22<00:04, 23.38it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▉                  | 461/561 [00:22<00:04, 23.59it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▌                 | 464/561 [00:23<00:04, 23.52it/s] 83%|████████████████████████████████████████████████████████████████████████████████████                 | 467/561 [00:23<00:03, 23.70it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▌                | 470/561 [00:23<00:03, 23.43it/s] 84%|█████████████████████████████████████████████████████████████████████████████████████▏               | 473/561 [00:23<00:04, 21.53it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▋               | 476/561 [00:23<00:04, 20.40it/s] 85%|██████████████████████████████████████████████████████████████████████████████████████▏              | 479/561 [00:23<00:04, 19.56it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▌              | 481/561 [00:23<00:04, 19.24it/s] 86%|███████████████████████████████████████████████████████████████████████████████████████▏             | 484/561 [00:24<00:03, 19.62it/s][2025-03-28 01:25:20,473] [INFO] [logging.py:128:log_dist] [Rank 0] step=8900, skipped=18, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:25:20,476] [INFO] [timer.py:264:stop] epoch=0/micro_step=8900/global_step=8900, RunningAvgSamplesPerSec=18.678331539292472, CurrSamplesPerSec=18.177368189130988, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 87%|███████████████████████████████████████████████████████████████████████████████████████▍             | 486/561 [00:24<00:03, 19.24it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▊             | 488/561 [00:24<00:03, 18.94it/s] 87%|████████████████████████████████████████████████████████████████████████████████████████▏            | 490/561 [00:24<00:03, 18.96it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▊            | 493/561 [00:24<00:03, 20.34it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████████▎           | 496/561 [00:24<00:03, 21.36it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▊           | 499/561 [00:24<00:02, 22.00it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████▍          | 502/561 [00:24<00:02, 21.95it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▉          | 505/561 [00:25<00:02, 21.93it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▍         | 508/561 [00:25<00:02, 21.96it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▉         | 511/561 [00:25<00:02, 21.89it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████████▌        | 514/561 [00:25<00:02, 21.70it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████        | 517/561 [00:25<00:02, 21.95it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▌       | 520/561 [00:25<00:01, 21.69it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████████▏      | 523/561 [00:25<00:01, 22.22it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▋      | 526/561 [00:25<00:01, 22.58it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▏     | 529/561 [00:26<00:01, 22.90it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▊     | 532/561 [00:26<00:01, 22.94it/s][2025-03-28 01:25:22,744] [INFO] [logging.py:128:log_dist] [Rank 0] step=8950, skipped=18, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:25:22,745] [INFO] [timer.py:264:stop] epoch=0/micro_step=8950/global_step=8950, RunningAvgSamplesPerSec=18.69449258103876, CurrSamplesPerSec=22.059123661237496, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 95%|████████████████████████████████████████████████████████████████████████████████████████████████▎    | 535/561 [00:26<00:01, 22.57it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▊    | 538/561 [00:26<00:01, 22.48it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████▍   | 541/561 [00:26<00:00, 21.58it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████████▉   | 544/561 [00:26<00:00, 20.44it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▍  | 547/561 [00:27<00:00, 19.58it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▊  | 549/561 [00:27<00:00, 19.25it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████████▏ | 551/561 [00:27<00:00, 18.97it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▌ | 553/561 [00:27<00:00, 18.74it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▉ | 555/561 [00:27<00:00, 18.56it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████▎| 557/561 [00:27<00:00, 18.43it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████████▋| 559/561 [00:27<00:00, 18.75it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:27<00:00, 20.17it/s]
  0%|                                                                                                               | 0/561 [00:00<?, ?it/s]  0%|▏                                                                                                      | 1/561 [00:00<04:01,  2.32it/s]  1%|▋                                                                                                      | 4/561 [00:00<01:07,  8.26it/s]  1%|█▎                                                                                                     | 7/561 [00:00<00:44, 12.33it/s]  2%|█▊                                                                                                    | 10/561 [00:00<00:36, 15.13it/s]  2%|██▎                                                                                                   | 13/561 [00:00<00:31, 17.18it/s]  3%|██▉                                                                                                   | 16/561 [00:01<00:29, 18.60it/s]  3%|███▍                                                                                                  | 19/561 [00:01<00:28, 19.03it/s]  4%|████                                                                                                  | 22/561 [00:01<00:27, 19.77it/s][2025-03-28 01:25:25,704] [INFO] [logging.py:128:log_dist] [Rank 0] step=9000, skipped=18, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:25:25,705] [INFO] [timer.py:264:stop] epoch=0/micro_step=9000/global_step=9000, RunningAvgSamplesPerSec=18.689245354433176, CurrSamplesPerSec=21.191252702802235, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
  4%|████▌                                                                                                 | 25/561 [00:01<00:26, 20.28it/s]  5%|█████                                                                                                 | 28/561 [00:01<00:25, 20.85it/s]  6%|█████▋                                                                                                | 31/561 [00:01<00:25, 21.18it/s]  6%|██████▏                                                                                               | 34/561 [00:01<00:25, 20.59it/s]  7%|██████▋                                                                                               | 37/561 [00:02<00:26, 19.66it/s]  7%|███████                                                                                               | 39/561 [00:02<00:27, 19.33it/s]  7%|███████▍                                                                                              | 41/561 [00:02<00:27, 19.05it/s][2025-03-28 01:25:26,667] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
  8%|███████▊                                                                                              | 43/561 [00:02<00:26, 19.20it/s][2025-03-28 01:25:26,713] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
  8%|████████▏                                                                                             | 45/561 [00:02<00:26, 19.35it/s]  8%|████████▌                                                                                             | 47/561 [00:02<00:27, 18.99it/s]  9%|████████▉                                                                                             | 49/561 [00:02<00:27, 18.72it/s]  9%|█████████▎                                                                                            | 51/561 [00:02<00:27, 18.53it/s] 10%|█████████▊                                                                                            | 54/561 [00:03<00:25, 19.77it/s] 10%|██████████▎                                                                                           | 57/561 [00:03<00:23, 21.15it/s] 11%|██████████▉                                                                                           | 60/561 [00:03<00:22, 21.87it/s] 11%|███████████▍                                                                                          | 63/561 [00:03<00:22, 22.22it/s] 12%|████████████                                                                                          | 66/561 [00:03<00:22, 22.17it/s] 12%|████████████▌                                                                                         | 69/561 [00:03<00:22, 22.03it/s] 13%|█████████████                                                                                         | 72/561 [00:03<00:22, 21.92it/s][2025-03-28 01:25:28,121] [INFO] [logging.py:128:log_dist] [Rank 0] step=9050, skipped=20, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:25:28,122] [INFO] [timer.py:264:stop] epoch=0/micro_step=9050/global_step=9050, RunningAvgSamplesPerSec=18.699434219370605, CurrSamplesPerSec=21.479269052870386, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 13%|█████████████▋                                                                                        | 75/561 [00:03<00:22, 21.83it/s] 14%|██████████████▏                                                                                       | 78/561 [00:04<00:22, 21.80it/s] 14%|██████████████▋                                                                                       | 81/561 [00:04<00:21, 21.85it/s] 15%|███████████████▎                                                                                      | 84/561 [00:04<00:21, 21.93it/s] 16%|███████████████▊                                                                                      | 87/561 [00:04<00:21, 22.02it/s] 16%|████████████████▎                                                                                     | 90/561 [00:04<00:21, 22.23it/s] 17%|████████████████▉                                                                                     | 93/561 [00:04<00:21, 22.26it/s] 17%|█████████████████▍                                                                                    | 96/561 [00:04<00:21, 22.02it/s] 18%|██████████████████                                                                                    | 99/561 [00:05<00:20, 22.48it/s] 18%|██████████████████▎                                                                                  | 102/561 [00:05<00:20, 22.77it/s] 19%|██████████████████▉                                                                                  | 105/561 [00:05<00:21, 21.38it/s] 19%|███████████████████▍                                                                                 | 108/561 [00:05<00:20, 21.86it/s] 20%|███████████████████▉                                                                                 | 111/561 [00:05<00:20, 21.75it/s] 20%|████████████████████▌                                                                                | 114/561 [00:05<00:20, 21.44it/s] 21%|█████████████████████                                                                                | 117/561 [00:05<00:22, 19.58it/s] 21%|█████████████████████▍                                                                               | 119/561 [00:06<00:23, 19.09it/s] 22%|█████████████████████▊                                                                               | 121/561 [00:06<00:23, 18.86it/s] 22%|██████████████████████▏                                                                              | 123/561 [00:06<00:23, 18.66it/s][2025-03-28 01:25:30,520] [INFO] [logging.py:128:log_dist] [Rank 0] step=9100, skipped=20, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:25:30,523] [INFO] [timer.py:264:stop] epoch=0/micro_step=9100/global_step=9100, RunningAvgSamplesPerSec=18.710150190162572, CurrSamplesPerSec=18.17870750502508, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 22%|██████████████████████▌                                                                              | 125/561 [00:06<00:23, 18.51it/s] 23%|██████████████████████▊                                                                              | 127/561 [00:06<00:23, 18.38it/s] 23%|███████████████████████▏                                                                             | 129/561 [00:06<00:23, 18.29it/s] 23%|███████████████████████▌                                                                             | 131/561 [00:06<00:23, 18.23it/s] 24%|████████████████████████                                                                             | 134/561 [00:06<00:22, 19.19it/s] 24%|████████████████████████▋                                                                            | 137/561 [00:06<00:21, 19.99it/s] 25%|█████████████████████████▏                                                                           | 140/561 [00:07<00:20, 20.54it/s] 25%|█████████████████████████▋                                                                           | 143/561 [00:07<00:20, 20.80it/s] 26%|██████████████████████████▎                                                                          | 146/561 [00:07<00:20, 20.50it/s] 27%|██████████████████████████▊                                                                          | 149/561 [00:07<00:19, 21.02it/s] 27%|███████████████████████████▎                                                                         | 152/561 [00:07<00:19, 21.46it/s] 28%|███████████████████████████▉                                                                         | 155/561 [00:07<00:18, 21.59it/s] 28%|████████████████████████████▍                                                                        | 158/561 [00:07<00:18, 21.63it/s] 29%|████████████████████████████▉                                                                        | 161/561 [00:08<00:18, 21.70it/s] 29%|█████████████████████████████▌                                                                       | 164/561 [00:08<00:18, 21.60it/s] 30%|██████████████████████████████                                                                       | 167/561 [00:08<00:18, 21.69it/s] 30%|██████████████████████████████▌                                                                      | 170/561 [00:08<00:17, 22.20it/s] 31%|███████████████████████████████▏                                                                     | 173/561 [00:08<00:17, 22.71it/s][2025-03-28 01:25:32,874] [INFO] [logging.py:128:log_dist] [Rank 0] step=9150, skipped=20, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:25:32,874] [INFO] [timer.py:264:stop] epoch=0/micro_step=9150/global_step=9150, RunningAvgSamplesPerSec=18.72267740795414, CurrSamplesPerSec=23.830027837953008, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 31%|███████████████████████████████▋                                                                     | 176/561 [00:08<00:16, 23.00it/s] 32%|████████████████████████████████▏                                                                    | 179/561 [00:08<00:16, 22.92it/s] 32%|████████████████████████████████▊                                                                    | 182/561 [00:09<00:16, 22.85it/s] 33%|█████████████████████████████████▎                                                                   | 185/561 [00:09<00:17, 22.03it/s] 34%|█████████████████████████████████▊                                                                   | 188/561 [00:09<00:16, 22.56it/s] 34%|██████████████████████████████████▍                                                                  | 191/561 [00:09<00:16, 22.88it/s] 35%|██████████████████████████████████▉                                                                  | 194/561 [00:09<00:15, 22.98it/s] 35%|███████████████████████████████████▍                                                                 | 197/561 [00:09<00:16, 21.42it/s] 36%|████████████████████████████████████                                                                 | 200/561 [00:09<00:17, 20.33it/s] 36%|████████████████████████████████████▌                                                                | 203/561 [00:10<00:18, 19.52it/s] 37%|████████████████████████████████████▉                                                                | 205/561 [00:10<00:18, 19.21it/s] 37%|█████████████████████████████████████▎                                                               | 207/561 [00:10<00:18, 18.95it/s] 37%|█████████████████████████████████████▋                                                               | 209/561 [00:10<00:18, 18.72it/s] 38%|█████████████████████████████████████▉                                                               | 211/561 [00:10<00:18, 18.54it/s] 38%|██████████████████████████████████████▎                                                              | 213/561 [00:10<00:18, 18.43it/s] 39%|██████████████████████████████████████▉                                                              | 216/561 [00:10<00:17, 19.66it/s] 39%|███████████████████████████████████████▍                                                             | 219/561 [00:10<00:16, 20.48it/s] 40%|███████████████████████████████████████▉                                                             | 222/561 [00:11<00:16, 21.07it/s][2025-03-28 01:25:35,292] [INFO] [logging.py:128:log_dist] [Rank 0] step=9200, skipped=20, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:25:35,293] [INFO] [timer.py:264:stop] epoch=0/micro_step=9200/global_step=9200, RunningAvgSamplesPerSec=18.732494010710788, CurrSamplesPerSec=22.345762696478022, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 40%|████████████████████████████████████████▌                                                            | 225/561 [00:11<00:15, 21.32it/s] 41%|█████████████████████████████████████████                                                            | 228/561 [00:11<00:15, 21.56it/s] 41%|█████████████████████████████████████████▌                                                           | 231/561 [00:11<00:15, 21.68it/s] 42%|██████████████████████████████████████████▏                                                          | 234/561 [00:11<00:15, 21.68it/s] 42%|██████████████████████████████████████████▋                                                          | 237/561 [00:11<00:14, 21.70it/s] 43%|███████████████████████████████████████████▏                                                         | 240/561 [00:11<00:14, 21.68it/s] 43%|███████████████████████████████████████████▋                                                         | 243/561 [00:11<00:14, 21.58it/s] 44%|████████████████████████████████████████████▎                                                        | 246/561 [00:12<00:14, 21.22it/s] 44%|████████████████████████████████████████████▊                                                        | 249/561 [00:12<00:14, 21.05it/s] 45%|█████████████████████████████████████████████▎                                                       | 252/561 [00:12<00:14, 21.23it/s] 45%|█████████████████████████████████████████████▉                                                       | 255/561 [00:12<00:14, 21.63it/s] 46%|██████████████████████████████████████████████▍                                                      | 258/561 [00:12<00:13, 21.82it/s] 47%|██████████████████████████████████████████████▉                                                      | 261/561 [00:12<00:13, 21.74it/s] 47%|███████████████████████████████████████████████▌                                                     | 264/561 [00:12<00:13, 21.68it/s] 48%|████████████████████████████████████████████████                                                     | 267/561 [00:13<00:13, 21.76it/s] 48%|████████████████████████████████████████████████▌                                                    | 270/561 [00:13<00:13, 21.02it/s] 49%|█████████████████████████████████████████████████▏                                                   | 273/561 [00:13<00:13, 20.98it/s][2025-03-28 01:25:37,625] [INFO] [logging.py:128:log_dist] [Rank 0] step=9250, skipped=20, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:25:37,626] [INFO] [timer.py:264:stop] epoch=0/micro_step=9250/global_step=9250, RunningAvgSamplesPerSec=18.745492628720733, CurrSamplesPerSec=21.303081771401867, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 49%|█████████████████████████████████████████████████▋                                                   | 276/561 [00:13<00:13, 21.19it/s] 50%|██████████████████████████████████████████████████▏                                                  | 279/561 [00:13<00:13, 21.34it/s] 50%|██████████████████████████████████████████████████▊                                                  | 282/561 [00:13<00:13, 21.39it/s] 51%|███████████████████████████████████████████████████▎                                                 | 285/561 [00:13<00:12, 21.94it/s] 51%|███████████████████████████████████████████████████▊                                                 | 288/561 [00:14<00:12, 22.47it/s] 52%|████████████████████████████████████████████████████▍                                                | 291/561 [00:14<00:11, 22.86it/s] 52%|████████████████████████████████████████████████████▉                                                | 294/561 [00:14<00:11, 23.02it/s] 53%|█████████████████████████████████████████████████████▍                                               | 297/561 [00:14<00:11, 23.19it/s] 53%|██████████████████████████████████████████████████████                                               | 300/561 [00:14<00:11, 22.94it/s] 54%|██████████████████████████████████████████████████████▌                                              | 303/561 [00:14<00:12, 21.31it/s] 55%|███████████████████████████████████████████████████████                                              | 306/561 [00:14<00:12, 20.27it/s] 55%|███████████████████████████████████████████████████████▋                                             | 309/561 [00:15<00:12, 19.59it/s] 55%|███████████████████████████████████████████████████████▉                                             | 311/561 [00:15<00:12, 19.25it/s] 56%|████████████████████████████████████████████████████████▎                                            | 313/561 [00:15<00:13, 18.96it/s] 56%|████████████████████████████████████████████████████████▋                                            | 315/561 [00:15<00:13, 18.87it/s] 57%|█████████████████████████████████████████████████████████▎                                           | 318/561 [00:15<00:11, 20.35it/s] 57%|█████████████████████████████████████████████████████████▊                                           | 321/561 [00:15<00:11, 21.24it/s][2025-03-28 01:25:39,983] [INFO] [logging.py:128:log_dist] [Rank 0] step=9300, skipped=20, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:25:39,984] [INFO] [timer.py:264:stop] epoch=0/micro_step=9300/global_step=9300, RunningAvgSamplesPerSec=18.75739977813608, CurrSamplesPerSec=21.31141638690387, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 58%|██████████████████████████████████████████████████████████▎                                          | 324/561 [00:15<00:11, 21.19it/s] 58%|██████████████████████████████████████████████████████████▊                                          | 327/561 [00:15<00:10, 21.58it/s] 59%|███████████████████████████████████████████████████████████▍                                         | 330/561 [00:16<00:10, 22.38it/s] 59%|███████████████████████████████████████████████████████████▉                                         | 333/561 [00:16<00:10, 22.39it/s] 60%|████████████████████████████████████████████████████████████▍                                        | 336/561 [00:16<00:10, 22.12it/s] 60%|█████████████████████████████████████████████████████████████                                        | 339/561 [00:16<00:09, 22.21it/s] 61%|█████████████████████████████████████████████████████████████▌                                       | 342/561 [00:16<00:09, 22.06it/s] 61%|██████████████████████████████████████████████████████████████                                       | 345/561 [00:16<00:09, 22.14it/s] 62%|██████████████████████████████████████████████████████████████▋                                      | 348/561 [00:16<00:09, 22.07it/s] 63%|███████████████████████████████████████████████████████████████▏                                     | 351/561 [00:17<00:09, 21.98it/s] 63%|███████████████████████████████████████████████████████████████▋                                     | 354/561 [00:17<00:09, 21.84it/s] 64%|████████████████████████████████████████████████████████████████▎                                    | 357/561 [00:17<00:09, 21.88it/s] 64%|████████████████████████████████████████████████████████████████▊                                    | 360/561 [00:17<00:09, 21.97it/s] 65%|█████████████████████████████████████████████████████████████████▎                                   | 363/561 [00:17<00:08, 22.09it/s] 65%|█████████████████████████████████████████████████████████████████▉                                   | 366/561 [00:17<00:08, 21.93it/s] 66%|██████████████████████████████████████████████████████████████████▍                                  | 369/561 [00:17<00:08, 21.80it/s] 66%|██████████████████████████████████████████████████████████████████▉                                  | 372/561 [00:17<00:08, 21.87it/s][2025-03-28 01:25:42,240] [INFO] [logging.py:128:log_dist] [Rank 0] step=9350, skipped=20, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:25:42,241] [INFO] [timer.py:264:stop] epoch=0/micro_step=9350/global_step=9350, RunningAvgSamplesPerSec=18.773034788108994, CurrSamplesPerSec=23.722071097260887, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 67%|███████████████████████████████████████████████████████████████████▌                                 | 375/561 [00:18<00:08, 22.35it/s] 67%|████████████████████████████████████████████████████████████████████                                 | 378/561 [00:18<00:08, 22.75it/s] 68%|████████████████████████████████████████████████████████████████████▌                                | 381/561 [00:18<00:08, 22.49it/s] 68%|█████████████████████████████████████████████████████████████████████▏                               | 384/561 [00:18<00:07, 22.28it/s] 69%|█████████████████████████████████████████████████████████████████████▋                               | 387/561 [00:18<00:07, 22.90it/s] 70%|██████████████████████████████████████████████████████████████████████▏                              | 390/561 [00:18<00:07, 22.62it/s] 70%|██████████████████████████████████████████████████████████████████████▊                              | 393/561 [00:18<00:07, 22.36it/s] 71%|███████████████████████████████████████████████████████████████████████▎                             | 396/561 [00:19<00:07, 22.53it/s] 71%|███████████████████████████████████████████████████████████████████████▊                             | 399/561 [00:19<00:07, 22.95it/s] 72%|████████████████████████████████████████████████████████████████████████▎                            | 402/561 [00:19<00:06, 23.13it/s] 72%|████████████████████████████████████████████████████████████████████████▉                            | 405/561 [00:19<00:06, 22.81it/s] 73%|█████████████████████████████████████████████████████████████████████████▍                           | 408/561 [00:19<00:06, 22.57it/s] 73%|█████████████████████████████████████████████████████████████████████████▉                           | 411/561 [00:19<00:06, 22.47it/s] 74%|██████████████████████████████████████████████████████████████████████████▌                          | 414/561 [00:19<00:06, 22.30it/s] 74%|███████████████████████████████████████████████████████████████████████████                          | 417/561 [00:19<00:06, 22.27it/s] 75%|███████████████████████████████████████████████████████████████████████████▌                         | 420/561 [00:20<00:06, 22.65it/s] 75%|████████████████████████████████████████████████████████████████████████████▏                        | 423/561 [00:20<00:06, 22.97it/s][2025-03-28 01:25:44,436] [INFO] [logging.py:128:log_dist] [Rank 0] step=9400, skipped=20, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:25:44,437] [INFO] [timer.py:264:stop] epoch=0/micro_step=9400/global_step=9400, RunningAvgSamplesPerSec=18.790787059028318, CurrSamplesPerSec=24.31717488144137, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 76%|████████████████████████████████████████████████████████████████████████████▋                        | 426/561 [00:20<00:05, 23.14it/s] 76%|█████████████████████████████████████████████████████████████████████████████▏                       | 429/561 [00:20<00:05, 22.78it/s] 77%|█████████████████████████████████████████████████████████████████████████████▊                       | 432/561 [00:20<00:05, 22.93it/s] 78%|██████████████████████████████████████████████████████████████████████████████▎                      | 435/561 [00:20<00:05, 22.75it/s] 78%|██████████████████████████████████████████████████████████████████████████████▊                      | 438/561 [00:20<00:05, 22.41it/s] 79%|███████████████████████████████████████████████████████████████████████████████▍                     | 441/561 [00:21<00:05, 22.14it/s] 79%|███████████████████████████████████████████████████████████████████████████████▉                     | 444/561 [00:21<00:05, 21.93it/s] 80%|████████████████████████████████████████████████████████████████████████████████▍                    | 447/561 [00:21<00:05, 21.07it/s] 80%|█████████████████████████████████████████████████████████████████████████████████                    | 450/561 [00:21<00:05, 20.81it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▌                   | 453/561 [00:21<00:05, 21.22it/s] 81%|██████████████████████████████████████████████████████████████████████████████████                   | 456/561 [00:21<00:04, 21.55it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▋                  | 459/561 [00:21<00:04, 20.90it/s] 82%|███████████████████████████████████████████████████████████████████████████████████▏                 | 462/561 [00:22<00:04, 20.61it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▋                 | 465/561 [00:22<00:04, 21.15it/s] 83%|████████████████████████████████████████████████████████████████████████████████████▎                | 468/561 [00:22<00:04, 21.28it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▊                | 471/561 [00:22<00:04, 21.71it/s][2025-03-28 01:25:46,756] [INFO] [logging.py:128:log_dist] [Rank 0] step=9450, skipped=20, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:25:46,756] [INFO] [timer.py:264:stop] epoch=0/micro_step=9450/global_step=9450, RunningAvgSamplesPerSec=18.80377006824226, CurrSamplesPerSec=23.557392037476255, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 84%|█████████████████████████████████████████████████████████████████████████████████████▎               | 474/561 [00:22<00:03, 21.81it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▉               | 477/561 [00:22<00:04, 20.72it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▍              | 480/561 [00:22<00:03, 20.51it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▉              | 483/561 [00:23<00:03, 20.60it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▍             | 486/561 [00:23<00:03, 20.37it/s] 87%|████████████████████████████████████████████████████████████████████████████████████████             | 489/561 [00:23<00:03, 20.57it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▌            | 492/561 [00:23<00:03, 20.84it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████████            | 495/561 [00:23<00:03, 21.03it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▋           | 498/561 [00:23<00:02, 21.26it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████▏          | 501/561 [00:23<00:02, 21.22it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▋          | 504/561 [00:24<00:02, 20.64it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████████▎         | 507/561 [00:24<00:02, 19.79it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▊         | 510/561 [00:24<00:02, 20.13it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████████▎        | 513/561 [00:24<00:02, 20.38it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████████▉        | 516/561 [00:24<00:02, 20.25it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▍       | 519/561 [00:24<00:02, 20.36it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▉       | 522/561 [00:24<00:01, 20.43it/s][2025-03-28 01:25:49,207] [INFO] [logging.py:128:log_dist] [Rank 0] step=9500, skipped=20, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:25:49,208] [INFO] [timer.py:264:stop] epoch=0/micro_step=9500/global_step=9500, RunningAvgSamplesPerSec=18.81170004472087, CurrSamplesPerSec=20.687359025600337, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 94%|██████████████████████████████████████████████████████████████████████████████████████████████▌      | 525/561 [00:25<00:01, 20.58it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████      | 528/561 [00:25<00:01, 20.80it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▌     | 531/561 [00:25<00:01, 20.49it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████████▏    | 534/561 [00:25<00:01, 20.14it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▋    | 537/561 [00:25<00:01, 20.18it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████▏   | 540/561 [00:25<00:01, 19.70it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████████▌   | 542/561 [00:25<00:00, 19.51it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████████▉   | 544/561 [00:26<00:00, 19.34it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████████▎  | 546/561 [00:26<00:00, 19.23it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▋  | 548/561 [00:26<00:00, 19.25it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████████  | 550/561 [00:26<00:00, 19.00it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▌ | 553/561 [00:26<00:00, 19.63it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████ | 556/561 [00:26<00:00, 20.38it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████████▋| 559/561 [00:26<00:00, 20.79it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:26<00:00, 20.84it/s]
  0%|                                                                                                               | 0/561 [00:00<?, ?it/s]  0%|▏                                                                                                      | 1/561 [00:00<02:46,  3.35it/s]  1%|▋                                                                                                      | 4/561 [00:00<00:50, 11.01it/s]  1%|█▎                                                                                                     | 7/561 [00:00<00:35, 15.50it/s]  2%|█▊                                                                                                    | 10/561 [00:00<00:30, 18.25it/s][2025-03-28 01:25:51,938] [INFO] [logging.py:128:log_dist] [Rank 0] step=9550, skipped=20, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:25:51,939] [INFO] [timer.py:264:stop] epoch=0/micro_step=9550/global_step=9550, RunningAvgSamplesPerSec=18.814616679075876, CurrSamplesPerSec=23.386895886299968, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
  2%|██▎                                                                                                   | 13/561 [00:00<00:27, 19.94it/s]  3%|██▉                                                                                                   | 16/561 [00:00<00:26, 20.71it/s]  3%|███▍                                                                                                  | 19/561 [00:01<00:26, 20.84it/s]  4%|████                                                                                                  | 22/561 [00:01<00:25, 21.27it/s]  4%|████▌                                                                                                 | 25/561 [00:01<00:25, 21.18it/s]  5%|█████                                                                                                 | 28/561 [00:01<00:24, 21.66it/s]  6%|█████▋                                                                                                | 31/561 [00:01<00:24, 21.92it/s]  6%|██████▏                                                                                               | 34/561 [00:01<00:23, 22.41it/s]  7%|██████▋                                                                                               | 37/561 [00:01<00:23, 22.78it/s]  7%|███████▎                                                                                              | 40/561 [00:02<00:22, 23.17it/s]  8%|███████▊                                                                                              | 43/561 [00:02<00:23, 21.87it/s]  8%|████████▎                                                                                             | 46/561 [00:02<00:23, 22.08it/s]  9%|████████▉                                                                                             | 49/561 [00:02<00:23, 22.21it/s]  9%|█████████▍                                                                                            | 52/561 [00:02<00:23, 21.92it/s] 10%|██████████                                                                                            | 55/561 [00:02<00:22, 22.03it/s] 10%|██████████▌                                                                                           | 58/561 [00:02<00:22, 22.04it/s] 11%|███████████                                                                                           | 61/561 [00:02<00:22, 22.05it/s][2025-03-28 01:25:54,196] [INFO] [logging.py:128:log_dist] [Rank 0] step=9600, skipped=20, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:25:54,197] [INFO] [timer.py:264:stop] epoch=0/micro_step=9600/global_step=9600, RunningAvgSamplesPerSec=18.82957376432132, CurrSamplesPerSec=21.020266596895393, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 11%|███████████▋                                                                                          | 64/561 [00:03<00:22, 21.97it/s] 12%|████████████▏                                                                                         | 67/561 [00:03<00:22, 21.97it/s] 12%|████████████▋                                                                                         | 70/561 [00:03<00:22, 21.70it/s] 13%|█████████████▎                                                                                        | 73/561 [00:03<00:22, 22.10it/s] 14%|█████████████▊                                                                                        | 76/561 [00:03<00:21, 22.42it/s] 14%|██████████████▎                                                                                       | 79/561 [00:03<00:21, 22.26it/s] 15%|██████████████▉                                                                                       | 82/561 [00:03<00:21, 22.53it/s] 15%|███████████████▍                                                                                      | 85/561 [00:04<00:21, 22.12it/s] 16%|████████████████                                                                                      | 88/561 [00:04<00:20, 22.54it/s] 16%|████████████████▌                                                                                     | 91/561 [00:04<00:21, 22.32it/s] 17%|█████████████████                                                                                     | 94/561 [00:04<00:20, 22.46it/s] 17%|█████████████████▋                                                                                    | 97/561 [00:04<00:20, 22.69it/s] 18%|██████████████████                                                                                   | 100/561 [00:04<00:20, 22.59it/s] 18%|██████████████████▌                                                                                  | 103/561 [00:04<00:20, 22.80it/s] 19%|███████████████████                                                                                  | 106/561 [00:04<00:20, 22.32it/s] 19%|███████████████████▌                                                                                 | 109/561 [00:05<00:20, 22.44it/s] 20%|████████████████████▏                                                                                | 112/561 [00:05<00:19, 22.76it/s][2025-03-28 01:25:56,418] [INFO] [logging.py:128:log_dist] [Rank 0] step=9650, skipped=20, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:25:56,418] [INFO] [timer.py:264:stop] epoch=0/micro_step=9650/global_step=9650, RunningAvgSamplesPerSec=18.845761189314686, CurrSamplesPerSec=24.716838529467196, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 20%|████████████████████▋                                                                                | 115/561 [00:05<00:19, 22.96it/s] 21%|█████████████████████▏                                                                               | 118/561 [00:05<00:19, 22.66it/s] 22%|█████████████████████▊                                                                               | 121/561 [00:05<00:19, 22.44it/s] 22%|██████████████████████▎                                                                              | 124/561 [00:05<00:19, 22.45it/s] 23%|██████████████████████▊                                                                              | 127/561 [00:05<00:19, 22.09it/s] 23%|███████████████████████▍                                                                             | 130/561 [00:06<00:19, 22.21it/s] 24%|███████████████████████▉                                                                             | 133/561 [00:06<00:18, 22.66it/s] 24%|████████████████████████▍                                                                            | 136/561 [00:06<00:18, 23.08it/s] 25%|█████████████████████████                                                                            | 139/561 [00:06<00:18, 23.00it/s] 25%|█████████████████████████▌                                                                           | 142/561 [00:06<00:18, 23.11it/s] 26%|██████████████████████████                                                                           | 145/561 [00:06<00:17, 23.14it/s] 26%|██████████████████████████▋                                                                          | 148/561 [00:06<00:18, 22.71it/s] 27%|███████████████████████████▏                                                                         | 151/561 [00:06<00:18, 22.14it/s] 27%|███████████████████████████▋                                                                         | 154/561 [00:07<00:18, 22.54it/s] 28%|████████████████████████████▎                                                                        | 157/561 [00:07<00:18, 22.38it/s] 29%|████████████████████████████▊                                                                        | 160/561 [00:07<00:17, 22.73it/s][2025-03-28 01:25:58,628] [INFO] [logging.py:128:log_dist] [Rank 0] step=9700, skipped=20, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:25:58,629] [INFO] [timer.py:264:stop] epoch=0/micro_step=9700/global_step=9700, RunningAvgSamplesPerSec=18.86219823923022, CurrSamplesPerSec=23.401248942966877, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 29%|█████████████████████████████▎                                                                       | 163/561 [00:07<00:17, 22.80it/s] 30%|█████████████████████████████▉                                                                       | 166/561 [00:07<00:17, 22.40it/s] 30%|██████████████████████████████▍                                                                      | 169/561 [00:07<00:17, 22.35it/s] 31%|██████████████████████████████▉                                                                      | 172/561 [00:07<00:17, 22.32it/s] 31%|███████████████████████████████▌                                                                     | 175/561 [00:08<00:17, 22.25it/s] 32%|████████████████████████████████                                                                     | 178/561 [00:08<00:17, 21.90it/s] 32%|████████████████████████████████▌                                                                    | 181/561 [00:08<00:17, 21.81it/s] 33%|█████████████████████████████████▏                                                                   | 184/561 [00:08<00:17, 21.74it/s] 33%|█████████████████████████████████▋                                                                   | 187/561 [00:08<00:17, 21.75it/s] 34%|██████████████████████████████████▏                                                                  | 190/561 [00:08<00:17, 21.63it/s] 34%|██████████████████████████████████▋                                                                  | 193/561 [00:08<00:17, 21.61it/s] 35%|███████████████████████████████████▎                                                                 | 196/561 [00:09<00:16, 21.57it/s] 35%|███████████████████████████████████▊                                                                 | 199/561 [00:09<00:16, 21.85it/s] 36%|████████████████████████████████████▎                                                                | 202/561 [00:09<00:16, 21.88it/s] 37%|████████████████████████████████████▉                                                                | 205/561 [00:09<00:16, 21.90it/s] 37%|█████████████████████████████████████▍                                                               | 208/561 [00:09<00:16, 22.01it/s] 38%|█████████████████████████████████████▉                                                               | 211/561 [00:09<00:16, 21.65it/s][2025-03-28 01:26:00,935] [INFO] [logging.py:128:log_dist] [Rank 0] step=9750, skipped=20, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:26:00,935] [INFO] [timer.py:264:stop] epoch=0/micro_step=9750/global_step=9750, RunningAvgSamplesPerSec=18.874991213561447, CurrSamplesPerSec=19.684988455153462, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 38%|██████████████████████████████████████▌                                                              | 214/561 [00:09<00:16, 21.27it/s] 39%|███████████████████████████████████████                                                              | 217/561 [00:09<00:16, 21.11it/s] 39%|███████████████████████████████████████▌                                                             | 220/561 [00:10<00:15, 21.68it/s] 40%|████████████████████████████████████████▏                                                            | 223/561 [00:10<00:15, 22.21it/s] 40%|████████████████████████████████████████▋                                                            | 226/561 [00:10<00:15, 22.04it/s] 41%|█████████████████████████████████████████▏                                                           | 229/561 [00:10<00:15, 21.82it/s] 41%|█████████████████████████████████████████▊                                                           | 232/561 [00:10<00:14, 21.99it/s] 42%|██████████████████████████████████████████▎                                                          | 235/561 [00:10<00:14, 22.25it/s] 42%|██████████████████████████████████████████▊                                                          | 238/561 [00:10<00:14, 21.98it/s] 43%|███████████████████████████████████████████▍                                                         | 241/561 [00:11<00:14, 22.07it/s] 43%|███████████████████████████████████████████▉                                                         | 244/561 [00:11<00:14, 21.82it/s] 44%|████████████████████████████████████████████▍                                                        | 247/561 [00:11<00:14, 22.23it/s] 45%|█████████████████████████████████████████████                                                        | 250/561 [00:11<00:13, 23.31it/s] 45%|█████████████████████████████████████████████▌                                                       | 253/561 [00:11<00:13, 23.36it/s] 46%|██████████████████████████████████████████████                                                       | 256/561 [00:11<00:13, 22.92it/s] 46%|██████████████████████████████████████████████▋                                                      | 259/561 [00:11<00:13, 22.64it/s] 47%|███████████████████████████████████████████████▏                                                     | 262/561 [00:11<00:13, 22.14it/s][2025-03-28 01:26:03,177] [INFO] [logging.py:128:log_dist] [Rank 0] step=9800, skipped=20, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:26:03,177] [INFO] [timer.py:264:stop] epoch=0/micro_step=9800/global_step=9800, RunningAvgSamplesPerSec=18.89002291851891, CurrSamplesPerSec=21.854189481370383, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 47%|███████████████████████████████████████████████▋                                                     | 265/561 [00:12<00:13, 22.07it/s] 48%|████████████████████████████████████████████████▏                                                    | 268/561 [00:12<00:13, 22.00it/s] 48%|████████████████████████████████████████████████▊                                                    | 271/561 [00:12<00:13, 21.94it/s] 49%|█████████████████████████████████████████████████▎                                                   | 274/561 [00:12<00:13, 21.93it/s] 49%|█████████████████████████████████████████████████▊                                                   | 277/561 [00:12<00:13, 21.74it/s] 50%|██████████████████████████████████████████████████▍                                                  | 280/561 [00:12<00:12, 22.18it/s] 50%|██████████████████████████████████████████████████▉                                                  | 283/561 [00:12<00:12, 22.46it/s] 51%|███████████████████████████████████████████████████▍                                                 | 286/561 [00:13<00:12, 22.28it/s] 52%|████████████████████████████████████████████████████                                                 | 289/561 [00:13<00:12, 22.10it/s] 52%|████████████████████████████████████████████████████▌                                                | 292/561 [00:13<00:12, 21.93it/s] 53%|█████████████████████████████████████████████████████                                                | 295/561 [00:13<00:11, 22.25it/s] 53%|█████████████████████████████████████████████████████▋                                               | 298/561 [00:13<00:11, 22.38it/s] 54%|██████████████████████████████████████████████████████▏                                              | 301/561 [00:13<00:11, 22.32it/s] 54%|██████████████████████████████████████████████████████▋                                              | 304/561 [00:13<00:11, 22.63it/s] 55%|███████████████████████████████████████████████████████▎                                             | 307/561 [00:14<00:10, 23.13it/s] 55%|███████████████████████████████████████████████████████▊                                             | 310/561 [00:14<00:10, 23.25it/s][2025-03-28 01:26:05,404] [INFO] [logging.py:128:log_dist] [Rank 0] step=9850, skipped=20, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:26:05,405] [INFO] [timer.py:264:stop] epoch=0/micro_step=9850/global_step=9850, RunningAvgSamplesPerSec=18.905461483076238, CurrSamplesPerSec=21.42123808237831, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 56%|████████████████████████████████████████████████████████▎                                            | 313/561 [00:14<00:10, 22.96it/s] 56%|████████████████████████████████████████████████████████▉                                            | 316/561 [00:14<00:10, 22.96it/s] 57%|█████████████████████████████████████████████████████████▍                                           | 319/561 [00:14<00:10, 23.33it/s] 57%|█████████████████████████████████████████████████████████▉                                           | 322/561 [00:14<00:10, 23.36it/s] 58%|██████████████████████████████████████████████████████████▌                                          | 325/561 [00:14<00:10, 23.43it/s] 58%|███████████████████████████████████████████████████████████                                          | 328/561 [00:14<00:10, 22.33it/s] 59%|███████████████████████████████████████████████████████████▌                                         | 331/561 [00:15<00:10, 21.97it/s] 60%|████████████████████████████████████████████████████████████▏                                        | 334/561 [00:15<00:10, 21.87it/s] 60%|████████████████████████████████████████████████████████████▋                                        | 337/561 [00:15<00:10, 22.13it/s] 61%|█████████████████████████████████████████████████████████████▏                                       | 340/561 [00:15<00:09, 22.54it/s] 61%|█████████████████████████████████████████████████████████████▊                                       | 343/561 [00:15<00:09, 23.01it/s] 62%|██████████████████████████████████████████████████████████████▎                                      | 346/561 [00:15<00:09, 23.33it/s] 62%|██████████████████████████████████████████████████████████████▊                                      | 349/561 [00:15<00:09, 23.41it/s] 63%|███████████████████████████████████████████████████████████████▎                                     | 352/561 [00:15<00:08, 23.51it/s] 63%|███████████████████████████████████████████████████████████████▉                                     | 355/561 [00:16<00:08, 23.19it/s] 64%|████████████████████████████████████████████████████████████████▍                                    | 358/561 [00:16<00:09, 21.59it/s] 64%|████████████████████████████████████████████████████████████████▉                                    | 361/561 [00:16<00:09, 21.65it/s][2025-03-28 01:26:07,624] [INFO] [logging.py:128:log_dist] [Rank 0] step=9900, skipped=20, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:26:07,625] [INFO] [timer.py:264:stop] epoch=0/micro_step=9900/global_step=9900, RunningAvgSamplesPerSec=18.92100109442471, CurrSamplesPerSec=23.333812509162033, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 65%|█████████████████████████████████████████████████████████████████▌                                   | 364/561 [00:16<00:08, 22.06it/s] 65%|██████████████████████████████████████████████████████████████████                                   | 367/561 [00:16<00:08, 22.70it/s] 66%|██████████████████████████████████████████████████████████████████▌                                  | 370/561 [00:16<00:08, 22.65it/s] 66%|███████████████████████████████████████████████████████████████████▏                                 | 373/561 [00:16<00:08, 22.51it/s] 67%|███████████████████████████████████████████████████████████████████▋                                 | 376/561 [00:17<00:08, 22.41it/s] 68%|████████████████████████████████████████████████████████████████████▏                                | 379/561 [00:17<00:08, 22.22it/s] 68%|████████████████████████████████████████████████████████████████████▊                                | 382/561 [00:17<00:08, 22.13it/s] 69%|█████████████████████████████████████████████████████████████████████▎                               | 385/561 [00:17<00:07, 22.11it/s] 69%|█████████████████████████████████████████████████████████████████████▊                               | 388/561 [00:17<00:07, 22.17it/s] 70%|██████████████████████████████████████████████████████████████████████▍                              | 391/561 [00:17<00:08, 21.07it/s] 70%|██████████████████████████████████████████████████████████████████████▉                              | 394/561 [00:17<00:08, 20.31it/s] 71%|███████████████████████████████████████████████████████████████████████▍                             | 397/561 [00:18<00:08, 20.42it/s] 71%|████████████████████████████████████████████████████████████████████████                             | 400/561 [00:18<00:07, 20.82it/s] 72%|████████████████████████████████████████████████████████████████████████▌                            | 403/561 [00:18<00:07, 21.15it/s] 72%|█████████████████████████████████████████████████████████████████████████                            | 406/561 [00:18<00:07, 21.54it/s] 73%|█████████████████████████████████████████████████████████████████████████▋                           | 409/561 [00:18<00:07, 21.07it/s] 73%|██████████████████████████████████████████████████████████████████████████▏                          | 412/561 [00:18<00:06, 21.68it/s][2025-03-28 01:26:09,930] [INFO] [logging.py:128:log_dist] [Rank 0] step=9950, skipped=20, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:26:09,931] [INFO] [timer.py:264:stop] epoch=0/micro_step=9950/global_step=9950, RunningAvgSamplesPerSec=18.933360775048836, CurrSamplesPerSec=24.458694623890135, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 74%|██████████████████████████████████████████████████████████████████████████▋                          | 415/561 [00:18<00:06, 22.41it/s] 75%|███████████████████████████████████████████████████████████████████████████▎                         | 418/561 [00:19<00:06, 21.95it/s] 75%|███████████████████████████████████████████████████████████████████████████▊                         | 421/561 [00:19<00:06, 22.45it/s] 76%|████████████████████████████████████████████████████████████████████████████▎                        | 424/561 [00:19<00:05, 22.94it/s] 76%|████████████████████████████████████████████████████████████████████████████▉                        | 427/561 [00:19<00:05, 23.09it/s] 77%|█████████████████████████████████████████████████████████████████████████████▍                       | 430/561 [00:19<00:05, 22.90it/s] 77%|█████████████████████████████████████████████████████████████████████████████▉                       | 433/561 [00:19<00:05, 23.17it/s] 78%|██████████████████████████████████████████████████████████████████████████████▍                      | 436/561 [00:19<00:05, 23.22it/s] 78%|███████████████████████████████████████████████████████████████████████████████                      | 439/561 [00:19<00:05, 23.37it/s] 79%|███████████████████████████████████████████████████████████████████████████████▌                     | 442/561 [00:20<00:05, 23.64it/s] 79%|████████████████████████████████████████████████████████████████████████████████                     | 445/561 [00:20<00:04, 23.55it/s] 80%|████████████████████████████████████████████████████████████████████████████████▋                    | 448/561 [00:20<00:04, 23.46it/s] 80%|█████████████████████████████████████████████████████████████████████████████████▏                   | 451/561 [00:20<00:04, 23.00it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▋                   | 454/561 [00:20<00:04, 21.67it/s] 81%|██████████████████████████████████████████████████████████████████████████████████▎                  | 457/561 [00:20<00:04, 21.74it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▊                  | 460/561 [00:20<00:04, 22.11it/s][2025-03-28 01:26:12,120] [INFO] [logging.py:128:log_dist] [Rank 0] step=10000, skipped=20, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:26:12,121] [INFO] [timer.py:264:stop] epoch=0/micro_step=10000/global_step=10000, RunningAvgSamplesPerSec=18.949738646520483, CurrSamplesPerSec=22.8715519588078, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 83%|███████████████████████████████████████████████████████████████████████████████████▎                 | 463/561 [00:20<00:04, 22.37it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▉                 | 466/561 [00:21<00:04, 22.61it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▍                | 469/561 [00:21<00:04, 22.44it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▉                | 472/561 [00:21<00:03, 22.44it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▌               | 475/561 [00:21<00:03, 22.82it/s] 85%|██████████████████████████████████████████████████████████████████████████████████████               | 478/561 [00:21<00:03, 23.19it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▌              | 481/561 [00:21<00:03, 23.34it/s][2025-03-28 01:26:13,019] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
 86%|███████████████████████████████████████████████████████████████████████████████████████▏             | 484/561 [00:21<00:03, 23.72it/s][2025-03-28 01:26:13,060] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
 87%|███████████████████████████████████████████████████████████████████████████████████████▋             | 487/561 [00:22<00:03, 22.46it/s] 87%|████████████████████████████████████████████████████████████████████████████████████████▏            | 490/561 [00:22<00:03, 22.14it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▊            | 493/561 [00:22<00:02, 23.22it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████████▎           | 496/561 [00:22<00:02, 22.79it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▊           | 499/561 [00:22<00:02, 22.37it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████▍          | 502/561 [00:22<00:02, 22.30it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▉          | 505/561 [00:22<00:02, 22.14it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▍         | 508/561 [00:22<00:02, 22.21it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▉         | 511/561 [00:23<00:02, 22.13it/s][2025-03-28 01:26:14,338] [INFO] [logging.py:128:log_dist] [Rank 0] step=10050, skipped=22, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:26:14,338] [INFO] [timer.py:264:stop] epoch=0/micro_step=10050/global_step=10050, RunningAvgSamplesPerSec=18.965008928238948, CurrSamplesPerSec=22.831587230309704, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 92%|████████████████████████████████████████████████████████████████████████████████████████████▌        | 514/561 [00:23<00:02, 22.01it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████        | 517/561 [00:23<00:01, 22.13it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▌       | 520/561 [00:23<00:01, 22.22it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████████▏      | 523/561 [00:23<00:01, 22.40it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▋      | 526/561 [00:23<00:01, 22.33it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▏     | 529/561 [00:23<00:01, 22.80it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▊     | 532/561 [00:24<00:01, 22.98it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████████▎    | 535/561 [00:24<00:01, 23.16it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▊    | 538/561 [00:24<00:00, 23.40it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████▍   | 541/561 [00:24<00:00, 23.35it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████████▉   | 544/561 [00:24<00:00, 23.07it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▍  | 547/561 [00:24<00:00, 22.58it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████████  | 550/561 [00:24<00:00, 22.36it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▌ | 553/561 [00:24<00:00, 22.23it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████ | 556/561 [00:25<00:00, 22.11it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████████▋| 559/561 [00:25<00:00, 21.97it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:25<00:00, 22.10it/s]
  0%|                                                                                                               | 0/561 [00:00<?, ?it/s]  0%|▏                                                                                                      | 1/561 [00:00<01:53,  4.93it/s][2025-03-28 01:26:16,797] [INFO] [logging.py:128:log_dist] [Rank 0] step=10100, skipped=22, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:26:16,798] [INFO] [timer.py:264:stop] epoch=0/micro_step=10100/global_step=10100, RunningAvgSamplesPerSec=18.9765107604794, CurrSamplesPerSec=20.71320619544867, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
  1%|▋                                                                                                      | 4/561 [00:00<00:42, 13.03it/s]  1%|█▎                                                                                                     | 7/561 [00:00<00:33, 16.72it/s]  2%|█▋                                                                                                     | 9/561 [00:00<00:31, 17.38it/s]  2%|██▏                                                                                                   | 12/561 [00:00<00:29, 18.82it/s]  3%|██▋                                                                                                   | 15/561 [00:00<00:27, 19.85it/s]  3%|███▎                                                                                                  | 18/561 [00:01<00:26, 20.40it/s]  4%|███▊                                                                                                  | 21/561 [00:01<00:25, 20.82it/s]  4%|████▎                                                                                                 | 24/561 [00:01<00:25, 21.27it/s]  5%|████▉                                                                                                 | 27/561 [00:01<00:24, 21.52it/s]  5%|█████▍                                                                                                | 30/561 [00:01<00:24, 21.59it/s]  6%|██████                                                                                                | 33/561 [00:01<00:23, 22.16it/s]  6%|██████▌                                                                                               | 36/561 [00:01<00:23, 22.60it/s]  7%|███████                                                                                               | 39/561 [00:01<00:22, 22.81it/s]  7%|███████▋                                                                                              | 42/561 [00:02<00:22, 22.57it/s]  8%|████████▏                                                                                             | 45/561 [00:02<00:22, 22.48it/s]  9%|████████▋                                                                                             | 48/561 [00:02<00:22, 22.81it/s]  9%|█████████▎                                                                                            | 51/561 [00:02<00:22, 23.09it/s][2025-03-28 01:26:19,047] [INFO] [logging.py:128:log_dist] [Rank 0] step=10150, skipped=22, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:26:19,048] [INFO] [timer.py:264:stop] epoch=0/micro_step=10150/global_step=10150, RunningAvgSamplesPerSec=18.990410542920866, CurrSamplesPerSec=23.379725958482084, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 10%|█████████▊                                                                                            | 54/561 [00:02<00:21, 23.22it/s] 10%|██████████▎                                                                                           | 57/561 [00:02<00:21, 23.27it/s] 11%|██████████▉                                                                                           | 60/561 [00:02<00:21, 23.37it/s] 11%|███████████▍                                                                                          | 63/561 [00:02<00:21, 23.19it/s] 12%|████████████                                                                                          | 66/561 [00:03<00:21, 23.49it/s] 12%|████████████▌                                                                                         | 69/561 [00:03<00:20, 23.49it/s] 13%|█████████████                                                                                         | 72/561 [00:03<00:20, 23.64it/s] 13%|█████████████▋                                                                                        | 75/561 [00:03<00:20, 23.68it/s] 14%|██████████████▏                                                                                       | 78/561 [00:03<00:20, 23.20it/s] 14%|██████████████▋                                                                                       | 81/561 [00:03<00:21, 22.79it/s] 15%|███████████████▎                                                                                      | 84/561 [00:03<00:21, 22.50it/s] 16%|███████████████▊                                                                                      | 87/561 [00:04<00:21, 22.29it/s] 16%|████████████████▎                                                                                     | 90/561 [00:04<00:21, 21.76it/s] 17%|████████████████▉                                                                                     | 93/561 [00:04<00:21, 21.90it/s] 17%|█████████████████▍                                                                                    | 96/561 [00:04<00:20, 22.45it/s] 18%|██████████████████                                                                                    | 99/561 [00:04<00:21, 21.49it/s][2025-03-28 01:26:21,268] [INFO] [logging.py:128:log_dist] [Rank 0] step=10200, skipped=22, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:26:21,269] [INFO] [timer.py:264:stop] epoch=0/micro_step=10200/global_step=10200, RunningAvgSamplesPerSec=19.00519694493009, CurrSamplesPerSec=21.447746371259257, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 18%|██████████████████▎                                                                                  | 102/561 [00:04<00:21, 21.48it/s] 19%|██████████████████▉                                                                                  | 105/561 [00:04<00:20, 21.77it/s] 19%|███████████████████▍                                                                                 | 108/561 [00:04<00:20, 21.87it/s] 20%|███████████████████▉                                                                                 | 111/561 [00:05<00:20, 21.86it/s] 20%|████████████████████▌                                                                                | 114/561 [00:05<00:20, 21.84it/s] 21%|█████████████████████                                                                                | 117/561 [00:05<00:19, 22.37it/s] 21%|█████████████████████▌                                                                               | 120/561 [00:05<00:19, 22.81it/s] 22%|██████████████████████▏                                                                              | 123/561 [00:05<00:19, 23.04it/s] 22%|██████████████████████▋                                                                              | 126/561 [00:05<00:18, 23.14it/s] 23%|███████████████████████▏                                                                             | 129/561 [00:05<00:18, 22.89it/s] 24%|███████████████████████▊                                                                             | 132/561 [00:06<00:18, 22.58it/s] 24%|████████████████████████▎                                                                            | 135/561 [00:06<00:19, 22.32it/s] 25%|████████████████████████▊                                                                            | 138/561 [00:06<00:19, 22.11it/s] 25%|█████████████████████████▍                                                                           | 141/561 [00:06<00:18, 22.13it/s] 26%|█████████████████████████▉                                                                           | 144/561 [00:06<00:18, 22.16it/s] 26%|██████████████████████████▍                                                                          | 147/561 [00:06<00:18, 22.32it/s] 27%|███████████████████████████                                                                          | 150/561 [00:06<00:18, 22.47it/s][2025-03-28 01:26:23,487] [INFO] [logging.py:128:log_dist] [Rank 0] step=10250, skipped=22, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:26:23,488] [INFO] [timer.py:264:stop] epoch=0/micro_step=10250/global_step=10250, RunningAvgSamplesPerSec=19.01991208944285, CurrSamplesPerSec=23.650641716583092, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 27%|███████████████████████████▌                                                                         | 153/561 [00:06<00:17, 23.06it/s] 28%|████████████████████████████                                                                         | 156/561 [00:07<00:17, 23.58it/s] 28%|████████████████████████████▋                                                                        | 159/561 [00:07<00:17, 23.49it/s] 29%|█████████████████████████████▏                                                                       | 162/561 [00:07<00:16, 23.66it/s] 29%|█████████████████████████████▋                                                                       | 165/561 [00:07<00:16, 23.53it/s] 30%|██████████████████████████████▏                                                                      | 168/561 [00:07<00:16, 23.45it/s] 30%|██████████████████████████████▊                                                                      | 171/561 [00:07<00:16, 23.56it/s] 31%|███████████████████████████████▎                                                                     | 174/561 [00:07<00:16, 23.61it/s] 32%|███████████████████████████████▊                                                                     | 177/561 [00:07<00:16, 23.63it/s] 32%|████████████████████████████████▍                                                                    | 180/561 [00:08<00:16, 23.72it/s] 33%|████████████████████████████████▉                                                                    | 183/561 [00:08<00:15, 23.69it/s] 33%|█████████████████████████████████▍                                                                   | 186/561 [00:08<00:15, 23.71it/s] 34%|██████████████████████████████████                                                                   | 189/561 [00:08<00:15, 23.77it/s] 34%|██████████████████████████████████▌                                                                  | 192/561 [00:08<00:15, 23.18it/s] 35%|███████████████████████████████████                                                                  | 195/561 [00:08<00:16, 22.62it/s] 35%|███████████████████████████████████▋                                                                 | 198/561 [00:08<00:16, 22.52it/s] 36%|████████████████████████████████████▏                                                                | 201/561 [00:09<00:16, 22.41it/s][2025-03-28 01:26:25,641] [INFO] [logging.py:128:log_dist] [Rank 0] step=10300, skipped=22, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:26:25,642] [INFO] [timer.py:264:stop] epoch=0/micro_step=10300/global_step=10300, RunningAvgSamplesPerSec=19.03681264945359, CurrSamplesPerSec=18.199294746726114, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 36%|████████████████████████████████████▋                                                                | 204/561 [00:09<00:16, 21.43it/s] 37%|█████████████████████████████████████▎                                                               | 207/561 [00:09<00:16, 21.55it/s] 37%|█████████████████████████████████████▊                                                               | 210/561 [00:09<00:16, 20.97it/s] 38%|██████████████████████████████████████▎                                                              | 213/561 [00:09<00:16, 21.48it/s] 39%|██████████████████████████████████████▉                                                              | 216/561 [00:09<00:16, 21.53it/s] 39%|███████████████████████████████████████▍                                                             | 219/561 [00:09<00:15, 21.76it/s] 40%|███████████████████████████████████████▉                                                             | 222/561 [00:10<00:15, 21.94it/s] 40%|████████████████████████████████████████▌                                                            | 225/561 [00:10<00:15, 22.17it/s] 41%|█████████████████████████████████████████                                                            | 228/561 [00:10<00:14, 22.22it/s] 41%|█████████████████████████████████████████▌                                                           | 231/561 [00:10<00:14, 22.07it/s] 42%|██████████████████████████████████████████▏                                                          | 234/561 [00:10<00:14, 21.97it/s] 42%|██████████████████████████████████████████▋                                                          | 237/561 [00:10<00:14, 22.57it/s] 43%|███████████████████████████████████████████▏                                                         | 240/561 [00:10<00:14, 22.01it/s] 43%|███████████████████████████████████████████▋                                                         | 243/561 [00:10<00:14, 21.77it/s] 44%|████████████████████████████████████████████▎                                                        | 246/561 [00:11<00:14, 21.85it/s] 44%|████████████████████████████████████████████▊                                                        | 249/561 [00:11<00:13, 22.57it/s][2025-03-28 01:26:27,911] [INFO] [logging.py:128:log_dist] [Rank 0] step=10350, skipped=22, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:26:27,912] [INFO] [timer.py:264:stop] epoch=0/micro_step=10350/global_step=10350, RunningAvgSamplesPerSec=19.049533164605126, CurrSamplesPerSec=23.27554343164232, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 45%|█████████████████████████████████████████████▎                                                       | 252/561 [00:11<00:13, 22.63it/s] 45%|█████████████████████████████████████████████▉                                                       | 255/561 [00:11<00:13, 22.61it/s] 46%|██████████████████████████████████████████████▍                                                      | 258/561 [00:11<00:13, 22.38it/s] 47%|██████████████████████████████████████████████▉                                                      | 261/561 [00:11<00:13, 22.60it/s] 47%|███████████████████████████████████████████████▌                                                     | 264/561 [00:11<00:12, 23.05it/s] 48%|████████████████████████████████████████████████                                                     | 267/561 [00:12<00:12, 23.22it/s] 48%|████████████████████████████████████████████████▌                                                    | 270/561 [00:12<00:12, 23.41it/s] 49%|█████████████████████████████████████████████████▏                                                   | 273/561 [00:12<00:12, 22.45it/s] 49%|█████████████████████████████████████████████████▋                                                   | 276/561 [00:12<00:13, 21.66it/s] 50%|██████████████████████████████████████████████████▏                                                  | 279/561 [00:12<00:13, 21.68it/s] 50%|██████████████████████████████████████████████████▊                                                  | 282/561 [00:12<00:12, 21.81it/s] 51%|███████████████████████████████████████████████████▎                                                 | 285/561 [00:12<00:12, 21.99it/s] 51%|███████████████████████████████████████████████████▊                                                 | 288/561 [00:12<00:12, 21.98it/s] 52%|████████████████████████████████████████████████████▍                                                | 291/561 [00:13<00:12, 22.10it/s] 52%|████████████████████████████████████████████████████▉                                                | 294/561 [00:13<00:12, 22.13it/s] 53%|█████████████████████████████████████████████████████▍                                               | 297/561 [00:13<00:11, 22.33it/s] 53%|██████████████████████████████████████████████████████                                               | 300/561 [00:13<00:11, 22.02it/s][2025-03-28 01:26:30,164] [INFO] [logging.py:128:log_dist] [Rank 0] step=10400, skipped=22, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:26:30,165] [INFO] [timer.py:264:stop] epoch=0/micro_step=10400/global_step=10400, RunningAvgSamplesPerSec=19.06272345677446, CurrSamplesPerSec=20.959029015619837, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 54%|██████████████████████████████████████████████████████▌                                              | 303/561 [00:13<00:11, 21.74it/s] 55%|███████████████████████████████████████████████████████                                              | 306/561 [00:13<00:11, 21.62it/s] 55%|███████████████████████████████████████████████████████▋                                             | 309/561 [00:13<00:11, 22.09it/s] 56%|████████████████████████████████████████████████████████▏                                            | 312/561 [00:14<00:11, 22.44it/s] 56%|████████████████████████████████████████████████████████▋                                            | 315/561 [00:14<00:11, 22.36it/s] 57%|█████████████████████████████████████████████████████████▎                                           | 318/561 [00:14<00:10, 22.20it/s] 57%|█████████████████████████████████████████████████████████▊                                           | 321/561 [00:14<00:10, 22.25it/s] 58%|██████████████████████████████████████████████████████████▎                                          | 324/561 [00:14<00:10, 22.34it/s] 58%|██████████████████████████████████████████████████████████▊                                          | 327/561 [00:14<00:10, 22.28it/s] 59%|███████████████████████████████████████████████████████████▍                                         | 330/561 [00:14<00:10, 22.24it/s] 59%|███████████████████████████████████████████████████████████▉                                         | 333/561 [00:15<00:10, 22.07it/s] 60%|████████████████████████████████████████████████████████████▍                                        | 336/561 [00:15<00:10, 21.40it/s] 60%|█████████████████████████████████████████████████████████████                                        | 339/561 [00:15<00:10, 21.53it/s] 61%|█████████████████████████████████████████████████████████████▌                                       | 342/561 [00:15<00:10, 21.56it/s] 61%|██████████████████████████████████████████████████████████████                                       | 345/561 [00:15<00:09, 21.73it/s] 62%|██████████████████████████████████████████████████████████████▋                                      | 348/561 [00:15<00:09, 22.30it/s] 63%|███████████████████████████████████████████████████████████████▏                                     | 351/561 [00:15<00:09, 22.39it/s][2025-03-28 01:26:32,428] [INFO] [logging.py:128:log_dist] [Rank 0] step=10450, skipped=22, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:26:32,429] [INFO] [timer.py:264:stop] epoch=0/micro_step=10450/global_step=10450, RunningAvgSamplesPerSec=19.07545059999273, CurrSamplesPerSec=21.148832413271617, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 63%|███████████████████████████████████████████████████████████████▋                                     | 354/561 [00:15<00:09, 21.28it/s] 64%|████████████████████████████████████████████████████████████████▎                                    | 357/561 [00:16<00:09, 21.04it/s] 64%|████████████████████████████████████████████████████████████████▊                                    | 360/561 [00:16<00:09, 21.14it/s] 65%|█████████████████████████████████████████████████████████████████▎                                   | 363/561 [00:16<00:09, 21.44it/s] 65%|█████████████████████████████████████████████████████████████████▉                                   | 366/561 [00:16<00:09, 21.30it/s] 66%|██████████████████████████████████████████████████████████████████▍                                  | 369/561 [00:16<00:08, 21.86it/s] 66%|██████████████████████████████████████████████████████████████████▉                                  | 372/561 [00:16<00:08, 22.24it/s] 67%|███████████████████████████████████████████████████████████████████▌                                 | 375/561 [00:16<00:08, 22.70it/s] 67%|████████████████████████████████████████████████████████████████████                                 | 378/561 [00:17<00:07, 23.09it/s] 68%|████████████████████████████████████████████████████████████████████▌                                | 381/561 [00:17<00:07, 23.27it/s] 68%|█████████████████████████████████████████████████████████████████████▏                               | 384/561 [00:17<00:07, 23.49it/s] 69%|█████████████████████████████████████████████████████████████████████▋                               | 387/561 [00:17<00:07, 22.54it/s] 70%|██████████████████████████████████████████████████████████████████████▏                              | 390/561 [00:17<00:07, 22.41it/s] 70%|██████████████████████████████████████████████████████████████████████▊                              | 393/561 [00:17<00:07, 22.17it/s] 71%|███████████████████████████████████████████████████████████████████████▎                             | 396/561 [00:17<00:07, 21.97it/s] 71%|███████████████████████████████████████████████████████████████████████▊                             | 399/561 [00:18<00:07, 22.43it/s][2025-03-28 01:26:34,675] [INFO] [logging.py:128:log_dist] [Rank 0] step=10500, skipped=22, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:26:34,675] [INFO] [timer.py:264:stop] epoch=0/micro_step=10500/global_step=10500, RunningAvgSamplesPerSec=19.08863792065651, CurrSamplesPerSec=24.76192808488547, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 72%|████████████████████████████████████████████████████████████████████████▎                            | 402/561 [00:18<00:06, 22.84it/s] 72%|████████████████████████████████████████████████████████████████████████▉                            | 405/561 [00:18<00:07, 21.77it/s] 73%|█████████████████████████████████████████████████████████████████████████▍                           | 408/561 [00:18<00:06, 21.95it/s] 73%|█████████████████████████████████████████████████████████████████████████▉                           | 411/561 [00:18<00:07, 21.03it/s] 74%|██████████████████████████████████████████████████████████████████████████▌                          | 414/561 [00:18<00:07, 20.54it/s] 74%|███████████████████████████████████████████████████████████████████████████                          | 417/561 [00:18<00:06, 20.87it/s] 75%|███████████████████████████████████████████████████████████████████████████▌                         | 420/561 [00:18<00:06, 21.71it/s] 75%|████████████████████████████████████████████████████████████████████████████▏                        | 423/561 [00:19<00:06, 22.07it/s] 76%|████████████████████████████████████████████████████████████████████████████▋                        | 426/561 [00:19<00:05, 22.70it/s] 76%|█████████████████████████████████████████████████████████████████████████████▏                       | 429/561 [00:19<00:05, 22.51it/s] 77%|█████████████████████████████████████████████████████████████████████████████▊                       | 432/561 [00:19<00:05, 22.22it/s] 78%|██████████████████████████████████████████████████████████████████████████████▎                      | 435/561 [00:19<00:05, 22.11it/s] 78%|██████████████████████████████████████████████████████████████████████████████▊                      | 438/561 [00:19<00:05, 21.30it/s] 79%|███████████████████████████████████████████████████████████████████████████████▍                     | 441/561 [00:19<00:05, 21.26it/s] 79%|███████████████████████████████████████████████████████████████████████████████▉                     | 444/561 [00:20<00:05, 21.46it/s] 80%|████████████████████████████████████████████████████████████████████████████████▍                    | 447/561 [00:20<00:05, 21.66it/s] 80%|█████████████████████████████████████████████████████████████████████████████████                    | 450/561 [00:20<00:05, 21.81it/s][2025-03-28 01:26:36,994] [INFO] [logging.py:128:log_dist] [Rank 0] step=10550, skipped=22, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:26:36,995] [INFO] [timer.py:264:stop] epoch=0/micro_step=10550/global_step=10550, RunningAvgSamplesPerSec=19.099240551589617, CurrSamplesPerSec=22.192766372777562, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 81%|█████████████████████████████████████████████████████████████████████████████████▌                   | 453/561 [00:20<00:04, 21.92it/s] 81%|██████████████████████████████████████████████████████████████████████████████████                   | 456/561 [00:20<00:04, 21.38it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▋                  | 459/561 [00:20<00:04, 21.43it/s] 82%|███████████████████████████████████████████████████████████████████████████████████▏                 | 462/561 [00:20<00:04, 21.64it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▋                 | 465/561 [00:21<00:04, 21.88it/s] 83%|████████████████████████████████████████████████████████████████████████████████████▎                | 468/561 [00:21<00:04, 22.00it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▊                | 471/561 [00:21<00:04, 21.41it/s] 84%|█████████████████████████████████████████████████████████████████████████████████████▎               | 474/561 [00:21<00:04, 21.72it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▉               | 477/561 [00:21<00:03, 21.66it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▍              | 480/561 [00:21<00:03, 20.91it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▉              | 483/561 [00:21<00:03, 21.28it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▍             | 486/561 [00:22<00:03, 21.51it/s] 87%|████████████████████████████████████████████████████████████████████████████████████████             | 489/561 [00:22<00:03, 21.74it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▌            | 492/561 [00:22<00:03, 21.72it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████████            | 495/561 [00:22<00:03, 21.81it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▋           | 498/561 [00:22<00:02, 21.78it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████▏          | 501/561 [00:22<00:02, 21.94it/s][2025-03-28 01:26:39,307] [INFO] [logging.py:128:log_dist] [Rank 0] step=10600, skipped=22, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:26:39,307] [INFO] [timer.py:264:stop] epoch=0/micro_step=10600/global_step=10600, RunningAvgSamplesPerSec=19.10997163698491, CurrSamplesPerSec=21.99642190888047, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 90%|██████████████████████████████████████████████████████████████████████████████████████████▋          | 504/561 [00:22<00:02, 22.08it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████████▎         | 507/561 [00:22<00:02, 22.56it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▊         | 510/561 [00:23<00:02, 22.83it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████████▎        | 513/561 [00:23<00:02, 22.03it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████████▉        | 516/561 [00:23<00:02, 21.14it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▍       | 519/561 [00:23<00:01, 21.29it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▉       | 522/561 [00:23<00:01, 22.41it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▌      | 525/561 [00:23<00:01, 23.70it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████      | 528/561 [00:23<00:01, 23.08it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▌     | 531/561 [00:24<00:01, 22.68it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████████▏    | 534/561 [00:24<00:01, 23.01it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▋    | 537/561 [00:24<00:01, 23.21it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████▏   | 540/561 [00:24<00:00, 23.46it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████████▊   | 543/561 [00:24<00:00, 23.47it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████████▎  | 546/561 [00:24<00:00, 23.52it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▊  | 549/561 [00:24<00:00, 23.17it/s][2025-03-28 01:26:41,488] [INFO] [logging.py:128:log_dist] [Rank 0] step=10650, skipped=22, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:26:41,489] [INFO] [timer.py:264:stop] epoch=0/micro_step=10650/global_step=10650, RunningAvgSamplesPerSec=19.125114676253737, CurrSamplesPerSec=23.845065701760984, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 98%|███████████████████████████████████████████████████████████████████████████████████████████████████▍ | 552/561 [00:24<00:00, 23.14it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▉ | 555/561 [00:25<00:00, 23.35it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████▍| 558/561 [00:25<00:00, 23.17it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:25<00:00, 22.83it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:25<00:00, 22.09it/s]
  0%|                                                                                                               | 0/561 [00:00<?, ?it/s]  0%|▏                                                                                                      | 1/561 [00:00<03:31,  2.65it/s]  1%|▋                                                                                                      | 4/561 [00:00<01:00,  9.18it/s]  1%|█▎                                                                                                     | 7/561 [00:00<00:40, 13.52it/s]  2%|█▊                                                                                                    | 10/561 [00:00<00:33, 16.28it/s]  2%|██▏                                                                                                   | 12/561 [00:00<00:32, 17.03it/s]  3%|██▋                                                                                                   | 15/561 [00:01<00:30, 18.13it/s]  3%|███▎                                                                                                  | 18/561 [00:01<00:27, 19.55it/s]  4%|███▊                                                                                                  | 21/561 [00:01<00:25, 21.20it/s]  4%|████▎                                                                                                 | 24/561 [00:01<00:24, 21.89it/s]  5%|████▉                                                                                                 | 27/561 [00:01<00:23, 22.41it/s]  5%|█████▍                                                                                                | 30/561 [00:01<00:23, 22.30it/s]  6%|██████                                                                                                | 33/561 [00:01<00:23, 22.22it/s]  6%|██████▌                                                                                               | 36/561 [00:01<00:23, 22.43it/s]  7%|███████                                                                                               | 39/561 [00:02<00:23, 22.39it/s][2025-03-28 01:26:44,132] [INFO] [logging.py:128:log_dist] [Rank 0] step=10700, skipped=22, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:26:44,133] [INFO] [timer.py:264:stop] epoch=0/micro_step=10700/global_step=10700, RunningAvgSamplesPerSec=19.129067624855605, CurrSamplesPerSec=20.912213557929554, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
  7%|███████▋                                                                                              | 42/561 [00:02<00:23, 22.27it/s]  8%|████████▏                                                                                             | 45/561 [00:02<00:23, 22.24it/s]  9%|████████▋                                                                                             | 48/561 [00:02<00:22, 22.50it/s]  9%|█████████▎                                                                                            | 51/561 [00:02<00:22, 22.24it/s] 10%|█████████▊                                                                                            | 54/561 [00:02<00:22, 22.67it/s] 10%|██████████▎                                                                                           | 57/561 [00:02<00:23, 21.42it/s] 11%|██████████▉                                                                                           | 60/561 [00:03<00:23, 21.49it/s] 11%|███████████▍                                                                                          | 63/561 [00:03<00:23, 21.54it/s] 12%|████████████                                                                                          | 66/561 [00:03<00:23, 20.96it/s] 12%|████████████▌                                                                                         | 69/561 [00:03<00:23, 20.93it/s] 13%|█████████████                                                                                         | 72/561 [00:03<00:22, 21.31it/s] 13%|█████████████▋                                                                                        | 75/561 [00:03<00:22, 21.68it/s] 14%|██████████████▏                                                                                       | 78/561 [00:03<00:21, 21.98it/s] 14%|██████████████▋                                                                                       | 81/561 [00:04<00:21, 22.04it/s] 15%|███████████████▎                                                                                      | 84/561 [00:04<00:21, 21.96it/s] 16%|███████████████▊                                                                                      | 87/561 [00:04<00:21, 21.94it/s] 16%|████████████████▎                                                                                     | 90/561 [00:04<00:21, 21.81it/s][2025-03-28 01:26:46,432] [INFO] [logging.py:128:log_dist] [Rank 0] step=10750, skipped=22, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:26:46,433] [INFO] [timer.py:264:stop] epoch=0/micro_step=10750/global_step=10750, RunningAvgSamplesPerSec=19.140004168375906, CurrSamplesPerSec=22.523599349013264, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 17%|████████████████▉                                                                                     | 93/561 [00:04<00:21, 21.89it/s] 17%|█████████████████▍                                                                                    | 96/561 [00:04<00:21, 21.89it/s] 18%|██████████████████                                                                                    | 99/561 [00:04<00:20, 22.46it/s] 18%|██████████████████▎                                                                                  | 102/561 [00:04<00:19, 23.04it/s] 19%|██████████████████▉                                                                                  | 105/561 [00:05<00:20, 22.12it/s] 19%|███████████████████▍                                                                                 | 108/561 [00:05<00:20, 22.59it/s] 20%|███████████████████▉                                                                                 | 111/561 [00:05<00:19, 23.08it/s] 20%|████████████████████▌                                                                                | 114/561 [00:05<00:19, 23.06it/s] 21%|█████████████████████                                                                                | 117/561 [00:05<00:19, 23.13it/s] 21%|█████████████████████▌                                                                               | 120/561 [00:05<00:19, 22.52it/s] 22%|██████████████████████▏                                                                              | 123/561 [00:05<00:19, 22.40it/s] 22%|██████████████████████▋                                                                              | 126/561 [00:06<00:19, 22.35it/s] 23%|███████████████████████▏                                                                             | 129/561 [00:06<00:19, 22.09it/s] 24%|███████████████████████▊                                                                             | 132/561 [00:06<00:20, 21.35it/s] 24%|████████████████████████▎                                                                            | 135/561 [00:06<00:19, 21.62it/s] 25%|████████████████████████▊                                                                            | 138/561 [00:06<00:19, 21.94it/s][2025-03-28 01:26:48,675] [INFO] [logging.py:128:log_dist] [Rank 0] step=10800, skipped=22, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:26:48,676] [INFO] [timer.py:264:stop] epoch=0/micro_step=10800/global_step=10800, RunningAvgSamplesPerSec=19.152750746211748, CurrSamplesPerSec=21.113062572787992, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 25%|█████████████████████████▍                                                                           | 141/561 [00:06<00:19, 21.75it/s] 26%|█████████████████████████▉                                                                           | 144/561 [00:06<00:20, 20.79it/s] 26%|██████████████████████████▍                                                                          | 147/561 [00:07<00:19, 20.83it/s] 27%|███████████████████████████                                                                          | 150/561 [00:07<00:19, 21.14it/s] 27%|███████████████████████████▌                                                                         | 153/561 [00:07<00:18, 21.49it/s] 28%|████████████████████████████                                                                         | 156/561 [00:07<00:19, 21.10it/s] 28%|████████████████████████████▋                                                                        | 159/561 [00:07<00:19, 20.86it/s] 29%|█████████████████████████████▏                                                                       | 162/561 [00:07<00:19, 20.71it/s] 29%|█████████████████████████████▋                                                                       | 165/561 [00:07<00:19, 20.47it/s] 30%|██████████████████████████████▏                                                                      | 168/561 [00:08<00:18, 20.74it/s] 30%|██████████████████████████████▊                                                                      | 171/561 [00:08<00:18, 20.64it/s] 31%|███████████████████████████████▎                                                                     | 174/561 [00:08<00:19, 20.36it/s] 32%|███████████████████████████████▊                                                                     | 177/561 [00:08<00:18, 20.71it/s] 32%|████████████████████████████████▍                                                                    | 180/561 [00:08<00:18, 20.80it/s] 33%|████████████████████████████████▉                                                                    | 183/561 [00:08<00:18, 20.24it/s] 33%|█████████████████████████████████▍                                                                   | 186/561 [00:08<00:18, 20.31it/s] 34%|██████████████████████████████████                                                                   | 189/561 [00:09<00:18, 19.78it/s][2025-03-28 01:26:51,130] [INFO] [logging.py:128:log_dist] [Rank 0] step=10850, skipped=22, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:26:51,131] [INFO] [timer.py:264:stop] epoch=0/micro_step=10850/global_step=10850, RunningAvgSamplesPerSec=19.1582011447964, CurrSamplesPerSec=20.353862275078466, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 34%|██████████████████████████████████▍                                                                  | 191/561 [00:09<00:18, 19.75it/s] 35%|██████████████████████████████████▉                                                                  | 194/561 [00:09<00:18, 19.90it/s] 35%|███████████████████████████████████▍                                                                 | 197/561 [00:09<00:17, 20.23it/s] 36%|████████████████████████████████████                                                                 | 200/561 [00:09<00:17, 20.27it/s] 36%|████████████████████████████████████▌                                                                | 203/561 [00:09<00:17, 20.09it/s] 37%|█████████████████████████████████████                                                                | 206/561 [00:09<00:17, 20.53it/s] 37%|█████████████████████████████████████▋                                                               | 209/561 [00:10<00:17, 20.68it/s] 38%|██████████████████████████████████████▏                                                              | 212/561 [00:10<00:16, 20.75it/s] 38%|██████████████████████████████████████▋                                                              | 215/561 [00:10<00:17, 20.28it/s] 39%|███████████████████████████████████████▏                                                             | 218/561 [00:10<00:16, 20.30it/s] 39%|███████████████████████████████████████▊                                                             | 221/561 [00:10<00:16, 20.42it/s] 40%|████████████████████████████████████████▎                                                            | 224/561 [00:10<00:16, 20.10it/s] 40%|████████████████████████████████████████▊                                                            | 227/561 [00:10<00:16, 20.11it/s] 41%|█████████████████████████████████████████▍                                                           | 230/561 [00:11<00:16, 20.35it/s] 42%|█████████████████████████████████████████▉                                                           | 233/561 [00:11<00:15, 21.28it/s] 42%|██████████████████████████████████████████▍                                                          | 236/561 [00:11<00:16, 20.20it/s] 43%|███████████████████████████████████████████                                                          | 239/561 [00:11<00:16, 19.63it/s][2025-03-28 01:26:53,601] [INFO] [logging.py:128:log_dist] [Rank 0] step=10900, skipped=22, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:26:53,604] [INFO] [timer.py:264:stop] epoch=0/micro_step=10900/global_step=10900, RunningAvgSamplesPerSec=19.16297241734082, CurrSamplesPerSec=18.1373587075513, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 43%|███████████████████████████████████████████▍                                                         | 241/561 [00:11<00:16, 19.40it/s] 43%|███████████████████████████████████████████▋                                                         | 243/561 [00:11<00:16, 19.03it/s] 44%|████████████████████████████████████████████                                                         | 245/561 [00:11<00:16, 18.93it/s] 44%|████████████████████████████████████████████▍                                                        | 247/561 [00:11<00:16, 18.85it/s] 44%|████████████████████████████████████████████▊                                                        | 249/561 [00:12<00:16, 18.80it/s] 45%|█████████████████████████████████████████████▏                                                       | 251/561 [00:12<00:16, 18.77it/s] 45%|█████████████████████████████████████████████▌                                                       | 253/561 [00:12<00:16, 18.74it/s] 45%|█████████████████████████████████████████████▉                                                       | 255/561 [00:12<00:16, 18.72it/s] 46%|██████████████████████████████████████████████▎                                                      | 257/561 [00:12<00:16, 18.70it/s] 46%|██████████████████████████████████████████████▋                                                      | 259/561 [00:12<00:16, 18.72it/s] 47%|██████████████████████████████████████████████▉                                                      | 261/561 [00:12<00:16, 18.73it/s] 47%|███████████████████████████████████████████████▎                                                     | 263/561 [00:12<00:15, 18.93it/s] 47%|███████████████████████████████████████████████▉                                                     | 266/561 [00:12<00:14, 19.74it/s] 48%|████████████████████████████████████████████████▏                                                    | 268/561 [00:13<00:14, 19.61it/s] 48%|████████████████████████████████████████████████▌                                                    | 270/561 [00:13<00:14, 19.44it/s] 48%|████████████████████████████████████████████████▉                                                    | 272/561 [00:13<00:15, 19.18it/s] 49%|█████████████████████████████████████████████████▎                                                   | 274/561 [00:13<00:15, 19.05it/s] 49%|█████████████████████████████████████████████████▋                                                   | 276/561 [00:13<00:14, 19.07it/s] 50%|██████████████████████████████████████████████████                                                   | 278/561 [00:13<00:14, 18.96it/s] 50%|██████████████████████████████████████████████████▍                                                  | 280/561 [00:13<00:14, 18.86it/s] 50%|██████████████████████████████████████████████████▊                                                  | 282/561 [00:13<00:14, 18.83it/s] 51%|███████████████████████████████████████████████████▏                                                 | 284/561 [00:13<00:14, 18.81it/s] 51%|███████████████████████████████████████████████████▍                                                 | 286/561 [00:14<00:14, 18.78it/s] 51%|███████████████████████████████████████████████████▊                                                 | 288/561 [00:14<00:14, 18.60it/s] 52%|████████████████████████████████████████████████████▏                                                | 290/561 [00:14<00:14, 18.78it/s][2025-03-28 01:26:56,249] [INFO] [logging.py:128:log_dist] [Rank 0] step=10950, skipped=22, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:26:56,252] [INFO] [timer.py:264:stop] epoch=0/micro_step=10950/global_step=10950, RunningAvgSamplesPerSec=19.161880334919857, CurrSamplesPerSec=19.471513073424372, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 52%|████████████████████████████████████████████████████▌                                                | 292/561 [00:14<00:14, 18.76it/s] 52%|████████████████████████████████████████████████████▉                                                | 294/561 [00:14<00:14, 18.72it/s] 53%|█████████████████████████████████████████████████████▎                                               | 296/561 [00:14<00:14, 18.89it/s] 53%|█████████████████████████████████████████████████████▋                                               | 298/561 [00:14<00:13, 18.80it/s] 53%|██████████████████████████████████████████████████████                                               | 300/561 [00:14<00:14, 18.51it/s] 54%|██████████████████████████████████████████████████████▎                                              | 302/561 [00:14<00:13, 18.55it/s] 54%|██████████████████████████████████████████████████████▋                                              | 304/561 [00:14<00:13, 18.57it/s] 55%|███████████████████████████████████████████████████████                                              | 306/561 [00:15<00:13, 18.61it/s] 55%|███████████████████████████████████████████████████████▍                                             | 308/561 [00:15<00:13, 18.62it/s] 55%|███████████████████████████████████████████████████████▊                                             | 310/561 [00:15<00:13, 18.59it/s] 56%|████████████████████████████████████████████████████████▏                                            | 312/561 [00:15<00:13, 18.61it/s] 56%|████████████████████████████████████████████████████████▋                                            | 315/561 [00:15<00:12, 20.20it/s] 57%|█████████████████████████████████████████████████████████▎                                           | 318/561 [00:15<00:11, 21.49it/s] 57%|█████████████████████████████████████████████████████████▊                                           | 321/561 [00:15<00:11, 21.62it/s] 58%|██████████████████████████████████████████████████████████▎                                          | 324/561 [00:15<00:11, 21.42it/s] 58%|██████████████████████████████████████████████████████████▊                                          | 327/561 [00:16<00:11, 20.24it/s] 59%|███████████████████████████████████████████████████████████▍                                         | 330/561 [00:16<00:11, 19.53it/s] 59%|███████████████████████████████████████████████████████████▊                                         | 332/561 [00:16<00:11, 19.20it/s] 60%|████████████████████████████████████████████████████████████▏                                        | 334/561 [00:16<00:11, 18.95it/s] 60%|████████████████████████████████████████████████████████████▍                                        | 336/561 [00:16<00:12, 18.74it/s] 60%|████████████████████████████████████████████████████████████▊                                        | 338/561 [00:16<00:12, 17.88it/s] 61%|█████████████████████████████████████████████████████████████▏                                       | 340/561 [00:16<00:12, 17.60it/s][2025-03-28 01:26:58,871] [INFO] [logging.py:128:log_dist] [Rank 0] step=11000, skipped=22, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:26:58,875] [INFO] [timer.py:264:stop] epoch=0/micro_step=11000/global_step=11000, RunningAvgSamplesPerSec=19.161642766720476, CurrSamplesPerSec=18.173036460048717, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 61%|█████████████████████████████████████████████████████████████▌                                       | 342/561 [00:16<00:12, 17.73it/s] 61%|██████████████████████████████████████████████████████████████                                       | 345/561 [00:17<00:10, 19.67it/s] 62%|██████████████████████████████████████████████████████████████▋                                      | 348/561 [00:17<00:10, 20.81it/s] 63%|███████████████████████████████████████████████████████████████▏                                     | 351/561 [00:17<00:09, 21.61it/s] 63%|███████████████████████████████████████████████████████████████▋                                     | 354/561 [00:17<00:09, 22.26it/s] 64%|████████████████████████████████████████████████████████████████▎                                    | 357/561 [00:17<00:09, 21.69it/s] 64%|████████████████████████████████████████████████████████████████▊                                    | 360/561 [00:17<00:09, 20.45it/s] 65%|█████████████████████████████████████████████████████████████████▎                                   | 363/561 [00:17<00:10, 19.65it/s][2025-03-28 01:26:59,963] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2025-03-28 01:27:00,017] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
 65%|█████████████████████████████████████████████████████████████████▋                                   | 365/561 [00:18<00:09, 19.65it/s] 65%|██████████████████████████████████████████████████████████████████                                   | 367/561 [00:18<00:10, 18.60it/s] 66%|██████████████████████████████████████████████████████████████████▍                                  | 369/561 [00:18<00:10, 18.13it/s] 66%|██████████████████████████████████████████████████████████████████▊                                  | 371/561 [00:18<00:10, 18.11it/s] 66%|███████████████████████████████████████████████████████████████████▏                                 | 373/561 [00:18<00:10, 18.11it/s] 67%|███████████████████████████████████████████████████████████████████▌                                 | 375/561 [00:18<00:10, 18.38it/s] 67%|████████████████████████████████████████████████████████████████████                                 | 378/561 [00:18<00:09, 19.78it/s] 68%|████████████████████████████████████████████████████████████████████▌                                | 381/561 [00:18<00:08, 21.02it/s] 68%|█████████████████████████████████████████████████████████████████████▏                               | 384/561 [00:19<00:08, 21.94it/s] 69%|█████████████████████████████████████████████████████████████████████▋                               | 387/561 [00:19<00:07, 22.29it/s] 70%|██████████████████████████████████████████████████████████████████████▏                              | 390/561 [00:19<00:08, 20.78it/s][2025-03-28 01:27:01,318] [INFO] [logging.py:128:log_dist] [Rank 0] step=11050, skipped=24, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:27:01,322] [INFO] [timer.py:264:stop] epoch=0/micro_step=11050/global_step=11050, RunningAvgSamplesPerSec=19.167238186972764, CurrSamplesPerSec=18.21992867106992, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 70%|██████████████████████████████████████████████████████████████████████▊                              | 393/561 [00:19<00:08, 19.88it/s] 71%|███████████████████████████████████████████████████████████████████████▎                             | 396/561 [00:19<00:08, 19.31it/s] 71%|███████████████████████████████████████████████████████████████████████▋                             | 398/561 [00:19<00:08, 18.91it/s] 71%|████████████████████████████████████████████████████████████████████████                             | 400/561 [00:19<00:08, 18.70it/s] 72%|████████████████████████████████████████████████████████████████████████▎                            | 402/561 [00:19<00:08, 18.54it/s] 72%|████████████████████████████████████████████████████████████████████████▋                            | 404/561 [00:20<00:08, 18.42it/s] 72%|█████████████████████████████████████████████████████████████████████████                            | 406/561 [00:20<00:08, 18.64it/s] 73%|█████████████████████████████████████████████████████████████████████████▋                           | 409/561 [00:20<00:07, 20.32it/s] 73%|██████████████████████████████████████████████████████████████████████████▏                          | 412/561 [00:20<00:06, 21.43it/s] 74%|██████████████████████████████████████████████████████████████████████████▋                          | 415/561 [00:20<00:06, 22.09it/s] 75%|███████████████████████████████████████████████████████████████████████████▎                         | 418/561 [00:20<00:06, 22.64it/s] 75%|███████████████████████████████████████████████████████████████████████████▊                         | 421/561 [00:20<00:06, 21.93it/s] 76%|████████████████████████████████████████████████████████████████████████████▎                        | 424/561 [00:20<00:06, 22.30it/s] 76%|████████████████████████████████████████████████████████████████████████████▉                        | 427/561 [00:21<00:06, 22.09it/s] 77%|█████████████████████████████████████████████████████████████████████████████▍                       | 430/561 [00:21<00:06, 20.73it/s] 77%|█████████████████████████████████████████████████████████████████████████████▉                       | 433/561 [00:21<00:06, 19.88it/s] 78%|██████████████████████████████████████████████████████████████████████████████▍                      | 436/561 [00:21<00:06, 19.32it/s] 78%|██████████████████████████████████████████████████████████████████████████████▊                      | 438/561 [00:21<00:06, 19.05it/s] 78%|███████████████████████████████████████████████████████████████████████████████▏                     | 440/561 [00:21<00:06, 18.80it/s][2025-03-28 01:27:03,833] [INFO] [logging.py:128:log_dist] [Rank 0] step=11100, skipped=24, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:27:03,836] [INFO] [timer.py:264:stop] epoch=0/micro_step=11100/global_step=11100, RunningAvgSamplesPerSec=19.170529989623763, CurrSamplesPerSec=18.107681966597575, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 79%|███████████████████████████████████████████████████████████████████████████████▌                     | 442/561 [00:21<00:06, 18.60it/s] 79%|███████████████████████████████████████████████████████████████████████████████▉                     | 444/561 [00:22<00:06, 18.45it/s] 80%|████████████████████████████████████████████████████████████████████████████████▎                    | 446/561 [00:22<00:06, 18.75it/s] 80%|████████████████████████████████████████████████████████████████████████████████▊                    | 449/561 [00:22<00:05, 20.60it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▍                   | 452/561 [00:22<00:05, 21.46it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▉                   | 455/561 [00:22<00:04, 22.24it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▍                  | 458/561 [00:22<00:04, 22.24it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▉                  | 461/561 [00:22<00:04, 20.80it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▌                 | 464/561 [00:22<00:04, 19.91it/s] 83%|████████████████████████████████████████████████████████████████████████████████████                 | 467/561 [00:23<00:04, 19.37it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▍                | 469/561 [00:23<00:04, 19.11it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▊                | 471/561 [00:23<00:04, 18.86it/s] 84%|█████████████████████████████████████████████████████████████████████████████████████▏               | 473/561 [00:23<00:04, 18.65it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▌               | 475/561 [00:23<00:04, 18.50it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▉               | 477/561 [00:23<00:04, 18.69it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▍              | 480/561 [00:23<00:03, 20.32it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▉              | 483/561 [00:23<00:03, 21.45it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▍             | 486/561 [00:24<00:03, 22.28it/s] 87%|████████████████████████████████████████████████████████████████████████████████████████             | 489/561 [00:24<00:03, 22.17it/s][2025-03-28 01:27:06,276] [INFO] [logging.py:128:log_dist] [Rank 0] step=11150, skipped=24, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:27:06,280] [INFO] [timer.py:264:stop] epoch=0/micro_step=11150/global_step=11150, RunningAvgSamplesPerSec=19.1761535603867, CurrSamplesPerSec=17.085423765667933, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 88%|████████████████████████████████████████████████████████████████████████████████████████▌            | 492/561 [00:24<00:03, 20.59it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████████            | 495/561 [00:24<00:03, 19.78it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▋           | 498/561 [00:24<00:03, 19.27it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████           | 500/561 [00:24<00:03, 19.03it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████▍          | 502/561 [00:24<00:03, 18.80it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▋          | 504/561 [00:25<00:03, 18.60it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████████          | 506/561 [00:25<00:02, 18.46it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▍         | 508/561 [00:25<00:02, 18.53it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▉         | 511/561 [00:25<00:02, 19.85it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████████▌        | 514/561 [00:25<00:02, 20.77it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████        | 517/561 [00:25<00:02, 21.73it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▌       | 520/561 [00:25<00:01, 21.93it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████████▏      | 523/561 [00:25<00:01, 20.46it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▋      | 526/561 [00:26<00:01, 19.71it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████      | 528/561 [00:26<00:01, 19.35it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▍     | 530/561 [00:26<00:01, 19.06it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▊     | 532/561 [00:26<00:01, 18.83it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████████▏    | 534/561 [00:26<00:01, 18.62it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▍    | 536/561 [00:26<00:01, 18.46it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▊    | 538/561 [00:26<00:01, 18.36it/s][2025-03-28 01:27:08,861] [INFO] [logging.py:128:log_dist] [Rank 0] step=11200, skipped=24, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:27:08,862] [INFO] [timer.py:264:stop] epoch=0/micro_step=11200/global_step=11200, RunningAvgSamplesPerSec=19.17716351044596, CurrSamplesPerSec=23.343942162909837, MemAllocated=0.02GB, MaxMemAllocated=1.89GB
 96%|█████████████████████████████████████████████████████████████████████████████████████████████████▍   | 541/561 [00:26<00:01, 19.80it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████████▉   | 544/561 [00:27<00:00, 21.30it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▍  | 547/561 [00:27<00:00, 21.92it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████████  | 550/561 [00:27<00:00, 22.46it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▌ | 553/561 [00:27<00:00, 21.13it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████ | 556/561 [00:27<00:00, 20.14it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████████▋| 559/561 [00:27<00:00, 19.49it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:27<00:00, 18.88it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:27<00:00, 20.08it/s]
[rank0]:[W328 01:27:23.584090559 ProcessGroupNCCL.cpp:1496] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[2025-03-28 01:27:25,867] [INFO] [launch.py:351:main] Process 580064 exits successfully.
[?2004h(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ bash scripts/script_normal_dif_test.sh 
[?2004l[2025-03-28 01:31:16,531] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-28 01:31:16,539] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-28 01:31:18,955] [WARNING] [runner.py:215:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2025-03-28 01:31:18,956] [INFO] [runner.py:607:main] cmd = /hpc2hdd/home/yli045/.conda/envs/ywj/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 --enable_each_rank_log=None main.py --image_size 16 --batch_size 1 --num_epochs 200 --timesteps 1000 --lr 2e-4 --time_emb_dim 256 --mu1 4 --sigma1 1 --num1 9000 --mu2 10 --sigma2 4 --num2 1000 --samples_dir ./samples --checkpoints_dir ./checkpoints --fp16 --mode train --model_path  --num_images 1000 --simulation_distribution normal --use_different_noise --use_moe --num_experts 4 --moe_hidden_dim 64 --moe_tau 0.1
[2025-03-28 01:31:21,832] [WARNING] [real_accelerator.py:181:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[2025-03-28 01:31:21,840] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cpu (auto detect)
[2025-03-28 01:31:22,979] [INFO] [launch.py:146:main] WORLD INFO DICT: {'localhost': [0]}
[2025-03-28 01:31:22,979] [INFO] [launch.py:152:main] nnodes=1, num_local_procs=1, node_rank=0
[2025-03-28 01:31:22,979] [INFO] [launch.py:163:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2025-03-28 01:31:22,979] [INFO] [launch.py:164:main] dist_world_size=1
[2025-03-28 01:31:22,979] [INFO] [launch.py:168:main] Setting CUDA_VISIBLE_DEVICES=0
[2025-03-28 01:31:22,980] [INFO] [launch.py:256:main] process 584785 spawned with command: ['/hpc2hdd/home/yli045/.conda/envs/ywj/bin/python', '-u', 'main.py', '--local_rank=0', '--image_size', '16', '--batch_size', '1', '--num_epochs', '200', '--timesteps', '1000', '--lr', '2e-4', '--time_emb_dim', '256', '--mu1', '4', '--sigma1', '1', '--num1', '9000', '--mu2', '10', '--sigma2', '4', '--num2', '1000', '--samples_dir', './samples', '--checkpoints_dir', './checkpoints', '--fp16', '--mode', 'train', '--model_path', '', '--num_images', '1000', '--simulation_distribution', 'normal', '--use_different_noise', '--use_moe', '--num_experts', '4', '--moe_hidden_dim', '64', '--moe_tau', '0.1']
[2025-03-28 01:31:28,124] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-03-28 01:31:41,885] [INFO] [logging.py:128:log_dist] [Rank -1] DeepSpeed info: version=0.16.4, git-hash=unknown, git-branch=unknown
[2025-03-28 01:31:41,886] [INFO] [comm.py:658:init_distributed] cdb=None
[2025-03-28 01:31:41,886] [INFO] [comm.py:689:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2025-03-28 01:31:41,896] [INFO] [config.py:734:__init__] Config mesh_device None world_size = 1
[2025-03-28 01:31:44,069] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
Using /hpc2hdd/home/yli045/.cache/torch_extensions/py312_cu124 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /hpc2hdd/home/yli045/.cache/torch_extensions/py312_cu124/fused_adam/build.ninja...
/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/utils/cpp_extension.py:2059: UserWarning: TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation. 
If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'].
  warnings.warn(
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 0.2168130874633789 seconds
[2025-03-28 01:31:44,292] [INFO] [logging.py:128:log_dist] [Rank 0] Using DeepSpeed Optimizer param name adamw as basic optimizer
[2025-03-28 01:31:44,292] [INFO] [logging.py:128:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2025-03-28 01:31:44,295] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Basic Optimizer = FusedAdam
[2025-03-28 01:31:44,295] [INFO] [utils.py:59:is_zero_supported_optimizer] Checking ZeRO support for optimizer=FusedAdam type=<class 'deepspeed.ops.adam.fused_adam.FusedAdam'>
[2025-03-28 01:31:44,295] [INFO] [logging.py:128:log_dist] [Rank 0] Creating torch.float16 ZeRO stage 2 optimizer
[2025-03-28 01:31:44,296] [INFO] [stage_1_and_2.py:149:__init__] Reduce bucket size 500000000
[2025-03-28 01:31:44,296] [INFO] [stage_1_and_2.py:150:__init__] Allgather bucket size 500000000
[2025-03-28 01:31:44,296] [INFO] [stage_1_and_2.py:151:__init__] CPU Offload: False
[2025-03-28 01:31:44,296] [INFO] [stage_1_and_2.py:152:__init__] Round robin gradient partitioning: False
[2025-03-28 01:31:45,525] [INFO] [utils.py:781:see_memory_usage] Before initializing optimizer states
[2025-03-28 01:31:45,525] [INFO] [utils.py:782:see_memory_usage] MA 0.0 GB         Max_MA 0.01 GB         CA 0.02 GB         Max_CA 0 GB 
[2025-03-28 01:31:45,526] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 153.54 GB, percent = 15.2%
[2025-03-28 01:31:45,649] [INFO] [utils.py:781:see_memory_usage] After initializing optimizer states
[2025-03-28 01:31:45,649] [INFO] [utils.py:782:see_memory_usage] MA 0.0 GB         Max_MA 0.01 GB         CA 0.02 GB         Max_CA 0 GB 
[2025-03-28 01:31:45,649] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 153.65 GB, percent = 15.2%
[2025-03-28 01:31:45,649] [INFO] [stage_1_and_2.py:550:__init__] optimizer state initialized
[2025-03-28 01:31:45,772] [INFO] [utils.py:781:see_memory_usage] After initializing ZeRO optimizer
[2025-03-28 01:31:45,772] [INFO] [utils.py:782:see_memory_usage] MA 0.0 GB         Max_MA 0.0 GB         CA 0.02 GB         Max_CA 0 GB 
[2025-03-28 01:31:45,772] [INFO] [utils.py:789:see_memory_usage] CPU Virtual Memory:  used = 153.73 GB, percent = 15.3%
[2025-03-28 01:31:45,774] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed Final Optimizer = DeepSpeedZeroOptimizer
[2025-03-28 01:31:45,774] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed using configured LR scheduler = None
[2025-03-28 01:31:45,774] [INFO] [logging.py:128:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2025-03-28 01:31:45,774] [INFO] [logging.py:128:log_dist] [Rank 0] step=0, skipped=0, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:31:45,774] [INFO] [config.py:1001:print] DeepSpeedEngine configuration:
[2025-03-28 01:31:45,774] [INFO] [config.py:1005:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2025-03-28 01:31:45,774] [INFO] [config.py:1005:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'intra_op_parallelism': 1, 'single_submit': False, 'overlap_events': True, 'use_gds': False}
[2025-03-28 01:31:45,774] [INFO] [config.py:1005:print]   amp_enabled .................. False
[2025-03-28 01:31:45,774] [INFO] [config.py:1005:print]   amp_params ................... False
[2025-03-28 01:31:45,775] [INFO] [config.py:1005:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2025-03-28 01:31:45,775] [INFO] [config.py:1005:print]   bfloat16_enabled ............. False
[2025-03-28 01:31:45,775] [INFO] [config.py:1005:print]   bfloat16_immediate_grad_update  False
[2025-03-28 01:31:45,775] [INFO] [config.py:1005:print]   checkpoint_parallel_write_pipeline  False
[2025-03-28 01:31:45,775] [INFO] [config.py:1005:print]   checkpoint_tag_validation_enabled  True
[2025-03-28 01:31:45,775] [INFO] [config.py:1005:print]   checkpoint_tag_validation_fail  False
[2025-03-28 01:31:45,775] [INFO] [config.py:1005:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7f1952b0cfb0>
[2025-03-28 01:31:45,775] [INFO] [config.py:1005:print]   communication_data_type ...... None
[2025-03-28 01:31:45,775] [INFO] [config.py:1005:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2025-03-28 01:31:45,775] [INFO] [config.py:1005:print]   curriculum_enabled_legacy .... False
[2025-03-28 01:31:45,775] [INFO] [config.py:1005:print]   curriculum_params_legacy ..... False
[2025-03-28 01:31:45,775] [INFO] [config.py:1005:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2025-03-28 01:31:45,775] [INFO] [config.py:1005:print]   data_efficiency_enabled ...... False
[2025-03-28 01:31:45,775] [INFO] [config.py:1005:print]   dataloader_drop_last ......... False
[2025-03-28 01:31:45,775] [INFO] [config.py:1005:print]   disable_allgather ............ False
[2025-03-28 01:31:45,775] [INFO] [config.py:1005:print]   dump_state ................... False
[2025-03-28 01:31:45,775] [INFO] [config.py:1005:print]   dynamic_loss_scale_args ...... {'init_scale': 65536, 'scale_window': 1000, 'delayed_shift': 2, 'consecutive_hysteresis': False, 'min_scale': 1}
[2025-03-28 01:31:45,775] [INFO] [config.py:1005:print]   eigenvalue_enabled ........... False
[2025-03-28 01:31:45,775] [INFO] [config.py:1005:print]   eigenvalue_gas_boundary_resolution  1
[2025-03-28 01:31:45,775] [INFO] [config.py:1005:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2025-03-28 01:31:45,775] [INFO] [config.py:1005:print]   eigenvalue_layer_num ......... 0
[2025-03-28 01:31:45,776] [INFO] [config.py:1005:print]   eigenvalue_max_iter .......... 100
[2025-03-28 01:31:45,776] [INFO] [config.py:1005:print]   eigenvalue_stability ......... 1e-06
[2025-03-28 01:31:45,776] [INFO] [config.py:1005:print]   eigenvalue_tol ............... 0.01
[2025-03-28 01:31:45,776] [INFO] [config.py:1005:print]   eigenvalue_verbose ........... False
[2025-03-28 01:31:45,776] [INFO] [config.py:1005:print]   elasticity_enabled ........... False
[2025-03-28 01:31:45,776] [INFO] [config.py:1005:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2025-03-28 01:31:45,776] [INFO] [config.py:1005:print]   fp16_auto_cast ............... False
[2025-03-28 01:31:45,776] [INFO] [config.py:1005:print]   fp16_enabled ................. True
[2025-03-28 01:31:45,776] [INFO] [config.py:1005:print]   fp16_master_weights_and_gradients  False
[2025-03-28 01:31:45,776] [INFO] [config.py:1005:print]   global_rank .................. 0
[2025-03-28 01:31:45,776] [INFO] [config.py:1005:print]   grad_accum_dtype ............. None
[2025-03-28 01:31:45,776] [INFO] [config.py:1005:print]   gradient_accumulation_steps .. 1
[2025-03-28 01:31:45,776] [INFO] [config.py:1005:print]   gradient_clipping ............ 1.0
[2025-03-28 01:31:45,776] [INFO] [config.py:1005:print]   gradient_predivide_factor .... 1.0
[2025-03-28 01:31:45,776] [INFO] [config.py:1005:print]   graph_harvesting ............. False
[2025-03-28 01:31:45,776] [INFO] [config.py:1005:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2025-03-28 01:31:45,776] [INFO] [config.py:1005:print]   initial_dynamic_scale ........ 65536
[2025-03-28 01:31:45,776] [INFO] [config.py:1005:print]   load_universal_checkpoint .... False
[2025-03-28 01:31:45,776] [INFO] [config.py:1005:print]   loss_scale ................... 0
[2025-03-28 01:31:45,776] [INFO] [config.py:1005:print]   memory_breakdown ............. False
[2025-03-28 01:31:45,776] [INFO] [config.py:1005:print]   mics_hierarchial_params_gather  False
[2025-03-28 01:31:45,776] [INFO] [config.py:1005:print]   mics_shard_size .............. -1
[2025-03-28 01:31:45,776] [INFO] [config.py:1005:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') comet=CometConfig(enabled=False, samples_log_interval=100, project=None, workspace=None, api_key=None, experiment_name=None, experiment_key=None, online=None, mode=None) wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName')
[2025-03-28 01:31:45,777] [INFO] [config.py:1005:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2025-03-28 01:31:45,777] [INFO] [config.py:1005:print]   optimizer_legacy_fusion ...... False
[2025-03-28 01:31:45,777] [INFO] [config.py:1005:print]   optimizer_name ............... adamw
[2025-03-28 01:31:45,777] [INFO] [config.py:1005:print]   optimizer_params ............. {'lr': 0.0002, 'weight_decay': 0.01}
[2025-03-28 01:31:45,777] [INFO] [config.py:1005:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2025-03-28 01:31:45,777] [INFO] [config.py:1005:print]   pld_enabled .................. False
[2025-03-28 01:31:45,777] [INFO] [config.py:1005:print]   pld_params ................... False
[2025-03-28 01:31:45,777] [INFO] [config.py:1005:print]   prescale_gradients ........... False
[2025-03-28 01:31:45,777] [INFO] [config.py:1005:print]   scheduler_name ............... None
[2025-03-28 01:31:45,777] [INFO] [config.py:1005:print]   scheduler_params ............. None
[2025-03-28 01:31:45,777] [INFO] [config.py:1005:print]   seq_parallel_communication_data_type  torch.float32
[2025-03-28 01:31:45,777] [INFO] [config.py:1005:print]   sparse_attention ............. None
[2025-03-28 01:31:45,777] [INFO] [config.py:1005:print]   sparse_gradients_enabled ..... False
[2025-03-28 01:31:45,777] [INFO] [config.py:1005:print]   steps_per_print .............. 50
[2025-03-28 01:31:45,777] [INFO] [config.py:1005:print]   tensor_parallel_config ....... dtype=torch.float16 autotp_size=0 tensor_parallel=TPConfig(tp_size=1, tp_grain_size=1, mpu=None, tp_group=None) injection_policy_tuple=None keep_module_on_host=False replace_with_kernel_inject=False
[2025-03-28 01:31:45,777] [INFO] [config.py:1005:print]   timers_config ................ enabled=True synchronized=True
[2025-03-28 01:31:45,777] [INFO] [config.py:1005:print]   train_batch_size ............. 1
[2025-03-28 01:31:45,777] [INFO] [config.py:1005:print]   train_micro_batch_size_per_gpu  1
[2025-03-28 01:31:45,777] [INFO] [config.py:1005:print]   use_data_before_expert_parallel_  False
[2025-03-28 01:31:45,777] [INFO] [config.py:1005:print]   use_node_local_storage ....... False
[2025-03-28 01:31:45,777] [INFO] [config.py:1005:print]   wall_clock_breakdown ......... False
[2025-03-28 01:31:45,777] [INFO] [config.py:1005:print]   weight_quantization_config ... None
[2025-03-28 01:31:45,777] [INFO] [config.py:1005:print]   world_size ................... 1
[2025-03-28 01:31:45,777] [INFO] [config.py:1005:print]   zero_allow_untested_optimizer  False
[2025-03-28 01:31:45,777] [INFO] [config.py:1005:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=500000000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50000000 param_persistence_threshold=100000 model_persistence_threshold=9223372036854775807 max_live_parameters=1000000000 max_reuse_distance=1000000000 gather_16bit_weights_on_model_save=False module_granularity_threshold=0 use_all_reduce_for_fetch_params=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False zeropp_loco_param=None mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True log_trace_cache_warnings=False
[2025-03-28 01:31:45,777] [INFO] [config.py:1005:print]   zero_enabled ................. True
[2025-03-28 01:31:45,778] [INFO] [config.py:1005:print]   zero_force_ds_cpu_optimizer .. True
[2025-03-28 01:31:45,778] [INFO] [config.py:1005:print]   zero_optimization_stage ...... 2
[2025-03-28 01:31:45,778] [INFO] [config.py:991:print_user_config]   json = {
    "train_batch_size": 1, 
    "gradient_accumulation_steps": 1, 
    "optimizer": {
        "type": "AdamW", 
        "params": {
            "lr": 0.0002, 
            "weight_decay": 0.01
        }
    }, 
    "fp16": {
        "enabled": true, 
        "loss_scale": 0, 
        "loss_scale_window": 1000
    }, 
    "zero_optimization": {
        "stage": 2, 
        "contiguous_gradients": true, 
        "overlap_comm": true
    }, 
    "steps_per_print": 50, 
    "gradient_clipping": 1.0
}
****START TRAINING****
image_size: 16, batch_size: 1, timesteps: 1000, time_emb_dim: 256
  0%|                                                                                                               | 0/561 [00:00<?, ?it/s][2025-03-28 01:31:47,239] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
  0%|▏                                                                                                      | 1/561 [00:01<13:12,  1.42s/it][2025-03-28 01:31:47,275] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
  1%|▌                                                                                                      | 3/561 [00:01<04:22,  2.13it/s]  1%|▉                                                                                                      | 5/561 [00:01<02:23,  3.88it/s]  1%|█▍                                                                                                     | 8/561 [00:01<01:21,  6.81it/s]  2%|██                                                                                                    | 11/561 [00:02<00:56,  9.80it/s]  2%|██▌                                                                                                   | 14/561 [00:02<00:43, 12.60it/s]  3%|███                                                                                                   | 17/561 [00:02<00:36, 14.71it/s]  4%|███▋                                                                                                  | 20/561 [00:02<00:34, 15.82it/s]  4%|████                                                                                                  | 22/561 [00:02<00:32, 16.65it/s]  4%|████▌                                                                                                 | 25/561 [00:02<00:30, 17.56it/s]  5%|████▉                                                                                                 | 27/561 [00:02<00:29, 17.85it/s]  5%|█████▍                                                                                                | 30/561 [00:03<00:28, 18.59it/s]  6%|██████                                                                                                | 33/561 [00:03<00:26, 19.90it/s]  6%|██████▌                                                                                               | 36/561 [00:03<00:26, 20.17it/s]  7%|███████                                                                                               | 39/561 [00:03<00:25, 20.49it/s]  7%|███████▋                                                                                              | 42/561 [00:03<00:25, 20.00it/s]  8%|████████▏                                                                                             | 45/561 [00:03<00:27, 18.91it/s]  8%|████████▌                                                                                             | 47/561 [00:03<00:27, 18.46it/s]  9%|████████▉                                                                                             | 49/561 [00:03<00:27, 18.63it/s][2025-03-28 01:31:49,856] [INFO] [logging.py:128:log_dist] [Rank 0] step=50, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:31:49,857] [INFO] [timer.py:264:stop] epoch=0/micro_step=50/global_step=50, RunningAvgSamplesPerSec=18.642352274474, CurrSamplesPerSec=19.993422354412456, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
  9%|█████████▍                                                                                            | 52/561 [00:04<00:26, 18.90it/s] 10%|█████████▊                                                                                            | 54/561 [00:04<00:26, 18.81it/s] 10%|██████████▏                                                                                           | 56/561 [00:04<00:26, 18.74it/s] 10%|██████████▌                                                                                           | 58/561 [00:04<00:26, 18.85it/s] 11%|██████████▉                                                                                           | 60/561 [00:04<00:26, 18.78it/s] 11%|███████████▎                                                                                          | 62/561 [00:04<00:26, 18.59it/s] 11%|███████████▋                                                                                          | 64/561 [00:04<00:26, 18.72it/s] 12%|████████████                                                                                          | 66/561 [00:04<00:26, 18.57it/s] 12%|████████████▎                                                                                         | 68/561 [00:04<00:26, 18.56it/s] 12%|████████████▋                                                                                         | 70/561 [00:05<00:26, 18.53it/s] 13%|█████████████                                                                                         | 72/561 [00:05<00:26, 18.54it/s] 13%|█████████████▍                                                                                        | 74/561 [00:05<00:27, 17.96it/s] 14%|█████████████▊                                                                                        | 76/561 [00:05<00:26, 18.51it/s] 14%|██████████████▎                                                                                       | 79/561 [00:05<00:24, 19.83it/s] 15%|██████████████▉                                                                                       | 82/561 [00:05<00:23, 20.53it/s] 15%|███████████████▍                                                                                      | 85/561 [00:05<00:22, 20.87it/s] 16%|████████████████                                                                                      | 88/561 [00:06<00:23, 19.86it/s] 16%|████████████████▎                                                                                     | 90/561 [00:06<00:24, 19.41it/s] 16%|████████████████▋                                                                                     | 92/561 [00:06<00:24, 19.05it/s] 17%|█████████████████                                                                                     | 94/561 [00:06<00:25, 18.46it/s] 17%|█████████████████▍                                                                                    | 96/561 [00:06<00:25, 18.20it/s] 17%|█████████████████▊                                                                                    | 98/561 [00:06<00:25, 18.15it/s][2025-03-28 01:31:52,506] [INFO] [logging.py:128:log_dist] [Rank 0] step=100, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:31:52,509] [INFO] [timer.py:264:stop] epoch=0/micro_step=100/global_step=100, RunningAvgSamplesPerSec=18.76956297392894, CurrSamplesPerSec=17.973211411070817, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 18%|██████████████████                                                                                   | 100/561 [00:06<00:25, 18.08it/s] 18%|██████████████████▎                                                                                  | 102/561 [00:06<00:25, 18.09it/s] 19%|██████████████████▋                                                                                  | 104/561 [00:06<00:25, 18.06it/s] 19%|███████████████████▎                                                                                 | 107/561 [00:07<00:22, 19.84it/s] 20%|███████████████████▊                                                                                 | 110/561 [00:07<00:21, 21.08it/s] 20%|████████████████████▎                                                                                | 113/561 [00:07<00:21, 20.84it/s] 21%|████████████████████▉                                                                                | 116/561 [00:07<00:22, 20.10it/s] 21%|█████████████████████▍                                                                               | 119/561 [00:07<00:21, 20.26it/s] 22%|█████████████████████▉                                                                               | 122/561 [00:07<00:22, 19.58it/s] 22%|██████████████████████▎                                                                              | 124/561 [00:07<00:22, 19.25it/s] 22%|██████████████████████▋                                                                              | 126/561 [00:07<00:22, 18.96it/s] 23%|███████████████████████                                                                              | 128/561 [00:08<00:23, 18.72it/s] 23%|███████████████████████▍                                                                             | 130/561 [00:08<00:24, 17.85it/s] 24%|███████████████████████▊                                                                             | 132/561 [00:08<00:23, 17.90it/s] 24%|████████████████████████                                                                             | 134/561 [00:08<00:23, 17.92it/s] 24%|████████████████████████▍                                                                            | 136/561 [00:08<00:23, 17.94it/s] 25%|████████████████████████▊                                                                            | 138/561 [00:08<00:23, 17.96it/s] 25%|█████████████████████████▍                                                                           | 141/561 [00:08<00:21, 19.14it/s] 26%|█████████████████████████▉                                                                           | 144/561 [00:08<00:20, 19.90it/s] 26%|██████████████████████████▍                                                                          | 147/561 [00:09<00:20, 20.51it/s][2025-03-28 01:31:55,064] [INFO] [logging.py:128:log_dist] [Rank 0] step=150, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:31:55,067] [INFO] [timer.py:264:stop] epoch=0/micro_step=150/global_step=150, RunningAvgSamplesPerSec=19.04189421077721, CurrSamplesPerSec=19.37482208864741, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 27%|███████████████████████████                                                                          | 150/561 [00:09<00:20, 20.54it/s] 27%|███████████████████████████▌                                                                         | 153/561 [00:09<00:20, 19.72it/s] 28%|███████████████████████████▉                                                                         | 155/561 [00:09<00:20, 19.33it/s] 28%|████████████████████████████▎                                                                        | 157/561 [00:09<00:21, 19.01it/s] 28%|████████████████████████████▋                                                                        | 159/561 [00:09<00:21, 18.75it/s] 29%|████████████████████████████▉                                                                        | 161/561 [00:09<00:21, 18.55it/s] 29%|█████████████████████████████▎                                                                       | 163/561 [00:09<00:21, 18.39it/s] 29%|█████████████████████████████▋                                                                       | 165/561 [00:10<00:21, 18.27it/s] 30%|██████████████████████████████                                                                       | 167/561 [00:10<00:21, 18.20it/s] 30%|██████████████████████████████▍                                                                      | 169/561 [00:10<00:21, 18.63it/s] 31%|██████████████████████████████▉                                                                      | 172/561 [00:10<00:19, 19.68it/s] 31%|███████████████████████████████▌                                                                     | 175/561 [00:10<00:19, 20.20it/s] 32%|████████████████████████████████                                                                     | 178/561 [00:10<00:18, 20.87it/s] 32%|████████████████████████████████▌                                                                    | 181/561 [00:10<00:17, 21.50it/s] 33%|█████████████████████████████████▏                                                                   | 184/561 [00:10<00:17, 21.21it/s] 33%|█████████████████████████████████▋                                                                   | 187/561 [00:11<00:18, 20.15it/s] 34%|██████████████████████████████████▏                                                                  | 190/561 [00:11<00:19, 19.37it/s] 34%|██████████████████████████████████▌                                                                  | 192/561 [00:11<00:19, 19.06it/s] 35%|██████████████████████████████████▉                                                                  | 194/561 [00:11<00:19, 18.80it/s] 35%|███████████████████████████████████▎                                                                 | 196/561 [00:11<00:19, 18.60it/s] 35%|███████████████████████████████████▋                                                                 | 198/561 [00:11<00:19, 18.42it/s][2025-03-28 01:31:57,686] [INFO] [logging.py:128:log_dist] [Rank 0] step=200, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:31:57,689] [INFO] [timer.py:264:stop] epoch=0/micro_step=200/global_step=200, RunningAvgSamplesPerSec=19.059470545751847, CurrSamplesPerSec=17.92091485780324, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 36%|████████████████████████████████████                                                                 | 200/561 [00:11<00:19, 18.26it/s] 36%|████████████████████████████████████▎                                                                | 202/561 [00:11<00:19, 18.19it/s] 37%|████████████████████████████████████▉                                                                | 205/561 [00:12<00:18, 19.28it/s] 37%|█████████████████████████████████████▍                                                               | 208/561 [00:12<00:17, 20.44it/s] 38%|█████████████████████████████████████▉                                                               | 211/561 [00:12<00:16, 21.06it/s] 38%|██████████████████████████████████████▌                                                              | 214/561 [00:12<00:16, 21.19it/s] 39%|███████████████████████████████████████                                                              | 217/561 [00:12<00:16, 21.32it/s] 39%|███████████████████████████████████████▌                                                             | 220/561 [00:12<00:16, 21.12it/s] 40%|████████████████████████████████████████▏                                                            | 223/561 [00:12<00:16, 20.10it/s] 40%|████████████████████████████████████████▋                                                            | 226/561 [00:13<00:17, 19.42it/s] 41%|█████████████████████████████████████████                                                            | 228/561 [00:13<00:17, 19.10it/s] 41%|█████████████████████████████████████████▍                                                           | 230/561 [00:13<00:18, 18.04it/s] 41%|█████████████████████████████████████████▊                                                           | 232/561 [00:13<00:18, 17.88it/s] 42%|██████████████████████████████████████████▏                                                          | 234/561 [00:13<00:18, 17.91it/s] 42%|██████████████████████████████████████████▍                                                          | 236/561 [00:13<00:18, 17.94it/s] 42%|██████████████████████████████████████████▊                                                          | 238/561 [00:13<00:17, 17.95it/s] 43%|███████████████████████████████████████████▍                                                         | 241/561 [00:13<00:16, 18.94it/s] 43%|███████████████████████████████████████████▉                                                         | 244/561 [00:14<00:16, 19.80it/s] 44%|████████████████████████████████████████████▍                                                        | 247/561 [00:14<00:15, 20.54it/s][2025-03-28 01:32:00,204] [INFO] [logging.py:128:log_dist] [Rank 0] step=250, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:32:00,205] [INFO] [timer.py:264:stop] epoch=0/micro_step=250/global_step=250, RunningAvgSamplesPerSec=19.226724235895727, CurrSamplesPerSec=21.77669203136799, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 45%|█████████████████████████████████████████████                                                        | 250/561 [00:14<00:14, 20.89it/s] 45%|█████████████████████████████████████████████▌                                                       | 253/561 [00:14<00:14, 21.37it/s] 46%|██████████████████████████████████████████████                                                       | 256/561 [00:14<00:13, 22.02it/s] 46%|██████████████████████████████████████████████▋                                                      | 259/561 [00:14<00:14, 21.38it/s] 47%|███████████████████████████████████████████████▏                                                     | 262/561 [00:14<00:14, 20.27it/s] 47%|███████████████████████████████████████████████▋                                                     | 265/561 [00:15<00:15, 19.56it/s] 48%|████████████████████████████████████████████████                                                     | 267/561 [00:15<00:15, 19.21it/s] 48%|████████████████████████████████████████████████▍                                                    | 269/561 [00:15<00:15, 18.92it/s] 48%|████████████████████████████████████████████████▊                                                    | 271/561 [00:15<00:15, 18.67it/s] 49%|█████████████████████████████████████████████████▏                                                   | 273/561 [00:15<00:15, 18.49it/s] 49%|█████████████████████████████████████████████████▌                                                   | 275/561 [00:15<00:15, 18.36it/s] 49%|█████████████████████████████████████████████████▊                                                   | 277/561 [00:15<00:15, 18.53it/s] 50%|██████████████████████████████████████████████████▍                                                  | 280/561 [00:15<00:14, 19.67it/s] 50%|██████████████████████████████████████████████████▉                                                  | 283/561 [00:16<00:13, 20.46it/s] 51%|███████████████████████████████████████████████████▍                                                 | 286/561 [00:16<00:13, 20.82it/s] 52%|████████████████████████████████████████████████████                                                 | 289/561 [00:16<00:12, 21.37it/s] 52%|████████████████████████████████████████████████████▌                                                | 292/561 [00:16<00:12, 21.04it/s] 53%|█████████████████████████████████████████████████████                                                | 295/561 [00:16<00:12, 21.07it/s] 53%|█████████████████████████████████████████████████████▋                                               | 298/561 [00:16<00:12, 21.22it/s][2025-03-28 01:32:02,669] [INFO] [logging.py:128:log_dist] [Rank 0] step=300, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:32:02,670] [INFO] [timer.py:264:stop] epoch=0/micro_step=300/global_step=300, RunningAvgSamplesPerSec=19.404891481874234, CurrSamplesPerSec=21.920777994581098, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 54%|██████████████████████████████████████████████████████▏                                              | 301/561 [00:16<00:12, 21.44it/s] 54%|██████████████████████████████████████████████████████▋                                              | 304/561 [00:17<00:12, 20.62it/s] 55%|███████████████████████████████████████████████████████▎                                             | 307/561 [00:17<00:12, 19.64it/s] 55%|███████████████████████████████████████████████████████▋                                             | 309/561 [00:17<00:13, 19.15it/s] 55%|███████████████████████████████████████████████████████▉                                             | 311/561 [00:17<00:13, 18.91it/s] 56%|████████████████████████████████████████████████████████▎                                            | 313/561 [00:17<00:13, 18.70it/s] 56%|████████████████████████████████████████████████████████▋                                            | 315/561 [00:17<00:13, 18.54it/s] 57%|█████████████████████████████████████████████████████████                                            | 317/561 [00:17<00:13, 18.39it/s] 57%|█████████████████████████████████████████████████████████▍                                           | 319/561 [00:17<00:13, 18.29it/s] 57%|█████████████████████████████████████████████████████████▊                                           | 321/561 [00:17<00:13, 18.21it/s] 58%|██████████████████████████████████████████████████████████▏                                          | 323/561 [00:18<00:12, 18.62it/s] 58%|██████████████████████████████████████████████████████████▋                                          | 326/561 [00:18<00:11, 20.54it/s] 59%|███████████████████████████████████████████████████████████▏                                         | 329/561 [00:18<00:11, 21.08it/s] 59%|███████████████████████████████████████████████████████████▊                                         | 332/561 [00:18<00:11, 20.56it/s] 60%|████████████████████████████████████████████████████████████▎                                        | 335/561 [00:18<00:10, 21.39it/s] 60%|████████████████████████████████████████████████████████████▊                                        | 338/561 [00:18<00:10, 22.27it/s] 61%|█████████████████████████████████████████████████████████████▍                                       | 341/561 [00:18<00:09, 22.25it/s] 61%|█████████████████████████████████████████████████████████████▉                                       | 344/561 [00:19<00:09, 22.26it/s] 62%|██████████████████████████████████████████████████████████████▍                                      | 347/561 [00:19<00:09, 22.19it/s][2025-03-28 01:32:05,128] [INFO] [logging.py:128:log_dist] [Rank 0] step=350, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:32:05,129] [INFO] [timer.py:264:stop] epoch=0/micro_step=350/global_step=350, RunningAvgSamplesPerSec=19.53946738224475, CurrSamplesPerSec=23.018915034398216, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 62%|███████████████████████████████████████████████████████████████                                      | 350/561 [00:19<00:09, 21.99it/s] 63%|███████████████████████████████████████████████████████████████▌                                     | 353/561 [00:19<00:09, 22.10it/s] 63%|████████████████████████████████████████████████████████████████                                     | 356/561 [00:19<00:09, 22.45it/s] 64%|████████████████████████████████████████████████████████████████▋                                    | 359/561 [00:19<00:08, 22.68it/s] 65%|█████████████████████████████████████████████████████████████████▏                                   | 362/561 [00:19<00:09, 21.64it/s] 65%|█████████████████████████████████████████████████████████████████▋                                   | 365/561 [00:20<00:09, 20.43it/s] 66%|██████████████████████████████████████████████████████████████████▎                                  | 368/561 [00:20<00:09, 19.64it/s] 66%|██████████████████████████████████████████████████████████████████▌                                  | 370/561 [00:20<00:09, 19.26it/s] 66%|██████████████████████████████████████████████████████████████████▉                                  | 372/561 [00:20<00:10, 18.84it/s] 67%|███████████████████████████████████████████████████████████████████▎                                 | 374/561 [00:20<00:10, 18.62it/s] 67%|███████████████████████████████████████████████████████████████████▋                                 | 376/561 [00:20<00:10, 18.44it/s] 67%|████████████████████████████████████████████████████████████████████                                 | 378/561 [00:20<00:10, 18.14it/s] 68%|████████████████████████████████████████████████████████████████████▍                                | 380/561 [00:20<00:09, 18.23it/s] 68%|████████████████████████████████████████████████████████████████████▉                                | 383/561 [00:20<00:08, 19.92it/s] 69%|█████████████████████████████████████████████████████████████████████▍                               | 386/561 [00:21<00:08, 20.88it/s] 69%|██████████████████████████████████████████████████████████████████████                               | 389/561 [00:21<00:08, 21.29it/s] 70%|██████████████████████████████████████████████████████████████████████▌                              | 392/561 [00:21<00:07, 21.54it/s] 70%|███████████████████████████████████████████████████████████████████████                              | 395/561 [00:21<00:07, 21.61it/s] 71%|███████████████████████████████████████████████████████████████████████▋                             | 398/561 [00:21<00:07, 21.69it/s][2025-03-28 01:32:07,573] [INFO] [logging.py:128:log_dist] [Rank 0] step=400, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:32:07,574] [INFO] [timer.py:264:stop] epoch=0/micro_step=400/global_step=400, RunningAvgSamplesPerSec=19.65514690751574, CurrSamplesPerSec=21.370703988437675, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 71%|████████████████████████████████████████████████████████████████████████▏                            | 401/561 [00:21<00:07, 21.79it/s] 72%|████████████████████████████████████████████████████████████████████████▋                            | 404/561 [00:21<00:07, 21.82it/s] 73%|█████████████████████████████████████████████████████████████████████████▎                           | 407/561 [00:22<00:07, 21.62it/s] 73%|█████████████████████████████████████████████████████████████████████████▊                           | 410/561 [00:22<00:06, 21.69it/s] 74%|██████████████████████████████████████████████████████████████████████████▎                          | 413/561 [00:22<00:06, 21.66it/s] 74%|██████████████████████████████████████████████████████████████████████████▉                          | 416/561 [00:22<00:06, 21.58it/s] 75%|███████████████████████████████████████████████████████████████████████████▍                         | 419/561 [00:22<00:06, 20.41it/s] 75%|███████████████████████████████████████████████████████████████████████████▉                         | 422/561 [00:22<00:06, 21.11it/s] 76%|████████████████████████████████████████████████████████████████████████████▌                        | 425/561 [00:22<00:06, 21.76it/s] 76%|█████████████████████████████████████████████████████████████████████████████                        | 428/561 [00:23<00:06, 21.95it/s] 77%|█████████████████████████████████████████████████████████████████████████████▌                       | 431/561 [00:23<00:05, 22.37it/s] 77%|██████████████████████████████████████████████████████████████████████████████▏                      | 434/561 [00:23<00:05, 22.92it/s] 78%|██████████████████████████████████████████████████████████████████████████████▋                      | 437/561 [00:23<00:05, 23.03it/s] 78%|███████████████████████████████████████████████████████████████████████████████▏                     | 440/561 [00:23<00:05, 21.89it/s] 79%|███████████████████████████████████████████████████████████████████████████████▊                     | 443/561 [00:23<00:05, 22.28it/s] 80%|████████████████████████████████████████████████████████████████████████████████▎                    | 446/561 [00:23<00:05, 22.29it/s] 80%|████████████████████████████████████████████████████████████████████████████████▊                    | 449/561 [00:23<00:05, 22.10it/s][2025-03-28 01:32:09,852] [INFO] [logging.py:128:log_dist] [Rank 0] step=450, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:32:09,853] [INFO] [timer.py:264:stop] epoch=0/micro_step=450/global_step=450, RunningAvgSamplesPerSec=19.891722066267757, CurrSamplesPerSec=21.906695550247193, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 81%|█████████████████████████████████████████████████████████████████████████████████▍                   | 452/561 [00:24<00:04, 22.13it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▉                   | 455/561 [00:24<00:04, 22.65it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▍                  | 458/561 [00:24<00:04, 22.90it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▉                  | 461/561 [00:24<00:04, 22.67it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▌                 | 464/561 [00:24<00:04, 22.49it/s] 83%|████████████████████████████████████████████████████████████████████████████████████                 | 467/561 [00:24<00:04, 22.35it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▌                | 470/561 [00:24<00:04, 22.30it/s] 84%|█████████████████████████████████████████████████████████████████████████████████████▏               | 473/561 [00:25<00:03, 22.60it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▋               | 476/561 [00:25<00:03, 22.41it/s] 85%|██████████████████████████████████████████████████████████████████████████████████████▏              | 479/561 [00:25<00:03, 22.04it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▊              | 482/561 [00:25<00:03, 22.05it/s] 86%|███████████████████████████████████████████████████████████████████████████████████████▎             | 485/561 [00:25<00:03, 22.17it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▊             | 488/561 [00:25<00:03, 22.65it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▍            | 491/561 [00:25<00:03, 22.93it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▉            | 494/561 [00:25<00:02, 22.65it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▍           | 497/561 [00:26<00:02, 22.20it/s][2025-03-28 01:32:12,082] [INFO] [logging.py:128:log_dist] [Rank 0] step=500, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:32:12,083] [INFO] [timer.py:264:stop] epoch=0/micro_step=500/global_step=500, RunningAvgSamplesPerSec=20.124597334800683, CurrSamplesPerSec=21.732798829135913, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 89%|██████████████████████████████████████████████████████████████████████████████████████████           | 500/561 [00:26<00:02, 22.00it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▌          | 503/561 [00:26<00:02, 22.17it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████████          | 506/561 [00:26<00:02, 22.46it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▋         | 509/561 [00:26<00:02, 22.23it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████████▏        | 512/561 [00:26<00:02, 22.02it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████████▋        | 515/561 [00:26<00:02, 22.13it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████▎       | 518/561 [00:27<00:01, 22.57it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▊       | 521/561 [00:27<00:01, 22.73it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████████▎      | 524/561 [00:27<00:01, 22.73it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▉      | 527/561 [00:27<00:01, 22.74it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▍     | 530/561 [00:27<00:01, 22.29it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▉     | 533/561 [00:27<00:01, 22.46it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▍    | 536/561 [00:27<00:01, 21.94it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████    | 539/561 [00:28<00:01, 21.69it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████████▌   | 542/561 [00:28<00:00, 21.63it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████████   | 545/561 [00:28<00:00, 20.59it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▋  | 548/561 [00:28<00:00, 20.96it/s][2025-03-28 01:32:14,364] [INFO] [logging.py:128:log_dist] [Rank 0] step=550, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:32:14,365] [INFO] [timer.py:264:stop] epoch=0/micro_step=550/global_step=550, RunningAvgSamplesPerSec=20.279863952741206, CurrSamplesPerSec=22.437328898633986, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 98%|███████████████████████████████████████████████████████████████████████████████████████████████████▏ | 551/561 [00:28<00:00, 21.28it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▋ | 554/561 [00:28<00:00, 21.66it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████▎| 557/561 [00:28<00:00, 22.30it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████████▊| 560/561 [00:28<00:00, 22.80it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:29<00:00, 19.31it/s]
/hpc2hdd/home/yli045/diffusion_noise_agent/train.py:189: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  df = pd.concat([df, pd.DataFrame([new_row])], ignore_index=True) # 使用 pd.concat 追加数据
  0%|                                                                                                               | 0/561 [00:00<?, ?it/s]  0%|▏                                                                                                      | 1/561 [00:00<02:02,  4.57it/s]  1%|▌                                                                                                      | 3/561 [00:00<00:52, 10.57it/s]  1%|█                                                                                                      | 6/561 [00:00<00:35, 15.54it/s]  2%|█▋                                                                                                     | 9/561 [00:00<00:30, 17.94it/s]  2%|██▏                                                                                                   | 12/561 [00:00<00:28, 19.39it/s]  3%|██▋                                                                                                   | 15/561 [00:00<00:26, 20.22it/s]  3%|███▎                                                                                                  | 18/561 [00:01<00:26, 20.78it/s]  4%|███▊                                                                                                  | 21/561 [00:01<00:25, 21.32it/s]  4%|████▎                                                                                                 | 24/561 [00:01<00:25, 21.47it/s]  5%|████▉                                                                                                 | 27/561 [00:01<00:24, 21.67it/s]  5%|█████▍                                                                                                | 30/561 [00:01<00:25, 20.71it/s]  6%|██████                                                                                                | 33/561 [00:01<00:25, 20.81it/s]  6%|██████▌                                                                                               | 36/561 [00:01<00:24, 21.12it/s][2025-03-28 01:32:16,914] [INFO] [logging.py:128:log_dist] [Rank 0] step=600, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:32:16,915] [INFO] [timer.py:264:stop] epoch=0/micro_step=600/global_step=600, RunningAvgSamplesPerSec=20.337965671501536, CurrSamplesPerSec=22.828480573963624, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
  7%|███████                                                                                               | 39/561 [00:01<00:24, 21.49it/s]  7%|███████▋                                                                                              | 42/561 [00:02<00:24, 21.61it/s]  8%|████████▏                                                                                             | 45/561 [00:02<00:24, 21.31it/s]  9%|████████▋                                                                                             | 48/561 [00:02<00:23, 21.41it/s]  9%|█████████▎                                                                                            | 51/561 [00:02<00:23, 21.98it/s] 10%|█████████▊                                                                                            | 54/561 [00:02<00:22, 22.10it/s] 10%|██████████▎                                                                                           | 57/561 [00:02<00:22, 22.57it/s] 11%|██████████▉                                                                                           | 60/561 [00:02<00:21, 22.90it/s] 11%|███████████▍                                                                                          | 63/561 [00:03<00:22, 22.17it/s] 12%|████████████                                                                                          | 66/561 [00:03<00:22, 22.17it/s] 12%|████████████▌                                                                                         | 69/561 [00:03<00:23, 21.38it/s] 13%|█████████████                                                                                         | 72/561 [00:03<00:22, 21.35it/s] 13%|█████████████▋                                                                                        | 75/561 [00:03<00:22, 21.43it/s] 14%|██████████████▏                                                                                       | 78/561 [00:03<00:22, 21.25it/s] 14%|██████████████▋                                                                                       | 81/561 [00:03<00:23, 20.50it/s] 15%|███████████████▎                                                                                      | 84/561 [00:04<00:23, 20.66it/s] 16%|███████████████▊                                                                                      | 87/561 [00:04<00:22, 20.90it/s][2025-03-28 01:32:19,250] [INFO] [logging.py:128:log_dist] [Rank 0] step=650, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:32:19,251] [INFO] [timer.py:264:stop] epoch=0/micro_step=650/global_step=650, RunningAvgSamplesPerSec=20.420652110506744, CurrSamplesPerSec=19.345421777987127, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 16%|████████████████▎                                                                                     | 90/561 [00:04<00:22, 20.84it/s] 17%|████████████████▉                                                                                     | 93/561 [00:04<00:21, 21.61it/s] 17%|█████████████████▍                                                                                    | 96/561 [00:04<00:20, 22.26it/s] 18%|██████████████████                                                                                    | 99/561 [00:04<00:20, 22.22it/s] 18%|██████████████████▎                                                                                  | 102/561 [00:04<00:20, 22.20it/s] 19%|██████████████████▉                                                                                  | 105/561 [00:05<00:20, 21.88it/s] 19%|███████████████████▍                                                                                 | 108/561 [00:05<00:20, 21.90it/s] 20%|███████████████████▉                                                                                 | 111/561 [00:05<00:21, 21.41it/s] 20%|████████████████████▌                                                                                | 114/561 [00:06<00:50,  8.78it/s] 21%|████████████████████▉                                                                                | 116/561 [00:07<01:30,  4.93it/s] 21%|█████████████████████▏                                                                               | 118/561 [00:07<01:15,  5.88it/s] 22%|█████████████████████▊                                                                               | 121/561 [00:07<00:55,  7.91it/s] 22%|██████████████████████▎                                                                              | 124/561 [00:07<00:43, 10.12it/s] 23%|██████████████████████▊                                                                              | 127/561 [00:07<00:35, 12.35it/s] 23%|███████████████████████▍                                                                             | 130/561 [00:07<00:30, 14.33it/s] 24%|███████████████████████▉                                                                             | 133/561 [00:07<00:26, 16.04it/s] 24%|████████████████████████▍                                                                            | 136/561 [00:08<00:24, 17.53it/s][2025-03-28 01:32:23,142] [INFO] [logging.py:128:log_dist] [Rank 0] step=700, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:32:23,143] [INFO] [timer.py:264:stop] epoch=0/micro_step=700/global_step=700, RunningAvgSamplesPerSec=19.59692290154559, CurrSamplesPerSec=21.793891315592596, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 25%|█████████████████████████                                                                            | 139/561 [00:08<00:22, 18.59it/s] 25%|█████████████████████████▌                                                                           | 142/561 [00:08<00:21, 19.60it/s] 26%|██████████████████████████                                                                           | 145/561 [00:08<00:21, 19.62it/s] 26%|██████████████████████████▋                                                                          | 148/561 [00:08<00:20, 20.02it/s] 27%|███████████████████████████▏                                                                         | 151/561 [00:08<00:20, 19.73it/s] 27%|███████████████████████████▋                                                                         | 154/561 [00:08<00:20, 20.24it/s] 28%|████████████████████████████▎                                                                        | 157/561 [00:09<00:19, 20.79it/s] 29%|████████████████████████████▊                                                                        | 160/561 [00:09<00:18, 21.25it/s] 29%|█████████████████████████████▎                                                                       | 163/561 [00:09<00:18, 21.52it/s] 30%|█████████████████████████████▉                                                                       | 166/561 [00:09<00:18, 21.75it/s] 30%|██████████████████████████████▍                                                                      | 169/561 [00:09<00:18, 21.03it/s] 31%|██████████████████████████████▉                                                                      | 172/561 [00:09<00:18, 21.26it/s] 31%|███████████████████████████████▌                                                                     | 175/561 [00:09<00:18, 20.96it/s] 32%|████████████████████████████████                                                                     | 178/561 [00:10<00:18, 20.80it/s] 32%|████████████████████████████████▌                                                                    | 181/561 [00:10<00:18, 21.10it/s] 33%|█████████████████████████████████▏                                                                   | 184/561 [00:10<00:17, 21.34it/s] 33%|█████████████████████████████████▋                                                                   | 187/561 [00:10<00:17, 21.58it/s][2025-03-28 01:32:25,487] [INFO] [logging.py:128:log_dist] [Rank 0] step=750, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:32:25,487] [INFO] [timer.py:264:stop] epoch=0/micro_step=750/global_step=750, RunningAvgSamplesPerSec=19.707240454636867, CurrSamplesPerSec=24.26835204861496, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 34%|██████████████████████████████████▏                                                                  | 190/561 [00:10<00:16, 22.26it/s] 34%|██████████████████████████████████▋                                                                  | 193/561 [00:10<00:17, 21.60it/s] 35%|███████████████████████████████████▎                                                                 | 196/561 [00:10<00:17, 21.35it/s] 35%|███████████████████████████████████▊                                                                 | 199/561 [00:11<00:16, 21.50it/s] 36%|████████████████████████████████████▎                                                                | 202/561 [00:11<00:16, 21.61it/s] 37%|████████████████████████████████████▉                                                                | 205/561 [00:11<00:16, 22.19it/s] 37%|█████████████████████████████████████▍                                                               | 208/561 [00:11<00:15, 22.17it/s] 38%|█████████████████████████████████████▉                                                               | 211/561 [00:11<00:15, 22.20it/s] 38%|██████████████████████████████████████▌                                                              | 214/561 [00:11<00:15, 22.18it/s] 39%|███████████████████████████████████████                                                              | 217/561 [00:11<00:15, 21.90it/s] 39%|███████████████████████████████████████▌                                                             | 220/561 [00:11<00:15, 21.97it/s] 40%|████████████████████████████████████████▏                                                            | 223/561 [00:12<00:15, 22.37it/s] 40%|████████████████████████████████████████▋                                                            | 226/561 [00:12<00:15, 21.44it/s] 41%|█████████████████████████████████████████▏                                                           | 229/561 [00:12<00:15, 21.75it/s] 41%|█████████████████████████████████████████▊                                                           | 232/561 [00:12<00:15, 21.18it/s] 42%|██████████████████████████████████████████▎                                                          | 235/561 [00:12<00:15, 21.24it/s] 42%|██████████████████████████████████████████▊                                                          | 238/561 [00:12<00:14, 21.83it/s][2025-03-28 01:32:27,780] [INFO] [logging.py:128:log_dist] [Rank 0] step=800, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:32:27,780] [INFO] [timer.py:264:stop] epoch=0/micro_step=800/global_step=800, RunningAvgSamplesPerSec=19.829663727388102, CurrSamplesPerSec=24.282964242342878, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 43%|███████████████████████████████████████████▍                                                         | 241/561 [00:12<00:14, 22.55it/s] 43%|███████████████████████████████████████████▉                                                         | 244/561 [00:13<00:14, 21.31it/s] 44%|████████████████████████████████████████████▍                                                        | 247/561 [00:13<00:14, 21.36it/s] 45%|█████████████████████████████████████████████                                                        | 250/561 [00:13<00:14, 20.92it/s] 45%|█████████████████████████████████████████████▌                                                       | 253/561 [00:13<00:14, 21.10it/s] 46%|██████████████████████████████████████████████                                                       | 256/561 [00:13<00:14, 21.33it/s] 46%|██████████████████████████████████████████████▋                                                      | 259/561 [00:13<00:14, 21.51it/s] 47%|███████████████████████████████████████████████▏                                                     | 262/561 [00:13<00:13, 22.14it/s] 47%|███████████████████████████████████████████████▋                                                     | 265/561 [00:14<00:13, 22.71it/s] 48%|████████████████████████████████████████████████▏                                                    | 268/561 [00:14<00:12, 22.99it/s] 48%|████████████████████████████████████████████████▊                                                    | 271/561 [00:14<00:12, 23.09it/s] 49%|█████████████████████████████████████████████████▎                                                   | 274/561 [00:14<00:12, 22.43it/s] 49%|█████████████████████████████████████████████████▊                                                   | 277/561 [00:14<00:12, 22.46it/s] 50%|██████████████████████████████████████████████████▍                                                  | 280/561 [00:14<00:12, 22.71it/s] 50%|██████████████████████████████████████████████████▉                                                  | 283/561 [00:14<00:12, 22.36it/s] 51%|███████████████████████████████████████████████████▍                                                 | 286/561 [00:14<00:12, 22.37it/s][2025-03-28 01:32:30,041] [INFO] [logging.py:128:log_dist] [Rank 0] step=850, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:32:30,041] [INFO] [timer.py:264:stop] epoch=0/micro_step=850/global_step=850, RunningAvgSamplesPerSec=19.95390283909568, CurrSamplesPerSec=22.427850695828088, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 52%|████████████████████████████████████████████████████                                                 | 289/561 [00:15<00:12, 22.34it/s] 52%|████████████████████████████████████████████████████▌                                                | 292/561 [00:15<00:11, 22.48it/s] 53%|█████████████████████████████████████████████████████                                                | 295/561 [00:15<00:11, 22.81it/s] 53%|█████████████████████████████████████████████████████▋                                               | 298/561 [00:15<00:11, 23.23it/s] 54%|██████████████████████████████████████████████████████▏                                              | 301/561 [00:15<00:11, 23.21it/s] 54%|██████████████████████████████████████████████████████▋                                              | 304/561 [00:15<00:11, 23.22it/s] 55%|███████████████████████████████████████████████████████▎                                             | 307/561 [00:15<00:11, 22.88it/s] 55%|███████████████████████████████████████████████████████▊                                             | 310/561 [00:16<00:11, 22.42it/s] 56%|████████████████████████████████████████████████████████▎                                            | 313/561 [00:16<00:11, 22.34it/s] 56%|████████████████████████████████████████████████████████▉                                            | 316/561 [00:16<00:11, 21.85it/s] 57%|█████████████████████████████████████████████████████████▍                                           | 319/561 [00:16<00:11, 21.76it/s] 57%|█████████████████████████████████████████████████████████▉                                           | 322/561 [00:16<00:11, 21.65it/s] 58%|██████████████████████████████████████████████████████████▌                                          | 325/561 [00:16<00:10, 21.47it/s] 58%|███████████████████████████████████████████████████████████                                          | 328/561 [00:16<00:10, 21.44it/s] 59%|███████████████████████████████████████████████████████████▌                                         | 331/561 [00:17<00:10, 21.69it/s] 60%|████████████████████████████████████████████████████████████▏                                        | 334/561 [00:17<00:10, 21.68it/s] 60%|████████████████████████████████████████████████████████████▋                                        | 337/561 [00:17<00:10, 21.74it/s][2025-03-28 01:32:32,295] [INFO] [logging.py:128:log_dist] [Rank 0] step=900, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:32:32,296] [INFO] [timer.py:264:stop] epoch=0/micro_step=900/global_step=900, RunningAvgSamplesPerSec=20.068734140461803, CurrSamplesPerSec=22.5825361925941, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 61%|█████████████████████████████████████████████████████████████▏                                       | 340/561 [00:17<00:09, 22.11it/s] 61%|█████████████████████████████████████████████████████████████▊                                       | 343/561 [00:17<00:09, 21.81it/s] 62%|██████████████████████████████████████████████████████████████▎                                      | 346/561 [00:17<00:09, 21.77it/s] 62%|██████████████████████████████████████████████████████████████▊                                      | 349/561 [00:17<00:09, 22.30it/s] 63%|███████████████████████████████████████████████████████████████▎                                     | 352/561 [00:17<00:09, 22.44it/s] 63%|███████████████████████████████████████████████████████████████▉                                     | 355/561 [00:18<00:09, 22.20it/s] 64%|████████████████████████████████████████████████████████████████▍                                    | 358/561 [00:18<00:09, 22.11it/s] 64%|████████████████████████████████████████████████████████████████▉                                    | 361/561 [00:18<00:09, 22.09it/s] 65%|█████████████████████████████████████████████████████████████████▌                                   | 364/561 [00:18<00:08, 22.10it/s] 65%|██████████████████████████████████████████████████████████████████                                   | 367/561 [00:18<00:08, 22.02it/s] 66%|██████████████████████████████████████████████████████████████████▌                                  | 370/561 [00:18<00:08, 21.89it/s] 66%|███████████████████████████████████████████████████████████████████▏                                 | 373/561 [00:18<00:08, 21.91it/s] 67%|███████████████████████████████████████████████████████████████████▋                                 | 376/561 [00:19<00:08, 21.62it/s] 68%|████████████████████████████████████████████████████████████████████▏                                | 379/561 [00:19<00:08, 21.80it/s] 68%|████████████████████████████████████████████████████████████████████▊                                | 382/561 [00:19<00:08, 21.82it/s] 69%|█████████████████████████████████████████████████████████████████████▎                               | 385/561 [00:19<00:08, 21.78it/s] 69%|█████████████████████████████████████████████████████████████████████▊                               | 388/561 [00:19<00:07, 22.15it/s][2025-03-28 01:32:34,570] [INFO] [logging.py:128:log_dist] [Rank 0] step=950, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:32:34,571] [INFO] [timer.py:264:stop] epoch=0/micro_step=950/global_step=950, RunningAvgSamplesPerSec=20.163682991603583, CurrSamplesPerSec=21.11083097483943, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 70%|██████████████████████████████████████████████████████████████████████▍                              | 391/561 [00:19<00:07, 22.13it/s] 70%|██████████████████████████████████████████████████████████████████████▉                              | 394/561 [00:19<00:07, 22.31it/s] 71%|███████████████████████████████████████████████████████████████████████▍                             | 397/561 [00:19<00:07, 22.07it/s] 71%|████████████████████████████████████████████████████████████████████████                             | 400/561 [00:20<00:07, 22.14it/s] 72%|████████████████████████████████████████████████████████████████████████▌                            | 403/561 [00:20<00:07, 21.85it/s] 72%|█████████████████████████████████████████████████████████████████████████                            | 406/561 [00:20<00:07, 21.90it/s] 73%|█████████████████████████████████████████████████████████████████████████▋                           | 409/561 [00:20<00:06, 22.06it/s] 73%|██████████████████████████████████████████████████████████████████████████▏                          | 412/561 [00:20<00:06, 22.10it/s] 74%|██████████████████████████████████████████████████████████████████████████▋                          | 415/561 [00:20<00:06, 21.96it/s] 75%|███████████████████████████████████████████████████████████████████████████▎                         | 418/561 [00:20<00:06, 21.93it/s] 75%|███████████████████████████████████████████████████████████████████████████▊                         | 421/561 [00:21<00:06, 22.11it/s] 76%|████████████████████████████████████████████████████████████████████████████▎                        | 424/561 [00:21<00:06, 22.36it/s] 76%|████████████████████████████████████████████████████████████████████████████▉                        | 427/561 [00:21<00:06, 22.15it/s] 77%|█████████████████████████████████████████████████████████████████████████████▍                       | 430/561 [00:21<00:05, 22.08it/s] 77%|█████████████████████████████████████████████████████████████████████████████▉                       | 433/561 [00:21<00:05, 22.02it/s] 78%|██████████████████████████████████████████████████████████████████████████████▍                      | 436/561 [00:21<00:05, 22.08it/s][2025-03-28 01:32:36,826] [INFO] [logging.py:128:log_dist] [Rank 0] step=1000, skipped=2, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:32:36,827] [INFO] [timer.py:264:stop] epoch=0/micro_step=1000/global_step=1000, RunningAvgSamplesPerSec=20.257855442267683, CurrSamplesPerSec=23.836528369736428, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 78%|███████████████████████████████████████████████████████████████████████████████                      | 439/561 [00:21<00:05, 22.44it/s][2025-03-28 01:32:36,962] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
 79%|███████████████████████████████████████████████████████████████████████████████▌                     | 442/561 [00:22<00:05, 22.37it/s][2025-03-28 01:32:37,006] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
 79%|████████████████████████████████████████████████████████████████████████████████                     | 445/561 [00:22<00:05, 21.73it/s] 80%|████████████████████████████████████████████████████████████████████████████████▋                    | 448/561 [00:22<00:05, 21.70it/s] 80%|█████████████████████████████████████████████████████████████████████████████████▏                   | 451/561 [00:22<00:05, 21.86it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▋                   | 454/561 [00:22<00:04, 21.60it/s] 81%|██████████████████████████████████████████████████████████████████████████████████▎                  | 457/561 [00:22<00:04, 22.11it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▊                  | 460/561 [00:22<00:04, 22.21it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▎                 | 463/561 [00:23<00:04, 21.55it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▉                 | 466/561 [00:23<00:04, 21.26it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▍                | 469/561 [00:23<00:04, 21.24it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▉                | 472/561 [00:23<00:04, 21.50it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▌               | 475/561 [00:23<00:03, 21.67it/s] 85%|██████████████████████████████████████████████████████████████████████████████████████               | 478/561 [00:23<00:03, 21.87it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▌              | 481/561 [00:23<00:03, 21.96it/s] 86%|███████████████████████████████████████████████████████████████████████████████████████▏             | 484/561 [00:23<00:03, 21.87it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▋             | 487/561 [00:24<00:03, 21.80it/s][2025-03-28 01:32:39,133] [INFO] [logging.py:128:log_dist] [Rank 0] step=1050, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:32:39,133] [INFO] [timer.py:264:stop] epoch=0/micro_step=1050/global_step=1050, RunningAvgSamplesPerSec=20.32384859143338, CurrSamplesPerSec=21.357862991933015, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 87%|████████████████████████████████████████████████████████████████████████████████████████▏            | 490/561 [00:24<00:03, 21.83it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▊            | 493/561 [00:24<00:03, 21.89it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████████▎           | 496/561 [00:24<00:02, 21.98it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▊           | 499/561 [00:24<00:02, 21.91it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████▍          | 502/561 [00:24<00:02, 20.88it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▉          | 505/561 [00:24<00:02, 21.13it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▍         | 508/561 [00:25<00:02, 21.32it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▉         | 511/561 [00:25<00:02, 21.91it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████████▌        | 514/561 [00:25<00:02, 22.49it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████        | 517/561 [00:25<00:01, 22.85it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▌       | 520/561 [00:25<00:01, 23.19it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████████▏      | 523/561 [00:25<00:01, 22.78it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▋      | 526/561 [00:25<00:01, 22.46it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▏     | 529/561 [00:26<00:01, 22.32it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▊     | 532/561 [00:26<00:01, 22.11it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████████▎    | 535/561 [00:26<00:01, 21.61it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▊    | 538/561 [00:26<00:01, 21.71it/s][2025-03-28 01:32:41,405] [INFO] [logging.py:128:log_dist] [Rank 0] step=1100, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:32:41,406] [INFO] [timer.py:264:stop] epoch=0/micro_step=1100/global_step=1100, RunningAvgSamplesPerSec=20.39714747313864, CurrSamplesPerSec=22.493039826634647, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 96%|█████████████████████████████████████████████████████████████████████████████████████████████████▍   | 541/561 [00:26<00:00, 21.87it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████████▉   | 544/561 [00:26<00:00, 21.71it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▍  | 547/561 [00:26<00:00, 21.75it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████████  | 550/561 [00:26<00:00, 21.86it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▌ | 553/561 [00:27<00:00, 21.99it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████ | 556/561 [00:27<00:00, 21.93it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████████▋| 559/561 [00:27<00:00, 21.29it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:27<00:00, 20.36it/s]
  0%|                                                                                                               | 0/561 [00:00<?, ?it/s]  0%|▏                                                                                                      | 1/561 [00:00<03:58,  2.34it/s]  1%|▋                                                                                                      | 4/561 [00:00<01:05,  8.52it/s]  1%|█▎                                                                                                     | 7/561 [00:00<00:45, 12.31it/s]  2%|█▋                                                                                                     | 9/561 [00:00<00:39, 14.12it/s]  2%|██▏                                                                                                   | 12/561 [00:00<00:33, 16.27it/s]  3%|██▋                                                                                                   | 15/561 [00:01<00:30, 17.92it/s]  3%|███▎                                                                                                  | 18/561 [00:01<00:29, 18.64it/s]  4%|███▋                                                                                                  | 20/561 [00:01<00:28, 18.68it/s]  4%|████▏                                                                                                 | 23/561 [00:01<00:28, 19.13it/s]  5%|████▋                                                                                                 | 26/561 [00:01<00:27, 19.69it/s][2025-03-28 01:32:44,260] [INFO] [logging.py:128:log_dist] [Rank 0] step=1150, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:32:44,261] [INFO] [timer.py:264:stop] epoch=0/micro_step=1150/global_step=1150, RunningAvgSamplesPerSec=20.30741790424366, CurrSamplesPerSec=20.85543921926846, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
  5%|█████▎                                                                                                | 29/561 [00:01<00:27, 19.70it/s]  6%|█████▋                                                                                                | 31/561 [00:01<00:27, 19.62it/s]  6%|██████▏                                                                                               | 34/561 [00:02<00:26, 19.76it/s]  7%|██████▋                                                                                               | 37/561 [00:02<00:25, 20.22it/s]  7%|███████▎                                                                                              | 40/561 [00:02<00:26, 19.92it/s]  8%|███████▊                                                                                              | 43/561 [00:02<00:25, 19.93it/s]  8%|████████▏                                                                                             | 45/561 [00:02<00:26, 19.71it/s]  8%|████████▌                                                                                             | 47/561 [00:02<00:26, 19.37it/s]  9%|████████▉                                                                                             | 49/561 [00:02<00:26, 19.11it/s]  9%|█████████▎                                                                                            | 51/561 [00:02<00:26, 18.93it/s]  9%|█████████▋                                                                                            | 53/561 [00:03<00:27, 18.81it/s] 10%|██████████                                                                                            | 55/561 [00:03<00:27, 18.71it/s] 10%|██████████▎                                                                                           | 57/561 [00:03<00:27, 18.59it/s] 11%|██████████▋                                                                                           | 59/561 [00:03<00:27, 18.56it/s] 11%|███████████                                                                                           | 61/561 [00:03<00:27, 18.38it/s] 11%|███████████▍                                                                                          | 63/561 [00:03<00:27, 18.43it/s] 12%|███████████▊                                                                                          | 65/561 [00:03<00:26, 18.64it/s] 12%|████████████▏                                                                                         | 67/561 [00:03<00:26, 18.60it/s] 12%|████████████▌                                                                                         | 69/561 [00:03<00:26, 18.56it/s] 13%|████████████▉                                                                                         | 71/561 [00:04<00:26, 18.57it/s] 13%|█████████████▎                                                                                        | 73/561 [00:04<00:26, 18.56it/s] 13%|█████████████▋                                                                                        | 75/561 [00:04<00:26, 18.56it/s] 14%|██████████████                                                                                        | 77/561 [00:04<00:25, 18.77it/s][2025-03-28 01:32:46,892] [INFO] [logging.py:128:log_dist] [Rank 0] step=1200, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:32:46,893] [INFO] [timer.py:264:stop] epoch=0/micro_step=1200/global_step=1200, RunningAvgSamplesPerSec=20.2512614054945, CurrSamplesPerSec=20.796497271249407, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 14%|██████████████▎                                                                                       | 79/561 [00:04<00:25, 18.88it/s] 14%|██████████████▋                                                                                       | 81/561 [00:04<00:25, 19.19it/s] 15%|███████████████▎                                                                                      | 84/561 [00:04<00:23, 20.11it/s] 15%|███████████████▋                                                                                      | 86/561 [00:04<00:24, 19.56it/s] 16%|████████████████                                                                                      | 88/561 [00:04<00:24, 19.09it/s] 16%|████████████████▎                                                                                     | 90/561 [00:05<00:25, 18.76it/s] 16%|████████████████▋                                                                                     | 92/561 [00:05<00:25, 18.53it/s] 17%|█████████████████                                                                                     | 94/561 [00:05<00:25, 18.38it/s] 17%|█████████████████▍                                                                                    | 96/561 [00:05<00:25, 18.26it/s] 17%|█████████████████▊                                                                                    | 98/561 [00:05<00:25, 18.17it/s] 18%|██████████████████                                                                                   | 100/561 [00:05<00:25, 18.12it/s] 18%|██████████████████▎                                                                                  | 102/561 [00:05<00:25, 18.06it/s] 19%|██████████████████▋                                                                                  | 104/561 [00:05<00:24, 18.44it/s] 19%|███████████████████▎                                                                                 | 107/561 [00:05<00:22, 20.18it/s] 20%|███████████████████▊                                                                                 | 110/561 [00:06<00:21, 20.93it/s] 20%|████████████████████▎                                                                                | 113/561 [00:06<00:20, 21.52it/s] 21%|████████████████████▉                                                                                | 116/561 [00:06<00:20, 21.45it/s] 21%|█████████████████████▍                                                                               | 119/561 [00:06<00:21, 20.74it/s] 22%|█████████████████████▉                                                                               | 122/561 [00:06<00:20, 21.01it/s] 22%|██████████████████████▌                                                                              | 125/561 [00:06<00:20, 21.42it/s][2025-03-28 01:32:49,382] [INFO] [logging.py:128:log_dist] [Rank 0] step=1250, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:32:49,383] [INFO] [timer.py:264:stop] epoch=0/micro_step=1250/global_step=1250, RunningAvgSamplesPerSec=20.24634155123419, CurrSamplesPerSec=22.906026188049125, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 23%|███████████████████████                                                                              | 128/561 [00:06<00:19, 21.77it/s] 23%|███████████████████████▌                                                                             | 131/561 [00:07<00:19, 21.88it/s] 24%|████████████████████████                                                                             | 134/561 [00:07<00:19, 21.92it/s] 24%|████████████████████████▋                                                                            | 137/561 [00:07<00:19, 21.84it/s] 25%|█████████████████████████▏                                                                           | 140/561 [00:07<00:19, 21.62it/s] 25%|█████████████████████████▋                                                                           | 143/561 [00:07<00:20, 20.37it/s] 26%|██████████████████████████▎                                                                          | 146/561 [00:07<00:19, 21.07it/s] 27%|██████████████████████████▊                                                                          | 149/561 [00:07<00:19, 21.40it/s] 27%|███████████████████████████▎                                                                         | 152/561 [00:07<00:18, 21.54it/s] 28%|███████████████████████████▉                                                                         | 155/561 [00:08<00:18, 21.69it/s] 28%|████████████████████████████▍                                                                        | 158/561 [00:08<00:19, 20.84it/s] 29%|████████████████████████████▉                                                                        | 161/561 [00:08<00:19, 20.58it/s] 29%|█████████████████████████████▌                                                                       | 164/561 [00:08<00:19, 20.75it/s] 30%|██████████████████████████████                                                                       | 167/561 [00:08<00:18, 21.00it/s] 30%|██████████████████████████████▌                                                                      | 170/561 [00:08<00:18, 21.32it/s] 31%|███████████████████████████████▏                                                                     | 173/561 [00:08<00:17, 21.62it/s] 31%|███████████████████████████████▋                                                                     | 176/561 [00:09<00:17, 21.84it/s][2025-03-28 01:32:51,750] [INFO] [logging.py:128:log_dist] [Rank 0] step=1300, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:32:51,751] [INFO] [timer.py:264:stop] epoch=0/micro_step=1300/global_step=1300, RunningAvgSamplesPerSec=20.28035102823047, CurrSamplesPerSec=18.885673448203676, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 32%|████████████████████████████████▏                                                                    | 179/561 [00:09<00:18, 20.49it/s] 32%|████████████████████████████████▊                                                                    | 182/561 [00:09<00:18, 20.84it/s] 33%|█████████████████████████████████▎                                                                   | 185/561 [00:09<00:17, 21.44it/s] 34%|█████████████████████████████████▊                                                                   | 188/561 [00:09<00:17, 21.65it/s] 34%|██████████████████████████████████▍                                                                  | 191/561 [00:09<00:16, 22.20it/s] 35%|██████████████████████████████████▉                                                                  | 194/561 [00:09<00:16, 21.70it/s] 35%|███████████████████████████████████▍                                                                 | 197/561 [00:10<00:16, 21.80it/s] 36%|████████████████████████████████████                                                                 | 200/561 [00:10<00:16, 21.82it/s] 36%|████████████████████████████████████▌                                                                | 203/561 [00:10<00:16, 21.77it/s] 37%|█████████████████████████████████████                                                                | 206/561 [00:10<00:16, 21.76it/s] 37%|█████████████████████████████████████▋                                                               | 209/561 [00:10<00:16, 21.65it/s] 38%|██████████████████████████████████████▏                                                              | 212/561 [00:10<00:15, 22.07it/s] 38%|██████████████████████████████████████▋                                                              | 215/561 [00:10<00:15, 21.97it/s] 39%|███████████████████████████████████████▏                                                             | 218/561 [00:11<00:15, 22.07it/s] 39%|███████████████████████████████████████▊                                                             | 221/561 [00:11<00:15, 21.32it/s] 40%|████████████████████████████████████████▎                                                            | 224/561 [00:11<00:16, 20.67it/s] 40%|████████████████████████████████████████▊                                                            | 227/561 [00:11<00:15, 21.13it/s][2025-03-28 01:32:54,050] [INFO] [logging.py:128:log_dist] [Rank 0] step=1350, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:32:54,052] [INFO] [timer.py:264:stop] epoch=0/micro_step=1350/global_step=1350, RunningAvgSamplesPerSec=20.33223486681285, CurrSamplesPerSec=24.987037602503563, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 41%|█████████████████████████████████████████▍                                                           | 230/561 [00:11<00:15, 21.63it/s] 42%|█████████████████████████████████████████▉                                                           | 233/561 [00:11<00:15, 21.39it/s] 42%|██████████████████████████████████████████▍                                                          | 236/561 [00:11<00:15, 21.52it/s] 43%|███████████████████████████████████████████                                                          | 239/561 [00:12<00:14, 21.54it/s] 43%|███████████████████████████████████████████▌                                                         | 242/561 [00:12<00:14, 22.04it/s] 44%|████████████████████████████████████████████                                                         | 245/561 [00:12<00:14, 21.52it/s] 44%|████████████████████████████████████████████▋                                                        | 248/561 [00:12<00:14, 21.34it/s] 45%|█████████████████████████████████████████████▏                                                       | 251/561 [00:12<00:14, 21.31it/s] 45%|█████████████████████████████████████████████▋                                                       | 254/561 [00:12<00:14, 21.15it/s] 46%|██████████████████████████████████████████████▎                                                      | 257/561 [00:12<00:14, 21.22it/s] 46%|██████████████████████████████████████████████▊                                                      | 260/561 [00:13<00:14, 21.13it/s] 47%|███████████████████████████████████████████████▎                                                     | 263/561 [00:13<00:14, 20.94it/s] 47%|███████████████████████████████████████████████▉                                                     | 266/561 [00:13<00:14, 20.74it/s] 48%|████████████████████████████████████████████████▍                                                    | 269/561 [00:13<00:13, 20.88it/s] 48%|████████████████████████████████████████████████▉                                                    | 272/561 [00:13<00:13, 20.83it/s] 49%|█████████████████████████████████████████████████▌                                                   | 275/561 [00:13<00:13, 20.59it/s][2025-03-28 01:32:56,428] [INFO] [logging.py:128:log_dist] [Rank 0] step=1400, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:32:56,431] [INFO] [timer.py:264:stop] epoch=0/micro_step=1400/global_step=1400, RunningAvgSamplesPerSec=20.35764073166724, CurrSamplesPerSec=20.151050405587995, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 50%|██████████████████████████████████████████████████                                                   | 278/561 [00:13<00:13, 20.44it/s] 50%|██████████████████████████████████████████████████▌                                                  | 281/561 [00:14<00:13, 20.23it/s] 51%|███████████████████████████████████████████████████▏                                                 | 284/561 [00:14<00:13, 20.06it/s] 51%|███████████████████████████████████████████████████▋                                                 | 287/561 [00:14<00:13, 20.03it/s] 52%|████████████████████████████████████████████████████▏                                                | 290/561 [00:14<00:13, 19.80it/s] 52%|████████████████████████████████████████████████████▊                                                | 293/561 [00:14<00:13, 19.95it/s] 53%|█████████████████████████████████████████████████████▎                                               | 296/561 [00:14<00:13, 20.10it/s] 53%|█████████████████████████████████████████████████████▊                                               | 299/561 [00:14<00:13, 19.78it/s] 54%|██████████████████████████████████████████████████████▏                                              | 301/561 [00:15<00:13, 19.63it/s] 54%|██████████████████████████████████████████████████████▋                                              | 304/561 [00:15<00:12, 19.78it/s] 55%|███████████████████████████████████████████████████████                                              | 306/561 [00:15<00:12, 19.69it/s] 55%|███████████████████████████████████████████████████████▍                                             | 308/561 [00:15<00:12, 19.51it/s] 55%|███████████████████████████████████████████████████████▊                                             | 310/561 [00:15<00:13, 19.15it/s] 56%|████████████████████████████████████████████████████████▏                                            | 312/561 [00:15<00:12, 19.34it/s] 56%|████████████████████████████████████████████████████████▌                                            | 314/561 [00:15<00:13, 18.39it/s] 56%|████████████████████████████████████████████████████████▉                                            | 316/561 [00:15<00:14, 17.29it/s] 57%|█████████████████████████████████████████████████████████▎                                           | 318/561 [00:16<00:13, 17.89it/s] 57%|█████████████████████████████████████████████████████████▌                                           | 320/561 [00:16<00:13, 18.07it/s] 57%|█████████████████████████████████████████████████████████▉                                           | 322/561 [00:16<00:13, 18.29it/s] 58%|██████████████████████████████████████████████████████████▎                                          | 324/561 [00:16<00:12, 18.48it/s] 58%|██████████████████████████████████████████████████████████▋                                          | 326/561 [00:16<00:12, 18.68it/s][2025-03-28 01:32:59,046] [INFO] [logging.py:128:log_dist] [Rank 0] step=1450, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:32:59,050] [INFO] [timer.py:264:stop] epoch=0/micro_step=1450/global_step=1450, RunningAvgSamplesPerSec=20.31290077586935, CurrSamplesPerSec=18.50350458228946, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 58%|███████████████████████████████████████████████████████████                                          | 328/561 [00:16<00:12, 18.92it/s] 59%|███████████████████████████████████████████████████████████▌                                         | 331/561 [00:16<00:11, 19.29it/s] 59%|███████████████████████████████████████████████████████████▉                                         | 333/561 [00:16<00:11, 19.19it/s] 60%|████████████████████████████████████████████████████████████▎                                        | 335/561 [00:16<00:11, 19.11it/s] 60%|████████████████████████████████████████████████████████████▋                                        | 337/561 [00:17<00:11, 19.12it/s] 60%|█████████████████████████████████████████████████████████████                                        | 339/561 [00:17<00:11, 19.03it/s] 61%|█████████████████████████████████████████████████████████████▌                                       | 342/561 [00:17<00:11, 19.51it/s] 61%|█████████████████████████████████████████████████████████████▉                                       | 344/561 [00:17<00:11, 19.57it/s] 62%|██████████████████████████████████████████████████████████████▎                                      | 346/561 [00:17<00:11, 19.37it/s] 62%|██████████████████████████████████████████████████████████████▋                                      | 348/561 [00:17<00:11, 19.16it/s] 62%|███████████████████████████████████████████████████████████████                                      | 350/561 [00:17<00:11, 19.02it/s] 63%|███████████████████████████████████████████████████████████████▎                                     | 352/561 [00:17<00:11, 18.99it/s] 63%|███████████████████████████████████████████████████████████████▋                                     | 354/561 [00:17<00:10, 19.23it/s] 63%|████████████████████████████████████████████████████████████████                                     | 356/561 [00:17<00:10, 19.12it/s] 64%|████████████████████████████████████████████████████████████████▍                                    | 358/561 [00:18<00:10, 19.06it/s] 64%|████████████████████████████████████████████████████████████████▊                                    | 360/561 [00:18<00:10, 18.97it/s] 65%|█████████████████████████████████████████████████████████████████▏                                   | 362/561 [00:18<00:10, 18.91it/s] 65%|█████████████████████████████████████████████████████████████████▌                                   | 364/561 [00:18<00:10, 18.93it/s] 65%|█████████████████████████████████████████████████████████████████▉                                   | 366/561 [00:18<00:10, 18.89it/s] 66%|██████████████████████████████████████████████████████████████████▎                                  | 368/561 [00:18<00:10, 18.80it/s] 66%|██████████████████████████████████████████████████████████████████▌                                  | 370/561 [00:18<00:10, 18.89it/s] 66%|██████████████████████████████████████████████████████████████████▉                                  | 372/561 [00:18<00:10, 18.76it/s] 67%|███████████████████████████████████████████████████████████████████▎                                 | 374/561 [00:18<00:10, 18.67it/s] 67%|███████████████████████████████████████████████████████████████████▋                                 | 376/561 [00:19<00:09, 19.01it/s][2025-03-28 01:33:01,670] [INFO] [logging.py:128:log_dist] [Rank 0] step=1500, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:33:01,673] [INFO] [timer.py:264:stop] epoch=0/micro_step=1500/global_step=1500, RunningAvgSamplesPerSec=20.26998900880265, CurrSamplesPerSec=18.585331263108475, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 67%|████████████████████████████████████████████████████████████████████                                 | 378/561 [00:19<00:09, 18.82it/s] 68%|████████████████████████████████████████████████████████████████████▌                                | 381/561 [00:19<00:09, 19.31it/s] 68%|████████████████████████████████████████████████████████████████████▉                                | 383/561 [00:19<00:09, 19.00it/s] 69%|█████████████████████████████████████████████████████████████████████▎                               | 385/561 [00:19<00:09, 18.72it/s] 69%|█████████████████████████████████████████████████████████████████████▋                               | 387/561 [00:19<00:09, 18.84it/s] 69%|██████████████████████████████████████████████████████████████████████                               | 389/561 [00:19<00:09, 19.02it/s] 70%|██████████████████████████████████████████████████████████████████████▍                              | 391/561 [00:19<00:09, 18.80it/s] 70%|██████████████████████████████████████████████████████████████████████▊                              | 393/561 [00:19<00:08, 18.92it/s] 70%|███████████████████████████████████████████████████████████████████████                              | 395/561 [00:20<00:08, 19.16it/s] 71%|███████████████████████████████████████████████████████████████████████▍                             | 397/561 [00:20<00:08, 18.86it/s] 71%|███████████████████████████████████████████████████████████████████████▊                             | 399/561 [00:20<00:08, 18.93it/s] 71%|████████████████████████████████████████████████████████████████████████▏                            | 401/561 [00:20<00:08, 18.99it/s] 72%|████████████████████████████████████████████████████████████████████████▌                            | 403/561 [00:20<00:08, 19.27it/s] 72%|████████████████████████████████████████████████████████████████████████▉                            | 405/561 [00:20<00:08, 19.42it/s] 73%|█████████████████████████████████████████████████████████████████████████▎                           | 407/561 [00:20<00:08, 19.10it/s] 73%|█████████████████████████████████████████████████████████████████████████▋                           | 409/561 [00:20<00:08, 18.87it/s] 73%|█████████████████████████████████████████████████████████████████████████▉                           | 411/561 [00:20<00:08, 18.69it/s] 74%|██████████████████████████████████████████████████████████████████████████▎                          | 413/561 [00:21<00:07, 18.58it/s] 74%|██████████████████████████████████████████████████████████████████████████▋                          | 415/561 [00:21<00:07, 18.74it/s] 74%|███████████████████████████████████████████████████████████████████████████                          | 417/561 [00:21<00:07, 18.82it/s] 75%|███████████████████████████████████████████████████████████████████████████▍                         | 419/561 [00:21<00:07, 19.04it/s] 75%|███████████████████████████████████████████████████████████████████████████▊                         | 421/561 [00:21<00:07, 19.16it/s] 75%|████████████████████████████████████████████████████████████████████████████▏                        | 423/561 [00:21<00:07, 19.10it/s] 76%|████████████████████████████████████████████████████████████████████████████▌                        | 425/561 [00:21<00:07, 19.00it/s] 76%|████████████████████████████████████████████████████████████████████████████▉                        | 427/561 [00:21<00:07, 18.91it/s][2025-03-28 01:33:04,307] [INFO] [logging.py:128:log_dist] [Rank 0] step=1550, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:33:04,311] [INFO] [timer.py:264:stop] epoch=0/micro_step=1550/global_step=1550, RunningAvgSamplesPerSec=20.22655084904125, CurrSamplesPerSec=18.3607824986496, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 76%|█████████████████████████████████████████████████████████████████████████████▏                       | 429/561 [00:21<00:07, 18.83it/s] 77%|█████████████████████████████████████████████████████████████████████████████▌                       | 431/561 [00:21<00:06, 18.89it/s] 77%|█████████████████████████████████████████████████████████████████████████████▉                       | 433/561 [00:22<00:06, 18.82it/s] 78%|██████████████████████████████████████████████████████████████████████████████▎                      | 435/561 [00:22<00:06, 18.74it/s] 78%|██████████████████████████████████████████████████████████████████████████████▋                      | 437/561 [00:22<00:06, 18.68it/s] 78%|███████████████████████████████████████████████████████████████████████████████                      | 439/561 [00:22<00:06, 18.60it/s] 79%|███████████████████████████████████████████████████████████████████████████████▍                     | 441/561 [00:22<00:06, 18.54it/s] 79%|███████████████████████████████████████████████████████████████████████████████▊                     | 443/561 [00:22<00:06, 17.48it/s] 79%|████████████████████████████████████████████████████████████████████████████████                     | 445/561 [00:22<00:06, 17.83it/s] 80%|████████████████████████████████████████████████████████████████████████████████▍                    | 447/561 [00:22<00:06, 18.09it/s] 80%|████████████████████████████████████████████████████████████████████████████████▊                    | 449/561 [00:22<00:06, 18.43it/s] 80%|█████████████████████████████████████████████████████████████████████████████████▏                   | 451/561 [00:23<00:05, 18.51it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▌                   | 453/561 [00:23<00:05, 18.40it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▉                   | 455/561 [00:23<00:05, 18.11it/s] 81%|██████████████████████████████████████████████████████████████████████████████████▎                  | 457/561 [00:23<00:05, 18.05it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▋                  | 459/561 [00:23<00:05, 18.38it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▉                  | 461/561 [00:23<00:05, 18.61it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▎                 | 463/561 [00:23<00:05, 18.69it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▋                 | 465/561 [00:23<00:05, 18.62it/s] 83%|████████████████████████████████████████████████████████████████████████████████████                 | 467/561 [00:23<00:05, 18.70it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▍                | 469/561 [00:24<00:04, 18.71it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▊                | 471/561 [00:24<00:04, 18.64it/s] 84%|█████████████████████████████████████████████████████████████████████████████████████▏               | 473/561 [00:24<00:04, 18.64it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▌               | 475/561 [00:24<00:04, 18.45it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▉               | 477/561 [00:24<00:04, 18.52it/s][2025-03-28 01:33:07,019] [INFO] [logging.py:128:log_dist] [Rank 0] step=1600, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:33:07,022] [INFO] [timer.py:264:stop] epoch=0/micro_step=1600/global_step=1600, RunningAvgSamplesPerSec=20.16717706767139, CurrSamplesPerSec=18.559015539558068, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 85%|██████████████████████████████████████████████████████████████████████████████████████▏              | 479/561 [00:24<00:04, 18.53it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▌              | 481/561 [00:24<00:04, 18.15it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▉              | 483/561 [00:24<00:04, 18.06it/s] 86%|███████████████████████████████████████████████████████████████████████████████████████▎             | 485/561 [00:24<00:04, 18.17it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▋             | 487/561 [00:25<00:04, 18.24it/s] 87%|████████████████████████████████████████████████████████████████████████████████████████             | 489/561 [00:25<00:03, 18.61it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▍            | 491/561 [00:25<00:03, 18.58it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▊            | 493/561 [00:25<00:03, 18.75it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████████            | 495/561 [00:25<00:03, 18.82it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▍           | 497/561 [00:25<00:03, 18.87it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▊           | 499/561 [00:25<00:03, 18.86it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████▏          | 501/561 [00:25<00:03, 18.87it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▌          | 503/561 [00:25<00:03, 18.79it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▉          | 505/561 [00:25<00:03, 18.57it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████████▎         | 507/561 [00:26<00:02, 18.79it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▋         | 509/561 [00:26<00:02, 18.71it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▉         | 511/561 [00:26<00:02, 18.63it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████████▎        | 513/561 [00:26<00:02, 18.52it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████████▋        | 515/561 [00:26<00:02, 18.58it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████        | 517/561 [00:26<00:02, 18.87it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▍       | 519/561 [00:26<00:02, 18.67it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▊       | 521/561 [00:26<00:02, 18.28it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████████▏      | 523/561 [00:26<00:02, 17.17it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▌      | 525/561 [00:27<00:02, 16.56it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▉      | 527/561 [00:27<00:01, 17.25it/s][2025-03-28 01:33:09,761] [INFO] [logging.py:128:log_dist] [Rank 0] step=1650, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:33:09,762] [INFO] [timer.py:264:stop] epoch=0/micro_step=1650/global_step=1650, RunningAvgSamplesPerSec=20.104597554076502, CurrSamplesPerSec=18.241085408977852, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 94%|███████████████████████████████████████████████████████████████████████████████████████████████▏     | 529/561 [00:27<00:01, 17.44it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▌     | 531/561 [00:27<00:01, 17.80it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▉     | 533/561 [00:27<00:01, 18.29it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████████▎    | 535/561 [00:27<00:01, 18.46it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▋    | 537/561 [00:27<00:01, 18.34it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████    | 539/561 [00:27<00:01, 18.42it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████▍   | 541/561 [00:27<00:01, 18.46it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████████▊   | 543/561 [00:28<00:00, 18.27it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████████   | 545/561 [00:28<00:00, 18.38it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▍  | 547/561 [00:28<00:00, 18.43it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▊  | 549/561 [00:28<00:00, 18.42it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████████▏ | 551/561 [00:28<00:00, 18.42it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▌ | 553/561 [00:28<00:00, 18.43it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▉ | 555/561 [00:28<00:00, 18.39it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████▎| 557/561 [00:28<00:00, 18.16it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████████▋| 559/561 [00:28<00:00, 18.18it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:29<00:00, 17.76it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:29<00:00, 19.27it/s]
  0%|                                                                                                               | 0/561 [00:00<?, ?it/s]  0%|▏                                                                                                      | 1/561 [00:00<03:55,  2.38it/s]  1%|▌                                                                                                      | 3/561 [00:00<01:24,  6.62it/s]  1%|▉                                                                                                      | 5/561 [00:00<00:57,  9.71it/s]  1%|█▎                                                                                                     | 7/561 [00:00<00:45, 12.24it/s]  2%|█▋                                                                                                     | 9/561 [00:00<00:39, 14.12it/s]  2%|██                                                                                                    | 11/561 [00:00<00:35, 15.63it/s]  2%|██▎                                                                                                   | 13/561 [00:01<00:33, 16.40it/s]  3%|██▋                                                                                                   | 15/561 [00:01<00:31, 17.11it/s][2025-03-28 01:33:12,940] [INFO] [logging.py:128:log_dist] [Rank 0] step=1700, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:33:12,942] [INFO] [timer.py:264:stop] epoch=0/micro_step=1700/global_step=1700, RunningAvgSamplesPerSec=19.9772290728309, CurrSamplesPerSec=18.47595483119135, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
  3%|███                                                                                                   | 17/561 [00:01<00:31, 17.35it/s]  3%|███▍                                                                                                  | 19/561 [00:01<00:30, 17.90it/s]  4%|███▊                                                                                                  | 21/561 [00:01<00:29, 18.13it/s]  4%|████▏                                                                                                 | 23/561 [00:01<00:29, 18.46it/s]  4%|████▌                                                                                                 | 25/561 [00:01<00:29, 17.93it/s]  5%|████▉                                                                                                 | 27/561 [00:01<00:29, 18.40it/s]  5%|█████▎                                                                                                | 29/561 [00:01<00:28, 18.54it/s]  6%|█████▋                                                                                                | 31/561 [00:02<00:28, 18.68it/s]  6%|██████                                                                                                | 33/561 [00:02<00:28, 18.69it/s]  6%|██████▎                                                                                               | 35/561 [00:02<00:29, 17.92it/s]  7%|██████▋                                                                                               | 37/561 [00:02<00:29, 17.98it/s]  7%|███████▎                                                                                              | 40/561 [00:02<00:25, 20.07it/s]  8%|███████▊                                                                                              | 43/561 [00:02<00:24, 21.10it/s]  8%|████████▎                                                                                             | 46/561 [00:02<00:25, 20.22it/s]  9%|████████▉                                                                                             | 49/561 [00:02<00:25, 19.81it/s]  9%|█████████▎                                                                                            | 51/561 [00:03<00:25, 19.78it/s]  9%|█████████▋                                                                                            | 53/561 [00:03<00:26, 19.42it/s] 10%|██████████                                                                                            | 55/561 [00:03<00:26, 19.13it/s] 10%|██████████▎                                                                                           | 57/561 [00:03<00:26, 18.90it/s] 11%|██████████▋                                                                                           | 59/561 [00:03<00:26, 18.66it/s] 11%|███████████                                                                                           | 61/561 [00:03<00:26, 18.74it/s] 11%|███████████▍                                                                                          | 63/561 [00:03<00:26, 18.59it/s] 12%|███████████▊                                                                                          | 65/561 [00:03<00:26, 18.63it/s][2025-03-28 01:33:15,564] [INFO] [logging.py:128:log_dist] [Rank 0] step=1750, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:33:15,567] [INFO] [timer.py:264:stop] epoch=0/micro_step=1750/global_step=1750, RunningAvgSamplesPerSec=19.95064063950889, CurrSamplesPerSec=18.4648115668135, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 12%|████████████▏                                                                                         | 67/561 [00:03<00:26, 18.58it/s] 12%|████████████▌                                                                                         | 69/561 [00:04<00:26, 18.46it/s] 13%|████████████▉                                                                                         | 71/561 [00:04<00:26, 18.39it/s] 13%|█████████████▍                                                                                        | 74/561 [00:04<00:25, 19.46it/s] 14%|██████████████                                                                                        | 77/561 [00:04<00:24, 20.01it/s] 14%|██████████████▎                                                                                       | 79/561 [00:04<00:24, 19.63it/s] 14%|██████████████▋                                                                                       | 81/561 [00:04<00:25, 19.14it/s] 15%|███████████████                                                                                       | 83/561 [00:04<00:25, 18.96it/s] 15%|███████████████▍                                                                                      | 85/561 [00:04<00:25, 18.51it/s] 16%|███████████████▊                                                                                      | 87/561 [00:04<00:25, 18.34it/s] 16%|████████████████▏                                                                                     | 89/561 [00:05<00:25, 18.38it/s] 16%|████████████████▌                                                                                     | 91/561 [00:05<00:25, 18.43it/s] 17%|████████████████▉                                                                                     | 93/561 [00:05<00:25, 18.25it/s] 17%|█████████████████▎                                                                                    | 95/561 [00:05<00:25, 18.29it/s] 17%|█████████████████▋                                                                                    | 97/561 [00:05<00:25, 18.11it/s] 18%|██████████████████                                                                                    | 99/561 [00:05<00:24, 18.60it/s] 18%|██████████████████▏                                                                                  | 101/561 [00:05<00:24, 18.54it/s] 18%|██████████████████▌                                                                                  | 103/561 [00:05<00:24, 18.48it/s] 19%|██████████████████▉                                                                                  | 105/561 [00:05<00:24, 18.40it/s] 19%|███████████████████▎                                                                                 | 107/561 [00:06<00:24, 18.25it/s] 19%|███████████████████▌                                                                                 | 109/561 [00:06<00:24, 18.36it/s] 20%|███████████████████▉                                                                                 | 111/561 [00:06<00:24, 18.37it/s] 20%|████████████████████▎                                                                                | 113/561 [00:06<00:24, 18.24it/s] 20%|████████████████████▋                                                                                | 115/561 [00:06<00:24, 18.07it/s][2025-03-28 01:33:18,262] [INFO] [logging.py:128:log_dist] [Rank 0] step=1800, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:33:18,264] [INFO] [timer.py:264:stop] epoch=0/micro_step=1800/global_step=1800, RunningAvgSamplesPerSec=19.909924697597514, CurrSamplesPerSec=18.086209437346, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 21%|█████████████████████                                                                                | 117/561 [00:06<00:24, 18.06it/s] 21%|█████████████████████▍                                                                               | 119/561 [00:06<00:24, 18.12it/s] 22%|█████████████████████▊                                                                               | 121/561 [00:06<00:24, 18.28it/s] 22%|██████████████████████▏                                                                              | 123/561 [00:06<00:23, 18.47it/s] 22%|██████████████████████▌                                                                              | 125/561 [00:07<00:23, 18.41it/s] 23%|██████████████████████▊                                                                              | 127/561 [00:07<00:23, 18.10it/s] 23%|███████████████████████▏                                                                             | 129/561 [00:07<00:23, 18.46it/s] 23%|███████████████████████▌                                                                             | 131/561 [00:07<00:23, 18.55it/s] 24%|███████████████████████▉                                                                             | 133/561 [00:07<00:22, 18.70it/s] 24%|████████████████████████▎                                                                            | 135/561 [00:07<00:22, 18.69it/s] 24%|████████████████████████▋                                                                            | 137/561 [00:07<00:22, 18.66it/s] 25%|█████████████████████████▏                                                                           | 140/561 [00:07<00:21, 19.55it/s] 25%|█████████████████████████▋                                                                           | 143/561 [00:07<00:20, 20.37it/s] 26%|██████████████████████████▎                                                                          | 146/561 [00:08<00:20, 20.15it/s] 27%|██████████████████████████▊                                                                          | 149/561 [00:08<00:20, 19.65it/s] 27%|███████████████████████████▏                                                                         | 151/561 [00:08<00:21, 19.41it/s] 27%|███████████████████████████▌                                                                         | 153/561 [00:08<00:21, 19.24it/s] 28%|███████████████████████████▉                                                                         | 155/561 [00:08<00:21, 19.05it/s] 28%|████████████████████████████▎                                                                        | 157/561 [00:08<00:22, 18.33it/s] 28%|████████████████████████████▋                                                                        | 159/561 [00:08<00:21, 18.32it/s] 29%|████████████████████████████▉                                                                        | 161/561 [00:08<00:21, 18.44it/s] 29%|█████████████████████████████▎                                                                       | 163/561 [00:09<00:21, 18.45it/s] 29%|█████████████████████████████▋                                                                       | 165/561 [00:09<00:21, 18.43it/s][2025-03-28 01:33:20,910] [INFO] [logging.py:128:log_dist] [Rank 0] step=1850, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:33:20,913] [INFO] [timer.py:264:stop] epoch=0/micro_step=1850/global_step=1850, RunningAvgSamplesPerSec=19.88189138277038, CurrSamplesPerSec=18.787375418420552, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 30%|██████████████████████████████                                                                       | 167/561 [00:09<00:21, 18.51it/s] 30%|██████████████████████████████▍                                                                      | 169/561 [00:09<00:21, 18.52it/s] 30%|██████████████████████████████▊                                                                      | 171/561 [00:09<00:21, 18.44it/s] 31%|███████████████████████████████▏                                                                     | 173/561 [00:09<00:20, 18.55it/s] 31%|███████████████████████████████▌                                                                     | 175/561 [00:09<00:20, 18.47it/s] 32%|███████████████████████████████▊                                                                     | 177/561 [00:09<00:20, 18.40it/s] 32%|████████████████████████████████▏                                                                    | 179/561 [00:09<00:20, 18.49it/s] 32%|████████████████████████████████▌                                                                    | 181/561 [00:10<00:21, 17.83it/s] 33%|████████████████████████████████▉                                                                    | 183/561 [00:10<00:20, 18.09it/s] 33%|█████████████████████████████████▎                                                                   | 185/561 [00:10<00:20, 18.27it/s] 33%|█████████████████████████████████▋                                                                   | 187/561 [00:10<00:20, 18.47it/s] 34%|██████████████████████████████████                                                                   | 189/561 [00:10<00:20, 18.51it/s] 34%|██████████████████████████████████▍                                                                  | 191/561 [00:10<00:19, 18.77it/s] 35%|██████████████████████████████████▉                                                                  | 194/561 [00:10<00:18, 20.30it/s] 35%|███████████████████████████████████▍                                                                 | 197/561 [00:10<00:18, 19.75it/s] 35%|███████████████████████████████████▊                                                                 | 199/561 [00:10<00:18, 19.39it/s] 36%|████████████████████████████████████▏                                                                | 201/561 [00:11<00:18, 19.01it/s] 36%|████████████████████████████████████▌                                                                | 203/561 [00:11<00:18, 18.92it/s] 37%|████████████████████████████████████▉                                                                | 205/561 [00:11<00:18, 18.76it/s] 37%|█████████████████████████████████████▎                                                               | 207/561 [00:11<00:19, 17.97it/s] 37%|█████████████████████████████████████▋                                                               | 209/561 [00:11<00:19, 18.14it/s] 38%|█████████████████████████████████████▉                                                               | 211/561 [00:11<00:19, 18.21it/s] 38%|██████████████████████████████████████▎                                                              | 213/561 [00:11<00:19, 18.29it/s] 38%|██████████████████████████████████████▋                                                              | 215/561 [00:11<00:18, 18.33it/s][2025-03-28 01:33:23,601] [INFO] [logging.py:128:log_dist] [Rank 0] step=1900, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:33:23,604] [INFO] [timer.py:264:stop] epoch=0/micro_step=1900/global_step=1900, RunningAvgSamplesPerSec=19.846641680343144, CurrSamplesPerSec=18.292078561230756, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 39%|███████████████████████████████████████                                                              | 217/561 [00:11<00:18, 18.28it/s] 39%|███████████████████████████████████████▌                                                             | 220/561 [00:12<00:17, 19.38it/s] 40%|███████████████████████████████████████▉                                                             | 222/561 [00:12<00:17, 18.99it/s] 40%|████████████████████████████████████████▎                                                            | 224/561 [00:12<00:17, 18.80it/s] 40%|████████████████████████████████████████▋                                                            | 226/561 [00:12<00:17, 18.97it/s] 41%|█████████████████████████████████████████                                                            | 228/561 [00:12<00:17, 18.90it/s] 41%|█████████████████████████████████████████▍                                                           | 230/561 [00:12<00:17, 18.88it/s] 41%|█████████████████████████████████████████▊                                                           | 232/561 [00:12<00:17, 18.65it/s] 42%|██████████████████████████████████████████▏                                                          | 234/561 [00:12<00:17, 18.27it/s] 42%|██████████████████████████████████████████▍                                                          | 236/561 [00:12<00:18, 18.02it/s] 42%|██████████████████████████████████████████▊                                                          | 238/561 [00:13<00:17, 18.13it/s] 43%|███████████████████████████████████████████▏                                                         | 240/561 [00:13<00:17, 18.06it/s] 43%|███████████████████████████████████████████▌                                                         | 242/561 [00:13<00:17, 18.15it/s] 43%|███████████████████████████████████████████▉                                                         | 244/561 [00:13<00:17, 18.57it/s] 44%|████████████████████████████████████████████▎                                                        | 246/561 [00:13<00:16, 18.73it/s] 44%|████████████████████████████████████████████▋                                                        | 248/561 [00:13<00:16, 18.43it/s] 45%|█████████████████████████████████████████████                                                        | 250/561 [00:13<00:16, 18.60it/s] 45%|█████████████████████████████████████████████▎                                                       | 252/561 [00:13<00:16, 18.32it/s] 45%|█████████████████████████████████████████████▉                                                       | 255/561 [00:13<00:16, 18.89it/s] 46%|██████████████████████████████████████████████▎                                                      | 257/561 [00:14<00:16, 18.58it/s] 46%|██████████████████████████████████████████████▋                                                      | 259/561 [00:14<00:16, 18.64it/s] 47%|██████████████████████████████████████████████▉                                                      | 261/561 [00:14<00:16, 18.38it/s] 47%|███████████████████████████████████████████████▎                                                     | 263/561 [00:14<00:15, 18.68it/s] 47%|███████████████████████████████████████████████▋                                                     | 265/561 [00:14<00:16, 18.35it/s][2025-03-28 01:33:26,290] [INFO] [logging.py:128:log_dist] [Rank 0] step=1950, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:33:26,293] [INFO] [timer.py:264:stop] epoch=0/micro_step=1950/global_step=1950, RunningAvgSamplesPerSec=19.813649483598674, CurrSamplesPerSec=19.07427837080496, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 48%|████████████████████████████████████████████████                                                     | 267/561 [00:14<00:15, 18.44it/s] 48%|████████████████████████████████████████████████▍                                                    | 269/561 [00:14<00:16, 18.22it/s] 48%|████████████████████████████████████████████████▊                                                    | 271/561 [00:14<00:15, 18.15it/s] 49%|█████████████████████████████████████████████████▏                                                   | 273/561 [00:14<00:15, 18.54it/s] 49%|█████████████████████████████████████████████████▋                                                   | 276/561 [00:15<00:14, 19.52it/s] 50%|██████████████████████████████████████████████████                                                   | 278/561 [00:15<00:14, 19.38it/s] 50%|██████████████████████████████████████████████████▍                                                  | 280/561 [00:15<00:14, 19.06it/s] 50%|██████████████████████████████████████████████████▊                                                  | 282/561 [00:15<00:14, 19.13it/s] 51%|███████████████████████████████████████████████████▏                                                 | 284/561 [00:15<00:14, 18.82it/s] 51%|███████████████████████████████████████████████████▍                                                 | 286/561 [00:15<00:14, 18.87it/s] 51%|███████████████████████████████████████████████████▊                                                 | 288/561 [00:15<00:14, 18.89it/s] 52%|████████████████████████████████████████████████████▍                                                | 291/561 [00:15<00:14, 19.03it/s] 52%|████████████████████████████████████████████████████▊                                                | 293/561 [00:16<00:13, 19.25it/s] 53%|█████████████████████████████████████████████████████▎                                               | 296/561 [00:16<00:12, 20.47it/s] 53%|█████████████████████████████████████████████████████▊                                               | 299/561 [00:16<00:12, 20.49it/s] 54%|██████████████████████████████████████████████████████▎                                              | 302/561 [00:16<00:13, 19.69it/s] 54%|██████████████████████████████████████████████████████▉                                              | 305/561 [00:16<00:12, 19.71it/s] 55%|███████████████████████████████████████████████████████▎                                             | 307/561 [00:16<00:13, 19.31it/s] 55%|███████████████████████████████████████████████████████▋                                             | 309/561 [00:16<00:13, 19.16it/s] 55%|███████████████████████████████████████████████████████▉                                             | 311/561 [00:16<00:13, 19.05it/s] 56%|████████████████████████████████████████████████████████▎                                            | 313/561 [00:17<00:13, 18.93it/s] 56%|████████████████████████████████████████████████████████▋                                            | 315/561 [00:17<00:13, 18.74it/s][2025-03-28 01:33:28,895] [INFO] [logging.py:128:log_dist] [Rank 0] step=2000, skipped=4, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:33:28,898] [INFO] [timer.py:264:stop] epoch=0/micro_step=2000/global_step=2000, RunningAvgSamplesPerSec=19.798845059648755, CurrSamplesPerSec=18.822870989727036, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 57%|█████████████████████████████████████████████████████████                                            | 317/561 [00:17<00:13, 18.69it/s] 57%|█████████████████████████████████████████████████████████▍                                           | 319/561 [00:17<00:13, 18.35it/s] 57%|█████████████████████████████████████████████████████████▊                                           | 321/561 [00:17<00:13, 18.43it/s][2025-03-28 01:33:29,161] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2025-03-28 01:33:29,203] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
 58%|██████████████████████████████████████████████████████████▎                                          | 324/561 [00:17<00:12, 19.43it/s] 58%|██████████████████████████████████████████████████████████▊                                          | 327/561 [00:17<00:11, 20.10it/s] 59%|███████████████████████████████████████████████████████████▍                                         | 330/561 [00:17<00:11, 20.50it/s] 59%|███████████████████████████████████████████████████████████▉                                         | 333/561 [00:18<00:11, 19.83it/s] 60%|████████████████████████████████████████████████████████████▎                                        | 335/561 [00:18<00:11, 19.56it/s] 60%|████████████████████████████████████████████████████████████▋                                        | 337/561 [00:18<00:11, 19.27it/s] 60%|█████████████████████████████████████████████████████████████                                        | 339/561 [00:18<00:11, 19.06it/s] 61%|█████████████████████████████████████████████████████████████▍                                       | 341/561 [00:18<00:11, 18.93it/s] 61%|█████████████████████████████████████████████████████████████▊                                       | 343/561 [00:18<00:11, 18.62it/s] 61%|██████████████████████████████████████████████████████████████                                       | 345/561 [00:18<00:11, 18.60it/s] 62%|██████████████████████████████████████████████████████████████▍                                      | 347/561 [00:18<00:11, 18.89it/s] 62%|███████████████████████████████████████████████████████████████                                      | 350/561 [00:18<00:10, 19.76it/s] 63%|███████████████████████████████████████████████████████████████▌                                     | 353/561 [00:19<00:10, 20.69it/s] 63%|████████████████████████████████████████████████████████████████                                     | 356/561 [00:19<00:09, 20.94it/s] 64%|████████████████████████████████████████████████████████████████▋                                    | 359/561 [00:19<00:10, 19.91it/s] 64%|████████████████████████████████████████████████████████████████▉                                    | 361/561 [00:19<00:10, 19.56it/s] 65%|█████████████████████████████████████████████████████████████████▎                                   | 363/561 [00:19<00:10, 18.27it/s] 65%|█████████████████████████████████████████████████████████████████▋                                   | 365/561 [00:19<00:10, 18.34it/s][2025-03-28 01:33:31,490] [INFO] [logging.py:128:log_dist] [Rank 0] step=2050, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:33:31,493] [INFO] [timer.py:264:stop] epoch=0/micro_step=2050/global_step=2050, RunningAvgSamplesPerSec=19.786613481933113, CurrSamplesPerSec=17.249635613489456, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 65%|██████████████████████████████████████████████████████████████████                                   | 367/561 [00:19<00:10, 18.17it/s] 66%|██████████████████████████████████████████████████████████████████▍                                  | 369/561 [00:19<00:10, 18.23it/s] 66%|██████████████████████████████████████████████████████████████████▊                                  | 371/561 [00:20<00:10, 18.17it/s] 66%|███████████████████████████████████████████████████████████████████▏                                 | 373/561 [00:20<00:10, 18.46it/s] 67%|███████████████████████████████████████████████████████████████████▋                                 | 376/561 [00:20<00:09, 19.83it/s] 68%|████████████████████████████████████████████████████████████████████▏                                | 379/561 [00:20<00:08, 20.91it/s] 68%|████████████████████████████████████████████████████████████████████▊                                | 382/561 [00:20<00:08, 20.74it/s] 69%|█████████████████████████████████████████████████████████████████████▎                               | 385/561 [00:20<00:08, 19.87it/s] 69%|█████████████████████████████████████████████████████████████████████▋                               | 387/561 [00:20<00:08, 19.49it/s] 69%|██████████████████████████████████████████████████████████████████████                               | 389/561 [00:20<00:09, 19.11it/s] 70%|██████████████████████████████████████████████████████████████████████▍                              | 391/561 [00:21<00:08, 18.92it/s] 70%|██████████████████████████████████████████████████████████████████████▊                              | 393/561 [00:21<00:09, 18.51it/s] 70%|███████████████████████████████████████████████████████████████████████                              | 395/561 [00:21<00:09, 18.29it/s] 71%|███████████████████████████████████████████████████████████████████████▍                             | 397/561 [00:21<00:08, 18.48it/s] 71%|████████████████████████████████████████████████████████████████████████                             | 400/561 [00:21<00:08, 19.58it/s] 72%|████████████████████████████████████████████████████████████████████████▎                            | 402/561 [00:21<00:08, 19.48it/s] 72%|████████████████████████████████████████████████████████████████████████▉                            | 405/561 [00:21<00:07, 20.18it/s] 73%|█████████████████████████████████████████████████████████████████████████▍                           | 408/561 [00:21<00:07, 20.62it/s] 73%|█████████████████████████████████████████████████████████████████████████▉                           | 411/561 [00:22<00:07, 21.03it/s] 74%|██████████████████████████████████████████████████████████████████████████▌                          | 414/561 [00:22<00:06, 21.44it/s][2025-03-28 01:33:33,971] [INFO] [logging.py:128:log_dist] [Rank 0] step=2100, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:33:33,972] [INFO] [timer.py:264:stop] epoch=0/micro_step=2100/global_step=2100, RunningAvgSamplesPerSec=19.79683248243086, CurrSamplesPerSec=23.833819383874157, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 74%|███████████████████████████████████████████████████████████████████████████                          | 417/561 [00:22<00:06, 22.02it/s] 75%|███████████████████████████████████████████████████████████████████████████▌                         | 420/561 [00:22<00:06, 22.74it/s] 75%|████████████████████████████████████████████████████████████████████████████▏                        | 423/561 [00:22<00:06, 22.79it/s] 76%|████████████████████████████████████████████████████████████████████████████▋                        | 426/561 [00:22<00:05, 22.76it/s] 76%|█████████████████████████████████████████████████████████████████████████████▏                       | 429/561 [00:22<00:05, 22.29it/s] 77%|█████████████████████████████████████████████████████████████████████████████▊                       | 432/561 [00:22<00:05, 22.46it/s] 78%|██████████████████████████████████████████████████████████████████████████████▎                      | 435/561 [00:23<00:05, 22.46it/s] 78%|██████████████████████████████████████████████████████████████████████████████▊                      | 438/561 [00:23<00:05, 22.52it/s] 79%|███████████████████████████████████████████████████████████████████████████████▍                     | 441/561 [00:23<00:05, 23.02it/s] 79%|███████████████████████████████████████████████████████████████████████████████▉                     | 444/561 [00:23<00:05, 23.22it/s] 80%|████████████████████████████████████████████████████████████████████████████████▍                    | 447/561 [00:23<00:04, 23.22it/s] 80%|█████████████████████████████████████████████████████████████████████████████████                    | 450/561 [00:23<00:04, 23.28it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▌                   | 453/561 [00:23<00:05, 21.46it/s] 81%|██████████████████████████████████████████████████████████████████████████████████                   | 456/561 [00:24<00:05, 19.87it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▋                  | 459/561 [00:24<00:05, 19.27it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▉                  | 461/561 [00:24<00:05, 18.98it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▎                 | 463/561 [00:24<00:05, 18.74it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▋                 | 465/561 [00:24<00:05, 18.55it/s][2025-03-28 01:33:36,353] [INFO] [logging.py:128:log_dist] [Rank 0] step=2150, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:33:36,356] [INFO] [timer.py:264:stop] epoch=0/micro_step=2150/global_step=2150, RunningAvgSamplesPerSec=19.823697417954808, CurrSamplesPerSec=18.032013758668626, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 83%|████████████████████████████████████████████████████████████████████████████████████                 | 467/561 [00:24<00:05, 18.39it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▍                | 469/561 [00:24<00:05, 18.08it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▊                | 471/561 [00:24<00:04, 18.53it/s] 84%|█████████████████████████████████████████████████████████████████████████████████████▏               | 473/561 [00:25<00:04, 18.68it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▋               | 476/561 [00:25<00:04, 19.45it/s] 85%|██████████████████████████████████████████████████████████████████████████████████████▏              | 479/561 [00:25<00:04, 20.40it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▊              | 482/561 [00:25<00:03, 20.58it/s] 86%|███████████████████████████████████████████████████████████████████████████████████████▎             | 485/561 [00:25<00:03, 21.16it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▊             | 488/561 [00:25<00:03, 21.55it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▍            | 491/561 [00:25<00:03, 21.70it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▉            | 494/561 [00:25<00:03, 22.19it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▍           | 497/561 [00:26<00:02, 21.93it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████           | 500/561 [00:26<00:02, 21.92it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▌          | 503/561 [00:26<00:02, 21.14it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████████          | 506/561 [00:26<00:02, 20.12it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▋         | 509/561 [00:26<00:02, 19.34it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▉         | 511/561 [00:26<00:02, 19.05it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████████▎        | 513/561 [00:26<00:02, 18.81it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████████▋        | 515/561 [00:27<00:02, 18.59it/s][2025-03-28 01:33:38,837] [INFO] [logging.py:128:log_dist] [Rank 0] step=2200, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:33:38,840] [INFO] [timer.py:264:stop] epoch=0/micro_step=2200/global_step=2200, RunningAvgSamplesPerSec=19.831661168912213, CurrSamplesPerSec=17.9664363939891, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 92%|█████████████████████████████████████████████████████████████████████████████████████████████        | 517/561 [00:27<00:02, 18.40it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▍       | 519/561 [00:27<00:02, 18.32it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▊       | 521/561 [00:27<00:02, 18.36it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████████▎      | 524/561 [00:27<00:01, 20.16it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▉      | 527/561 [00:27<00:01, 20.91it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▍     | 530/561 [00:27<00:01, 21.22it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▉     | 533/561 [00:27<00:01, 21.35it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▍    | 536/561 [00:28<00:01, 21.49it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████    | 539/561 [00:28<00:01, 21.38it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████████▌   | 542/561 [00:28<00:00, 21.37it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████████   | 545/561 [00:28<00:00, 21.53it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▋  | 548/561 [00:28<00:00, 20.52it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████████▏ | 551/561 [00:28<00:00, 20.62it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▋ | 554/561 [00:28<00:00, 20.95it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████▎| 557/561 [00:29<00:00, 20.57it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████████▊| 560/561 [00:29<00:00, 21.27it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:29<00:00, 19.13it/s]
  0%|                                                                                                               | 0/561 [00:00<?, ?it/s]  0%|▏                                                                                                      | 1/561 [00:00<02:39,  3.52it/s]  1%|▋                                                                                                      | 4/561 [00:00<00:51, 10.84it/s][2025-03-28 01:33:41,525] [INFO] [logging.py:128:log_dist] [Rank 0] step=2250, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:33:41,526] [INFO] [timer.py:264:stop] epoch=0/micro_step=2250/global_step=2250, RunningAvgSamplesPerSec=19.829565616231466, CurrSamplesPerSec=21.484550185765894, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
  1%|█▎                                                                                                     | 7/561 [00:00<00:37, 14.72it/s]  2%|█▊                                                                                                    | 10/561 [00:00<00:31, 17.38it/s]  2%|██▎                                                                                                   | 13/561 [00:00<00:30, 18.22it/s]  3%|██▋                                                                                                   | 15/561 [00:00<00:30, 18.18it/s]  3%|███                                                                                                   | 17/561 [00:01<00:29, 18.16it/s]  3%|███▍                                                                                                  | 19/561 [00:01<00:29, 18.12it/s]  4%|███▊                                                                                                  | 21/561 [00:01<00:29, 18.08it/s]  4%|████▏                                                                                                 | 23/561 [00:01<00:29, 18.07it/s]  4%|████▌                                                                                                 | 25/561 [00:01<00:28, 18.51it/s]  5%|█████                                                                                                 | 28/561 [00:01<00:26, 20.01it/s]  6%|█████▋                                                                                                | 31/561 [00:01<00:25, 21.12it/s]  6%|██████▏                                                                                               | 34/561 [00:01<00:24, 21.33it/s]  7%|██████▋                                                                                               | 37/561 [00:02<00:24, 21.22it/s]  7%|███████▎                                                                                              | 40/561 [00:02<00:24, 21.46it/s]  8%|███████▊                                                                                              | 43/561 [00:02<00:23, 21.74it/s]  8%|████████▎                                                                                             | 46/561 [00:02<00:23, 21.86it/s]  9%|████████▉                                                                                             | 49/561 [00:02<00:23, 21.74it/s]  9%|█████████▍                                                                                            | 52/561 [00:02<00:23, 22.01it/s] 10%|██████████                                                                                            | 55/561 [00:02<00:22, 22.47it/s][2025-03-28 01:33:43,900] [INFO] [logging.py:128:log_dist] [Rank 0] step=2300, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:33:43,900] [INFO] [timer.py:264:stop] epoch=0/micro_step=2300/global_step=2300, RunningAvgSamplesPerSec=19.855885042600587, CurrSamplesPerSec=23.55091060368829, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 10%|██████████▌                                                                                           | 58/561 [00:02<00:22, 22.52it/s] 11%|███████████                                                                                           | 61/561 [00:03<00:22, 22.35it/s] 11%|███████████▋                                                                                          | 64/561 [00:03<00:22, 22.22it/s] 12%|████████████▏                                                                                         | 67/561 [00:03<00:22, 22.11it/s] 12%|████████████▋                                                                                         | 70/561 [00:03<00:22, 21.92it/s] 13%|█████████████▎                                                                                        | 73/561 [00:03<00:22, 21.80it/s] 14%|█████████████▊                                                                                        | 76/561 [00:03<00:22, 21.77it/s] 14%|██████████████▎                                                                                       | 79/561 [00:03<00:21, 22.04it/s] 15%|██████████████▉                                                                                       | 82/561 [00:04<00:21, 22.15it/s] 15%|███████████████▍                                                                                      | 85/561 [00:04<00:21, 21.99it/s] 16%|████████████████                                                                                      | 88/561 [00:04<00:21, 21.99it/s] 16%|████████████████▌                                                                                     | 91/561 [00:04<00:21, 22.02it/s] 17%|█████████████████                                                                                     | 94/561 [00:04<00:21, 22.08it/s] 17%|█████████████████▋                                                                                    | 97/561 [00:04<00:20, 22.37it/s] 18%|██████████████████                                                                                   | 100/561 [00:04<00:20, 22.53it/s] 18%|██████████████████▌                                                                                  | 103/561 [00:05<00:20, 22.38it/s][2025-03-28 01:33:46,165] [INFO] [logging.py:128:log_dist] [Rank 0] step=2350, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:33:46,166] [INFO] [timer.py:264:stop] epoch=0/micro_step=2350/global_step=2350, RunningAvgSamplesPerSec=19.899332039919877, CurrSamplesPerSec=21.04357379599848, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 19%|███████████████████                                                                                  | 106/561 [00:05<00:20, 22.11it/s] 19%|███████████████████▌                                                                                 | 109/561 [00:05<00:20, 22.12it/s] 20%|████████████████████▏                                                                                | 112/561 [00:05<00:20, 21.96it/s] 20%|████████████████████▋                                                                                | 115/561 [00:05<00:20, 21.92it/s] 21%|█████████████████████▏                                                                               | 118/561 [00:05<00:20, 21.89it/s] 22%|█████████████████████▊                                                                               | 121/561 [00:05<00:20, 22.00it/s] 22%|██████████████████████▎                                                                              | 124/561 [00:05<00:19, 22.00it/s] 23%|██████████████████████▊                                                                              | 127/561 [00:06<00:19, 22.01it/s] 23%|███████████████████████▍                                                                             | 130/561 [00:06<00:20, 21.43it/s] 24%|███████████████████████▉                                                                             | 133/561 [00:06<00:19, 21.60it/s] 24%|████████████████████████▍                                                                            | 136/561 [00:06<00:19, 22.30it/s] 25%|█████████████████████████                                                                            | 139/561 [00:06<00:19, 21.53it/s] 25%|█████████████████████████▌                                                                           | 142/561 [00:06<00:19, 21.59it/s] 26%|██████████████████████████                                                                           | 145/561 [00:06<00:19, 21.65it/s] 26%|██████████████████████████▋                                                                          | 148/561 [00:07<00:18, 21.75it/s] 27%|███████████████████████████▏                                                                         | 151/561 [00:07<00:18, 21.98it/s] 27%|███████████████████████████▋                                                                         | 154/561 [00:07<00:18, 21.98it/s][2025-03-28 01:33:48,457] [INFO] [logging.py:128:log_dist] [Rank 0] step=2400, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:33:48,458] [INFO] [timer.py:264:stop] epoch=0/micro_step=2400/global_step=2400, RunningAvgSamplesPerSec=19.93680090594401, CurrSamplesPerSec=21.770362294037323, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 28%|████████████████████████████▎                                                                        | 157/561 [00:07<00:18, 21.84it/s] 29%|████████████████████████████▊                                                                        | 160/561 [00:07<00:17, 22.34it/s] 29%|█████████████████████████████▎                                                                       | 163/561 [00:07<00:17, 22.65it/s] 30%|█████████████████████████████▉                                                                       | 166/561 [00:07<00:17, 22.71it/s] 30%|██████████████████████████████▍                                                                      | 169/561 [00:08<00:17, 22.36it/s] 31%|██████████████████████████████▉                                                                      | 172/561 [00:08<00:17, 22.39it/s] 31%|███████████████████████████████▌                                                                     | 175/561 [00:08<00:17, 21.60it/s] 32%|████████████████████████████████                                                                     | 178/561 [00:08<00:18, 20.85it/s] 32%|████████████████████████████████▌                                                                    | 181/561 [00:08<00:17, 21.12it/s] 33%|█████████████████████████████████▏                                                                   | 184/561 [00:08<00:17, 21.38it/s] 33%|█████████████████████████████████▋                                                                   | 187/561 [00:08<00:17, 21.46it/s] 34%|██████████████████████████████████▏                                                                  | 190/561 [00:09<00:17, 21.51it/s] 34%|██████████████████████████████████▋                                                                  | 193/561 [00:09<00:17, 21.58it/s] 35%|███████████████████████████████████▎                                                                 | 196/561 [00:09<00:16, 21.55it/s] 35%|███████████████████████████████████▊                                                                 | 199/561 [00:09<00:16, 21.59it/s] 36%|████████████████████████████████████▎                                                                | 202/561 [00:09<00:16, 21.36it/s] 37%|████████████████████████████████████▉                                                                | 205/561 [00:09<00:16, 21.45it/s][2025-03-28 01:33:50,764] [INFO] [logging.py:128:log_dist] [Rank 0] step=2450, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:33:50,764] [INFO] [timer.py:264:stop] epoch=0/micro_step=2450/global_step=2450, RunningAvgSamplesPerSec=19.970583077442267, CurrSamplesPerSec=22.252697435933243, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 37%|█████████████████████████████████████▍                                                               | 208/561 [00:09<00:16, 21.51it/s] 38%|█████████████████████████████████████▉                                                               | 211/561 [00:09<00:16, 21.66it/s] 38%|██████████████████████████████████████▌                                                              | 214/561 [00:10<00:16, 21.53it/s] 39%|███████████████████████████████████████                                                              | 217/561 [00:10<00:15, 21.67it/s] 39%|███████████████████████████████████████▌                                                             | 220/561 [00:10<00:15, 21.93it/s] 40%|████████████████████████████████████████▏                                                            | 223/561 [00:10<00:16, 20.77it/s] 40%|████████████████████████████████████████▋                                                            | 226/561 [00:10<00:16, 20.45it/s] 41%|█████████████████████████████████████████▏                                                           | 229/561 [00:10<00:16, 20.58it/s] 41%|█████████████████████████████████████████▊                                                           | 232/561 [00:10<00:15, 20.95it/s] 42%|██████████████████████████████████████████▎                                                          | 235/561 [00:11<00:15, 21.29it/s] 42%|██████████████████████████████████████████▊                                                          | 238/561 [00:11<00:15, 20.81it/s] 43%|███████████████████████████████████████████▍                                                         | 241/561 [00:11<00:15, 21.15it/s] 43%|███████████████████████████████████████████▉                                                         | 244/561 [00:11<00:14, 21.24it/s] 44%|████████████████████████████████████████████▍                                                        | 247/561 [00:11<00:14, 21.18it/s] 45%|█████████████████████████████████████████████                                                        | 250/561 [00:11<00:14, 21.23it/s] 45%|█████████████████████████████████████████████▌                                                       | 253/561 [00:11<00:14, 21.31it/s][2025-03-28 01:33:53,122] [INFO] [logging.py:128:log_dist] [Rank 0] step=2500, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:33:53,125] [INFO] [timer.py:264:stop] epoch=0/micro_step=2500/global_step=2500, RunningAvgSamplesPerSec=19.994386335620373, CurrSamplesPerSec=21.080379681042114, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 46%|██████████████████████████████████████████████                                                       | 256/561 [00:12<00:14, 21.38it/s] 46%|██████████████████████████████████████████████▋                                                      | 259/561 [00:12<00:14, 21.29it/s] 47%|███████████████████████████████████████████████▏                                                     | 262/561 [00:12<00:14, 21.24it/s] 47%|███████████████████████████████████████████████▋                                                     | 265/561 [00:12<00:13, 21.16it/s] 48%|████████████████████████████████████████████████▏                                                    | 268/561 [00:12<00:13, 20.99it/s] 48%|████████████████████████████████████████████████▊                                                    | 271/561 [00:12<00:13, 20.76it/s] 49%|█████████████████████████████████████████████████▎                                                   | 274/561 [00:12<00:14, 20.45it/s] 49%|█████████████████████████████████████████████████▊                                                   | 277/561 [00:13<00:13, 20.66it/s] 50%|██████████████████████████████████████████████████▍                                                  | 280/561 [00:13<00:14, 20.06it/s] 50%|██████████████████████████████████████████████████▉                                                  | 283/561 [00:13<00:13, 19.93it/s] 51%|███████████████████████████████████████████████████▎                                                 | 285/561 [00:13<00:13, 19.93it/s] 51%|███████████████████████████████████████████████████▊                                                 | 288/561 [00:13<00:13, 20.10it/s] 52%|████████████████████████████████████████████████████▍                                                | 291/561 [00:13<00:13, 19.63it/s] 52%|████████████████████████████████████████████████████▊                                                | 293/561 [00:13<00:13, 19.71it/s] 53%|█████████████████████████████████████████████████████                                                | 295/561 [00:14<00:13, 19.56it/s] 53%|█████████████████████████████████████████████████████▍                                               | 297/561 [00:14<00:13, 19.57it/s] 53%|██████████████████████████████████████████████████████                                               | 300/561 [00:14<00:13, 19.67it/s] 54%|██████████████████████████████████████████████████████▎                                              | 302/561 [00:14<00:13, 19.29it/s] 54%|██████████████████████████████████████████████████████▋                                              | 304/561 [00:14<00:13, 19.44it/s][2025-03-28 01:33:55,631] [INFO] [logging.py:128:log_dist] [Rank 0] step=2550, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:33:55,634] [INFO] [timer.py:264:stop] epoch=0/micro_step=2550/global_step=2550, RunningAvgSamplesPerSec=19.993912732623066, CurrSamplesPerSec=19.12262994568409, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 55%|███████████████████████████████████████████████████████                                              | 306/561 [00:14<00:13, 19.26it/s] 55%|███████████████████████████████████████████████████████▍                                             | 308/561 [00:14<00:13, 19.07it/s] 55%|███████████████████████████████████████████████████████▊                                             | 310/561 [00:14<00:13, 19.04it/s] 56%|████████████████████████████████████████████████████████▏                                            | 312/561 [00:14<00:13, 18.81it/s] 56%|████████████████████████████████████████████████████████▌                                            | 314/561 [00:15<00:12, 19.06it/s] 56%|████████████████████████████████████████████████████████▉                                            | 316/561 [00:15<00:12, 19.10it/s] 57%|█████████████████████████████████████████████████████████▎                                           | 318/561 [00:15<00:13, 18.49it/s] 57%|█████████████████████████████████████████████████████████▌                                           | 320/561 [00:15<00:12, 18.56it/s] 57%|█████████████████████████████████████████████████████████▉                                           | 322/561 [00:15<00:12, 18.80it/s] 58%|██████████████████████████████████████████████████████████▎                                          | 324/561 [00:15<00:12, 18.83it/s] 58%|██████████████████████████████████████████████████████████▊                                          | 327/561 [00:15<00:12, 19.34it/s] 59%|███████████████████████████████████████████████████████████▏                                         | 329/561 [00:15<00:12, 19.09it/s] 59%|███████████████████████████████████████████████████████████▌                                         | 331/561 [00:15<00:12, 18.97it/s] 59%|███████████████████████████████████████████████████████████▉                                         | 333/561 [00:16<00:11, 19.17it/s] 60%|████████████████████████████████████████████████████████████▎                                        | 335/561 [00:16<00:11, 19.07it/s] 60%|████████████████████████████████████████████████████████████▋                                        | 337/561 [00:16<00:11, 19.21it/s] 60%|█████████████████████████████████████████████████████████████                                        | 339/561 [00:16<00:11, 19.11it/s] 61%|█████████████████████████████████████████████████████████████▍                                       | 341/561 [00:16<00:11, 18.87it/s] 61%|█████████████████████████████████████████████████████████████▊                                       | 343/561 [00:16<00:11, 18.92it/s] 61%|██████████████████████████████████████████████████████████████                                       | 345/561 [00:16<00:11, 18.97it/s] 62%|██████████████████████████████████████████████████████████████▍                                      | 347/561 [00:16<00:11, 19.04it/s] 62%|███████████████████████████████████████████████████████████████                                      | 350/561 [00:16<00:10, 20.35it/s] 63%|███████████████████████████████████████████████████████████████▌                                     | 353/561 [00:17<00:10, 19.90it/s] 63%|███████████████████████████████████████████████████████████████▉                                     | 355/561 [00:17<00:10, 19.71it/s][2025-03-28 01:33:58,236] [INFO] [logging.py:128:log_dist] [Rank 0] step=2600, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:33:58,239] [INFO] [timer.py:264:stop] epoch=0/micro_step=2600/global_step=2600, RunningAvgSamplesPerSec=19.978921500562702, CurrSamplesPerSec=20.84227763000441, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 64%|████████████████████████████████████████████████████████████████▎                                    | 357/561 [00:17<00:10, 19.58it/s] 64%|████████████████████████████████████████████████████████████████▊                                    | 360/561 [00:17<00:10, 19.67it/s] 65%|█████████████████████████████████████████████████████████████████▏                                   | 362/561 [00:17<00:10, 19.43it/s] 65%|█████████████████████████████████████████████████████████████████▌                                   | 364/561 [00:17<00:10, 19.55it/s] 65%|█████████████████████████████████████████████████████████████████▉                                   | 366/561 [00:17<00:10, 19.32it/s] 66%|██████████████████████████████████████████████████████████████████▍                                  | 369/561 [00:17<00:09, 19.66it/s] 66%|██████████████████████████████████████████████████████████████████▊                                  | 371/561 [00:18<00:09, 19.69it/s] 66%|███████████████████████████████████████████████████████████████████▏                                 | 373/561 [00:18<00:09, 19.52it/s] 67%|███████████████████████████████████████████████████████████████████▌                                 | 375/561 [00:18<00:09, 19.49it/s] 67%|███████████████████████████████████████████████████████████████████▊                                 | 377/561 [00:18<00:09, 19.37it/s] 68%|████████████████████████████████████████████████████████████████████▏                                | 379/561 [00:18<00:09, 19.10it/s] 68%|████████████████████████████████████████████████████████████████████▌                                | 381/561 [00:18<00:09, 19.24it/s] 68%|████████████████████████████████████████████████████████████████████▉                                | 383/561 [00:18<00:09, 19.19it/s] 69%|█████████████████████████████████████████████████████████████████████▎                               | 385/561 [00:18<00:09, 18.93it/s] 69%|█████████████████████████████████████████████████████████████████████▋                               | 387/561 [00:18<00:09, 19.06it/s] 69%|██████████████████████████████████████████████████████████████████████                               | 389/561 [00:18<00:09, 19.07it/s] 70%|██████████████████████████████████████████████████████████████████████▍                              | 391/561 [00:19<00:08, 19.09it/s] 70%|██████████████████████████████████████████████████████████████████████▊                              | 393/561 [00:19<00:08, 18.86it/s] 70%|███████████████████████████████████████████████████████████████████████                              | 395/561 [00:19<00:08, 18.97it/s] 71%|███████████████████████████████████████████████████████████████████████▍                             | 397/561 [00:19<00:08, 19.06it/s] 71%|███████████████████████████████████████████████████████████████████████▊                             | 399/561 [00:19<00:08, 19.01it/s] 71%|████████████████████████████████████████████████████████████████████████▏                            | 401/561 [00:19<00:08, 19.01it/s] 72%|████████████████████████████████████████████████████████████████████████▌                            | 403/561 [00:19<00:08, 19.07it/s] 72%|████████████████████████████████████████████████████████████████████████▉                            | 405/561 [00:19<00:08, 18.83it/s][2025-03-28 01:34:00,848] [INFO] [logging.py:128:log_dist] [Rank 0] step=2650, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:34:00,851] [INFO] [timer.py:264:stop] epoch=0/micro_step=2650/global_step=2650, RunningAvgSamplesPerSec=19.963404307601223, CurrSamplesPerSec=19.634582221171136, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 73%|█████████████████████████████████████████████████████████████████████████▎                           | 407/561 [00:19<00:08, 18.86it/s] 73%|█████████████████████████████████████████████████████████████████████████▋                           | 409/561 [00:20<00:08, 18.76it/s] 73%|█████████████████████████████████████████████████████████████████████████▉                           | 411/561 [00:20<00:07, 18.84it/s] 74%|██████████████████████████████████████████████████████████████████████████▎                          | 413/561 [00:20<00:07, 18.91it/s] 74%|██████████████████████████████████████████████████████████████████████████▋                          | 415/561 [00:20<00:07, 18.93it/s] 74%|███████████████████████████████████████████████████████████████████████████                          | 417/561 [00:20<00:07, 18.94it/s] 75%|███████████████████████████████████████████████████████████████████████████▍                         | 419/561 [00:20<00:07, 18.95it/s] 75%|███████████████████████████████████████████████████████████████████████████▊                         | 421/561 [00:20<00:07, 18.95it/s] 75%|████████████████████████████████████████████████████████████████████████████▏                        | 423/561 [00:20<00:07, 18.76it/s] 76%|████████████████████████████████████████████████████████████████████████████▌                        | 425/561 [00:20<00:07, 18.83it/s] 76%|████████████████████████████████████████████████████████████████████████████▉                        | 427/561 [00:20<00:07, 18.61it/s] 76%|█████████████████████████████████████████████████████████████████████████████▏                       | 429/561 [00:21<00:07, 18.46it/s] 77%|█████████████████████████████████████████████████████████████████████████████▌                       | 431/561 [00:21<00:07, 18.48it/s] 77%|█████████████████████████████████████████████████████████████████████████████▉                       | 433/561 [00:21<00:06, 18.48it/s] 78%|██████████████████████████████████████████████████████████████████████████████▎                      | 435/561 [00:21<00:06, 18.64it/s] 78%|██████████████████████████████████████████████████████████████████████████████▋                      | 437/561 [00:21<00:06, 18.78it/s] 78%|███████████████████████████████████████████████████████████████████████████████                      | 439/561 [00:21<00:06, 18.80it/s] 79%|███████████████████████████████████████████████████████████████████████████████▍                     | 441/561 [00:21<00:06, 18.80it/s] 79%|███████████████████████████████████████████████████████████████████████████████▊                     | 443/561 [00:21<00:06, 18.83it/s] 79%|████████████████████████████████████████████████████████████████████████████████                     | 445/561 [00:21<00:06, 18.76it/s] 80%|████████████████████████████████████████████████████████████████████████████████▍                    | 447/561 [00:22<00:06, 18.73it/s] 80%|████████████████████████████████████████████████████████████████████████████████▊                    | 449/561 [00:22<00:05, 18.87it/s] 80%|█████████████████████████████████████████████████████████████████████████████████▏                   | 451/561 [00:22<00:05, 18.83it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▌                   | 453/561 [00:22<00:05, 18.79it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▉                   | 455/561 [00:22<00:05, 18.74it/s][2025-03-28 01:34:03,510] [INFO] [logging.py:128:log_dist] [Rank 0] step=2700, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:34:03,513] [INFO] [timer.py:264:stop] epoch=0/micro_step=2700/global_step=2700, RunningAvgSamplesPerSec=19.94109826351489, CurrSamplesPerSec=20.631797411417196, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 81%|██████████████████████████████████████████████████████████████████████████████████▎                  | 457/561 [00:22<00:05, 19.09it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▊                  | 460/561 [00:22<00:04, 20.52it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▎                 | 463/561 [00:22<00:04, 19.82it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▋                 | 465/561 [00:22<00:04, 19.50it/s] 83%|████████████████████████████████████████████████████████████████████████████████████                 | 467/561 [00:23<00:04, 19.34it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▍                | 469/561 [00:23<00:04, 19.23it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▊                | 471/561 [00:23<00:04, 19.16it/s] 84%|█████████████████████████████████████████████████████████████████████████████████████▏               | 473/561 [00:23<00:04, 19.28it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▌               | 475/561 [00:23<00:04, 19.33it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▉               | 477/561 [00:23<00:04, 19.20it/s] 85%|██████████████████████████████████████████████████████████████████████████████████████▏              | 479/561 [00:23<00:04, 19.11it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▌              | 481/561 [00:23<00:04, 18.89it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▉              | 483/561 [00:23<00:04, 18.89it/s] 86%|███████████████████████████████████████████████████████████████████████████████████████▎             | 485/561 [00:24<00:04, 18.88it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▋             | 487/561 [00:24<00:03, 18.82it/s] 87%|████████████████████████████████████████████████████████████████████████████████████████             | 489/561 [00:24<00:03, 18.78it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▍            | 491/561 [00:24<00:03, 18.93it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▊            | 493/561 [00:24<00:03, 18.75it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████████            | 495/561 [00:24<00:03, 18.62it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▍           | 497/561 [00:24<00:03, 18.41it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▊           | 499/561 [00:24<00:03, 18.52it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████▏          | 501/561 [00:24<00:03, 18.69it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▌          | 503/561 [00:24<00:03, 18.77it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▉          | 505/561 [00:25<00:02, 18.70it/s][2025-03-28 01:34:06,138] [INFO] [logging.py:128:log_dist] [Rank 0] step=2750, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:34:06,141] [INFO] [timer.py:264:stop] epoch=0/micro_step=2750/global_step=2750, RunningAvgSamplesPerSec=19.924492453175088, CurrSamplesPerSec=18.656757919512614, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 90%|███████████████████████████████████████████████████████████████████████████████████████████▎         | 507/561 [00:25<00:02, 18.65it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▋         | 509/561 [00:25<00:02, 18.59it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▉         | 511/561 [00:25<00:02, 18.57it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████████▎        | 513/561 [00:25<00:02, 18.73it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████████▋        | 515/561 [00:25<00:02, 18.77it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████        | 517/561 [00:25<00:02, 18.65it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▍       | 519/561 [00:25<00:02, 18.51it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▊       | 521/561 [00:25<00:02, 18.59it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████████▏      | 523/561 [00:26<00:02, 18.72it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▌      | 525/561 [00:26<00:01, 18.74it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▉      | 527/561 [00:26<00:01, 18.71it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▏     | 529/561 [00:26<00:01, 18.91it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▌     | 531/561 [00:26<00:01, 18.93it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▉     | 533/561 [00:26<00:01, 18.84it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████████▎    | 535/561 [00:26<00:01, 18.96it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▋    | 537/561 [00:26<00:01, 19.04it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████    | 539/561 [00:26<00:01, 18.88it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████▍   | 541/561 [00:26<00:01, 18.79it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████████▊   | 543/561 [00:27<00:00, 18.90it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████████   | 545/561 [00:27<00:00, 18.97it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▍  | 547/561 [00:27<00:00, 18.58it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▊  | 549/561 [00:27<00:00, 18.64it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████████▏ | 551/561 [00:27<00:00, 18.64it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▌ | 553/561 [00:27<00:00, 18.70it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▉ | 555/561 [00:27<00:00, 18.53it/s][2025-03-28 01:34:08,808] [INFO] [logging.py:128:log_dist] [Rank 0] step=2800, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:34:08,811] [INFO] [timer.py:264:stop] epoch=0/micro_step=2800/global_step=2800, RunningAvgSamplesPerSec=19.902712304325984, CurrSamplesPerSec=18.88933072303704, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 99%|████████████████████████████████████████████████████████████████████████████████████████████████████▎| 557/561 [00:27<00:00, 17.84it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████████▋| 559/561 [00:27<00:00, 17.91it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:28<00:00, 18.17it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:28<00:00, 19.94it/s]
  0%|                                                                                                               | 0/561 [00:00<?, ?it/s]  0%|▏                                                                                                      | 1/561 [00:00<02:07,  4.40it/s]  1%|▌                                                                                                      | 3/561 [00:00<00:55, 10.03it/s]  1%|▉                                                                                                      | 5/561 [00:00<00:42, 12.99it/s]  1%|█▎                                                                                                     | 7/561 [00:00<00:37, 14.89it/s]  2%|█▋                                                                                                     | 9/561 [00:00<00:34, 16.08it/s]  2%|██                                                                                                    | 11/561 [00:00<00:33, 16.65it/s]  2%|██▌                                                                                                   | 14/561 [00:00<00:29, 18.53it/s]  3%|██▉                                                                                                   | 16/561 [00:01<00:29, 18.47it/s]  3%|███▎                                                                                                  | 18/561 [00:01<00:29, 18.40it/s]  4%|███▋                                                                                                  | 20/561 [00:01<00:29, 18.51it/s]  4%|████                                                                                                  | 22/561 [00:01<00:29, 18.51it/s]  4%|████▎                                                                                                 | 24/561 [00:01<00:28, 18.62it/s]  5%|████▋                                                                                                 | 26/561 [00:01<00:28, 18.69it/s]  5%|█████                                                                                                 | 28/561 [00:01<00:27, 19.04it/s]  5%|█████▍                                                                                                | 30/561 [00:01<00:27, 19.03it/s]  6%|█████▊                                                                                                | 32/561 [00:01<00:28, 18.81it/s]  6%|██████▏                                                                                               | 34/561 [00:01<00:28, 18.44it/s]  6%|██████▌                                                                                               | 36/561 [00:02<00:28, 18.60it/s]  7%|██████▉                                                                                               | 38/561 [00:02<00:28, 18.47it/s]  7%|███████▎                                                                                              | 40/561 [00:02<00:27, 18.71it/s]  7%|███████▋                                                                                              | 42/561 [00:02<00:27, 18.91it/s]  8%|████████                                                                                              | 44/561 [00:02<00:27, 18.89it/s][2025-03-28 01:34:11,718] [INFO] [logging.py:128:log_dist] [Rank 0] step=2850, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:34:11,719] [INFO] [timer.py:264:stop] epoch=0/micro_step=2850/global_step=2850, RunningAvgSamplesPerSec=19.868592754677827, CurrSamplesPerSec=28.037879541477956, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
  8%|████████▌                                                                                             | 47/561 [00:02<00:26, 19.75it/s]  9%|████████▉                                                                                             | 49/561 [00:02<00:26, 19.47it/s]  9%|█████████▎                                                                                            | 51/561 [00:02<00:26, 19.19it/s]  9%|█████████▋                                                                                            | 53/561 [00:02<00:26, 18.99it/s] 10%|██████████                                                                                            | 55/561 [00:03<00:26, 18.84it/s] 10%|██████████▎                                                                                           | 57/561 [00:03<00:26, 18.95it/s] 11%|██████████▋                                                                                           | 59/561 [00:03<00:26, 18.85it/s] 11%|███████████                                                                                           | 61/561 [00:03<00:26, 18.89it/s] 11%|███████████▍                                                                                          | 63/561 [00:03<00:27, 18.13it/s] 12%|███████████▊                                                                                          | 65/561 [00:03<00:26, 18.49it/s] 12%|████████████▏                                                                                         | 67/561 [00:03<00:26, 18.72it/s] 12%|████████████▌                                                                                         | 69/561 [00:03<00:26, 18.58it/s] 13%|████████████▉                                                                                         | 71/561 [00:03<00:26, 18.69it/s] 13%|█████████████▎                                                                                        | 73/561 [00:04<00:26, 18.50it/s] 13%|█████████████▋                                                                                        | 75/561 [00:04<00:26, 18.62it/s] 14%|██████████████                                                                                        | 77/561 [00:04<00:26, 18.60it/s] 14%|██████████████▎                                                                                       | 79/561 [00:04<00:25, 18.79it/s] 14%|██████████████▋                                                                                       | 81/561 [00:04<00:25, 18.96it/s] 15%|███████████████                                                                                       | 83/561 [00:04<00:25, 18.82it/s] 15%|███████████████▍                                                                                      | 85/561 [00:04<00:25, 18.88it/s] 16%|███████████████▊                                                                                      | 87/561 [00:04<00:25, 18.94it/s] 16%|████████████████▏                                                                                     | 89/561 [00:04<00:26, 17.88it/s] 16%|████████████████▌                                                                                     | 91/561 [00:05<00:25, 18.29it/s] 17%|████████████████▉                                                                                     | 93/561 [00:05<00:26, 17.63it/s][2025-03-28 01:34:14,423] [INFO] [logging.py:128:log_dist] [Rank 0] step=2900, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:34:14,426] [INFO] [timer.py:264:stop] epoch=0/micro_step=2900/global_step=2900, RunningAvgSamplesPerSec=19.843534611548225, CurrSamplesPerSec=19.135279946068128, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 17%|█████████████████▎                                                                                    | 95/561 [00:05<00:26, 17.82it/s] 17%|█████████████████▋                                                                                    | 97/561 [00:05<00:25, 18.16it/s] 18%|██████████████████                                                                                    | 99/561 [00:05<00:25, 18.38it/s] 18%|██████████████████▏                                                                                  | 101/561 [00:05<00:24, 18.60it/s] 18%|██████████████████▌                                                                                  | 103/561 [00:05<00:24, 18.55it/s] 19%|███████████████████                                                                                  | 106/561 [00:05<00:22, 20.10it/s] 19%|███████████████████▌                                                                                 | 109/561 [00:05<00:21, 21.06it/s] 20%|████████████████████▏                                                                                | 112/561 [00:06<00:20, 21.96it/s] 20%|████████████████████▋                                                                                | 115/561 [00:06<00:19, 22.48it/s] 21%|█████████████████████▏                                                                               | 118/561 [00:06<00:19, 22.93it/s] 22%|█████████████████████▊                                                                               | 121/561 [00:06<00:18, 23.31it/s] 22%|██████████████████████▎                                                                              | 124/561 [00:06<00:19, 22.15it/s] 23%|██████████████████████▊                                                                              | 127/561 [00:06<00:19, 22.16it/s] 23%|███████████████████████▍                                                                             | 130/561 [00:06<00:19, 22.11it/s] 24%|███████████████████████▉                                                                             | 133/561 [00:07<00:19, 22.12it/s] 24%|████████████████████████▍                                                                            | 136/561 [00:07<00:19, 22.03it/s] 25%|█████████████████████████                                                                            | 139/561 [00:07<00:18, 22.53it/s] 25%|█████████████████████████▌                                                                           | 142/561 [00:07<00:18, 22.97it/s][2025-03-28 01:34:16,685] [INFO] [logging.py:128:log_dist] [Rank 0] step=2950, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:34:16,686] [INFO] [timer.py:264:stop] epoch=0/micro_step=2950/global_step=2950, RunningAvgSamplesPerSec=19.879182649734577, CurrSamplesPerSec=23.215765495909032, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 26%|██████████████████████████                                                                           | 145/561 [00:07<00:18, 23.08it/s] 26%|██████████████████████████▋                                                                          | 148/561 [00:07<00:17, 23.45it/s] 27%|███████████████████████████▏                                                                         | 151/561 [00:07<00:17, 23.43it/s] 27%|███████████████████████████▋                                                                         | 154/561 [00:07<00:17, 23.62it/s] 28%|████████████████████████████▎                                                                        | 157/561 [00:08<00:17, 23.64it/s] 29%|████████████████████████████▊                                                                        | 160/561 [00:08<00:17, 23.57it/s] 29%|█████████████████████████████▎                                                                       | 163/561 [00:08<00:16, 23.80it/s] 30%|█████████████████████████████▉                                                                       | 166/561 [00:08<00:16, 23.63it/s] 30%|██████████████████████████████▍                                                                      | 169/561 [00:08<00:16, 23.34it/s] 31%|██████████████████████████████▉                                                                      | 172/561 [00:08<00:16, 22.89it/s] 31%|███████████████████████████████▌                                                                     | 175/561 [00:08<00:16, 22.79it/s] 32%|████████████████████████████████                                                                     | 178/561 [00:08<00:16, 23.14it/s] 32%|████████████████████████████████▌                                                                    | 181/561 [00:09<00:16, 23.42it/s] 33%|█████████████████████████████████▏                                                                   | 184/561 [00:09<00:16, 23.47it/s] 33%|█████████████████████████████████▋                                                                   | 187/561 [00:09<00:15, 23.59it/s] 34%|██████████████████████████████████▏                                                                  | 190/561 [00:09<00:15, 23.64it/s] 34%|██████████████████████████████████▋                                                                  | 193/561 [00:09<00:15, 23.69it/s][2025-03-28 01:34:18,812] [INFO] [logging.py:128:log_dist] [Rank 0] step=3000, skipped=6, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:34:18,812] [INFO] [timer.py:264:stop] epoch=0/micro_step=3000/global_step=3000, RunningAvgSamplesPerSec=19.931322021183792, CurrSamplesPerSec=23.301663735519607, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 35%|███████████████████████████████████▎                                                                 | 196/561 [00:09<00:15, 23.64it/s] 35%|███████████████████████████████████▊                                                                 | 199/561 [00:09<00:15, 23.68it/s][2025-03-28 01:34:19,099] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
 36%|████████████████████████████████████▎                                                                | 202/561 [00:09<00:14, 24.09it/s][2025-03-28 01:34:19,140] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
 37%|████████████████████████████████████▉                                                                | 205/561 [00:10<00:15, 23.04it/s] 37%|█████████████████████████████████████▍                                                               | 208/561 [00:10<00:15, 22.42it/s] 38%|█████████████████████████████████████▉                                                               | 211/561 [00:10<00:16, 21.74it/s] 38%|██████████████████████████████████████▌                                                              | 214/561 [00:10<00:16, 21.52it/s] 39%|███████████████████████████████████████                                                              | 217/561 [00:10<00:15, 21.73it/s] 39%|███████████████████████████████████████▌                                                             | 220/561 [00:10<00:15, 22.20it/s] 40%|████████████████████████████████████████▏                                                            | 223/561 [00:10<00:14, 22.75it/s] 40%|████████████████████████████████████████▋                                                            | 226/561 [00:11<00:14, 23.02it/s] 41%|█████████████████████████████████████████▏                                                           | 229/561 [00:11<00:14, 23.23it/s] 41%|█████████████████████████████████████████▊                                                           | 232/561 [00:11<00:14, 23.24it/s] 42%|██████████████████████████████████████████▎                                                          | 235/561 [00:11<00:14, 22.93it/s] 42%|██████████████████████████████████████████▊                                                          | 238/561 [00:11<00:14, 22.60it/s] 43%|███████████████████████████████████████████▍                                                         | 241/561 [00:11<00:14, 22.47it/s] 43%|███████████████████████████████████████████▉                                                         | 244/561 [00:11<00:14, 22.52it/s][2025-03-28 01:34:21,031] [INFO] [logging.py:128:log_dist] [Rank 0] step=3050, skipped=8, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:34:21,032] [INFO] [timer.py:264:stop] epoch=0/micro_step=3050/global_step=3050, RunningAvgSamplesPerSec=19.969917923310256, CurrSamplesPerSec=21.767876618147433, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 44%|████████████████████████████████████████████▍                                                        | 247/561 [00:11<00:14, 22.34it/s] 45%|█████████████████████████████████████████████                                                        | 250/561 [00:12<00:14, 22.10it/s] 45%|█████████████████████████████████████████████▌                                                       | 253/561 [00:12<00:13, 22.31it/s] 46%|██████████████████████████████████████████████                                                       | 256/561 [00:12<00:13, 22.35it/s] 46%|██████████████████████████████████████████████▋                                                      | 259/561 [00:12<00:13, 22.29it/s] 47%|███████████████████████████████████████████████▏                                                     | 262/561 [00:12<00:13, 22.40it/s] 47%|███████████████████████████████████████████████▋                                                     | 265/561 [00:12<00:13, 22.15it/s] 48%|████████████████████████████████████████████████▏                                                    | 268/561 [00:12<00:13, 22.19it/s] 48%|████████████████████████████████████████████████▊                                                    | 271/561 [00:13<00:13, 22.12it/s] 49%|█████████████████████████████████████████████████▎                                                   | 274/561 [00:13<00:13, 21.99it/s] 49%|█████████████████████████████████████████████████▊                                                   | 277/561 [00:13<00:13, 21.80it/s] 50%|██████████████████████████████████████████████████▍                                                  | 280/561 [00:13<00:12, 21.77it/s] 50%|██████████████████████████████████████████████████▉                                                  | 283/561 [00:13<00:12, 21.81it/s] 51%|███████████████████████████████████████████████████▍                                                 | 286/561 [00:13<00:12, 22.06it/s] 52%|████████████████████████████████████████████████████                                                 | 289/561 [00:13<00:12, 22.35it/s] 52%|████████████████████████████████████████████████████▌                                                | 292/561 [00:13<00:11, 22.69it/s][2025-03-28 01:34:23,285] [INFO] [logging.py:128:log_dist] [Rank 0] step=3100, skipped=8, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:34:23,285] [INFO] [timer.py:264:stop] epoch=0/micro_step=3100/global_step=3100, RunningAvgSamplesPerSec=20.002942281020005, CurrSamplesPerSec=22.095030853116604, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 53%|█████████████████████████████████████████████████████                                                | 295/561 [00:14<00:11, 22.43it/s] 53%|█████████████████████████████████████████████████████▋                                               | 298/561 [00:14<00:11, 22.43it/s] 54%|██████████████████████████████████████████████████████▏                                              | 301/561 [00:14<00:11, 22.27it/s] 54%|██████████████████████████████████████████████████████▋                                              | 304/561 [00:14<00:11, 22.24it/s] 55%|███████████████████████████████████████████████████████▎                                             | 307/561 [00:14<00:11, 22.22it/s] 55%|███████████████████████████████████████████████████████▊                                             | 310/561 [00:14<00:11, 22.16it/s] 56%|████████████████████████████████████████████████████████▎                                            | 313/561 [00:14<00:11, 22.05it/s] 56%|████████████████████████████████████████████████████████▉                                            | 316/561 [00:15<00:11, 22.23it/s] 57%|█████████████████████████████████████████████████████████▍                                           | 319/561 [00:15<00:10, 22.41it/s] 57%|█████████████████████████████████████████████████████████▉                                           | 322/561 [00:15<00:10, 22.27it/s] 58%|██████████████████████████████████████████████████████████▌                                          | 325/561 [00:15<00:10, 22.34it/s] 58%|███████████████████████████████████████████████████████████                                          | 328/561 [00:15<00:10, 22.51it/s] 59%|███████████████████████████████████████████████████████████▌                                         | 331/561 [00:15<00:10, 22.25it/s] 60%|████████████████████████████████████████████████████████████▏                                        | 334/561 [00:15<00:10, 21.93it/s] 60%|████████████████████████████████████████████████████████████▋                                        | 337/561 [00:16<00:10, 21.79it/s] 61%|█████████████████████████████████████████████████████████████▏                                       | 340/561 [00:16<00:10, 21.89it/s] 61%|█████████████████████████████████████████████████████████████▊                                       | 343/561 [00:16<00:09, 21.96it/s][2025-03-28 01:34:25,544] [INFO] [logging.py:128:log_dist] [Rank 0] step=3150, skipped=8, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:34:25,544] [INFO] [timer.py:264:stop] epoch=0/micro_step=3150/global_step=3150, RunningAvgSamplesPerSec=20.034350565405727, CurrSamplesPerSec=23.22064955674042, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 62%|██████████████████████████████████████████████████████████████▎                                      | 346/561 [00:16<00:09, 22.22it/s] 62%|██████████████████████████████████████████████████████████████▊                                      | 349/561 [00:16<00:09, 22.37it/s] 63%|███████████████████████████████████████████████████████████████▎                                     | 352/561 [00:16<00:09, 22.30it/s] 63%|███████████████████████████████████████████████████████████████▉                                     | 355/561 [00:16<00:09, 22.44it/s] 64%|████████████████████████████████████████████████████████████████▍                                    | 358/561 [00:16<00:08, 22.85it/s] 64%|████████████████████████████████████████████████████████████████▉                                    | 361/561 [00:17<00:08, 23.15it/s] 65%|█████████████████████████████████████████████████████████████████▌                                   | 364/561 [00:17<00:08, 23.24it/s] 65%|██████████████████████████████████████████████████████████████████                                   | 367/561 [00:17<00:08, 22.91it/s] 66%|██████████████████████████████████████████████████████████████████▌                                  | 370/561 [00:17<00:08, 22.56it/s] 66%|███████████████████████████████████████████████████████████████████▏                                 | 373/561 [00:17<00:08, 22.37it/s] 67%|███████████████████████████████████████████████████████████████████▋                                 | 376/561 [00:17<00:08, 22.17it/s] 68%|████████████████████████████████████████████████████████████████████▏                                | 379/561 [00:17<00:08, 22.12it/s] 68%|████████████████████████████████████████████████████████████████████▊                                | 382/561 [00:18<00:08, 21.83it/s] 69%|█████████████████████████████████████████████████████████████████████▎                               | 385/561 [00:18<00:08, 21.97it/s] 69%|█████████████████████████████████████████████████████████████████████▊                               | 388/561 [00:18<00:07, 22.30it/s] 70%|██████████████████████████████████████████████████████████████████████▍                              | 391/561 [00:18<00:07, 22.28it/s] 70%|██████████████████████████████████████████████████████████████████████▉                              | 394/561 [00:18<00:07, 21.83it/s][2025-03-28 01:34:27,781] [INFO] [logging.py:128:log_dist] [Rank 0] step=3200, skipped=8, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:34:27,782] [INFO] [timer.py:264:stop] epoch=0/micro_step=3200/global_step=3200, RunningAvgSamplesPerSec=20.067552889828644, CurrSamplesPerSec=21.388358324527154, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 71%|███████████████████████████████████████████████████████████████████████▍                             | 397/561 [00:18<00:07, 22.05it/s] 71%|████████████████████████████████████████████████████████████████████████                             | 400/561 [00:18<00:07, 21.08it/s] 72%|████████████████████████████████████████████████████████████████████████▌                            | 403/561 [00:19<00:07, 20.37it/s] 72%|█████████████████████████████████████████████████████████████████████████                            | 406/561 [00:19<00:07, 20.87it/s] 73%|█████████████████████████████████████████████████████████████████████████▋                           | 409/561 [00:19<00:07, 21.34it/s] 73%|██████████████████████████████████████████████████████████████████████████▏                          | 412/561 [00:19<00:06, 21.57it/s] 74%|██████████████████████████████████████████████████████████████████████████▋                          | 415/561 [00:19<00:06, 21.58it/s] 75%|███████████████████████████████████████████████████████████████████████████▎                         | 418/561 [00:19<00:06, 21.42it/s] 75%|███████████████████████████████████████████████████████████████████████████▊                         | 421/561 [00:19<00:06, 21.52it/s] 76%|████████████████████████████████████████████████████████████████████████████▎                        | 424/561 [00:19<00:06, 21.68it/s] 76%|████████████████████████████████████████████████████████████████████████████▉                        | 427/561 [00:20<00:06, 21.67it/s] 77%|█████████████████████████████████████████████████████████████████████████████▍                       | 430/561 [00:20<00:05, 21.88it/s] 77%|█████████████████████████████████████████████████████████████████████████████▉                       | 433/561 [00:20<00:05, 22.53it/s] 78%|██████████████████████████████████████████████████████████████████████████████▍                      | 436/561 [00:20<00:05, 22.91it/s] 78%|███████████████████████████████████████████████████████████████████████████████                      | 439/561 [00:20<00:05, 23.31it/s] 79%|███████████████████████████████████████████████████████████████████████████████▌                     | 442/561 [00:20<00:05, 23.28it/s][2025-03-28 01:34:30,070] [INFO] [logging.py:128:log_dist] [Rank 0] step=3250, skipped=8, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:34:30,071] [INFO] [timer.py:264:stop] epoch=0/micro_step=3250/global_step=3250, RunningAvgSamplesPerSec=20.09349525544754, CurrSamplesPerSec=20.79495066613405, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 79%|████████████████████████████████████████████████████████████████████████████████                     | 445/561 [00:20<00:05, 22.05it/s] 80%|████████████████████████████████████████████████████████████████████████████████▋                    | 448/561 [00:21<00:05, 21.32it/s] 80%|█████████████████████████████████████████████████████████████████████████████████▏                   | 451/561 [00:21<00:05, 21.48it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▋                   | 454/561 [00:21<00:04, 21.56it/s] 81%|██████████████████████████████████████████████████████████████████████████████████▎                  | 457/561 [00:21<00:04, 22.22it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▊                  | 460/561 [00:21<00:04, 22.71it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▎                 | 463/561 [00:21<00:04, 23.10it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▉                 | 466/561 [00:21<00:04, 23.30it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▍                | 469/561 [00:21<00:03, 23.58it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▉                | 472/561 [00:22<00:03, 23.50it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▌               | 475/561 [00:22<00:03, 23.13it/s] 85%|██████████████████████████████████████████████████████████████████████████████████████               | 478/561 [00:22<00:03, 23.14it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▌              | 481/561 [00:22<00:03, 21.85it/s] 86%|███████████████████████████████████████████████████████████████████████████████████████▏             | 484/561 [00:22<00:03, 21.79it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▋             | 487/561 [00:22<00:03, 21.83it/s] 87%|████████████████████████████████████████████████████████████████████████████████████████▏            | 490/561 [00:22<00:03, 21.77it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▊            | 493/561 [00:23<00:03, 21.77it/s][2025-03-28 01:34:32,310] [INFO] [logging.py:128:log_dist] [Rank 0] step=3300, skipped=8, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:34:32,311] [INFO] [timer.py:264:stop] epoch=0/micro_step=3300/global_step=3300, RunningAvgSamplesPerSec=20.124658738941402, CurrSamplesPerSec=22.964594878983785, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 88%|█████████████████████████████████████████████████████████████████████████████████████████▎           | 496/561 [00:23<00:02, 22.07it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▊           | 499/561 [00:23<00:02, 22.11it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████▍          | 502/561 [00:23<00:02, 21.96it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▉          | 505/561 [00:23<00:02, 20.90it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▍         | 508/561 [00:23<00:02, 21.08it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▉         | 511/561 [00:23<00:02, 21.32it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████████▌        | 514/561 [00:24<00:02, 21.24it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████        | 517/561 [00:24<00:02, 21.46it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▌       | 520/561 [00:24<00:01, 21.61it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████████▏      | 523/561 [00:24<00:01, 21.80it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▋      | 526/561 [00:24<00:01, 21.81it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▏     | 529/561 [00:24<00:01, 21.93it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▊     | 532/561 [00:24<00:01, 20.91it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████████▎    | 535/561 [00:25<00:01, 21.15it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▊    | 538/561 [00:25<00:01, 21.28it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████▍   | 541/561 [00:25<00:00, 21.43it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████████▉   | 544/561 [00:25<00:00, 21.58it/s][2025-03-28 01:34:34,642] [INFO] [logging.py:128:log_dist] [Rank 0] step=3350, skipped=8, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:34:34,643] [INFO] [timer.py:264:stop] epoch=0/micro_step=3350/global_step=3350, RunningAvgSamplesPerSec=20.143915273292734, CurrSamplesPerSec=22.222750369720682, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▍  | 547/561 [00:25<00:00, 21.67it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████████  | 550/561 [00:25<00:00, 21.52it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▌ | 553/561 [00:25<00:00, 21.69it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████ | 556/561 [00:25<00:00, 21.58it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████████▋| 559/561 [00:26<00:00, 21.67it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:26<00:00, 21.36it/s]
  0%|                                                                                                               | 0/561 [00:00<?, ?it/s]  0%|▏                                                                                                      | 1/561 [00:00<01:57,  4.75it/s]  1%|▋                                                                                                      | 4/561 [00:00<00:43, 12.92it/s]  1%|█▎                                                                                                     | 7/561 [00:00<00:33, 16.66it/s]  2%|█▊                                                                                                    | 10/561 [00:00<00:28, 19.06it/s]  2%|██▎                                                                                                   | 13/561 [00:00<00:24, 22.05it/s]  3%|██▉                                                                                                   | 16/561 [00:00<00:24, 22.20it/s]  3%|███▍                                                                                                  | 19/561 [00:00<00:24, 21.94it/s]  4%|████                                                                                                  | 22/561 [00:01<00:24, 21.75it/s]  4%|████▌                                                                                                 | 25/561 [00:01<00:24, 22.07it/s]  5%|█████                                                                                                 | 28/561 [00:01<00:24, 22.02it/s]  6%|█████▋                                                                                                | 31/561 [00:01<00:24, 22.07it/s][2025-03-28 01:34:37,128] [INFO] [logging.py:128:log_dist] [Rank 0] step=3400, skipped=8, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:34:37,129] [INFO] [timer.py:264:stop] epoch=0/micro_step=3400/global_step=3400, RunningAvgSamplesPerSec=20.160977734141742, CurrSamplesPerSec=21.449391606479427, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
  6%|██████▏                                                                                               | 34/561 [00:01<00:23, 22.13it/s]  7%|██████▋                                                                                               | 37/561 [00:01<00:23, 22.05it/s]  7%|███████▎                                                                                              | 40/561 [00:01<00:23, 22.08it/s]  8%|███████▊                                                                                              | 43/561 [00:02<00:23, 22.07it/s]  8%|████████▎                                                                                             | 46/561 [00:02<00:23, 22.01it/s]  9%|████████▉                                                                                             | 49/561 [00:02<00:23, 21.87it/s]  9%|█████████▍                                                                                            | 52/561 [00:02<00:23, 21.60it/s] 10%|██████████                                                                                            | 55/561 [00:02<00:23, 21.72it/s] 10%|██████████▌                                                                                           | 58/561 [00:02<00:23, 21.51it/s] 11%|███████████                                                                                           | 61/561 [00:02<00:22, 21.85it/s] 11%|███████████▋                                                                                          | 64/561 [00:03<00:22, 21.74it/s] 12%|████████████▏                                                                                         | 67/561 [00:03<00:22, 21.74it/s] 12%|████████████▋                                                                                         | 70/561 [00:03<00:22, 21.79it/s] 13%|█████████████▎                                                                                        | 73/561 [00:03<00:22, 21.84it/s] 14%|█████████████▊                                                                                        | 76/561 [00:03<00:22, 21.86it/s] 14%|██████████████▎                                                                                       | 79/561 [00:03<00:22, 21.85it/s] 15%|██████████████▉                                                                                       | 82/561 [00:03<00:21, 21.95it/s][2025-03-28 01:34:39,423] [INFO] [logging.py:128:log_dist] [Rank 0] step=3450, skipped=8, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:34:39,424] [INFO] [timer.py:264:stop] epoch=0/micro_step=3450/global_step=3450, RunningAvgSamplesPerSec=20.183486952068286, CurrSamplesPerSec=21.371684020260926, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 15%|███████████████▍                                                                                      | 85/561 [00:04<00:21, 21.64it/s] 16%|████████████████                                                                                      | 88/561 [00:04<00:21, 21.85it/s] 16%|████████████████▌                                                                                     | 91/561 [00:04<00:21, 21.93it/s] 17%|█████████████████                                                                                     | 94/561 [00:04<00:22, 20.49it/s] 17%|█████████████████▋                                                                                    | 97/561 [00:04<00:22, 20.82it/s] 18%|██████████████████                                                                                   | 100/561 [00:04<00:21, 21.16it/s] 18%|██████████████████▌                                                                                  | 103/561 [00:04<00:21, 21.45it/s] 19%|███████████████████                                                                                  | 106/561 [00:05<00:21, 20.97it/s] 19%|███████████████████▌                                                                                 | 109/561 [00:05<00:21, 21.26it/s] 20%|████████████████████▏                                                                                | 112/561 [00:05<00:20, 21.52it/s] 20%|████████████████████▋                                                                                | 115/561 [00:05<00:20, 22.14it/s] 21%|█████████████████████▏                                                                               | 118/561 [00:05<00:20, 21.77it/s] 22%|█████████████████████▊                                                                               | 121/561 [00:05<00:20, 21.77it/s] 22%|██████████████████████▎                                                                              | 124/561 [00:05<00:20, 21.17it/s] 23%|██████████████████████▊                                                                              | 127/561 [00:05<00:20, 21.30it/s] 23%|███████████████████████▍                                                                             | 130/561 [00:06<00:20, 20.95it/s] 24%|███████████████████████▉                                                                             | 133/561 [00:06<00:20, 21.30it/s][2025-03-28 01:34:41,770] [INFO] [logging.py:128:log_dist] [Rank 0] step=3500, skipped=8, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:34:41,771] [INFO] [timer.py:264:stop] epoch=0/micro_step=3500/global_step=3500, RunningAvgSamplesPerSec=20.19946008258959, CurrSamplesPerSec=21.894573967451244, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 24%|████████████████████████▍                                                                            | 136/561 [00:06<00:19, 21.63it/s] 25%|█████████████████████████                                                                            | 139/561 [00:06<00:18, 22.31it/s] 25%|█████████████████████████▌                                                                           | 142/561 [00:06<00:19, 21.17it/s] 26%|██████████████████████████                                                                           | 145/561 [00:06<00:19, 21.28it/s] 26%|██████████████████████████▋                                                                          | 148/561 [00:06<00:18, 21.75it/s] 27%|███████████████████████████▏                                                                         | 151/561 [00:07<00:18, 22.40it/s] 27%|███████████████████████████▋                                                                         | 154/561 [00:07<00:17, 22.67it/s] 28%|████████████████████████████▎                                                                        | 157/561 [00:07<00:17, 22.97it/s] 29%|████████████████████████████▊                                                                        | 160/561 [00:07<00:17, 23.21it/s] 29%|█████████████████████████████▎                                                                       | 163/561 [00:07<00:17, 23.35it/s] 30%|█████████████████████████████▉                                                                       | 166/561 [00:07<00:16, 23.54it/s] 30%|██████████████████████████████▍                                                                      | 169/561 [00:07<00:16, 23.60it/s] 31%|██████████████████████████████▉                                                                      | 172/561 [00:07<00:16, 23.71it/s] 31%|███████████████████████████████▌                                                                     | 175/561 [00:08<00:16, 23.74it/s] 32%|████████████████████████████████                                                                     | 178/561 [00:08<00:16, 23.70it/s] 32%|████████████████████████████████▌                                                                    | 181/561 [00:08<00:16, 23.23it/s][2025-03-28 01:34:43,948] [INFO] [logging.py:128:log_dist] [Rank 0] step=3550, skipped=8, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:34:43,949] [INFO] [timer.py:264:stop] epoch=0/micro_step=3550/global_step=3550, RunningAvgSamplesPerSec=20.23435952731982, CurrSamplesPerSec=21.36069103838074, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 33%|█████████████████████████████████▏                                                                   | 184/561 [00:08<00:16, 22.65it/s] 33%|█████████████████████████████████▋                                                                   | 187/561 [00:08<00:16, 22.40it/s] 34%|██████████████████████████████████▏                                                                  | 190/561 [00:08<00:16, 22.77it/s] 34%|██████████████████████████████████▋                                                                  | 193/561 [00:08<00:15, 23.11it/s] 35%|███████████████████████████████████▎                                                                 | 196/561 [00:09<00:15, 23.34it/s] 35%|███████████████████████████████████▊                                                                 | 199/561 [00:09<00:15, 23.48it/s] 36%|████████████████████████████████████▎                                                                | 202/561 [00:09<00:15, 23.58it/s] 37%|████████████████████████████████████▉                                                                | 205/561 [00:09<00:15, 23.69it/s] 37%|█████████████████████████████████████▍                                                               | 208/561 [00:09<00:14, 23.64it/s] 38%|█████████████████████████████████████▉                                                               | 211/561 [00:09<00:14, 23.42it/s] 38%|██████████████████████████████████████▌                                                              | 214/561 [00:09<00:15, 22.92it/s] 39%|███████████████████████████████████████                                                              | 217/561 [00:09<00:15, 22.39it/s] 39%|███████████████████████████████████████▌                                                             | 220/561 [00:10<00:15, 22.53it/s] 40%|████████████████████████████████████████▏                                                            | 223/561 [00:10<00:15, 22.20it/s] 40%|████████████████████████████████████████▋                                                            | 226/561 [00:10<00:15, 22.13it/s] 41%|█████████████████████████████████████████▏                                                           | 229/561 [00:10<00:15, 21.96it/s] 41%|█████████████████████████████████████████▊                                                           | 232/561 [00:10<00:14, 21.94it/s][2025-03-28 01:34:46,154] [INFO] [logging.py:128:log_dist] [Rank 0] step=3600, skipped=8, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:34:46,155] [INFO] [timer.py:264:stop] epoch=0/micro_step=3600/global_step=3600, RunningAvgSamplesPerSec=20.265243647500313, CurrSamplesPerSec=21.04146242034608, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 42%|██████████████████████████████████████████▎                                                          | 235/561 [00:10<00:14, 21.92it/s] 42%|██████████████████████████████████████████▊                                                          | 238/561 [00:10<00:14, 22.43it/s] 43%|███████████████████████████████████████████▍                                                         | 241/561 [00:10<00:14, 22.80it/s] 43%|███████████████████████████████████████████▉                                                         | 244/561 [00:11<00:13, 23.10it/s] 44%|████████████████████████████████████████████▍                                                        | 247/561 [00:11<00:13, 23.33it/s] 45%|█████████████████████████████████████████████                                                        | 250/561 [00:11<00:13, 23.13it/s] 45%|█████████████████████████████████████████████▌                                                       | 253/561 [00:11<00:13, 22.80it/s] 46%|██████████████████████████████████████████████                                                       | 256/561 [00:11<00:13, 22.73it/s] 46%|██████████████████████████████████████████████▋                                                      | 259/561 [00:11<00:13, 22.87it/s] 47%|███████████████████████████████████████████████▏                                                     | 262/561 [00:11<00:12, 23.23it/s] 47%|███████████████████████████████████████████████▋                                                     | 265/561 [00:12<00:12, 23.36it/s] 48%|████████████████████████████████████████████████▏                                                    | 268/561 [00:12<00:12, 23.36it/s] 48%|████████████████████████████████████████████████▊                                                    | 271/561 [00:12<00:12, 23.39it/s] 49%|█████████████████████████████████████████████████▎                                                   | 274/561 [00:12<00:12, 23.07it/s] 49%|█████████████████████████████████████████████████▊                                                   | 277/561 [00:12<00:12, 23.05it/s] 50%|██████████████████████████████████████████████████▍                                                  | 280/561 [00:12<00:12, 22.81it/s] 50%|██████████████████████████████████████████████████▉                                                  | 283/561 [00:12<00:12, 22.40it/s][2025-03-28 01:34:48,326] [INFO] [logging.py:128:log_dist] [Rank 0] step=3650, skipped=8, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:34:48,327] [INFO] [timer.py:264:stop] epoch=0/micro_step=3650/global_step=3650, RunningAvgSamplesPerSec=20.29919688281562, CurrSamplesPerSec=21.469044242719153, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 51%|███████████████████████████████████████████████████▍                                                 | 286/561 [00:12<00:12, 22.14it/s] 52%|████████████████████████████████████████████████████                                                 | 289/561 [00:13<00:12, 22.17it/s] 52%|████████████████████████████████████████████████████▌                                                | 292/561 [00:13<00:12, 22.19it/s] 53%|█████████████████████████████████████████████████████                                                | 295/561 [00:13<00:11, 22.28it/s] 53%|█████████████████████████████████████████████████████▋                                               | 298/561 [00:13<00:11, 22.50it/s] 54%|██████████████████████████████████████████████████████▏                                              | 301/561 [00:13<00:11, 22.72it/s] 54%|██████████████████████████████████████████████████████▋                                              | 304/561 [00:13<00:11, 22.49it/s] 55%|███████████████████████████████████████████████████████▎                                             | 307/561 [00:13<00:11, 22.48it/s] 55%|███████████████████████████████████████████████████████▊                                             | 310/561 [00:14<00:10, 23.04it/s] 56%|████████████████████████████████████████████████████████▎                                            | 313/561 [00:14<00:11, 22.19it/s] 56%|████████████████████████████████████████████████████████▉                                            | 316/561 [00:14<00:11, 22.05it/s] 57%|█████████████████████████████████████████████████████████▍                                           | 319/561 [00:14<00:10, 22.07it/s] 57%|█████████████████████████████████████████████████████████▉                                           | 322/561 [00:14<00:10, 22.07it/s] 58%|██████████████████████████████████████████████████████████▌                                          | 325/561 [00:14<00:10, 22.34it/s] 58%|███████████████████████████████████████████████████████████                                          | 328/561 [00:14<00:10, 22.81it/s] 59%|███████████████████████████████████████████████████████████▌                                         | 331/561 [00:14<00:09, 23.09it/s][2025-03-28 01:34:50,538] [INFO] [logging.py:128:log_dist] [Rank 0] step=3700, skipped=8, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:34:50,539] [INFO] [timer.py:264:stop] epoch=0/micro_step=3700/global_step=3700, RunningAvgSamplesPerSec=20.32791762419622, CurrSamplesPerSec=24.286198161552214, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 60%|████████████████████████████████████████████████████████████▏                                        | 334/561 [00:15<00:09, 23.29it/s] 60%|████████████████████████████████████████████████████████████▋                                        | 337/561 [00:15<00:09, 23.40it/s] 61%|█████████████████████████████████████████████████████████████▏                                       | 340/561 [00:15<00:09, 23.31it/s] 61%|█████████████████████████████████████████████████████████████▊                                       | 343/561 [00:15<00:10, 21.73it/s] 62%|██████████████████████████████████████████████████████████████▎                                      | 346/561 [00:15<00:09, 22.29it/s] 62%|██████████████████████████████████████████████████████████████▊                                      | 349/561 [00:15<00:09, 22.55it/s] 63%|███████████████████████████████████████████████████████████████▎                                     | 352/561 [00:15<00:09, 22.56it/s] 63%|███████████████████████████████████████████████████████████████▉                                     | 355/561 [00:16<00:09, 22.43it/s] 64%|████████████████████████████████████████████████████████████████▍                                    | 358/561 [00:16<00:09, 22.10it/s] 64%|████████████████████████████████████████████████████████████████▉                                    | 361/561 [00:16<00:09, 22.09it/s] 65%|█████████████████████████████████████████████████████████████████▌                                   | 364/561 [00:16<00:09, 21.13it/s] 65%|██████████████████████████████████████████████████████████████████                                   | 367/561 [00:16<00:09, 21.43it/s] 66%|██████████████████████████████████████████████████████████████████▌                                  | 370/561 [00:16<00:08, 21.60it/s] 66%|███████████████████████████████████████████████████████████████████▏                                 | 373/561 [00:16<00:08, 21.93it/s] 67%|███████████████████████████████████████████████████████████████████▋                                 | 376/561 [00:16<00:08, 21.90it/s] 68%|████████████████████████████████████████████████████████████████████▏                                | 379/561 [00:17<00:08, 21.90it/s] 68%|████████████████████████████████████████████████████████████████████▊                                | 382/561 [00:17<00:08, 21.90it/s][2025-03-28 01:34:52,821] [INFO] [logging.py:128:log_dist] [Rank 0] step=3750, skipped=8, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:34:52,821] [INFO] [timer.py:264:stop] epoch=0/micro_step=3750/global_step=3750, RunningAvgSamplesPerSec=20.348130509615608, CurrSamplesPerSec=21.06873172823154, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 69%|█████████████████████████████████████████████████████████████████████▎                               | 385/561 [00:17<00:08, 21.71it/s] 69%|█████████████████████████████████████████████████████████████████████▊                               | 388/561 [00:17<00:07, 21.87it/s] 70%|██████████████████████████████████████████████████████████████████████▍                              | 391/561 [00:17<00:07, 22.20it/s] 70%|██████████████████████████████████████████████████████████████████████▉                              | 394/561 [00:17<00:07, 21.82it/s] 71%|███████████████████████████████████████████████████████████████████████▍                             | 397/561 [00:17<00:07, 22.21it/s] 71%|████████████████████████████████████████████████████████████████████████                             | 400/561 [00:18<00:07, 22.20it/s] 72%|████████████████████████████████████████████████████████████████████████▌                            | 403/561 [00:18<00:07, 22.16it/s] 72%|█████████████████████████████████████████████████████████████████████████                            | 406/561 [00:18<00:07, 22.13it/s] 73%|█████████████████████████████████████████████████████████████████████████▋                           | 409/561 [00:18<00:06, 21.96it/s] 73%|██████████████████████████████████████████████████████████████████████████▏                          | 412/561 [00:18<00:06, 22.00it/s] 74%|██████████████████████████████████████████████████████████████████████████▋                          | 415/561 [00:18<00:06, 21.95it/s] 75%|███████████████████████████████████████████████████████████████████████████▎                         | 418/561 [00:18<00:06, 22.40it/s] 75%|███████████████████████████████████████████████████████████████████████████▊                         | 421/561 [00:19<00:06, 22.87it/s] 76%|████████████████████████████████████████████████████████████████████████████▎                        | 424/561 [00:19<00:05, 23.09it/s] 76%|████████████████████████████████████████████████████████████████████████████▉                        | 427/561 [00:19<00:05, 23.08it/s] 77%|█████████████████████████████████████████████████████████████████████████████▍                       | 430/561 [00:19<00:05, 23.25it/s] 77%|█████████████████████████████████████████████████████████████████████████████▉                       | 433/561 [00:19<00:05, 23.48it/s][2025-03-28 01:34:55,028] [INFO] [logging.py:128:log_dist] [Rank 0] step=3800, skipped=8, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:34:55,028] [INFO] [timer.py:264:stop] epoch=0/micro_step=3800/global_step=3800, RunningAvgSamplesPerSec=20.376077004879136, CurrSamplesPerSec=24.012018516494944, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 78%|██████████████████████████████████████████████████████████████████████████████▍                      | 436/561 [00:19<00:05, 22.95it/s] 78%|███████████████████████████████████████████████████████████████████████████████                      | 439/561 [00:19<00:05, 22.12it/s] 79%|███████████████████████████████████████████████████████████████████████████████▌                     | 442/561 [00:19<00:05, 22.17it/s] 79%|████████████████████████████████████████████████████████████████████████████████                     | 445/561 [00:20<00:05, 21.14it/s] 80%|████████████████████████████████████████████████████████████████████████████████▋                    | 448/561 [00:20<00:05, 21.52it/s] 80%|█████████████████████████████████████████████████████████████████████████████████▏                   | 451/561 [00:20<00:05, 21.54it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▋                   | 454/561 [00:20<00:04, 22.08it/s] 81%|██████████████████████████████████████████████████████████████████████████████████▎                  | 457/561 [00:20<00:04, 22.67it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▊                  | 460/561 [00:20<00:04, 22.78it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▎                 | 463/561 [00:20<00:04, 23.11it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▉                 | 466/561 [00:21<00:04, 22.99it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▍                | 469/561 [00:21<00:04, 22.72it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▉                | 472/561 [00:21<00:03, 22.46it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▌               | 475/561 [00:21<00:03, 22.35it/s] 85%|██████████████████████████████████████████████████████████████████████████████████████               | 478/561 [00:21<00:03, 22.30it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▌              | 481/561 [00:21<00:03, 22.37it/s][2025-03-28 01:34:57,284] [INFO] [logging.py:128:log_dist] [Rank 0] step=3850, skipped=8, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:34:57,285] [INFO] [timer.py:264:stop] epoch=0/micro_step=3850/global_step=3850, RunningAvgSamplesPerSec=20.398053198213592, CurrSamplesPerSec=22.216982452017298, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 86%|███████████████████████████████████████████████████████████████████████████████████████▏             | 484/561 [00:21<00:03, 22.42it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▋             | 487/561 [00:21<00:03, 21.45it/s] 87%|████████████████████████████████████████████████████████████████████████████████████████▏            | 490/561 [00:22<00:03, 21.59it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▊            | 493/561 [00:22<00:03, 21.74it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████████▎           | 496/561 [00:22<00:03, 21.56it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▊           | 499/561 [00:22<00:02, 21.66it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████▍          | 502/561 [00:22<00:02, 21.47it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▉          | 505/561 [00:22<00:02, 21.58it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▍         | 508/561 [00:22<00:02, 21.52it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▉         | 511/561 [00:23<00:02, 21.92it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████████▌        | 514/561 [00:23<00:02, 22.00it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████        | 517/561 [00:23<00:01, 22.21it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▌       | 520/561 [00:23<00:01, 22.26it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████████▏      | 523/561 [00:23<00:01, 22.77it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▋      | 526/561 [00:23<00:01, 22.94it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▏     | 529/561 [00:23<00:01, 22.94it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▊     | 532/561 [00:24<00:01, 22.59it/s][2025-03-28 01:34:59,575] [INFO] [logging.py:128:log_dist] [Rank 0] step=3900, skipped=8, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:34:59,576] [INFO] [timer.py:264:stop] epoch=0/micro_step=3900/global_step=3900, RunningAvgSamplesPerSec=20.41578440991631, CurrSamplesPerSec=15.612859272341804, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 95%|████████████████████████████████████████████████████████████████████████████████████████████████▎    | 535/561 [00:24<00:01, 21.20it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▊    | 538/561 [00:24<00:01, 20.37it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████▍   | 541/561 [00:24<00:00, 20.72it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████████▉   | 544/561 [00:24<00:00, 21.09it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▍  | 547/561 [00:24<00:00, 20.85it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████████  | 550/561 [00:24<00:00, 21.16it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▌ | 553/561 [00:25<00:00, 21.88it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████ | 556/561 [00:25<00:00, 22.41it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████████▋| 559/561 [00:25<00:00, 22.82it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:25<00:00, 22.09it/s]
  0%|                                                                                                               | 0/561 [00:00<?, ?it/s]  0%|▏                                                                                                      | 1/561 [00:00<03:42,  2.52it/s]  1%|▋                                                                                                      | 4/561 [00:00<01:03,  8.79it/s]  1%|█▎                                                                                                     | 7/561 [00:00<00:42, 13.00it/s]  2%|█▊                                                                                                    | 10/561 [00:00<00:34, 15.74it/s]  2%|██▎                                                                                                   | 13/561 [00:00<00:32, 16.95it/s]  3%|██▉                                                                                                   | 16/561 [00:01<00:29, 18.40it/s]  3%|███▍                                                                                                  | 19/561 [00:01<00:27, 19.59it/s]  4%|████                                                                                                  | 22/561 [00:01<00:26, 20.31it/s][2025-03-28 01:35:02,307] [INFO] [logging.py:128:log_dist] [Rank 0] step=3950, skipped=8, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:35:02,308] [INFO] [timer.py:264:stop] epoch=0/micro_step=3950/global_step=3950, RunningAvgSamplesPerSec=20.40086911622744, CurrSamplesPerSec=21.158861159308888, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
  4%|████▌                                                                                                 | 25/561 [00:01<00:26, 20.60it/s]  5%|█████                                                                                                 | 28/561 [00:01<00:25, 20.82it/s]  6%|█████▋                                                                                                | 31/561 [00:01<00:25, 21.06it/s]  6%|██████▏                                                                                               | 34/561 [00:01<00:24, 21.54it/s]  7%|██████▋                                                                                               | 37/561 [00:02<00:24, 21.83it/s]  7%|███████▎                                                                                              | 40/561 [00:02<00:24, 21.62it/s]  8%|███████▊                                                                                              | 43/561 [00:02<00:24, 21.36it/s]  8%|████████▎                                                                                             | 46/561 [00:02<00:23, 21.55it/s]  9%|████████▉                                                                                             | 49/561 [00:02<00:23, 21.65it/s]  9%|█████████▍                                                                                            | 52/561 [00:02<00:23, 21.22it/s] 10%|██████████                                                                                            | 55/561 [00:02<00:23, 21.52it/s] 10%|██████████▌                                                                                           | 58/561 [00:03<00:23, 21.84it/s] 11%|███████████                                                                                           | 61/561 [00:03<00:22, 22.50it/s] 11%|███████████▋                                                                                          | 64/561 [00:03<00:21, 22.72it/s] 12%|████████████▏                                                                                         | 67/561 [00:03<00:21, 22.84it/s] 12%|████████████▋                                                                                         | 70/561 [00:03<00:21, 22.66it/s][2025-03-28 01:35:04,575] [INFO] [logging.py:128:log_dist] [Rank 0] step=4000, skipped=8, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:35:04,576] [INFO] [timer.py:264:stop] epoch=0/micro_step=4000/global_step=4000, RunningAvgSamplesPerSec=20.42062521376635, CurrSamplesPerSec=21.73403759393086, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 13%|█████████████▎                                                                                        | 73/561 [00:03<00:21, 22.42it/s] 14%|█████████████▊                                                                                        | 76/561 [00:03<00:22, 21.85it/s] 14%|██████████████▎                                                                                       | 79/561 [00:03<00:22, 21.78it/s][2025-03-28 01:35:04,989] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
 15%|██████████████▉                                                                                       | 82/561 [00:04<00:21, 22.16it/s][2025-03-28 01:35:05,034] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
 15%|███████████████▍                                                                                      | 85/561 [00:04<00:22, 21.62it/s] 16%|████████████████                                                                                      | 88/561 [00:04<00:21, 21.68it/s] 16%|████████████████▌                                                                                     | 91/561 [00:04<00:21, 22.25it/s] 17%|█████████████████                                                                                     | 94/561 [00:04<00:20, 22.68it/s] 17%|█████████████████▋                                                                                    | 97/561 [00:04<00:20, 22.41it/s] 18%|██████████████████                                                                                   | 100/561 [00:04<00:20, 22.21it/s] 18%|██████████████████▌                                                                                  | 103/561 [00:05<00:20, 21.86it/s] 19%|███████████████████                                                                                  | 106/561 [00:05<00:20, 21.86it/s] 19%|███████████████████▌                                                                                 | 109/561 [00:05<00:20, 21.89it/s] 20%|████████████████████▏                                                                                | 112/561 [00:05<00:20, 22.25it/s] 20%|████████████████████▋                                                                                | 115/561 [00:05<00:19, 22.80it/s] 21%|█████████████████████▏                                                                               | 118/561 [00:05<00:19, 23.02it/s] 22%|█████████████████████▊                                                                               | 121/561 [00:05<00:18, 23.23it/s][2025-03-28 01:35:06,810] [INFO] [logging.py:128:log_dist] [Rank 0] step=4050, skipped=10, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:35:06,810] [INFO] [timer.py:264:stop] epoch=0/micro_step=4050/global_step=4050, RunningAvgSamplesPerSec=20.44330504588725, CurrSamplesPerSec=24.205048977171106, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 22%|██████████████████████▎                                                                              | 124/561 [00:05<00:18, 23.51it/s] 23%|██████████████████████▊                                                                              | 127/561 [00:06<00:18, 23.23it/s] 23%|███████████████████████▍                                                                             | 130/561 [00:06<00:18, 22.79it/s] 24%|███████████████████████▉                                                                             | 133/561 [00:06<00:19, 22.43it/s] 24%|████████████████████████▍                                                                            | 136/561 [00:06<00:19, 22.14it/s] 25%|█████████████████████████                                                                            | 139/561 [00:06<00:18, 22.33it/s] 25%|█████████████████████████▌                                                                           | 142/561 [00:06<00:19, 22.00it/s] 26%|██████████████████████████                                                                           | 145/561 [00:06<00:18, 22.11it/s] 26%|██████████████████████████▋                                                                          | 148/561 [00:07<00:18, 22.11it/s] 27%|███████████████████████████▏                                                                         | 151/561 [00:07<00:18, 22.05it/s] 27%|███████████████████████████▋                                                                         | 154/561 [00:07<00:18, 21.94it/s] 28%|████████████████████████████▎                                                                        | 157/561 [00:07<00:18, 21.96it/s] 29%|████████████████████████████▊                                                                        | 160/561 [00:07<00:18, 21.90it/s] 29%|█████████████████████████████▎                                                                       | 163/561 [00:07<00:18, 21.83it/s] 30%|█████████████████████████████▉                                                                       | 166/561 [00:07<00:18, 21.70it/s] 30%|██████████████████████████████▍                                                                      | 169/561 [00:08<00:17, 21.82it/s] 31%|██████████████████████████████▉                                                                      | 172/561 [00:08<00:17, 22.00it/s][2025-03-28 01:35:09,084] [INFO] [logging.py:128:log_dist] [Rank 0] step=4100, skipped=10, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:35:09,084] [INFO] [timer.py:264:stop] epoch=0/micro_step=4100/global_step=4100, RunningAvgSamplesPerSec=20.46147153648671, CurrSamplesPerSec=22.08200245010896, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 31%|███████████████████████████████▌                                                                     | 175/561 [00:08<00:17, 21.96it/s] 32%|████████████████████████████████                                                                     | 178/561 [00:08<00:17, 21.76it/s] 32%|████████████████████████████████▌                                                                    | 181/561 [00:08<00:17, 21.74it/s] 33%|█████████████████████████████████▏                                                                   | 184/561 [00:08<00:17, 22.15it/s] 33%|█████████████████████████████████▋                                                                   | 187/561 [00:08<00:16, 22.02it/s] 34%|██████████████████████████████████▏                                                                  | 190/561 [00:08<00:16, 22.06it/s] 34%|██████████████████████████████████▋                                                                  | 193/561 [00:09<00:16, 21.92it/s] 35%|███████████████████████████████████▎                                                                 | 196/561 [00:09<00:16, 22.35it/s] 35%|███████████████████████████████████▊                                                                 | 199/561 [00:09<00:15, 22.88it/s] 36%|████████████████████████████████████▎                                                                | 202/561 [00:09<00:15, 22.96it/s] 37%|████████████████████████████████████▉                                                                | 205/561 [00:09<00:15, 22.82it/s] 37%|█████████████████████████████████████▍                                                               | 208/561 [00:09<00:15, 22.65it/s] 38%|█████████████████████████████████████▉                                                               | 211/561 [00:09<00:15, 22.30it/s] 38%|██████████████████████████████████████▌                                                              | 214/561 [00:10<00:15, 22.24it/s] 39%|███████████████████████████████████████                                                              | 217/561 [00:10<00:15, 22.08it/s] 39%|███████████████████████████████████████▌                                                             | 220/561 [00:10<00:15, 22.12it/s][2025-03-28 01:35:11,330] [INFO] [logging.py:128:log_dist] [Rank 0] step=4150, skipped=10, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:35:11,331] [INFO] [timer.py:264:stop] epoch=0/micro_step=4150/global_step=4150, RunningAvgSamplesPerSec=20.482037280751538, CurrSamplesPerSec=22.15607291323833, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 40%|████████████████████████████████████████▏                                                            | 223/561 [00:10<00:15, 22.09it/s] 40%|████████████████████████████████████████▋                                                            | 226/561 [00:10<00:15, 22.13it/s] 41%|█████████████████████████████████████████▏                                                           | 229/561 [00:10<00:15, 22.12it/s] 41%|█████████████████████████████████████████▊                                                           | 232/561 [00:10<00:14, 22.13it/s] 42%|██████████████████████████████████████████▎                                                          | 235/561 [00:10<00:14, 22.54it/s] 42%|██████████████████████████████████████████▊                                                          | 238/561 [00:11<00:14, 22.82it/s] 43%|███████████████████████████████████████████▍                                                         | 241/561 [00:11<00:13, 23.09it/s] 43%|███████████████████████████████████████████▉                                                         | 244/561 [00:11<00:13, 23.25it/s] 44%|████████████████████████████████████████████▍                                                        | 247/561 [00:11<00:13, 23.43it/s] 45%|█████████████████████████████████████████████                                                        | 250/561 [00:11<00:14, 22.18it/s] 45%|█████████████████████████████████████████████▌                                                       | 253/561 [00:11<00:13, 22.13it/s] 46%|██████████████████████████████████████████████                                                       | 256/561 [00:11<00:13, 22.12it/s] 46%|██████████████████████████████████████████████▋                                                      | 259/561 [00:12<00:13, 22.21it/s] 47%|███████████████████████████████████████████████▏                                                     | 262/561 [00:12<00:13, 22.22it/s] 47%|███████████████████████████████████████████████▋                                                     | 265/561 [00:12<00:13, 22.34it/s] 48%|████████████████████████████████████████████████▏                                                    | 268/561 [00:12<00:13, 22.28it/s] 48%|████████████████████████████████████████████████▊                                                    | 271/561 [00:12<00:13, 21.83it/s][2025-03-28 01:35:13,562] [INFO] [logging.py:128:log_dist] [Rank 0] step=4200, skipped=10, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:35:13,563] [INFO] [timer.py:264:stop] epoch=0/micro_step=4200/global_step=4200, RunningAvgSamplesPerSec=20.50354724286207, CurrSamplesPerSec=23.487080991416768, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 49%|█████████████████████████████████████████████████▎                                                   | 274/561 [00:12<00:12, 22.26it/s] 49%|█████████████████████████████████████████████████▊                                                   | 277/561 [00:12<00:12, 22.66it/s] 50%|██████████████████████████████████████████████████▍                                                  | 280/561 [00:13<00:13, 21.50it/s] 50%|██████████████████████████████████████████████████▉                                                  | 283/561 [00:13<00:12, 21.50it/s] 51%|███████████████████████████████████████████████████▍                                                 | 286/561 [00:13<00:12, 21.73it/s] 52%|████████████████████████████████████████████████████                                                 | 289/561 [00:13<00:12, 21.77it/s] 52%|████████████████████████████████████████████████████▌                                                | 292/561 [00:13<00:12, 22.17it/s] 53%|█████████████████████████████████████████████████████                                                | 295/561 [00:13<00:11, 22.23it/s] 53%|█████████████████████████████████████████████████████▋                                               | 298/561 [00:13<00:11, 22.31it/s] 54%|██████████████████████████████████████████████████████▏                                              | 301/561 [00:13<00:11, 22.08it/s] 54%|██████████████████████████████████████████████████████▋                                              | 304/561 [00:14<00:11, 21.93it/s] 55%|███████████████████████████████████████████████████████▎                                             | 307/561 [00:14<00:11, 21.97it/s] 55%|███████████████████████████████████████████████████████▊                                             | 310/561 [00:14<00:11, 22.40it/s] 56%|████████████████████████████████████████████████████████▎                                            | 313/561 [00:14<00:10, 22.81it/s] 56%|████████████████████████████████████████████████████████▉                                            | 316/561 [00:14<00:10, 23.03it/s] 57%|█████████████████████████████████████████████████████████▍                                           | 319/561 [00:14<00:10, 23.40it/s] 57%|█████████████████████████████████████████████████████████▉                                           | 322/561 [00:14<00:10, 23.48it/s][2025-03-28 01:35:15,784] [INFO] [logging.py:128:log_dist] [Rank 0] step=4250, skipped=10, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:35:15,785] [INFO] [timer.py:264:stop] epoch=0/micro_step=4250/global_step=4250, RunningAvgSamplesPerSec=20.525570454257156, CurrSamplesPerSec=23.064357381294148, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 58%|██████████████████████████████████████████████████████████▌                                          | 325/561 [00:15<00:10, 22.31it/s] 58%|███████████████████████████████████████████████████████████                                          | 328/561 [00:15<00:10, 21.39it/s] 59%|███████████████████████████████████████████████████████████▌                                         | 331/561 [00:15<00:10, 21.63it/s] 60%|████████████████████████████████████████████████████████████▏                                        | 334/561 [00:15<00:10, 22.01it/s] 60%|████████████████████████████████████████████████████████████▋                                        | 337/561 [00:15<00:10, 22.14it/s] 61%|█████████████████████████████████████████████████████████████▏                                       | 340/561 [00:15<00:10, 22.01it/s] 61%|█████████████████████████████████████████████████████████████▊                                       | 343/561 [00:15<00:09, 22.08it/s] 62%|██████████████████████████████████████████████████████████████▎                                      | 346/561 [00:15<00:09, 22.09it/s] 62%|██████████████████████████████████████████████████████████████▊                                      | 349/561 [00:16<00:09, 22.00it/s] 63%|███████████████████████████████████████████████████████████████▎                                     | 352/561 [00:16<00:09, 21.82it/s] 63%|███████████████████████████████████████████████████████████████▉                                     | 355/561 [00:16<00:09, 21.92it/s] 64%|████████████████████████████████████████████████████████████████▍                                    | 358/561 [00:16<00:09, 22.00it/s] 64%|████████████████████████████████████████████████████████████████▉                                    | 361/561 [00:16<00:09, 21.64it/s] 65%|█████████████████████████████████████████████████████████████████▌                                   | 364/561 [00:16<00:09, 21.60it/s] 65%|██████████████████████████████████████████████████████████████████                                   | 367/561 [00:16<00:08, 21.58it/s] 66%|██████████████████████████████████████████████████████████████████▌                                  | 370/561 [00:17<00:08, 21.61it/s][2025-03-28 01:35:18,095] [INFO] [logging.py:128:log_dist] [Rank 0] step=4300, skipped=10, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:35:18,096] [INFO] [timer.py:264:stop] epoch=0/micro_step=4300/global_step=4300, RunningAvgSamplesPerSec=20.53844462674541, CurrSamplesPerSec=22.568562391849493, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 66%|███████████████████████████████████████████████████████████████████▏                                 | 373/561 [00:17<00:08, 21.86it/s] 67%|███████████████████████████████████████████████████████████████████▋                                 | 376/561 [00:17<00:08, 21.85it/s] 68%|████████████████████████████████████████████████████████████████████▏                                | 379/561 [00:17<00:08, 21.84it/s] 68%|████████████████████████████████████████████████████████████████████▊                                | 382/561 [00:17<00:08, 21.94it/s] 69%|█████████████████████████████████████████████████████████████████████▎                               | 385/561 [00:17<00:08, 21.06it/s] 69%|█████████████████████████████████████████████████████████████████████▊                               | 388/561 [00:17<00:08, 21.22it/s] 70%|██████████████████████████████████████████████████████████████████████▍                              | 391/561 [00:18<00:07, 21.38it/s] 70%|██████████████████████████████████████████████████████████████████████▉                              | 394/561 [00:18<00:07, 21.43it/s] 71%|███████████████████████████████████████████████████████████████████████▍                             | 397/561 [00:18<00:07, 21.67it/s] 71%|████████████████████████████████████████████████████████████████████████                             | 400/561 [00:18<00:07, 21.73it/s] 72%|████████████████████████████████████████████████████████████████████████▌                            | 403/561 [00:18<00:07, 21.87it/s] 72%|█████████████████████████████████████████████████████████████████████████                            | 406/561 [00:18<00:07, 21.36it/s] 73%|█████████████████████████████████████████████████████████████████████████▋                           | 409/561 [00:18<00:06, 21.76it/s] 73%|██████████████████████████████████████████████████████████████████████████▏                          | 412/561 [00:19<00:07, 20.82it/s] 74%|██████████████████████████████████████████████████████████████████████████▋                          | 415/561 [00:19<00:06, 21.24it/s] 75%|███████████████████████████████████████████████████████████████████████████▎                         | 418/561 [00:19<00:06, 21.35it/s] 75%|███████████████████████████████████████████████████████████████████████████▊                         | 421/561 [00:19<00:06, 21.48it/s][2025-03-28 01:35:20,430] [INFO] [logging.py:128:log_dist] [Rank 0] step=4350, skipped=10, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:35:20,431] [INFO] [timer.py:264:stop] epoch=0/micro_step=4350/global_step=4350, RunningAvgSamplesPerSec=20.548688970145996, CurrSamplesPerSec=20.592394020166104, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 76%|████████████████████████████████████████████████████████████████████████████▎                        | 424/561 [00:19<00:06, 21.46it/s] 76%|████████████████████████████████████████████████████████████████████████████▉                        | 427/561 [00:19<00:06, 22.20it/s] 77%|█████████████████████████████████████████████████████████████████████████████▍                       | 430/561 [00:19<00:05, 22.60it/s] 77%|█████████████████████████████████████████████████████████████████████████████▉                       | 433/561 [00:19<00:05, 23.01it/s] 78%|██████████████████████████████████████████████████████████████████████████████▍                      | 436/561 [00:20<00:05, 23.25it/s] 78%|███████████████████████████████████████████████████████████████████████████████                      | 439/561 [00:20<00:05, 23.56it/s] 79%|███████████████████████████████████████████████████████████████████████████████▌                     | 442/561 [00:20<00:05, 23.51it/s] 79%|████████████████████████████████████████████████████████████████████████████████                     | 445/561 [00:20<00:05, 22.95it/s] 80%|████████████████████████████████████████████████████████████████████████████████▋                    | 448/561 [00:20<00:04, 22.97it/s] 80%|█████████████████████████████████████████████████████████████████████████████████▏                   | 451/561 [00:20<00:04, 22.53it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▋                   | 454/561 [00:20<00:04, 22.10it/s] 81%|██████████████████████████████████████████████████████████████████████████████████▎                  | 457/561 [00:21<00:04, 21.90it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▊                  | 460/561 [00:21<00:04, 21.99it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▎                 | 463/561 [00:21<00:04, 22.60it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▉                 | 466/561 [00:21<00:04, 22.82it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▍                | 469/561 [00:21<00:04, 22.87it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▉                | 472/561 [00:21<00:03, 22.53it/s][2025-03-28 01:35:22,618] [INFO] [logging.py:128:log_dist] [Rank 0] step=4400, skipped=10, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:35:22,619] [INFO] [timer.py:264:stop] epoch=0/micro_step=4400/global_step=4400, RunningAvgSamplesPerSec=20.572843070106266, CurrSamplesPerSec=22.404130349113334, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 85%|█████████████████████████████████████████████████████████████████████████████████████▌               | 475/561 [00:21<00:03, 22.62it/s] 85%|██████████████████████████████████████████████████████████████████████████████████████               | 478/561 [00:21<00:03, 22.46it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▌              | 481/561 [00:22<00:03, 22.20it/s] 86%|███████████████████████████████████████████████████████████████████████████████████████▏             | 484/561 [00:22<00:03, 21.92it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▋             | 487/561 [00:22<00:03, 21.85it/s] 87%|████████████████████████████████████████████████████████████████████████████████████████▏            | 490/561 [00:22<00:03, 21.47it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▊            | 493/561 [00:22<00:03, 21.53it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████████▎           | 496/561 [00:22<00:02, 21.95it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▊           | 499/561 [00:22<00:02, 22.53it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████▍          | 502/561 [00:23<00:02, 22.90it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▉          | 505/561 [00:23<00:02, 23.06it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▍         | 508/561 [00:23<00:02, 23.41it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▉         | 511/561 [00:23<00:02, 23.55it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████████▌        | 514/561 [00:23<00:02, 23.50it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████        | 517/561 [00:23<00:01, 22.60it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▌       | 520/561 [00:23<00:01, 22.36it/s][2025-03-28 01:35:24,849] [INFO] [logging.py:128:log_dist] [Rank 0] step=4450, skipped=10, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:35:24,850] [INFO] [timer.py:264:stop] epoch=0/micro_step=4450/global_step=4450, RunningAvgSamplesPerSec=20.592325747118757, CurrSamplesPerSec=18.851889490183535, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 93%|██████████████████████████████████████████████████████████████████████████████████████████████▏      | 523/561 [00:23<00:01, 22.12it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▋      | 526/561 [00:24<00:01, 21.66it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▏     | 529/561 [00:24<00:01, 21.94it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▊     | 532/561 [00:24<00:01, 21.74it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████████▎    | 535/561 [00:24<00:01, 21.30it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▊    | 538/561 [00:24<00:01, 21.40it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████▍   | 541/561 [00:24<00:00, 21.72it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████████▉   | 544/561 [00:24<00:00, 22.08it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▍  | 547/561 [00:25<00:00, 20.97it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████████  | 550/561 [00:25<00:00, 21.28it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▌ | 553/561 [00:25<00:00, 21.47it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████ | 556/561 [00:25<00:00, 21.50it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████████▋| 559/561 [00:25<00:00, 21.75it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:25<00:00, 21.76it/s]
  0%|                                                                                                               | 0/561 [00:00<?, ?it/s]  0%|▏                                                                                                      | 1/561 [00:00<02:39,  3.52it/s]  1%|▋                                                                                                      | 4/561 [00:00<00:50, 11.00it/s]  1%|█▎                                                                                                     | 7/561 [00:00<00:37, 14.94it/s]  2%|█▊                                                                                                    | 10/561 [00:00<00:32, 17.16it/s][2025-03-28 01:35:27,481] [INFO] [logging.py:128:log_dist] [Rank 0] step=4500, skipped=10, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:35:27,482] [INFO] [timer.py:264:stop] epoch=0/micro_step=4500/global_step=4500, RunningAvgSamplesPerSec=20.586630740625246, CurrSamplesPerSec=20.92859604555698, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
  2%|██▎                                                                                                   | 13/561 [00:00<00:29, 18.51it/s]  3%|██▉                                                                                                   | 16/561 [00:00<00:28, 19.22it/s]  3%|███▍                                                                                                  | 19/561 [00:01<00:27, 19.73it/s]  4%|████                                                                                                  | 22/561 [00:01<00:27, 19.64it/s]  4%|████▌                                                                                                 | 25/561 [00:01<00:27, 19.72it/s]  5%|█████                                                                                                 | 28/561 [00:01<00:26, 19.96it/s]  6%|█████▋                                                                                                | 31/561 [00:01<00:26, 19.69it/s]  6%|██████▏                                                                                               | 34/561 [00:01<00:26, 19.94it/s]  7%|██████▋                                                                                               | 37/561 [00:02<00:25, 20.39it/s]  7%|███████▎                                                                                              | 40/561 [00:02<00:25, 20.55it/s]  8%|███████▊                                                                                              | 43/561 [00:02<00:24, 20.81it/s]  8%|████████▎                                                                                             | 46/561 [00:02<00:25, 20.39it/s]  9%|████████▉                                                                                             | 49/561 [00:02<00:25, 20.18it/s]  9%|█████████▍                                                                                            | 52/561 [00:02<00:25, 19.92it/s] 10%|█████████▊                                                                                            | 54/561 [00:02<00:25, 19.90it/s] 10%|██████████▏                                                                                           | 56/561 [00:02<00:25, 19.64it/s] 10%|██████████▌                                                                                           | 58/561 [00:03<00:26, 18.87it/s] 11%|██████████▉                                                                                           | 60/561 [00:03<00:26, 19.14it/s][2025-03-28 01:35:29,983] [INFO] [logging.py:128:log_dist] [Rank 0] step=4550, skipped=10, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:35:29,986] [INFO] [timer.py:264:stop] epoch=0/micro_step=4550/global_step=4550, RunningAvgSamplesPerSec=20.580177761013495, CurrSamplesPerSec=18.255137765292965, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 11%|███████████▎                                                                                          | 62/561 [00:03<00:26, 19.16it/s] 11%|███████████▋                                                                                          | 64/561 [00:03<00:26, 19.03it/s] 12%|████████████                                                                                          | 66/561 [00:03<00:25, 19.10it/s] 12%|████████████▎                                                                                         | 68/561 [00:03<00:25, 18.97it/s] 12%|████████████▋                                                                                         | 70/561 [00:03<00:26, 18.87it/s] 13%|█████████████                                                                                         | 72/561 [00:03<00:25, 18.81it/s] 13%|█████████████▍                                                                                        | 74/561 [00:03<00:25, 18.80it/s] 14%|█████████████▊                                                                                        | 76/561 [00:04<00:25, 18.76it/s] 14%|██████████████▏                                                                                       | 78/561 [00:04<00:25, 18.72it/s] 14%|██████████████▌                                                                                       | 80/561 [00:04<00:25, 18.68it/s] 15%|██████████████▉                                                                                       | 82/561 [00:04<00:25, 18.63it/s] 15%|███████████████▎                                                                                      | 84/561 [00:04<00:25, 18.63it/s] 15%|███████████████▋                                                                                      | 86/561 [00:04<00:25, 18.62it/s] 16%|████████████████                                                                                      | 88/561 [00:04<00:25, 18.61it/s] 16%|████████████████▌                                                                                     | 91/561 [00:04<00:23, 20.39it/s] 17%|█████████████████                                                                                     | 94/561 [00:04<00:21, 21.47it/s] 17%|█████████████████▋                                                                                    | 97/561 [00:05<00:21, 21.20it/s] 18%|██████████████████                                                                                   | 100/561 [00:05<00:22, 20.06it/s] 18%|██████████████████▌                                                                                  | 103/561 [00:05<00:23, 19.39it/s] 19%|██████████████████▉                                                                                  | 105/561 [00:05<00:23, 19.10it/s] 19%|███████████████████▎                                                                                 | 107/561 [00:05<00:24, 18.71it/s] 19%|███████████████████▌                                                                                 | 109/561 [00:05<00:24, 18.54it/s] 20%|███████████████████▉                                                                                 | 111/561 [00:05<00:24, 18.41it/s][2025-03-28 01:35:32,603] [INFO] [logging.py:128:log_dist] [Rank 0] step=4600, skipped=10, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:35:32,607] [INFO] [timer.py:264:stop] epoch=0/micro_step=4600/global_step=4600, RunningAvgSamplesPerSec=20.56313765150816, CurrSamplesPerSec=18.102445781242714, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 20%|████████████████████▎                                                                                | 113/561 [00:05<00:24, 18.31it/s] 20%|████████████████████▋                                                                                | 115/561 [00:06<00:24, 18.37it/s] 21%|█████████████████████▏                                                                               | 118/561 [00:06<00:21, 20.20it/s] 22%|█████████████████████▊                                                                               | 121/561 [00:06<00:20, 21.20it/s] 22%|██████████████████████▎                                                                              | 124/561 [00:06<00:19, 22.11it/s] 23%|██████████████████████▊                                                                              | 127/561 [00:06<00:19, 22.49it/s] 23%|███████████████████████▍                                                                             | 130/561 [00:06<00:18, 22.69it/s] 24%|███████████████████████▉                                                                             | 133/561 [00:06<00:18, 22.61it/s] 24%|████████████████████████▍                                                                            | 136/561 [00:06<00:19, 22.34it/s] 25%|█████████████████████████                                                                            | 139/561 [00:07<00:19, 21.76it/s] 25%|█████████████████████████▌                                                                           | 142/561 [00:07<00:19, 21.99it/s] 26%|██████████████████████████                                                                           | 145/561 [00:07<00:18, 21.91it/s] 26%|██████████████████████████▋                                                                          | 148/561 [00:07<00:18, 21.88it/s] 27%|███████████████████████████▏                                                                         | 151/561 [00:07<00:18, 22.09it/s] 27%|███████████████████████████▋                                                                         | 154/561 [00:07<00:18, 22.28it/s] 28%|████████████████████████████▎                                                                        | 157/561 [00:07<00:18, 22.27it/s] 29%|████████████████████████████▊                                                                        | 160/561 [00:08<00:17, 22.61it/s][2025-03-28 01:35:34,844] [INFO] [logging.py:128:log_dist] [Rank 0] step=4650, skipped=10, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:35:34,844] [INFO] [timer.py:264:stop] epoch=0/micro_step=4650/global_step=4650, RunningAvgSamplesPerSec=20.581328541882968, CurrSamplesPerSec=23.13394283104367, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 29%|█████████████████████████████▎                                                                       | 163/561 [00:08<00:17, 22.86it/s] 30%|█████████████████████████████▉                                                                       | 166/561 [00:08<00:17, 23.21it/s] 30%|██████████████████████████████▍                                                                      | 169/561 [00:08<00:16, 23.46it/s] 31%|██████████████████████████████▉                                                                      | 172/561 [00:08<00:16, 23.51it/s] 31%|███████████████████████████████▌                                                                     | 175/561 [00:08<00:16, 23.49it/s] 32%|████████████████████████████████                                                                     | 178/561 [00:08<00:16, 23.53it/s] 32%|████████████████████████████████▌                                                                    | 181/561 [00:08<00:16, 23.45it/s] 33%|█████████████████████████████████▏                                                                   | 184/561 [00:09<00:16, 23.51it/s] 33%|█████████████████████████████████▋                                                                   | 187/561 [00:09<00:16, 23.14it/s] 34%|██████████████████████████████████▏                                                                  | 190/561 [00:09<00:16, 22.03it/s] 34%|██████████████████████████████████▋                                                                  | 193/561 [00:09<00:16, 21.80it/s] 35%|███████████████████████████████████▎                                                                 | 196/561 [00:09<00:16, 21.83it/s] 35%|███████████████████████████████████▊                                                                 | 199/561 [00:09<00:16, 21.84it/s] 36%|████████████████████████████████████▎                                                                | 202/561 [00:09<00:16, 21.85it/s] 37%|████████████████████████████████████▉                                                                | 205/561 [00:10<00:16, 21.68it/s] 37%|█████████████████████████████████████▍                                                               | 208/561 [00:10<00:16, 21.78it/s] 38%|█████████████████████████████████████▉                                                               | 211/561 [00:10<00:16, 21.83it/s][2025-03-28 01:35:37,068] [INFO] [logging.py:128:log_dist] [Rank 0] step=4700, skipped=10, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:35:37,069] [INFO] [timer.py:264:stop] epoch=0/micro_step=4700/global_step=4700, RunningAvgSamplesPerSec=20.60028781715673, CurrSamplesPerSec=23.320579296085494, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 38%|██████████████████████████████████████▌                                                              | 214/561 [00:10<00:15, 21.95it/s] 39%|███████████████████████████████████████                                                              | 217/561 [00:10<00:15, 21.83it/s] 39%|███████████████████████████████████████▌                                                             | 220/561 [00:10<00:15, 22.08it/s] 40%|████████████████████████████████████████▏                                                            | 223/561 [00:10<00:15, 21.38it/s] 40%|████████████████████████████████████████▋                                                            | 226/561 [00:11<00:15, 21.23it/s] 41%|█████████████████████████████████████████▏                                                           | 229/561 [00:11<00:15, 21.24it/s] 41%|█████████████████████████████████████████▊                                                           | 232/561 [00:11<00:15, 21.48it/s] 42%|██████████████████████████████████████████▎                                                          | 235/561 [00:11<00:14, 21.75it/s] 42%|██████████████████████████████████████████▊                                                          | 238/561 [00:11<00:14, 21.86it/s] 43%|███████████████████████████████████████████▍                                                         | 241/561 [00:11<00:14, 21.97it/s] 43%|███████████████████████████████████████████▉                                                         | 244/561 [00:11<00:14, 21.83it/s] 44%|████████████████████████████████████████████▍                                                        | 247/561 [00:12<00:14, 21.48it/s] 45%|█████████████████████████████████████████████                                                        | 250/561 [00:12<00:14, 21.45it/s] 45%|█████████████████████████████████████████████▌                                                       | 253/561 [00:12<00:14, 21.49it/s] 46%|██████████████████████████████████████████████                                                       | 256/561 [00:12<00:14, 21.45it/s] 46%|██████████████████████████████████████████████▋                                                      | 259/561 [00:12<00:14, 20.65it/s][2025-03-28 01:35:39,414] [INFO] [logging.py:128:log_dist] [Rank 0] step=4750, skipped=10, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:35:39,415] [INFO] [timer.py:264:stop] epoch=0/micro_step=4750/global_step=4750, RunningAvgSamplesPerSec=20.60810360183158, CurrSamplesPerSec=22.702323053865836, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 47%|███████████████████████████████████████████████▏                                                     | 262/561 [00:12<00:14, 20.67it/s] 47%|███████████████████████████████████████████████▋                                                     | 265/561 [00:12<00:14, 20.87it/s] 48%|████████████████████████████████████████████████▏                                                    | 268/561 [00:13<00:14, 20.73it/s] 48%|████████████████████████████████████████████████▊                                                    | 271/561 [00:13<00:14, 20.63it/s] 49%|█████████████████████████████████████████████████▎                                                   | 274/561 [00:13<00:13, 20.84it/s] 49%|█████████████████████████████████████████████████▊                                                   | 277/561 [00:13<00:13, 20.87it/s] 50%|██████████████████████████████████████████████████▍                                                  | 280/561 [00:13<00:13, 20.38it/s] 50%|██████████████████████████████████████████████████▉                                                  | 283/561 [00:13<00:13, 20.38it/s] 51%|███████████████████████████████████████████████████▍                                                 | 286/561 [00:13<00:13, 20.42it/s] 52%|████████████████████████████████████████████████████                                                 | 289/561 [00:14<00:13, 20.23it/s] 52%|████████████████████████████████████████████████████▌                                                | 292/561 [00:14<00:13, 20.35it/s] 53%|█████████████████████████████████████████████████████                                                | 295/561 [00:14<00:13, 19.95it/s] 53%|█████████████████████████████████████████████████████▍                                               | 297/561 [00:14<00:13, 19.64it/s] 53%|█████████████████████████████████████████████████████▊                                               | 299/561 [00:14<00:13, 19.35it/s] 54%|██████████████████████████████████████████████████████▏                                              | 301/561 [00:14<00:13, 19.50it/s] 54%|██████████████████████████████████████████████████████▋                                              | 304/561 [00:14<00:13, 19.76it/s] 55%|███████████████████████████████████████████████████████                                              | 306/561 [00:14<00:13, 19.52it/s] 55%|███████████████████████████████████████████████████████▍                                             | 308/561 [00:15<00:13, 19.28it/s] 55%|███████████████████████████████████████████████████████▉                                             | 311/561 [00:15<00:12, 19.50it/s][2025-03-28 01:35:41,911] [INFO] [logging.py:128:log_dist] [Rank 0] step=4800, skipped=10, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:35:41,914] [INFO] [timer.py:264:stop] epoch=0/micro_step=4800/global_step=4800, RunningAvgSamplesPerSec=20.60210660218522, CurrSamplesPerSec=20.12050374656714, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 56%|████████████████████████████████████████████████████████▎                                            | 313/561 [00:15<00:12, 19.50it/s] 56%|████████████████████████████████████████████████████████▋                                            | 315/561 [00:15<00:12, 19.14it/s] 57%|█████████████████████████████████████████████████████████                                            | 317/561 [00:15<00:12, 19.04it/s] 57%|█████████████████████████████████████████████████████████▍                                           | 319/561 [00:15<00:12, 18.98it/s] 57%|█████████████████████████████████████████████████████████▊                                           | 321/561 [00:15<00:12, 18.99it/s] 58%|██████████████████████████████████████████████████████████▏                                          | 323/561 [00:15<00:12, 19.06it/s] 58%|██████████████████████████████████████████████████████████▌                                          | 325/561 [00:15<00:12, 18.78it/s] 58%|██████████████████████████████████████████████████████████▊                                          | 327/561 [00:16<00:12, 18.92it/s] 59%|███████████████████████████████████████████████████████████▏                                         | 329/561 [00:16<00:12, 18.96it/s] 59%|███████████████████████████████████████████████████████████▌                                         | 331/561 [00:16<00:12, 19.02it/s] 59%|███████████████████████████████████████████████████████████▉                                         | 333/561 [00:16<00:11, 19.05it/s] 60%|████████████████████████████████████████████████████████████▎                                        | 335/561 [00:16<00:12, 18.40it/s] 60%|████████████████████████████████████████████████████████████▋                                        | 337/561 [00:16<00:12, 18.57it/s] 60%|█████████████████████████████████████████████████████████████                                        | 339/561 [00:16<00:11, 18.67it/s] 61%|█████████████████████████████████████████████████████████████▍                                       | 341/561 [00:16<00:11, 18.75it/s] 61%|█████████████████████████████████████████████████████████████▊                                       | 343/561 [00:16<00:11, 18.70it/s] 61%|██████████████████████████████████████████████████████████████                                       | 345/561 [00:16<00:11, 18.75it/s] 62%|██████████████████████████████████████████████████████████████▍                                      | 347/561 [00:17<00:11, 18.51it/s] 62%|██████████████████████████████████████████████████████████████▊                                      | 349/561 [00:17<00:11, 18.62it/s] 63%|███████████████████████████████████████████████████████████████▏                                     | 351/561 [00:17<00:11, 18.91it/s] 63%|███████████████████████████████████████████████████████████████▌                                     | 353/561 [00:17<00:11, 18.89it/s] 63%|███████████████████████████████████████████████████████████████▉                                     | 355/561 [00:17<00:10, 18.84it/s] 64%|████████████████████████████████████████████████████████████████▎                                    | 357/561 [00:17<00:10, 19.01it/s] 64%|████████████████████████████████████████████████████████████████▋                                    | 359/561 [00:17<00:10, 18.86it/s] 64%|████████████████████████████████████████████████████████████████▉                                    | 361/561 [00:17<00:10, 18.87it/s][2025-03-28 01:35:44,573] [INFO] [logging.py:128:log_dist] [Rank 0] step=4850, skipped=10, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:35:44,577] [INFO] [timer.py:264:stop] epoch=0/micro_step=4850/global_step=4850, RunningAvgSamplesPerSec=20.582093794239917, CurrSamplesPerSec=18.792341789010454, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 65%|█████████████████████████████████████████████████████████████████▎                                   | 363/561 [00:17<00:10, 18.88it/s] 65%|█████████████████████████████████████████████████████████████████▋                                   | 365/561 [00:18<00:10, 18.99it/s] 65%|██████████████████████████████████████████████████████████████████                                   | 367/561 [00:18<00:10, 18.83it/s] 66%|██████████████████████████████████████████████████████████████████▍                                  | 369/561 [00:18<00:10, 18.73it/s] 66%|██████████████████████████████████████████████████████████████████▊                                  | 371/561 [00:18<00:10, 18.78it/s] 66%|███████████████████████████████████████████████████████████████████▏                                 | 373/561 [00:18<00:10, 18.57it/s] 67%|███████████████████████████████████████████████████████████████████▌                                 | 375/561 [00:18<00:10, 18.56it/s] 67%|███████████████████████████████████████████████████████████████████▊                                 | 377/561 [00:18<00:09, 18.76it/s] 68%|████████████████████████████████████████████████████████████████████▏                                | 379/561 [00:18<00:09, 18.85it/s] 68%|████████████████████████████████████████████████████████████████████▌                                | 381/561 [00:18<00:09, 18.79it/s] 68%|████████████████████████████████████████████████████████████████████▉                                | 383/561 [00:19<00:09, 18.80it/s] 69%|█████████████████████████████████████████████████████████████████████▎                               | 385/561 [00:19<00:09, 18.93it/s] 69%|█████████████████████████████████████████████████████████████████████▋                               | 387/561 [00:19<00:09, 18.75it/s] 69%|██████████████████████████████████████████████████████████████████████                               | 389/561 [00:19<00:09, 18.58it/s] 70%|██████████████████████████████████████████████████████████████████████▍                              | 391/561 [00:19<00:09, 18.76it/s] 70%|██████████████████████████████████████████████████████████████████████▊                              | 393/561 [00:19<00:08, 18.95it/s] 70%|███████████████████████████████████████████████████████████████████████                              | 395/561 [00:19<00:08, 18.70it/s] 71%|███████████████████████████████████████████████████████████████████████▍                             | 397/561 [00:19<00:08, 18.83it/s] 71%|███████████████████████████████████████████████████████████████████████▊                             | 399/561 [00:19<00:08, 18.87it/s] 71%|████████████████████████████████████████████████████████████████████████▏                            | 401/561 [00:19<00:08, 18.88it/s] 72%|████████████████████████████████████████████████████████████████████████▌                            | 403/561 [00:20<00:08, 18.84it/s] 72%|████████████████████████████████████████████████████████████████████████▉                            | 405/561 [00:20<00:08, 18.65it/s] 73%|█████████████████████████████████████████████████████████████████████████▎                           | 407/561 [00:20<00:08, 18.57it/s] 73%|█████████████████████████████████████████████████████████████████████████▋                           | 409/561 [00:20<00:08, 18.79it/s] 73%|█████████████████████████████████████████████████████████████████████████▉                           | 411/561 [00:20<00:07, 18.95it/s][2025-03-28 01:35:47,233] [INFO] [logging.py:128:log_dist] [Rank 0] step=4900, skipped=10, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:35:47,236] [INFO] [timer.py:264:stop] epoch=0/micro_step=4900/global_step=4900, RunningAvgSamplesPerSec=20.56275674542907, CurrSamplesPerSec=19.2958496684849, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 74%|██████████████████████████████████████████████████████████████████████████▎                          | 413/561 [00:20<00:07, 19.05it/s] 74%|██████████████████████████████████████████████████████████████████████████▋                          | 415/561 [00:20<00:07, 19.09it/s] 75%|███████████████████████████████████████████████████████████████████████████▎                         | 418/561 [00:20<00:07, 19.28it/s] 75%|███████████████████████████████████████████████████████████████████████████▌                         | 420/561 [00:20<00:07, 19.08it/s] 75%|███████████████████████████████████████████████████████████████████████████▉                         | 422/561 [00:21<00:07, 19.19it/s] 76%|████████████████████████████████████████████████████████████████████████████▎                        | 424/561 [00:21<00:07, 19.15it/s] 76%|████████████████████████████████████████████████████████████████████████████▋                        | 426/561 [00:21<00:07, 19.09it/s] 76%|█████████████████████████████████████████████████████████████████████████████▏                       | 429/561 [00:21<00:06, 19.34it/s] 77%|█████████████████████████████████████████████████████████████████████████████▌                       | 431/561 [00:21<00:06, 19.21it/s] 77%|█████████████████████████████████████████████████████████████████████████████▉                       | 433/561 [00:21<00:06, 19.11it/s] 78%|██████████████████████████████████████████████████████████████████████████████▎                      | 435/561 [00:21<00:06, 19.15it/s] 78%|██████████████████████████████████████████████████████████████████████████████▋                      | 437/561 [00:21<00:06, 19.01it/s] 78%|███████████████████████████████████████████████████████████████████████████████                      | 439/561 [00:21<00:06, 18.90it/s] 79%|███████████████████████████████████████████████████████████████████████████████▍                     | 441/561 [00:22<00:06, 18.79it/s] 79%|███████████████████████████████████████████████████████████████████████████████▊                     | 443/561 [00:22<00:06, 18.69it/s] 79%|████████████████████████████████████████████████████████████████████████████████                     | 445/561 [00:22<00:06, 18.61it/s] 80%|████████████████████████████████████████████████████████████████████████████████▍                    | 447/561 [00:22<00:06, 18.56it/s] 80%|████████████████████████████████████████████████████████████████████████████████▊                    | 449/561 [00:22<00:06, 18.50it/s] 80%|█████████████████████████████████████████████████████████████████████████████████▏                   | 451/561 [00:22<00:05, 18.38it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▌                   | 453/561 [00:22<00:05, 18.39it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▉                   | 455/561 [00:22<00:05, 18.39it/s] 81%|██████████████████████████████████████████████████████████████████████████████████▎                  | 457/561 [00:22<00:05, 18.33it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▋                  | 459/561 [00:23<00:05, 18.25it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▉                  | 461/561 [00:23<00:05, 18.20it/s][2025-03-28 01:35:49,902] [INFO] [logging.py:128:log_dist] [Rank 0] step=4950, skipped=10, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:35:49,905] [INFO] [timer.py:264:stop] epoch=0/micro_step=4950/global_step=4950, RunningAvgSamplesPerSec=20.543026714943416, CurrSamplesPerSec=18.129127181965845, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 83%|███████████████████████████████████████████████████████████████████████████████████▎                 | 463/561 [00:23<00:05, 18.14it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▋                 | 465/561 [00:23<00:05, 18.25it/s] 83%|████████████████████████████████████████████████████████████████████████████████████                 | 467/561 [00:23<00:05, 18.34it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▍                | 469/561 [00:23<00:04, 18.49it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▊                | 471/561 [00:23<00:04, 18.67it/s] 84%|█████████████████████████████████████████████████████████████████████████████████████▏               | 473/561 [00:23<00:04, 18.74it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▌               | 475/561 [00:23<00:04, 18.55it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▉               | 477/561 [00:24<00:04, 18.56it/s] 85%|██████████████████████████████████████████████████████████████████████████████████████▏              | 479/561 [00:24<00:04, 18.62it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▌              | 481/561 [00:24<00:04, 17.99it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▉              | 483/561 [00:24<00:04, 18.36it/s] 86%|███████████████████████████████████████████████████████████████████████████████████████▎             | 485/561 [00:24<00:04, 18.24it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▋             | 487/561 [00:24<00:04, 18.42it/s] 87%|████████████████████████████████████████████████████████████████████████████████████████             | 489/561 [00:24<00:03, 18.29it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▍            | 491/561 [00:24<00:03, 18.34it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▊            | 493/561 [00:24<00:03, 18.41it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████████            | 495/561 [00:25<00:03, 18.48it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▍           | 497/561 [00:25<00:03, 18.36it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▊           | 499/561 [00:25<00:03, 18.40it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████▏          | 501/561 [00:25<00:03, 18.45it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▌          | 503/561 [00:25<00:03, 18.81it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▉          | 505/561 [00:25<00:02, 18.86it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████████▎         | 507/561 [00:25<00:02, 18.95it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▋         | 509/561 [00:25<00:02, 18.94it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▉         | 511/561 [00:25<00:02, 18.85it/s][2025-03-28 01:35:52,597] [INFO] [logging.py:128:log_dist] [Rank 0] step=5000, skipped=10, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:35:52,600] [INFO] [timer.py:264:stop] epoch=0/micro_step=5000/global_step=5000, RunningAvgSamplesPerSec=20.521526186879864, CurrSamplesPerSec=17.791910406124664, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 91%|████████████████████████████████████████████████████████████████████████████████████████████▎        | 513/561 [00:25<00:02, 18.84it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████████▋        | 515/561 [00:26<00:02, 18.75it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████        | 517/561 [00:26<00:02, 19.01it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▍       | 519/561 [00:26<00:02, 19.06it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▊       | 521/561 [00:26<00:02, 18.92it/s][2025-03-28 01:35:53,167] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2025-03-28 01:35:53,208] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
 93%|██████████████████████████████████████████████████████████████████████████████████████████████▎      | 524/561 [00:26<00:01, 19.96it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▋      | 526/561 [00:26<00:01, 19.44it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████      | 528/561 [00:26<00:01, 19.29it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▍     | 530/561 [00:26<00:01, 19.02it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▊     | 532/561 [00:26<00:01, 18.88it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████████▏    | 534/561 [00:27<00:01, 19.05it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▍    | 536/561 [00:27<00:01, 19.06it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▊    | 538/561 [00:27<00:01, 19.06it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████▏   | 540/561 [00:27<00:01, 19.06it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████████▌   | 542/561 [00:27<00:01, 18.95it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████████▉   | 544/561 [00:27<00:00, 19.14it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████████▎  | 546/561 [00:27<00:00, 18.91it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▋  | 548/561 [00:27<00:00, 18.81it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████████  | 550/561 [00:27<00:00, 18.60it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████████▍ | 552/561 [00:28<00:00, 18.56it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▋ | 554/561 [00:28<00:00, 18.56it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████ | 556/561 [00:28<00:00, 18.54it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████▍| 558/561 [00:28<00:00, 18.50it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████████▊| 560/561 [00:28<00:00, 18.47it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:28<00:00, 19.64it/s]
  0%|                                                                                                               | 0/561 [00:00<?, ?it/s][2025-03-28 01:35:55,460] [INFO] [logging.py:128:log_dist] [Rank 0] step=5050, skipped=12, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:35:55,463] [INFO] [timer.py:264:stop] epoch=0/micro_step=5050/global_step=5050, RunningAvgSamplesPerSec=20.498518810330076, CurrSamplesPerSec=7.7648111166639655, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
  0%|▏                                                                                                      | 1/561 [00:00<01:45,  5.30it/s]  1%|▌                                                                                                      | 3/561 [00:00<00:49, 11.20it/s]  1%|▉                                                                                                      | 5/561 [00:00<00:40, 13.77it/s]  1%|█▎                                                                                                     | 7/561 [00:00<00:35, 15.53it/s]  2%|█▋                                                                                                     | 9/561 [00:00<00:33, 16.51it/s]  2%|██                                                                                                    | 11/561 [00:00<00:31, 17.52it/s]  2%|██▎                                                                                                   | 13/561 [00:00<00:30, 17.91it/s]  3%|██▋                                                                                                   | 15/561 [00:00<00:30, 18.08it/s]  3%|███                                                                                                   | 17/561 [00:01<00:29, 18.34it/s]  3%|███▍                                                                                                  | 19/561 [00:01<00:28, 18.71it/s]  4%|███▊                                                                                                  | 21/561 [00:01<00:28, 18.71it/s]  4%|████▎                                                                                                 | 24/561 [00:01<00:27, 19.27it/s]  5%|████▋                                                                                                 | 26/561 [00:01<00:27, 19.14it/s]  5%|█████                                                                                                 | 28/561 [00:01<00:27, 19.07it/s]  5%|█████▍                                                                                                | 30/561 [00:01<00:27, 19.00it/s]  6%|█████▊                                                                                                | 32/561 [00:01<00:27, 18.96it/s]  6%|██████▏                                                                                               | 34/561 [00:01<00:27, 18.96it/s]  6%|██████▌                                                                                               | 36/561 [00:02<00:27, 18.95it/s]  7%|██████▉                                                                                               | 38/561 [00:02<00:27, 18.93it/s]  7%|███████▎                                                                                              | 40/561 [00:02<00:27, 18.93it/s]  7%|███████▋                                                                                              | 42/561 [00:02<00:27, 18.88it/s]  8%|████████                                                                                              | 44/561 [00:02<00:28, 18.27it/s]  8%|████████▎                                                                                             | 46/561 [00:02<00:27, 18.58it/s]  9%|████████▋                                                                                             | 48/561 [00:02<00:27, 18.57it/s]  9%|█████████                                                                                             | 50/561 [00:02<00:27, 18.71it/s][2025-03-28 01:35:58,121] [INFO] [logging.py:128:log_dist] [Rank 0] step=5100, skipped=12, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:35:58,125] [INFO] [timer.py:264:stop] epoch=0/micro_step=5100/global_step=5100, RunningAvgSamplesPerSec=20.480717090623354, CurrSamplesPerSec=17.727839908914827, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
  9%|█████████▍                                                                                            | 52/561 [00:02<00:27, 18.46it/s] 10%|█████████▊                                                                                            | 54/561 [00:03<00:27, 18.44it/s] 10%|██████████▏                                                                                           | 56/561 [00:03<00:27, 18.49it/s] 10%|██████████▌                                                                                           | 58/561 [00:03<00:27, 18.42it/s] 11%|██████████▉                                                                                           | 60/561 [00:03<00:27, 18.40it/s] 11%|███████████▎                                                                                          | 62/561 [00:03<00:26, 18.56it/s] 11%|███████████▋                                                                                          | 64/561 [00:03<00:27, 18.33it/s] 12%|████████████                                                                                          | 66/561 [00:03<00:27, 18.25it/s] 12%|████████████▎                                                                                         | 68/561 [00:03<00:27, 18.24it/s] 12%|████████████▋                                                                                         | 70/561 [00:03<00:26, 18.19it/s] 13%|█████████████                                                                                         | 72/561 [00:03<00:26, 18.38it/s] 13%|█████████████▍                                                                                        | 74/561 [00:04<00:26, 18.44it/s] 14%|█████████████▊                                                                                        | 76/561 [00:04<00:26, 18.50it/s] 14%|██████████████▏                                                                                       | 78/561 [00:04<00:25, 18.58it/s] 14%|██████████████▌                                                                                       | 80/561 [00:04<00:26, 18.38it/s] 15%|██████████████▉                                                                                       | 82/561 [00:04<00:25, 18.45it/s] 15%|███████████████▎                                                                                      | 84/561 [00:04<00:25, 18.46it/s] 15%|███████████████▋                                                                                      | 86/561 [00:04<00:25, 18.46it/s] 16%|████████████████                                                                                      | 88/561 [00:04<00:25, 18.42it/s] 16%|████████████████▎                                                                                     | 90/561 [00:04<00:25, 18.44it/s] 16%|████████████████▋                                                                                     | 92/561 [00:05<00:25, 18.29it/s] 17%|█████████████████                                                                                     | 94/561 [00:05<00:25, 18.36it/s] 17%|█████████████████▍                                                                                    | 96/561 [00:05<00:25, 18.39it/s] 17%|█████████████████▊                                                                                    | 98/561 [00:05<00:25, 18.23it/s] 18%|██████████████████                                                                                   | 100/561 [00:05<00:25, 18.28it/s][2025-03-28 01:36:00,844] [INFO] [logging.py:128:log_dist] [Rank 0] step=5150, skipped=12, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:36:00,847] [INFO] [timer.py:264:stop] epoch=0/micro_step=5150/global_step=5150, RunningAvgSamplesPerSec=20.458381973163117, CurrSamplesPerSec=18.44467397009692, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 18%|██████████████████▎                                                                                  | 102/561 [00:05<00:25, 18.28it/s] 19%|██████████████████▋                                                                                  | 104/561 [00:05<00:24, 18.29it/s] 19%|███████████████████                                                                                  | 106/561 [00:05<00:24, 18.36it/s] 19%|███████████████████▍                                                                                 | 108/561 [00:05<00:24, 18.44it/s] 20%|███████████████████▊                                                                                 | 110/561 [00:06<00:24, 18.36it/s] 20%|████████████████████▏                                                                                | 112/561 [00:06<00:24, 18.47it/s] 20%|████████████████████▌                                                                                | 114/561 [00:06<00:24, 18.29it/s] 21%|████████████████████▉                                                                                | 116/561 [00:06<00:23, 18.61it/s] 21%|█████████████████████▏                                                                               | 118/561 [00:06<00:23, 18.51it/s] 21%|█████████████████████▌                                                                               | 120/561 [00:06<00:23, 18.79it/s] 22%|█████████████████████▉                                                                               | 122/561 [00:06<00:23, 19.02it/s] 22%|██████████████████████▎                                                                              | 124/561 [00:06<00:23, 18.77it/s] 22%|██████████████████████▋                                                                              | 126/561 [00:06<00:23, 18.89it/s] 23%|███████████████████████                                                                              | 128/561 [00:07<00:22, 19.06it/s] 23%|███████████████████████▍                                                                             | 130/561 [00:07<00:23, 18.74it/s] 24%|███████████████████████▉                                                                             | 133/561 [00:07<00:22, 19.08it/s] 24%|████████████████████████▎                                                                            | 135/561 [00:07<00:22, 19.15it/s] 24%|████████████████████████▋                                                                            | 137/561 [00:07<00:22, 19.01it/s] 25%|█████████████████████████                                                                            | 139/561 [00:07<00:22, 18.97it/s] 25%|█████████████████████████▍                                                                           | 141/561 [00:07<00:22, 18.90it/s] 25%|█████████████████████████▋                                                                           | 143/561 [00:07<00:22, 18.81it/s] 26%|██████████████████████████                                                                           | 145/561 [00:07<00:22, 18.61it/s] 26%|██████████████████████████▍                                                                          | 147/561 [00:08<00:22, 18.78it/s] 27%|██████████████████████████▊                                                                          | 149/561 [00:08<00:22, 18.69it/s][2025-03-28 01:36:03,516] [INFO] [logging.py:128:log_dist] [Rank 0] step=5200, skipped=12, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:36:03,520] [INFO] [timer.py:264:stop] epoch=0/micro_step=5200/global_step=5200, RunningAvgSamplesPerSec=20.440498307837963, CurrSamplesPerSec=17.55260629345313, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 27%|███████████████████████████▏                                                                         | 151/561 [00:08<00:22, 18.35it/s] 27%|███████████████████████████▌                                                                         | 153/561 [00:08<00:22, 17.76it/s] 28%|███████████████████████████▉                                                                         | 155/561 [00:08<00:22, 18.27it/s] 28%|████████████████████████████▎                                                                        | 157/561 [00:08<00:22, 17.93it/s] 28%|████████████████████████████▋                                                                        | 159/561 [00:08<00:22, 18.07it/s] 29%|████████████████████████████▉                                                                        | 161/561 [00:08<00:22, 18.07it/s] 29%|█████████████████████████████▎                                                                       | 163/561 [00:08<00:21, 18.33it/s] 29%|█████████████████████████████▋                                                                       | 165/561 [00:09<00:21, 18.49it/s] 30%|██████████████████████████████                                                                       | 167/561 [00:09<00:21, 18.58it/s] 30%|██████████████████████████████▍                                                                      | 169/561 [00:09<00:20, 18.71it/s] 30%|██████████████████████████████▊                                                                      | 171/561 [00:09<00:20, 18.68it/s] 31%|███████████████████████████████▏                                                                     | 173/561 [00:09<00:20, 18.72it/s] 31%|███████████████████████████████▌                                                                     | 175/561 [00:09<00:20, 18.55it/s] 32%|███████████████████████████████▊                                                                     | 177/561 [00:09<00:20, 18.58it/s] 32%|████████████████████████████████▏                                                                    | 179/561 [00:09<00:20, 18.63it/s] 32%|████████████████████████████████▌                                                                    | 181/561 [00:09<00:20, 18.33it/s] 33%|████████████████████████████████▉                                                                    | 183/561 [00:09<00:20, 18.22it/s] 33%|█████████████████████████████████▎                                                                   | 185/561 [00:10<00:20, 18.34it/s] 33%|█████████████████████████████████▋                                                                   | 187/561 [00:10<00:20, 18.42it/s] 34%|██████████████████████████████████                                                                   | 189/561 [00:10<00:20, 18.46it/s] 34%|██████████████████████████████████▍                                                                  | 191/561 [00:10<00:20, 18.48it/s] 34%|██████████████████████████████████▋                                                                  | 193/561 [00:10<00:19, 18.47it/s] 35%|███████████████████████████████████                                                                  | 195/561 [00:10<00:19, 18.50it/s] 35%|███████████████████████████████████▍                                                                 | 197/561 [00:10<00:19, 18.47it/s] 35%|███████████████████████████████████▊                                                                 | 199/561 [00:10<00:19, 18.48it/s][2025-03-28 01:36:06,232] [INFO] [logging.py:128:log_dist] [Rank 0] step=5250, skipped=12, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:36:06,236] [INFO] [timer.py:264:stop] epoch=0/micro_step=5250/global_step=5250, RunningAvgSamplesPerSec=20.419538399864294, CurrSamplesPerSec=18.673370189255696, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 36%|████████████████████████████████████▏                                                                | 201/561 [00:10<00:19, 18.47it/s] 36%|████████████████████████████████████▌                                                                | 203/561 [00:11<00:19, 18.44it/s] 37%|████████████████████████████████████▉                                                                | 205/561 [00:11<00:19, 18.43it/s] 37%|█████████████████████████████████████▎                                                               | 207/561 [00:11<00:19, 18.25it/s] 37%|█████████████████████████████████████▋                                                               | 209/561 [00:11<00:19, 18.26it/s] 38%|█████████████████████████████████████▉                                                               | 211/561 [00:11<00:19, 18.28it/s] 38%|██████████████████████████████████████▎                                                              | 213/561 [00:11<00:19, 18.26it/s] 38%|██████████████████████████████████████▋                                                              | 215/561 [00:11<00:18, 18.25it/s] 39%|███████████████████████████████████████                                                              | 217/561 [00:11<00:18, 18.31it/s] 39%|███████████████████████████████████████▍                                                             | 219/561 [00:11<00:18, 18.61it/s] 39%|███████████████████████████████████████▊                                                             | 221/561 [00:12<00:18, 18.48it/s] 40%|████████████████████████████████████████▏                                                            | 223/561 [00:12<00:18, 18.54it/s] 40%|████████████████████████████████████████▌                                                            | 225/561 [00:12<00:18, 18.43it/s] 40%|████████████████████████████████████████▊                                                            | 227/561 [00:12<00:17, 18.72it/s] 41%|█████████████████████████████████████████▏                                                           | 229/561 [00:12<00:17, 18.81it/s] 41%|█████████████████████████████████████████▌                                                           | 231/561 [00:12<00:17, 18.92it/s] 42%|█████████████████████████████████████████▉                                                           | 233/561 [00:12<00:17, 18.82it/s] 42%|██████████████████████████████████████████▎                                                          | 235/561 [00:12<00:17, 18.97it/s] 42%|██████████████████████████████████████████▋                                                          | 237/561 [00:12<00:17, 18.90it/s] 43%|███████████████████████████████████████████                                                          | 239/561 [00:13<00:17, 18.53it/s] 43%|███████████████████████████████████████████▍                                                         | 241/561 [00:13<00:17, 18.48it/s] 43%|███████████████████████████████████████████▋                                                         | 243/561 [00:13<00:17, 18.54it/s] 44%|████████████████████████████████████████████                                                         | 245/561 [00:13<00:16, 18.71it/s] 44%|████████████████████████████████████████████▍                                                        | 247/561 [00:13<00:17, 18.40it/s] 45%|█████████████████████████████████████████████                                                        | 250/561 [00:13<00:15, 19.62it/s][2025-03-28 01:36:08,905] [INFO] [logging.py:128:log_dist] [Rank 0] step=5300, skipped=12, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:36:08,908] [INFO] [timer.py:264:stop] epoch=0/micro_step=5300/global_step=5300, RunningAvgSamplesPerSec=20.402448329872477, CurrSamplesPerSec=19.330265064923548, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 45%|█████████████████████████████████████████████▎                                                       | 252/561 [00:13<00:15, 19.48it/s] 45%|█████████████████████████████████████████████▋                                                       | 254/561 [00:13<00:16, 19.12it/s] 46%|██████████████████████████████████████████████                                                       | 256/561 [00:13<00:15, 19.22it/s] 46%|██████████████████████████████████████████████▍                                                      | 258/561 [00:14<00:15, 19.09it/s] 46%|██████████████████████████████████████████████▊                                                      | 260/561 [00:14<00:15, 19.03it/s] 47%|███████████████████████████████████████████████▏                                                     | 262/561 [00:14<00:15, 19.11it/s] 47%|███████████████████████████████████████████████▌                                                     | 264/561 [00:14<00:15, 18.84it/s] 47%|███████████████████████████████████████████████▉                                                     | 266/561 [00:14<00:15, 19.08it/s] 48%|████████████████████████████████████████████████▏                                                    | 268/561 [00:14<00:15, 19.22it/s] 48%|████████████████████████████████████████████████▌                                                    | 270/561 [00:14<00:15, 18.85it/s] 48%|████████████████████████████████████████████████▉                                                    | 272/561 [00:14<00:15, 18.48it/s] 49%|█████████████████████████████████████████████████▎                                                   | 274/561 [00:14<00:15, 18.36it/s] 49%|█████████████████████████████████████████████████▋                                                   | 276/561 [00:14<00:15, 18.57it/s] 50%|██████████████████████████████████████████████████                                                   | 278/561 [00:15<00:15, 18.43it/s] 50%|██████████████████████████████████████████████████▍                                                  | 280/561 [00:15<00:15, 18.39it/s] 50%|██████████████████████████████████████████████████▊                                                  | 282/561 [00:15<00:15, 18.53it/s] 51%|███████████████████████████████████████████████████▏                                                 | 284/561 [00:15<00:15, 18.19it/s] 51%|███████████████████████████████████████████████████▍                                                 | 286/561 [00:15<00:15, 17.86it/s] 51%|███████████████████████████████████████████████████▊                                                 | 288/561 [00:15<00:15, 18.08it/s] 52%|████████████████████████████████████████████████████▏                                                | 290/561 [00:15<00:14, 18.32it/s] 52%|████████████████████████████████████████████████████▌                                                | 292/561 [00:15<00:14, 18.40it/s] 52%|████████████████████████████████████████████████████▉                                                | 294/561 [00:15<00:14, 18.35it/s] 53%|█████████████████████████████████████████████████████▎                                               | 296/561 [00:16<00:14, 17.72it/s] 53%|█████████████████████████████████████████████████████▋                                               | 298/561 [00:16<00:14, 18.03it/s] 53%|██████████████████████████████████████████████████████                                               | 300/561 [00:16<00:14, 18.19it/s][2025-03-28 01:36:11,621] [INFO] [logging.py:128:log_dist] [Rank 0] step=5350, skipped=12, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:36:11,624] [INFO] [timer.py:264:stop] epoch=0/micro_step=5350/global_step=5350, RunningAvgSamplesPerSec=20.382341511480682, CurrSamplesPerSec=17.341781562229855, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 54%|██████████████████████████████████████████████████████▎                                              | 302/561 [00:16<00:14, 18.14it/s] 54%|██████████████████████████████████████████████████████▋                                              | 304/561 [00:16<00:14, 17.73it/s] 55%|███████████████████████████████████████████████████████                                              | 306/561 [00:16<00:14, 17.81it/s] 55%|███████████████████████████████████████████████████████▍                                             | 308/561 [00:16<00:14, 18.00it/s] 55%|███████████████████████████████████████████████████████▊                                             | 310/561 [00:16<00:13, 18.14it/s] 56%|████████████████████████████████████████████████████████▏                                            | 312/561 [00:16<00:13, 18.33it/s] 56%|████████████████████████████████████████████████████████▌                                            | 314/561 [00:17<00:13, 18.36it/s] 56%|████████████████████████████████████████████████████████▉                                            | 316/561 [00:17<00:13, 18.39it/s] 57%|█████████████████████████████████████████████████████████▎                                           | 318/561 [00:17<00:13, 18.61it/s] 57%|█████████████████████████████████████████████████████████▌                                           | 320/561 [00:17<00:12, 18.57it/s] 57%|█████████████████████████████████████████████████████████▉                                           | 322/561 [00:17<00:12, 18.39it/s] 58%|██████████████████████████████████████████████████████████▎                                          | 324/561 [00:17<00:12, 18.61it/s] 58%|██████████████████████████████████████████████████████████▋                                          | 326/561 [00:17<00:12, 18.37it/s] 58%|███████████████████████████████████████████████████████████                                          | 328/561 [00:17<00:12, 18.41it/s] 59%|███████████████████████████████████████████████████████████▍                                         | 330/561 [00:17<00:12, 18.44it/s] 59%|███████████████████████████████████████████████████████████▊                                         | 332/561 [00:18<00:12, 18.22it/s] 60%|████████████████████████████████████████████████████████████▏                                        | 334/561 [00:18<00:12, 18.49it/s] 60%|████████████████████████████████████████████████████████████▍                                        | 336/561 [00:18<00:12, 18.47it/s] 60%|████████████████████████████████████████████████████████████▊                                        | 338/561 [00:18<00:12, 18.38it/s] 61%|█████████████████████████████████████████████████████████████▏                                       | 340/561 [00:18<00:12, 18.34it/s] 61%|█████████████████████████████████████████████████████████████▌                                       | 342/561 [00:18<00:12, 18.21it/s] 61%|█████████████████████████████████████████████████████████████▉                                       | 344/561 [00:18<00:11, 18.17it/s] 62%|██████████████████████████████████████████████████████████████▎                                      | 346/561 [00:18<00:11, 18.17it/s] 62%|██████████████████████████████████████████████████████████████▋                                      | 348/561 [00:18<00:11, 18.10it/s] 62%|███████████████████████████████████████████████████████████████                                      | 350/561 [00:19<00:11, 18.27it/s][2025-03-28 01:36:14,347] [INFO] [logging.py:128:log_dist] [Rank 0] step=5400, skipped=12, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:36:14,350] [INFO] [timer.py:264:stop] epoch=0/micro_step=5400/global_step=5400, RunningAvgSamplesPerSec=20.361826485879696, CurrSamplesPerSec=19.856931162446134, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 63%|███████████████████████████████████████████████████████████████▎                                     | 352/561 [00:19<00:11, 18.61it/s] 63%|███████████████████████████████████████████████████████████████▋                                     | 354/561 [00:19<00:11, 18.26it/s] 64%|████████████████████████████████████████████████████████████████▎                                    | 357/561 [00:19<00:10, 18.83it/s] 64%|████████████████████████████████████████████████████████████████▋                                    | 359/561 [00:19<00:10, 18.88it/s] 65%|█████████████████████████████████████████████████████████████████▏                                   | 362/561 [00:19<00:10, 19.83it/s] 65%|█████████████████████████████████████████████████████████████████▋                                   | 365/561 [00:19<00:09, 20.32it/s] 66%|██████████████████████████████████████████████████████████████████▎                                  | 368/561 [00:19<00:09, 20.87it/s] 66%|██████████████████████████████████████████████████████████████████▊                                  | 371/561 [00:20<00:08, 21.25it/s] 67%|███████████████████████████████████████████████████████████████████▎                                 | 374/561 [00:20<00:08, 21.89it/s] 67%|███████████████████████████████████████████████████████████████████▊                                 | 377/561 [00:20<00:08, 22.02it/s] 68%|████████████████████████████████████████████████████████████████████▍                                | 380/561 [00:20<00:08, 21.94it/s] 68%|████████████████████████████████████████████████████████████████████▉                                | 383/561 [00:20<00:08, 21.79it/s] 69%|█████████████████████████████████████████████████████████████████████▍                               | 386/561 [00:20<00:08, 20.79it/s] 69%|██████████████████████████████████████████████████████████████████████                               | 389/561 [00:20<00:08, 21.16it/s] 70%|██████████████████████████████████████████████████████████████████████▌                              | 392/561 [00:21<00:07, 21.31it/s] 70%|███████████████████████████████████████████████████████████████████████                              | 395/561 [00:21<00:07, 21.37it/s] 71%|███████████████████████████████████████████████████████████████████████▋                             | 398/561 [00:21<00:07, 21.52it/s][2025-03-28 01:36:16,735] [INFO] [logging.py:128:log_dist] [Rank 0] step=5450, skipped=12, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:36:16,736] [INFO] [timer.py:264:stop] epoch=0/micro_step=5450/global_step=5450, RunningAvgSamplesPerSec=20.367626437291502, CurrSamplesPerSec=19.70598264949328, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 71%|████████████████████████████████████████████████████████████████████████▏                            | 401/561 [00:21<00:07, 20.54it/s] 72%|████████████████████████████████████████████████████████████████████████▋                            | 404/561 [00:21<00:07, 20.94it/s] 73%|█████████████████████████████████████████████████████████████████████████▎                           | 407/561 [00:21<00:07, 21.29it/s] 73%|█████████████████████████████████████████████████████████████████████████▊                           | 410/561 [00:21<00:07, 21.56it/s] 74%|██████████████████████████████████████████████████████████████████████████▎                          | 413/561 [00:22<00:07, 20.38it/s] 74%|██████████████████████████████████████████████████████████████████████████▉                          | 416/561 [00:22<00:07, 19.53it/s] 75%|███████████████████████████████████████████████████████████████████████████▎                         | 418/561 [00:22<00:07, 19.20it/s] 75%|███████████████████████████████████████████████████████████████████████████▌                         | 420/561 [00:22<00:07, 18.92it/s] 75%|███████████████████████████████████████████████████████████████████████████▉                         | 422/561 [00:22<00:07, 18.70it/s] 76%|████████████████████████████████████████████████████████████████████████████▎                        | 424/561 [00:22<00:07, 18.51it/s] 76%|████████████████████████████████████████████████████████████████████████████▋                        | 426/561 [00:22<00:07, 18.37it/s] 76%|█████████████████████████████████████████████████████████████████████████████                        | 428/561 [00:22<00:07, 18.28it/s] 77%|█████████████████████████████████████████████████████████████████████████████▌                       | 431/561 [00:23<00:06, 19.00it/s] 77%|██████████████████████████████████████████████████████████████████████████████▏                      | 434/561 [00:23<00:06, 19.85it/s] 78%|██████████████████████████████████████████████████████████████████████████████▋                      | 437/561 [00:23<00:06, 20.44it/s] 78%|███████████████████████████████████████████████████████████████████████████████▏                     | 440/561 [00:23<00:05, 20.96it/s] 79%|███████████████████████████████████████████████████████████████████████████████▊                     | 443/561 [00:23<00:05, 21.30it/s] 80%|████████████████████████████████████████████████████████████████████████████████▎                    | 446/561 [00:23<00:05, 21.54it/s] 80%|████████████████████████████████████████████████████████████████████████████████▊                    | 449/561 [00:23<00:05, 21.65it/s][2025-03-28 01:36:19,205] [INFO] [logging.py:128:log_dist] [Rank 0] step=5500, skipped=12, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:36:19,206] [INFO] [timer.py:264:stop] epoch=0/micro_step=5500/global_step=5500, RunningAvgSamplesPerSec=20.366933128205805, CurrSamplesPerSec=21.18697091059477, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 81%|█████████████████████████████████████████████████████████████████████████████████▍                   | 452/561 [00:23<00:05, 21.42it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▉                   | 455/561 [00:24<00:04, 21.40it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▍                  | 458/561 [00:24<00:04, 21.48it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▉                  | 461/561 [00:24<00:04, 21.44it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▌                 | 464/561 [00:24<00:04, 20.68it/s] 83%|████████████████████████████████████████████████████████████████████████████████████                 | 467/561 [00:24<00:04, 19.83it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▍                | 469/561 [00:24<00:04, 19.39it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▊                | 471/561 [00:24<00:04, 19.04it/s] 84%|█████████████████████████████████████████████████████████████████████████████████████▏               | 473/561 [00:25<00:04, 18.78it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▌               | 475/561 [00:25<00:04, 18.57it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▉               | 477/561 [00:25<00:04, 18.41it/s] 85%|██████████████████████████████████████████████████████████████████████████████████████▏              | 479/561 [00:25<00:04, 18.32it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▌              | 481/561 [00:25<00:04, 18.24it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▉              | 483/561 [00:25<00:04, 18.21it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▍             | 486/561 [00:25<00:03, 19.32it/s] 87%|████████████████████████████████████████████████████████████████████████████████████████             | 489/561 [00:25<00:03, 19.95it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▌            | 492/561 [00:26<00:03, 20.77it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████████            | 495/561 [00:26<00:03, 21.24it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▋           | 498/561 [00:26<00:03, 20.39it/s][2025-03-28 01:36:21,725] [INFO] [logging.py:128:log_dist] [Rank 0] step=5550, skipped=12, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:36:21,725] [INFO] [timer.py:264:stop] epoch=0/micro_step=5550/global_step=5550, RunningAvgSamplesPerSec=20.36258078367664, CurrSamplesPerSec=22.230759790717435, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 89%|██████████████████████████████████████████████████████████████████████████████████████████▏          | 501/561 [00:26<00:02, 20.97it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▋          | 504/561 [00:26<00:02, 21.32it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████████▎         | 507/561 [00:26<00:02, 21.43it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▊         | 510/561 [00:26<00:02, 21.90it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████████▎        | 513/561 [00:27<00:02, 21.31it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████████▉        | 516/561 [00:27<00:02, 21.06it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▍       | 519/561 [00:27<00:01, 21.28it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▉       | 522/561 [00:27<00:01, 21.28it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▌      | 525/561 [00:27<00:01, 21.49it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████      | 528/561 [00:27<00:01, 21.43it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▌     | 531/561 [00:27<00:01, 21.57it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████████▏    | 534/561 [00:27<00:01, 21.77it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▋    | 537/561 [00:28<00:01, 21.80it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████▏   | 540/561 [00:28<00:00, 21.02it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████████▊   | 543/561 [00:28<00:00, 19.94it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████████▎  | 546/561 [00:28<00:00, 19.37it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▋  | 548/561 [00:28<00:00, 19.06it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████████  | 550/561 [00:28<00:00, 18.80it/s][2025-03-28 01:36:24,152] [INFO] [logging.py:128:log_dist] [Rank 0] step=5600, skipped=12, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:36:24,156] [INFO] [timer.py:264:stop] epoch=0/micro_step=5600/global_step=5600, RunningAvgSamplesPerSec=20.364895756504623, CurrSamplesPerSec=18.16327795014092, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 98%|███████████████████████████████████████████████████████████████████████████████████████████████████▍ | 552/561 [00:28<00:00, 18.95it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▉ | 555/561 [00:29<00:00, 20.48it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████▍| 558/561 [00:29<00:00, 21.47it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:29<00:00, 22.19it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:29<00:00, 19.09it/s]
  0%|                                                                                                               | 0/561 [00:00<?, ?it/s]  0%|▏                                                                                                      | 1/561 [00:00<02:29,  3.73it/s]  1%|▌                                                                                                      | 3/561 [00:00<00:59,  9.33it/s]  1%|█                                                                                                      | 6/561 [00:00<00:37, 14.63it/s]  1%|█▍                                                                                                     | 8/561 [00:00<00:34, 15.90it/s]  2%|██                                                                                                    | 11/561 [00:00<00:30, 18.15it/s]  2%|██▌                                                                                                   | 14/561 [00:00<00:28, 18.99it/s]  3%|███                                                                                                   | 17/561 [00:01<00:27, 19.81it/s]  4%|███▋                                                                                                  | 20/561 [00:01<00:26, 20.31it/s]  4%|████▏                                                                                                 | 23/561 [00:01<00:26, 20.09it/s]  5%|████▋                                                                                                 | 26/561 [00:01<00:26, 20.57it/s]  5%|█████▎                                                                                                | 29/561 [00:01<00:25, 21.01it/s]  6%|█████▊                                                                                                | 32/561 [00:01<00:24, 21.26it/s]  6%|██████▎                                                                                               | 35/561 [00:01<00:24, 21.39it/s]  7%|██████▉                                                                                               | 38/561 [00:02<00:24, 21.45it/s][2025-03-28 01:36:26,789] [INFO] [logging.py:128:log_dist] [Rank 0] step=5650, skipped=12, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:36:26,790] [INFO] [timer.py:264:stop] epoch=0/micro_step=5650/global_step=5650, RunningAvgSamplesPerSec=20.363858846520735, CurrSamplesPerSec=20.280051927070485, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
  7%|███████▍                                                                                              | 41/561 [00:02<00:24, 21.36it/s]  8%|████████                                                                                              | 44/561 [00:02<00:23, 21.90it/s]  8%|████████▌                                                                                             | 47/561 [00:02<00:22, 22.45it/s]  9%|█████████                                                                                             | 50/561 [00:02<00:22, 22.77it/s]  9%|█████████▋                                                                                            | 53/561 [00:02<00:22, 22.99it/s] 10%|██████████▏                                                                                           | 56/561 [00:02<00:22, 22.79it/s] 11%|██████████▋                                                                                           | 59/561 [00:02<00:22, 22.56it/s] 11%|███████████▎                                                                                          | 62/561 [00:03<00:22, 22.34it/s] 12%|███████████▊                                                                                          | 65/561 [00:03<00:22, 22.25it/s] 12%|████████████▎                                                                                         | 68/561 [00:03<00:22, 22.27it/s] 13%|████████████▉                                                                                         | 71/561 [00:03<00:21, 22.47it/s] 13%|█████████████▍                                                                                        | 74/561 [00:03<00:21, 22.36it/s] 14%|██████████████                                                                                        | 77/561 [00:03<00:21, 22.08it/s] 14%|██████████████▌                                                                                       | 80/561 [00:03<00:22, 21.75it/s] 15%|███████████████                                                                                       | 83/561 [00:04<00:21, 21.77it/s] 15%|███████████████▋                                                                                      | 86/561 [00:04<00:21, 21.62it/s] 16%|████████████████▏                                                                                     | 89/561 [00:04<00:21, 21.92it/s][2025-03-28 01:36:29,027] [INFO] [logging.py:128:log_dist] [Rank 0] step=5700, skipped=12, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:36:29,027] [INFO] [timer.py:264:stop] epoch=0/micro_step=5700/global_step=5700, RunningAvgSamplesPerSec=20.380171494130295, CurrSamplesPerSec=22.657927533703816, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 16%|████████████████▋                                                                                     | 92/561 [00:04<00:21, 22.06it/s] 17%|█████████████████▎                                                                                    | 95/561 [00:04<00:21, 22.00it/s] 17%|█████████████████▊                                                                                    | 98/561 [00:04<00:21, 21.86it/s] 18%|██████████████████▏                                                                                  | 101/561 [00:04<00:20, 21.91it/s] 19%|██████████████████▋                                                                                  | 104/561 [00:05<00:21, 21.05it/s] 19%|███████████████████▎                                                                                 | 107/561 [00:05<00:21, 21.22it/s] 20%|███████████████████▊                                                                                 | 110/561 [00:05<00:21, 21.31it/s] 20%|████████████████████▎                                                                                | 113/561 [00:05<00:20, 21.40it/s] 21%|████████████████████▉                                                                                | 116/561 [00:05<00:20, 21.47it/s] 21%|█████████████████████▍                                                                               | 119/561 [00:05<00:20, 21.68it/s] 22%|█████████████████████▉                                                                               | 122/561 [00:05<00:20, 21.69it/s] 22%|██████████████████████▌                                                                              | 125/561 [00:05<00:20, 21.66it/s] 23%|███████████████████████                                                                              | 128/561 [00:06<00:20, 21.61it/s] 23%|███████████████████████▌                                                                             | 131/561 [00:06<00:19, 21.87it/s] 24%|████████████████████████                                                                             | 134/561 [00:06<00:19, 21.91it/s] 24%|████████████████████████▋                                                                            | 137/561 [00:06<00:19, 21.74it/s][2025-03-28 01:36:31,334] [INFO] [logging.py:128:log_dist] [Rank 0] step=5750, skipped=12, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:36:31,336] [INFO] [timer.py:264:stop] epoch=0/micro_step=5750/global_step=5750, RunningAvgSamplesPerSec=20.391113662384814, CurrSamplesPerSec=22.940729973551694, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 25%|█████████████████████████▏                                                                           | 140/561 [00:06<00:19, 21.98it/s] 25%|█████████████████████████▋                                                                           | 143/561 [00:06<00:19, 20.98it/s] 26%|██████████████████████████▎                                                                          | 146/561 [00:06<00:19, 20.90it/s] 27%|██████████████████████████▊                                                                          | 149/561 [00:07<00:19, 21.08it/s] 27%|███████████████████████████▎                                                                         | 152/561 [00:07<00:19, 21.12it/s] 28%|███████████████████████████▉                                                                         | 155/561 [00:07<00:19, 21.30it/s] 28%|████████████████████████████▍                                                                        | 158/561 [00:07<00:18, 21.45it/s] 29%|████████████████████████████▉                                                                        | 161/561 [00:07<00:18, 21.41it/s] 29%|█████████████████████████████▌                                                                       | 164/561 [00:07<00:18, 21.49it/s] 30%|██████████████████████████████                                                                       | 167/561 [00:07<00:18, 21.46it/s] 30%|██████████████████████████████▌                                                                      | 170/561 [00:08<00:18, 21.52it/s] 31%|███████████████████████████████▏                                                                     | 173/561 [00:08<00:18, 21.54it/s] 31%|███████████████████████████████▋                                                                     | 176/561 [00:08<00:17, 21.56it/s] 32%|████████████████████████████████▏                                                                    | 179/561 [00:08<00:17, 21.34it/s] 32%|████████████████████████████████▊                                                                    | 182/561 [00:08<00:17, 21.26it/s] 33%|█████████████████████████████████▎                                                                   | 185/561 [00:08<00:17, 21.21it/s] 34%|█████████████████████████████████▊                                                                   | 188/561 [00:08<00:17, 21.16it/s][2025-03-28 01:36:33,697] [INFO] [logging.py:128:log_dist] [Rank 0] step=5800, skipped=12, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:36:33,698] [INFO] [timer.py:264:stop] epoch=0/micro_step=5800/global_step=5800, RunningAvgSamplesPerSec=20.397943394034968, CurrSamplesPerSec=20.481280649676222, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 34%|██████████████████████████████████▍                                                                  | 191/561 [00:09<00:17, 21.10it/s] 35%|██████████████████████████████████▉                                                                  | 194/561 [00:09<00:17, 21.24it/s] 35%|███████████████████████████████████▍                                                                 | 197/561 [00:09<00:17, 21.22it/s] 36%|████████████████████████████████████                                                                 | 200/561 [00:09<00:17, 21.16it/s] 36%|████████████████████████████████████▌                                                                | 203/561 [00:09<00:16, 21.26it/s] 37%|█████████████████████████████████████                                                                | 206/561 [00:09<00:16, 20.97it/s] 37%|█████████████████████████████████████▋                                                               | 209/561 [00:09<00:16, 21.03it/s] 38%|██████████████████████████████████████▏                                                              | 212/561 [00:10<00:16, 20.98it/s] 38%|██████████████████████████████████████▋                                                              | 215/561 [00:10<00:16, 20.89it/s] 39%|███████████████████████████████████████▏                                                             | 218/561 [00:10<00:16, 20.65it/s] 39%|███████████████████████████████████████▊                                                             | 221/561 [00:10<00:16, 20.47it/s] 40%|████████████████████████████████████████▎                                                            | 224/561 [00:10<00:16, 20.35it/s] 40%|████████████████████████████████████████▊                                                            | 227/561 [00:10<00:16, 20.40it/s] 41%|█████████████████████████████████████████▍                                                           | 230/561 [00:10<00:16, 20.26it/s] 42%|█████████████████████████████████████████▉                                                           | 233/561 [00:11<00:16, 20.24it/s] 42%|██████████████████████████████████████████▍                                                          | 236/561 [00:11<00:16, 20.03it/s] 43%|███████████████████████████████████████████                                                          | 239/561 [00:11<00:16, 20.06it/s][2025-03-28 01:36:36,136] [INFO] [logging.py:128:log_dist] [Rank 0] step=5850, skipped=12, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:36:36,138] [INFO] [timer.py:264:stop] epoch=0/micro_step=5850/global_step=5850, RunningAvgSamplesPerSec=20.39912382939392, CurrSamplesPerSec=18.007781779765963, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 43%|███████████████████████████████████████████▌                                                         | 242/561 [00:11<00:16, 19.85it/s] 43%|███████████████████████████████████████████▉                                                         | 244/561 [00:11<00:15, 19.88it/s] 44%|████████████████████████████████████████████▍                                                        | 247/561 [00:11<00:15, 19.87it/s] 44%|████████████████████████████████████████████▊                                                        | 249/561 [00:11<00:15, 19.64it/s] 45%|█████████████████████████████████████████████▏                                                       | 251/561 [00:12<00:15, 19.43it/s] 45%|█████████████████████████████████████████████▌                                                       | 253/561 [00:12<00:15, 19.52it/s] 45%|█████████████████████████████████████████████▉                                                       | 255/561 [00:12<00:15, 19.18it/s] 46%|██████████████████████████████████████████████▎                                                      | 257/561 [00:12<00:15, 19.21it/s] 46%|██████████████████████████████████████████████▋                                                      | 259/561 [00:12<00:15, 19.02it/s] 47%|██████████████████████████████████████████████▉                                                      | 261/561 [00:12<00:15, 18.97it/s] 47%|███████████████████████████████████████████████▎                                                     | 263/561 [00:12<00:15, 18.93it/s] 47%|███████████████████████████████████████████████▋                                                     | 265/561 [00:12<00:15, 18.98it/s] 48%|████████████████████████████████████████████████                                                     | 267/561 [00:12<00:15, 19.01it/s] 48%|████████████████████████████████████████████████▍                                                    | 269/561 [00:12<00:15, 18.80it/s] 48%|████████████████████████████████████████████████▊                                                    | 271/561 [00:13<00:15, 18.61it/s] 49%|█████████████████████████████████████████████████▏                                                   | 273/561 [00:13<00:15, 18.46it/s] 49%|█████████████████████████████████████████████████▌                                                   | 275/561 [00:13<00:15, 18.62it/s] 49%|█████████████████████████████████████████████████▊                                                   | 277/561 [00:13<00:15, 18.58it/s] 50%|██████████████████████████████████████████████████▏                                                  | 279/561 [00:13<00:15, 18.75it/s] 50%|██████████████████████████████████████████████████▌                                                  | 281/561 [00:13<00:15, 18.65it/s] 50%|██████████████████████████████████████████████████▉                                                  | 283/561 [00:13<00:14, 18.78it/s] 51%|███████████████████████████████████████████████████▎                                                 | 285/561 [00:13<00:14, 18.82it/s] 51%|███████████████████████████████████████████████████▋                                                 | 287/561 [00:13<00:14, 18.70it/s] 52%|████████████████████████████████████████████████████                                                 | 289/561 [00:14<00:14, 19.02it/s][2025-03-28 01:36:38,772] [INFO] [logging.py:128:log_dist] [Rank 0] step=5900, skipped=12, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:36:38,774] [INFO] [timer.py:264:stop] epoch=0/micro_step=5900/global_step=5900, RunningAvgSamplesPerSec=20.386544624166756, CurrSamplesPerSec=18.437782074630267, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 52%|████████████████████████████████████████████████████▍                                                | 291/561 [00:14<00:14, 18.98it/s] 52%|████████████████████████████████████████████████████▊                                                | 293/561 [00:14<00:14, 18.94it/s] 53%|█████████████████████████████████████████████████████                                                | 295/561 [00:14<00:13, 19.02it/s] 53%|█████████████████████████████████████████████████████▍                                               | 297/561 [00:14<00:14, 18.32it/s] 53%|█████████████████████████████████████████████████████▊                                               | 299/561 [00:14<00:14, 18.52it/s] 54%|██████████████████████████████████████████████████████▏                                              | 301/561 [00:14<00:13, 18.80it/s] 54%|██████████████████████████████████████████████████████▌                                              | 303/561 [00:14<00:13, 18.95it/s] 55%|███████████████████████████████████████████████████████                                              | 306/561 [00:14<00:12, 20.52it/s] 55%|███████████████████████████████████████████████████████▋                                             | 309/561 [00:15<00:12, 19.43it/s] 55%|███████████████████████████████████████████████████████▉                                             | 311/561 [00:15<00:13, 19.04it/s] 56%|████████████████████████████████████████████████████████▎                                            | 313/561 [00:15<00:13, 19.05it/s] 56%|████████████████████████████████████████████████████████▋                                            | 315/561 [00:15<00:12, 19.04it/s] 57%|█████████████████████████████████████████████████████████                                            | 317/561 [00:15<00:12, 19.07it/s] 57%|█████████████████████████████████████████████████████████▍                                           | 319/561 [00:15<00:12, 19.03it/s] 57%|█████████████████████████████████████████████████████████▊                                           | 321/561 [00:15<00:12, 19.00it/s] 58%|██████████████████████████████████████████████████████████▏                                          | 323/561 [00:15<00:12, 18.92it/s] 58%|██████████████████████████████████████████████████████████▌                                          | 325/561 [00:15<00:12, 19.21it/s] 58%|██████████████████████████████████████████████████████████▊                                          | 327/561 [00:16<00:12, 18.21it/s] 59%|███████████████████████████████████████████████████████████▏                                         | 329/561 [00:16<00:12, 17.93it/s] 59%|███████████████████████████████████████████████████████████▌                                         | 331/561 [00:16<00:12, 18.25it/s] 59%|███████████████████████████████████████████████████████████▉                                         | 333/561 [00:16<00:12, 18.60it/s] 60%|████████████████████████████████████████████████████████████▎                                        | 335/561 [00:16<00:12, 18.72it/s] 60%|████████████████████████████████████████████████████████████▋                                        | 337/561 [00:16<00:12, 18.65it/s] 60%|█████████████████████████████████████████████████████████████                                        | 339/561 [00:16<00:11, 18.87it/s][2025-03-28 01:36:41,418] [INFO] [logging.py:128:log_dist] [Rank 0] step=5950, skipped=12, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:36:41,422] [INFO] [timer.py:264:stop] epoch=0/micro_step=5950/global_step=5950, RunningAvgSamplesPerSec=20.37340269257381, CurrSamplesPerSec=19.268281534258357, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 61%|█████████████████████████████████████████████████████████████▍                                       | 341/561 [00:16<00:11, 18.83it/s] 61%|█████████████████████████████████████████████████████████████▊                                       | 343/561 [00:16<00:11, 18.77it/s] 61%|██████████████████████████████████████████████████████████████                                       | 345/561 [00:17<00:11, 18.90it/s] 62%|██████████████████████████████████████████████████████████████▍                                      | 347/561 [00:17<00:11, 19.03it/s] 62%|██████████████████████████████████████████████████████████████▊                                      | 349/561 [00:17<00:11, 19.02it/s] 63%|███████████████████████████████████████████████████████████████▏                                     | 351/561 [00:17<00:11, 19.03it/s] 63%|███████████████████████████████████████████████████████████████▌                                     | 353/561 [00:17<00:10, 18.97it/s] 63%|███████████████████████████████████████████████████████████████▉                                     | 355/561 [00:17<00:10, 18.96it/s] 64%|████████████████████████████████████████████████████████████████▎                                    | 357/561 [00:17<00:10, 18.89it/s] 64%|████████████████████████████████████████████████████████████████▋                                    | 359/561 [00:17<00:10, 19.03it/s] 64%|████████████████████████████████████████████████████████████████▉                                    | 361/561 [00:17<00:10, 18.89it/s] 65%|█████████████████████████████████████████████████████████████████▎                                   | 363/561 [00:17<00:10, 18.05it/s] 65%|█████████████████████████████████████████████████████████████████▋                                   | 365/561 [00:18<00:10, 18.34it/s] 65%|██████████████████████████████████████████████████████████████████                                   | 367/561 [00:18<00:10, 18.57it/s] 66%|██████████████████████████████████████████████████████████████████▍                                  | 369/561 [00:18<00:10, 18.70it/s] 66%|██████████████████████████████████████████████████████████████████▊                                  | 371/561 [00:18<00:10, 18.80it/s] 66%|███████████████████████████████████████████████████████████████████▏                                 | 373/561 [00:18<00:10, 18.79it/s] 67%|███████████████████████████████████████████████████████████████████▌                                 | 375/561 [00:18<00:09, 18.76it/s] 67%|███████████████████████████████████████████████████████████████████▊                                 | 377/561 [00:18<00:09, 18.73it/s] 68%|████████████████████████████████████████████████████████████████████▏                                | 379/561 [00:18<00:09, 18.55it/s] 68%|████████████████████████████████████████████████████████████████████▌                                | 381/561 [00:18<00:09, 18.58it/s] 68%|████████████████████████████████████████████████████████████████████▉                                | 383/561 [00:19<00:09, 18.65it/s] 69%|█████████████████████████████████████████████████████████████████████▎                               | 385/561 [00:19<00:09, 18.46it/s] 69%|█████████████████████████████████████████████████████████████████████▋                               | 387/561 [00:19<00:09, 18.24it/s] 69%|██████████████████████████████████████████████████████████████████████                               | 389/561 [00:19<00:09, 18.30it/s][2025-03-28 01:36:44,100] [INFO] [logging.py:128:log_dist] [Rank 0] step=6000, skipped=12, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:36:44,103] [INFO] [timer.py:264:stop] epoch=0/micro_step=6000/global_step=6000, RunningAvgSamplesPerSec=20.358159754068105, CurrSamplesPerSec=18.942306963685166, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 70%|██████████████████████████████████████████████████████████████████████▍                              | 391/561 [00:19<00:09, 18.47it/s] 70%|██████████████████████████████████████████████████████████████████████▊                              | 393/561 [00:19<00:09, 18.20it/s] 70%|███████████████████████████████████████████████████████████████████████                              | 395/561 [00:19<00:09, 18.37it/s] 71%|███████████████████████████████████████████████████████████████████████▍                             | 397/561 [00:19<00:08, 18.47it/s] 71%|███████████████████████████████████████████████████████████████████████▊                             | 399/561 [00:19<00:08, 18.34it/s] 71%|████████████████████████████████████████████████████████████████████████▏                            | 401/561 [00:20<00:08, 18.64it/s][2025-03-28 01:36:44,787] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2025-03-28 01:36:44,833] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
 72%|████████████████████████████████████████████████████████████████████████▋                            | 404/561 [00:20<00:07, 19.82it/s] 72%|█████████████████████████████████████████████████████████████████████████                            | 406/561 [00:20<00:08, 19.33it/s] 73%|█████████████████████████████████████████████████████████████████████████▍                           | 408/561 [00:20<00:08, 19.08it/s] 73%|█████████████████████████████████████████████████████████████████████████▊                           | 410/561 [00:20<00:08, 18.69it/s] 73%|██████████████████████████████████████████████████████████████████████████▏                          | 412/561 [00:20<00:08, 18.60it/s] 74%|██████████████████████████████████████████████████████████████████████████▌                          | 414/561 [00:20<00:07, 18.59it/s] 74%|██████████████████████████████████████████████████████████████████████████▉                          | 416/561 [00:20<00:07, 18.86it/s] 75%|███████████████████████████████████████████████████████████████████████████▎                         | 418/561 [00:20<00:07, 18.90it/s] 75%|███████████████████████████████████████████████████████████████████████████▌                         | 420/561 [00:21<00:07, 18.20it/s] 75%|███████████████████████████████████████████████████████████████████████████▉                         | 422/561 [00:21<00:07, 18.06it/s] 76%|████████████████████████████████████████████████████████████████████████████▎                        | 424/561 [00:21<00:07, 18.34it/s] 76%|████████████████████████████████████████████████████████████████████████████▋                        | 426/561 [00:21<00:07, 18.56it/s] 76%|█████████████████████████████████████████████████████████████████████████████                        | 428/561 [00:21<00:07, 18.63it/s] 77%|█████████████████████████████████████████████████████████████████████████████▍                       | 430/561 [00:21<00:06, 18.74it/s] 77%|█████████████████████████████████████████████████████████████████████████████▊                       | 432/561 [00:21<00:06, 18.76it/s] 77%|██████████████████████████████████████████████████████████████████████████████▏                      | 434/561 [00:21<00:06, 18.76it/s] 78%|██████████████████████████████████████████████████████████████████████████████▍                      | 436/561 [00:21<00:06, 18.77it/s] 78%|██████████████████████████████████████████████████████████████████████████████▊                      | 438/561 [00:21<00:06, 18.98it/s][2025-03-28 01:36:46,767] [INFO] [logging.py:128:log_dist] [Rank 0] step=6050, skipped=14, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:36:46,771] [INFO] [timer.py:264:stop] epoch=0/micro_step=6050/global_step=6050, RunningAvgSamplesPerSec=20.34410434062905, CurrSamplesPerSec=18.652277673069708, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 78%|███████████████████████████████████████████████████████████████████████████████▏                     | 440/561 [00:22<00:06, 18.91it/s] 79%|███████████████████████████████████████████████████████████████████████████████▌                     | 442/561 [00:22<00:06, 18.87it/s] 79%|███████████████████████████████████████████████████████████████████████████████▉                     | 444/561 [00:22<00:06, 19.01it/s] 80%|████████████████████████████████████████████████████████████████████████████████▎                    | 446/561 [00:22<00:06, 18.85it/s] 80%|████████████████████████████████████████████████████████████████████████████████▋                    | 448/561 [00:22<00:06, 18.81it/s] 80%|█████████████████████████████████████████████████████████████████████████████████                    | 450/561 [00:22<00:05, 18.82it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▍                   | 452/561 [00:22<00:05, 18.92it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▋                   | 454/561 [00:22<00:05, 18.80it/s] 81%|██████████████████████████████████████████████████████████████████████████████████                   | 456/561 [00:22<00:05, 18.73it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▍                  | 458/561 [00:23<00:05, 18.65it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▊                  | 460/561 [00:23<00:05, 18.61it/s] 82%|███████████████████████████████████████████████████████████████████████████████████▏                 | 462/561 [00:23<00:05, 18.73it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▌                 | 464/561 [00:23<00:05, 18.78it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▉                 | 466/561 [00:23<00:05, 18.80it/s] 83%|████████████████████████████████████████████████████████████████████████████████████▎                | 468/561 [00:23<00:04, 18.97it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▌                | 470/561 [00:23<00:04, 18.96it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▉                | 472/561 [00:23<00:04, 18.87it/s] 84%|█████████████████████████████████████████████████████████████████████████████████████▎               | 474/561 [00:23<00:04, 18.90it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▋               | 476/561 [00:24<00:04, 18.69it/s] 85%|██████████████████████████████████████████████████████████████████████████████████████               | 478/561 [00:24<00:04, 18.54it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▍              | 480/561 [00:24<00:04, 18.44it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▊              | 482/561 [00:24<00:04, 18.36it/s] 86%|███████████████████████████████████████████████████████████████████████████████████████▏             | 484/561 [00:24<00:04, 18.46it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▍             | 486/561 [00:24<00:04, 18.64it/s] 87%|████████████████████████████████████████████████████████████████████████████████████████             | 489/561 [00:24<00:03, 19.53it/s][2025-03-28 01:36:49,423] [INFO] [logging.py:128:log_dist] [Rank 0] step=6100, skipped=14, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:36:49,426] [INFO] [timer.py:264:stop] epoch=0/micro_step=6100/global_step=6100, RunningAvgSamplesPerSec=20.331132146779016, CurrSamplesPerSec=18.00499889057272, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 88%|████████████████████████████████████████████████████████████████████████████████████████▍            | 491/561 [00:24<00:03, 19.29it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▊            | 493/561 [00:24<00:03, 19.32it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████████            | 495/561 [00:25<00:03, 19.27it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▍           | 497/561 [00:25<00:03, 18.99it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▊           | 499/561 [00:25<00:03, 18.96it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████▏          | 501/561 [00:25<00:03, 18.95it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▌          | 503/561 [00:25<00:03, 18.76it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▉          | 505/561 [00:25<00:02, 18.81it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████████▎         | 507/561 [00:25<00:02, 18.79it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▋         | 509/561 [00:25<00:02, 18.55it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▉         | 511/561 [00:25<00:02, 18.83it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████████▎        | 513/561 [00:25<00:02, 18.78it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████████▋        | 515/561 [00:26<00:02, 18.77it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████        | 517/561 [00:26<00:02, 18.77it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▍       | 519/561 [00:26<00:02, 18.75it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▊       | 521/561 [00:26<00:02, 18.66it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████████▏      | 523/561 [00:26<00:02, 18.44it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▌      | 525/561 [00:26<00:01, 18.49it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▉      | 527/561 [00:26<00:01, 18.49it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▏     | 529/561 [00:26<00:01, 18.27it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▌     | 531/561 [00:26<00:01, 18.32it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▉     | 533/561 [00:27<00:01, 18.20it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████████▎    | 535/561 [00:27<00:01, 18.28it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▋    | 537/561 [00:27<00:01, 18.19it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████    | 539/561 [00:27<00:01, 18.09it/s][2025-03-28 01:36:52,117] [INFO] [logging.py:128:log_dist] [Rank 0] step=6150, skipped=14, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:36:52,120] [INFO] [timer.py:264:stop] epoch=0/micro_step=6150/global_step=6150, RunningAvgSamplesPerSec=20.31581392091119, CurrSamplesPerSec=19.231528752319115, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 96%|█████████████████████████████████████████████████████████████████████████████████████████████████▍   | 541/561 [00:27<00:01, 18.36it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████████▊   | 543/561 [00:27<00:00, 18.68it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████████   | 545/561 [00:27<00:00, 18.60it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▍  | 547/561 [00:27<00:00, 18.89it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▊  | 549/561 [00:27<00:00, 18.54it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████████▏ | 551/561 [00:28<00:00, 18.79it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▌ | 553/561 [00:28<00:00, 18.81it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▉ | 555/561 [00:28<00:00, 18.63it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████▎| 557/561 [00:28<00:00, 18.89it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████████▋| 559/561 [00:28<00:00, 18.90it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:28<00:00, 18.99it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:28<00:00, 19.61it/s]
  0%|                                                                                                               | 0/561 [00:00<?, ?it/s]  0%|▏                                                                                                      | 1/561 [00:00<02:02,  4.57it/s]  1%|▌                                                                                                      | 3/561 [00:00<00:54, 10.29it/s]  1%|▉                                                                                                      | 5/561 [00:00<00:41, 13.25it/s]  1%|█▎                                                                                                     | 7/561 [00:00<00:36, 15.10it/s]  2%|█▋                                                                                                     | 9/561 [00:00<00:33, 16.54it/s]  2%|██                                                                                                    | 11/561 [00:00<00:31, 17.40it/s]  2%|██▎                                                                                                   | 13/561 [00:00<00:33, 16.58it/s]  3%|██▋                                                                                                   | 15/561 [00:00<00:31, 17.10it/s]  3%|███                                                                                                   | 17/561 [00:01<00:31, 17.50it/s]  3%|███▍                                                                                                  | 19/561 [00:01<00:30, 17.78it/s]  4%|███▊                                                                                                  | 21/561 [00:01<00:29, 18.28it/s]  4%|████▏                                                                                                 | 23/561 [00:01<00:29, 18.39it/s]  4%|████▌                                                                                                 | 25/561 [00:01<00:29, 18.43it/s]  5%|████▉                                                                                                 | 27/561 [00:01<00:28, 18.54it/s][2025-03-28 01:36:55,057] [INFO] [logging.py:128:log_dist] [Rank 0] step=6200, skipped=14, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:36:55,061] [INFO] [timer.py:264:stop] epoch=0/micro_step=6200/global_step=6200, RunningAvgSamplesPerSec=20.294317850051957, CurrSamplesPerSec=19.21153281447737, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
  5%|█████▎                                                                                                | 29/561 [00:01<00:28, 18.53it/s]  6%|█████▋                                                                                                | 31/561 [00:01<00:28, 18.44it/s]  6%|██████                                                                                                | 33/561 [00:01<00:28, 18.60it/s]  6%|██████▎                                                                                               | 35/561 [00:02<00:28, 18.54it/s]  7%|██████▋                                                                                               | 37/561 [00:02<00:27, 18.75it/s]  7%|███████                                                                                               | 39/561 [00:02<00:27, 18.85it/s]  7%|███████▍                                                                                              | 41/561 [00:02<00:27, 18.87it/s]  8%|███████▊                                                                                              | 43/561 [00:02<00:27, 18.88it/s]  8%|████████▏                                                                                             | 45/561 [00:02<00:27, 18.95it/s]  8%|████████▌                                                                                             | 47/561 [00:02<00:27, 18.97it/s]  9%|████████▉                                                                                             | 49/561 [00:02<00:26, 18.97it/s]  9%|█████████▎                                                                                            | 51/561 [00:02<00:26, 18.94it/s] 10%|█████████▊                                                                                            | 54/561 [00:03<00:25, 19.81it/s] 10%|██████████▎                                                                                           | 57/561 [00:03<00:24, 20.99it/s] 11%|██████████▉                                                                                           | 60/561 [00:03<00:22, 21.79it/s] 11%|███████████▍                                                                                          | 63/561 [00:03<00:22, 22.17it/s] 12%|████████████                                                                                          | 66/561 [00:03<00:22, 22.04it/s] 12%|████████████▌                                                                                         | 69/561 [00:03<00:22, 21.98it/s] 13%|█████████████                                                                                         | 72/561 [00:03<00:22, 22.21it/s] 13%|█████████████▋                                                                                        | 75/561 [00:03<00:21, 22.31it/s] 14%|██████████████▏                                                                                       | 78/561 [00:04<00:21, 21.98it/s][2025-03-28 01:36:57,480] [INFO] [logging.py:128:log_dist] [Rank 0] step=6250, skipped=14, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:36:57,480] [INFO] [timer.py:264:stop] epoch=0/micro_step=6250/global_step=6250, RunningAvgSamplesPerSec=20.297633987254432, CurrSamplesPerSec=21.477949175296303, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 14%|██████████████▋                                                                                       | 81/561 [00:04<00:21, 21.97it/s] 15%|███████████████▎                                                                                      | 84/561 [00:04<00:22, 20.93it/s] 16%|███████████████▊                                                                                      | 87/561 [00:04<00:22, 21.20it/s] 16%|████████████████▎                                                                                     | 90/561 [00:04<00:21, 21.53it/s] 17%|████████████████▉                                                                                     | 93/561 [00:04<00:22, 20.84it/s] 17%|█████████████████▍                                                                                    | 96/561 [00:05<00:23, 19.92it/s] 18%|██████████████████                                                                                    | 99/561 [00:05<00:22, 20.55it/s] 18%|██████████████████▎                                                                                  | 102/561 [00:05<00:21, 20.96it/s] 19%|██████████████████▉                                                                                  | 105/561 [00:05<00:21, 21.28it/s] 19%|███████████████████▍                                                                                 | 108/561 [00:05<00:20, 21.58it/s] 20%|███████████████████▉                                                                                 | 111/561 [00:05<00:20, 21.92it/s] 20%|████████████████████▌                                                                                | 114/561 [00:05<00:20, 21.85it/s] 21%|█████████████████████                                                                                | 117/561 [00:05<00:20, 21.89it/s] 21%|█████████████████████▌                                                                               | 120/561 [00:06<00:20, 21.86it/s] 22%|██████████████████████▏                                                                              | 123/561 [00:06<00:21, 20.28it/s] 22%|██████████████████████▋                                                                              | 126/561 [00:06<00:22, 19.62it/s][2025-03-28 01:36:59,884] [INFO] [logging.py:128:log_dist] [Rank 0] step=6300, skipped=14, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:36:59,885] [INFO] [timer.py:264:stop] epoch=0/micro_step=6300/global_step=6300, RunningAvgSamplesPerSec=20.301874858890383, CurrSamplesPerSec=21.76392330338965, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 23%|███████████████████████▏                                                                             | 129/561 [00:06<00:21, 20.13it/s] 24%|███████████████████████▊                                                                             | 132/561 [00:06<00:21, 19.86it/s] 24%|████████████████████████▎                                                                            | 135/561 [00:06<00:21, 20.22it/s] 25%|████████████████████████▊                                                                            | 138/561 [00:06<00:20, 20.88it/s] 25%|█████████████████████████▍                                                                           | 141/561 [00:07<00:19, 21.43it/s] 26%|█████████████████████████▉                                                                           | 144/561 [00:07<00:19, 21.63it/s] 26%|██████████████████████████▍                                                                          | 147/561 [00:07<00:19, 21.65it/s] 27%|███████████████████████████                                                                          | 150/561 [00:07<00:18, 21.65it/s] 27%|███████████████████████████▌                                                                         | 153/561 [00:07<00:18, 21.87it/s] 28%|████████████████████████████                                                                         | 156/561 [00:07<00:18, 22.04it/s] 28%|████████████████████████████▋                                                                        | 159/561 [00:07<00:18, 21.87it/s] 29%|█████████████████████████████▏                                                                       | 162/561 [00:08<00:18, 21.57it/s] 29%|█████████████████████████████▋                                                                       | 165/561 [00:08<00:18, 21.55it/s] 30%|██████████████████████████████▏                                                                      | 168/561 [00:08<00:18, 21.03it/s] 30%|██████████████████████████████▊                                                                      | 171/561 [00:08<00:19, 20.29it/s] 31%|███████████████████████████████▎                                                                     | 174/561 [00:08<00:18, 20.70it/s] 32%|███████████████████████████████▊                                                                     | 177/561 [00:08<00:18, 21.18it/s][2025-03-28 01:37:02,216] [INFO] [logging.py:128:log_dist] [Rank 0] step=6350, skipped=14, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:37:02,217] [INFO] [timer.py:264:stop] epoch=0/micro_step=6350/global_step=6350, RunningAvgSamplesPerSec=20.310795938050102, CurrSamplesPerSec=25.22841150546896, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 32%|████████████████████████████████▍                                                                    | 180/561 [00:08<00:17, 21.80it/s] 33%|████████████████████████████████▉                                                                    | 183/561 [00:09<00:17, 21.84it/s] 33%|█████████████████████████████████▍                                                                   | 186/561 [00:09<00:17, 21.94it/s] 34%|██████████████████████████████████                                                                   | 189/561 [00:09<00:17, 21.46it/s] 34%|██████████████████████████████████▌                                                                  | 192/561 [00:09<00:17, 21.50it/s] 35%|███████████████████████████████████                                                                  | 195/561 [00:09<00:16, 21.68it/s] 35%|███████████████████████████████████▋                                                                 | 198/561 [00:09<00:16, 21.65it/s] 36%|████████████████████████████████████▏                                                                | 201/561 [00:09<00:16, 21.85it/s] 36%|████████████████████████████████████▋                                                                | 204/561 [00:10<00:15, 22.46it/s] 37%|█████████████████████████████████████▎                                                               | 207/561 [00:10<00:15, 22.88it/s] 37%|█████████████████████████████████████▊                                                               | 210/561 [00:10<00:15, 23.13it/s] 38%|██████████████████████████████████████▎                                                              | 213/561 [00:10<00:14, 23.31it/s] 39%|██████████████████████████████████████▉                                                              | 216/561 [00:10<00:14, 23.44it/s] 39%|███████████████████████████████████████▍                                                             | 219/561 [00:10<00:14, 23.51it/s] 40%|███████████████████████████████████████▉                                                             | 222/561 [00:10<00:14, 23.62it/s] 40%|████████████████████████████████████████▌                                                            | 225/561 [00:10<00:14, 23.71it/s] 41%|█████████████████████████████████████████                                                            | 228/561 [00:11<00:13, 23.79it/s][2025-03-28 01:37:04,403] [INFO] [logging.py:128:log_dist] [Rank 0] step=6400, skipped=14, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:37:04,403] [INFO] [timer.py:264:stop] epoch=0/micro_step=6400/global_step=6400, RunningAvgSamplesPerSec=20.328931576097588, CurrSamplesPerSec=23.370216295987635, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 41%|█████████████████████████████████████████▌                                                           | 231/561 [00:11<00:13, 23.85it/s] 42%|██████████████████████████████████████████▏                                                          | 234/561 [00:11<00:14, 23.11it/s] 42%|██████████████████████████████████████████▋                                                          | 237/561 [00:11<00:14, 22.65it/s] 43%|███████████████████████████████████████████▏                                                         | 240/561 [00:11<00:14, 22.65it/s] 43%|███████████████████████████████████████████▋                                                         | 243/561 [00:11<00:14, 21.80it/s] 44%|████████████████████████████████████████████▎                                                        | 246/561 [00:11<00:14, 22.06it/s] 44%|████████████████████████████████████████████▊                                                        | 249/561 [00:12<00:14, 21.38it/s] 45%|█████████████████████████████████████████████▎                                                       | 252/561 [00:12<00:14, 21.56it/s] 45%|█████████████████████████████████████████████▉                                                       | 255/561 [00:12<00:14, 21.74it/s] 46%|██████████████████████████████████████████████▍                                                      | 258/561 [00:12<00:13, 21.79it/s] 47%|██████████████████████████████████████████████▉                                                      | 261/561 [00:12<00:13, 21.71it/s] 47%|███████████████████████████████████████████████▌                                                     | 264/561 [00:12<00:14, 21.02it/s] 48%|████████████████████████████████████████████████                                                     | 267/561 [00:12<00:14, 20.92it/s] 48%|████████████████████████████████████████████████▌                                                    | 270/561 [00:12<00:13, 21.56it/s] 49%|█████████████████████████████████████████████████▏                                                   | 273/561 [00:13<00:13, 20.73it/s] 49%|█████████████████████████████████████████████████▋                                                   | 276/561 [00:13<00:13, 21.01it/s][2025-03-28 01:37:06,735] [INFO] [logging.py:128:log_dist] [Rank 0] step=6450, skipped=14, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:37:06,736] [INFO] [timer.py:264:stop] epoch=0/micro_step=6450/global_step=6450, RunningAvgSamplesPerSec=20.337444406661845, CurrSamplesPerSec=22.487371892330454, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 50%|██████████████████████████████████████████████████▏                                                  | 279/561 [00:13<00:13, 21.26it/s] 50%|██████████████████████████████████████████████████▊                                                  | 282/561 [00:13<00:13, 21.33it/s] 51%|███████████████████████████████████████████████████▎                                                 | 285/561 [00:13<00:12, 21.68it/s] 51%|███████████████████████████████████████████████████▊                                                 | 288/561 [00:13<00:12, 21.86it/s] 52%|████████████████████████████████████████████████████▍                                                | 291/561 [00:13<00:12, 21.76it/s] 52%|████████████████████████████████████████████████████▉                                                | 294/561 [00:14<00:12, 21.38it/s] 53%|█████████████████████████████████████████████████████▍                                               | 297/561 [00:14<00:12, 21.58it/s] 53%|██████████████████████████████████████████████████████                                               | 300/561 [00:14<00:12, 21.60it/s] 54%|██████████████████████████████████████████████████████▌                                              | 303/561 [00:14<00:11, 21.74it/s] 55%|███████████████████████████████████████████████████████                                              | 306/561 [00:14<00:11, 21.86it/s] 55%|███████████████████████████████████████████████████████▋                                             | 309/561 [00:14<00:11, 21.95it/s] 56%|████████████████████████████████████████████████████████▏                                            | 312/561 [00:14<00:11, 22.16it/s] 56%|████████████████████████████████████████████████████████▋                                            | 315/561 [00:15<00:10, 22.37it/s] 57%|█████████████████████████████████████████████████████████▎                                           | 318/561 [00:15<00:10, 22.19it/s] 57%|█████████████████████████████████████████████████████████▊                                           | 321/561 [00:15<00:10, 22.33it/s] 58%|██████████████████████████████████████████████████████████▎                                          | 324/561 [00:15<00:10, 22.30it/s] 58%|██████████████████████████████████████████████████████████▊                                          | 327/561 [00:15<00:10, 22.28it/s][2025-03-28 01:37:09,007] [INFO] [logging.py:128:log_dist] [Rank 0] step=6500, skipped=14, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:37:09,008] [INFO] [timer.py:264:stop] epoch=0/micro_step=6500/global_step=6500, RunningAvgSamplesPerSec=20.34976527252509, CurrSamplesPerSec=21.26247633167801, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 59%|███████████████████████████████████████████████████████████▍                                         | 330/561 [00:15<00:10, 22.09it/s] 59%|███████████████████████████████████████████████████████████▉                                         | 333/561 [00:15<00:10, 22.57it/s] 60%|████████████████████████████████████████████████████████████▍                                        | 336/561 [00:15<00:09, 22.82it/s] 60%|█████████████████████████████████████████████████████████████                                        | 339/561 [00:16<00:09, 22.63it/s] 61%|█████████████████████████████████████████████████████████████▌                                       | 342/561 [00:16<00:10, 21.69it/s] 61%|██████████████████████████████████████████████████████████████                                       | 345/561 [00:16<00:09, 21.84it/s] 62%|██████████████████████████████████████████████████████████████▋                                      | 348/561 [00:16<00:09, 21.66it/s] 63%|███████████████████████████████████████████████████████████████▏                                     | 351/561 [00:16<00:09, 22.27it/s] 63%|███████████████████████████████████████████████████████████████▋                                     | 354/561 [00:16<00:09, 22.50it/s] 64%|████████████████████████████████████████████████████████████████▎                                    | 357/561 [00:16<00:09, 22.21it/s] 64%|████████████████████████████████████████████████████████████████▊                                    | 360/561 [00:17<00:09, 22.32it/s] 65%|█████████████████████████████████████████████████████████████████▎                                   | 363/561 [00:17<00:08, 22.78it/s] 65%|█████████████████████████████████████████████████████████████████▉                                   | 366/561 [00:17<00:08, 23.23it/s] 66%|██████████████████████████████████████████████████████████████████▍                                  | 369/561 [00:17<00:08, 23.03it/s] 66%|██████████████████████████████████████████████████████████████████▉                                  | 372/561 [00:17<00:08, 22.79it/s] 67%|███████████████████████████████████████████████████████████████████▌                                 | 375/561 [00:17<00:08, 21.89it/s] 67%|████████████████████████████████████████████████████████████████████                                 | 378/561 [00:17<00:08, 21.51it/s][2025-03-28 01:37:11,253] [INFO] [logging.py:128:log_dist] [Rank 0] step=6550, skipped=14, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:37:11,254] [INFO] [timer.py:264:stop] epoch=0/micro_step=6550/global_step=6550, RunningAvgSamplesPerSec=20.363483668580024, CurrSamplesPerSec=22.449458275467713, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 68%|████████████████████████████████████████████████████████████████████▌                                | 381/561 [00:18<00:08, 21.69it/s] 68%|█████████████████████████████████████████████████████████████████████▏                               | 384/561 [00:18<00:08, 21.84it/s] 69%|█████████████████████████████████████████████████████████████████████▋                               | 387/561 [00:18<00:08, 21.25it/s] 70%|██████████████████████████████████████████████████████████████████████▏                              | 390/561 [00:18<00:07, 21.38it/s] 70%|██████████████████████████████████████████████████████████████████████▊                              | 393/561 [00:18<00:07, 21.56it/s] 71%|███████████████████████████████████████████████████████████████████████▎                             | 396/561 [00:18<00:07, 21.61it/s] 71%|███████████████████████████████████████████████████████████████████████▊                             | 399/561 [00:18<00:07, 21.70it/s] 72%|████████████████████████████████████████████████████████████████████████▎                            | 402/561 [00:18<00:07, 22.12it/s] 72%|████████████████████████████████████████████████████████████████████████▉                            | 405/561 [00:19<00:07, 22.19it/s] 73%|█████████████████████████████████████████████████████████████████████████▍                           | 408/561 [00:19<00:06, 22.09it/s] 73%|█████████████████████████████████████████████████████████████████████████▉                           | 411/561 [00:19<00:06, 21.99it/s] 74%|██████████████████████████████████████████████████████████████████████████▌                          | 414/561 [00:19<00:06, 21.43it/s] 74%|███████████████████████████████████████████████████████████████████████████                          | 417/561 [00:19<00:06, 21.43it/s] 75%|███████████████████████████████████████████████████████████████████████████▌                         | 420/561 [00:19<00:06, 21.34it/s] 75%|████████████████████████████████████████████████████████████████████████████▏                        | 423/561 [00:19<00:06, 21.49it/s] 76%|████████████████████████████████████████████████████████████████████████████▋                        | 426/561 [00:20<00:06, 21.67it/s][2025-03-28 01:37:13,558] [INFO] [logging.py:128:log_dist] [Rank 0] step=6600, skipped=14, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:37:13,559] [INFO] [timer.py:264:stop] epoch=0/micro_step=6600/global_step=6600, RunningAvgSamplesPerSec=20.37328898448445, CurrSamplesPerSec=20.87225216315378, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 76%|█████████████████████████████████████████████████████████████████████████████▏                       | 429/561 [00:20<00:06, 21.70it/s] 77%|█████████████████████████████████████████████████████████████████████████████▊                       | 432/561 [00:20<00:06, 21.22it/s] 78%|██████████████████████████████████████████████████████████████████████████████▎                      | 435/561 [00:20<00:05, 21.57it/s] 78%|██████████████████████████████████████████████████████████████████████████████▊                      | 438/561 [00:20<00:05, 22.05it/s] 79%|███████████████████████████████████████████████████████████████████████████████▍                     | 441/561 [00:20<00:05, 22.17it/s] 79%|███████████████████████████████████████████████████████████████████████████████▉                     | 444/561 [00:20<00:05, 21.97it/s] 80%|████████████████████████████████████████████████████████████████████████████████▍                    | 447/561 [00:21<00:05, 21.77it/s] 80%|█████████████████████████████████████████████████████████████████████████████████                    | 450/561 [00:21<00:05, 21.74it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▌                   | 453/561 [00:21<00:04, 21.89it/s] 81%|██████████████████████████████████████████████████████████████████████████████████                   | 456/561 [00:21<00:04, 21.92it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▋                  | 459/561 [00:21<00:04, 22.06it/s] 82%|███████████████████████████████████████████████████████████████████████████████████▏                 | 462/561 [00:21<00:04, 22.13it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▋                 | 465/561 [00:21<00:04, 21.95it/s] 83%|████████████████████████████████████████████████████████████████████████████████████▎                | 468/561 [00:22<00:04, 21.93it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▊                | 471/561 [00:22<00:04, 21.78it/s] 84%|█████████████████████████████████████████████████████████████████████████████████████▎               | 474/561 [00:22<00:04, 21.60it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▉               | 477/561 [00:22<00:03, 21.93it/s][2025-03-28 01:37:15,844] [INFO] [logging.py:128:log_dist] [Rank 0] step=6650, skipped=14, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:37:15,844] [INFO] [timer.py:264:stop] epoch=0/micro_step=6650/global_step=6650, RunningAvgSamplesPerSec=20.384227843775726, CurrSamplesPerSec=21.608740772043735, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 86%|██████████████████████████████████████████████████████████████████████████████████████▍              | 480/561 [00:22<00:03, 21.93it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▉              | 483/561 [00:22<00:03, 22.41it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▍             | 486/561 [00:22<00:03, 21.77it/s] 87%|████████████████████████████████████████████████████████████████████████████████████████             | 489/561 [00:22<00:03, 22.32it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▌            | 492/561 [00:23<00:03, 22.80it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████████            | 495/561 [00:23<00:02, 23.09it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▋           | 498/561 [00:23<00:02, 23.26it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████▏          | 501/561 [00:23<00:02, 22.75it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▋          | 504/561 [00:23<00:02, 21.58it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████████▎         | 507/561 [00:23<00:02, 21.44it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▊         | 510/561 [00:23<00:02, 21.59it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████████▎        | 513/561 [00:24<00:02, 21.63it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████████▉        | 516/561 [00:24<00:02, 21.91it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▍       | 519/561 [00:24<00:01, 21.28it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▉       | 522/561 [00:24<00:01, 21.34it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▌      | 525/561 [00:24<00:01, 21.73it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████      | 528/561 [00:24<00:01, 21.78it/s][2025-03-28 01:37:18,116] [INFO] [logging.py:128:log_dist] [Rank 0] step=6700, skipped=14, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:37:18,117] [INFO] [timer.py:264:stop] epoch=0/micro_step=6700/global_step=6700, RunningAvgSamplesPerSec=20.395811112081496, CurrSamplesPerSec=22.104695752603185, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 95%|███████████████████████████████████████████████████████████████████████████████████████████████▌     | 531/561 [00:24<00:01, 22.10it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████████▏    | 534/561 [00:25<00:01, 22.41it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▋    | 537/561 [00:25<00:01, 22.89it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████▏   | 540/561 [00:25<00:00, 22.52it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████████▊   | 543/561 [00:25<00:00, 22.38it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████████▎  | 546/561 [00:25<00:00, 22.28it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▊  | 549/561 [00:25<00:00, 22.23it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████████▍ | 552/561 [00:25<00:00, 22.21it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▉ | 555/561 [00:25<00:00, 22.05it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████▍| 558/561 [00:26<00:00, 22.10it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:26<00:00, 22.24it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:26<00:00, 21.34it/s]
  0%|                                                                                                               | 0/561 [00:00<?, ?it/s]  0%|▏                                                                                                      | 1/561 [00:00<01:38,  5.66it/s]  1%|▋                                                                                                      | 4/561 [00:00<00:40, 13.84it/s]  1%|█▎                                                                                                     | 7/561 [00:00<00:32, 17.14it/s]  2%|█▊                                                                                                    | 10/561 [00:00<00:29, 18.80it/s]  2%|██▎                                                                                                   | 13/561 [00:00<00:27, 19.97it/s]  3%|██▉                                                                                                   | 16/561 [00:00<00:26, 20.67it/s][2025-03-28 01:37:20,602] [INFO] [logging.py:128:log_dist] [Rank 0] step=6750, skipped=14, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:37:20,603] [INFO] [timer.py:264:stop] epoch=0/micro_step=6750/global_step=6750, RunningAvgSamplesPerSec=20.40290360902401, CurrSamplesPerSec=18.4016234057279, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
  3%|███▍                                                                                                  | 19/561 [00:01<00:27, 19.94it/s]  4%|████                                                                                                  | 22/561 [00:01<00:27, 19.89it/s]  4%|████▌                                                                                                 | 25/561 [00:01<00:26, 20.54it/s]  5%|█████                                                                                                 | 28/561 [00:01<00:24, 21.48it/s]  6%|█████▋                                                                                                | 31/561 [00:01<00:23, 22.11it/s]  6%|██████▏                                                                                               | 34/561 [00:01<00:23, 22.62it/s]  7%|██████▋                                                                                               | 37/561 [00:01<00:23, 22.26it/s]  7%|███████▎                                                                                              | 40/561 [00:01<00:23, 21.94it/s]  8%|███████▊                                                                                              | 43/561 [00:02<00:23, 21.98it/s]  8%|████████▎                                                                                             | 46/561 [00:02<00:23, 21.91it/s]  9%|████████▉                                                                                             | 49/561 [00:02<00:23, 21.78it/s]  9%|█████████▍                                                                                            | 52/561 [00:02<00:23, 22.06it/s] 10%|██████████                                                                                            | 55/561 [00:02<00:23, 21.66it/s] 10%|██████████▌                                                                                           | 58/561 [00:02<00:23, 21.77it/s] 11%|███████████                                                                                           | 61/561 [00:02<00:22, 21.88it/s] 11%|███████████▋                                                                                          | 64/561 [00:03<00:22, 21.74it/s] 12%|████████████▏                                                                                         | 67/561 [00:03<00:22, 21.88it/s][2025-03-28 01:37:22,890] [INFO] [logging.py:128:log_dist] [Rank 0] step=6800, skipped=14, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:37:22,891] [INFO] [timer.py:264:stop] epoch=0/micro_step=6800/global_step=6800, RunningAvgSamplesPerSec=20.413256925356123, CurrSamplesPerSec=21.35775423587032, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 12%|████████████▋                                                                                         | 70/561 [00:03<00:22, 21.84it/s] 13%|█████████████▎                                                                                        | 73/561 [00:03<00:22, 22.05it/s] 14%|█████████████▊                                                                                        | 76/561 [00:03<00:21, 22.08it/s] 14%|██████████████▎                                                                                       | 79/561 [00:03<00:21, 22.11it/s] 15%|██████████████▉                                                                                       | 82/561 [00:03<00:21, 22.60it/s] 15%|███████████████▍                                                                                      | 85/561 [00:04<00:20, 22.96it/s] 16%|████████████████                                                                                      | 88/561 [00:04<00:20, 23.13it/s] 16%|████████████████▌                                                                                     | 91/561 [00:04<00:20, 23.20it/s] 17%|█████████████████                                                                                     | 94/561 [00:04<00:19, 23.40it/s] 17%|█████████████████▋                                                                                    | 97/561 [00:04<00:19, 23.63it/s] 18%|██████████████████                                                                                   | 100/561 [00:04<00:19, 23.57it/s] 18%|██████████████████▌                                                                                  | 103/561 [00:04<00:20, 21.91it/s] 19%|███████████████████                                                                                  | 106/561 [00:04<00:21, 21.20it/s] 19%|███████████████████▌                                                                                 | 109/561 [00:05<00:21, 21.45it/s] 20%|████████████████████▏                                                                                | 112/561 [00:05<00:20, 21.61it/s] 20%|████████████████████▋                                                                                | 115/561 [00:05<00:20, 21.67it/s][2025-03-28 01:37:25,128] [INFO] [logging.py:128:log_dist] [Rank 0] step=6850, skipped=14, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:37:25,129] [INFO] [timer.py:264:stop] epoch=0/micro_step=6850/global_step=6850, RunningAvgSamplesPerSec=20.426487953313163, CurrSamplesPerSec=22.437328898633986, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 21%|█████████████████████▏                                                                               | 118/561 [00:05<00:20, 21.74it/s] 22%|█████████████████████▊                                                                               | 121/561 [00:05<00:20, 21.97it/s] 22%|██████████████████████▎                                                                              | 124/561 [00:05<00:20, 21.83it/s] 23%|██████████████████████▊                                                                              | 127/561 [00:05<00:19, 22.01it/s] 23%|███████████████████████▍                                                                             | 130/561 [00:06<00:19, 22.55it/s] 24%|███████████████████████▉                                                                             | 133/561 [00:06<00:18, 22.83it/s] 24%|████████████████████████▍                                                                            | 136/561 [00:06<00:18, 23.16it/s] 25%|█████████████████████████                                                                            | 139/561 [00:06<00:18, 23.41it/s] 25%|█████████████████████████▌                                                                           | 142/561 [00:06<00:17, 23.53it/s] 26%|██████████████████████████                                                                           | 145/561 [00:06<00:17, 23.59it/s] 26%|██████████████████████████▋                                                                          | 148/561 [00:06<00:17, 23.68it/s] 27%|███████████████████████████▏                                                                         | 151/561 [00:06<00:17, 23.80it/s] 27%|███████████████████████████▋                                                                         | 154/561 [00:07<00:17, 23.53it/s] 28%|████████████████████████████▎                                                                        | 157/561 [00:07<00:17, 23.40it/s] 29%|████████████████████████████▊                                                                        | 160/561 [00:07<00:17, 23.38it/s] 29%|█████████████████████████████▎                                                                       | 163/561 [00:07<00:17, 22.99it/s] 30%|█████████████████████████████▉                                                                       | 166/561 [00:07<00:17, 22.71it/s][2025-03-28 01:37:27,293] [INFO] [logging.py:128:log_dist] [Rank 0] step=6900, skipped=14, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:37:27,294] [INFO] [timer.py:264:stop] epoch=0/micro_step=6900/global_step=6900, RunningAvgSamplesPerSec=20.443961224420985, CurrSamplesPerSec=21.729871400886267, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 30%|██████████████████████████████▍                                                                      | 169/561 [00:07<00:17, 22.49it/s] 31%|██████████████████████████████▉                                                                      | 172/561 [00:07<00:17, 22.39it/s] 31%|███████████████████████████████▌                                                                     | 175/561 [00:07<00:17, 22.61it/s] 32%|████████████████████████████████                                                                     | 178/561 [00:08<00:17, 21.82it/s] 32%|████████████████████████████████▌                                                                    | 181/561 [00:08<00:17, 22.08it/s] 33%|█████████████████████████████████▏                                                                   | 184/561 [00:08<00:16, 22.65it/s] 33%|█████████████████████████████████▋                                                                   | 187/561 [00:08<00:17, 21.91it/s] 34%|██████████████████████████████████▏                                                                  | 190/561 [00:08<00:17, 21.68it/s] 34%|██████████████████████████████████▋                                                                  | 193/561 [00:08<00:16, 21.84it/s] 35%|███████████████████████████████████▎                                                                 | 196/561 [00:08<00:16, 21.97it/s] 35%|███████████████████████████████████▊                                                                 | 199/561 [00:09<00:16, 21.94it/s] 36%|████████████████████████████████████▎                                                                | 202/561 [00:09<00:16, 21.87it/s] 37%|████████████████████████████████████▉                                                                | 205/561 [00:09<00:16, 21.69it/s] 37%|█████████████████████████████████████▍                                                               | 208/561 [00:09<00:16, 21.79it/s] 38%|█████████████████████████████████████▉                                                               | 211/561 [00:09<00:16, 21.59it/s] 38%|██████████████████████████████████████▌                                                              | 214/561 [00:09<00:16, 21.63it/s] 39%|███████████████████████████████████████                                                              | 217/561 [00:09<00:16, 21.27it/s][2025-03-28 01:37:29,594] [INFO] [logging.py:128:log_dist] [Rank 0] step=6950, skipped=14, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:37:29,594] [INFO] [timer.py:264:stop] epoch=0/micro_step=6950/global_step=6950, RunningAvgSamplesPerSec=20.45306987111753, CurrSamplesPerSec=21.00247825109269, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 39%|███████████████████████████████████████▌                                                             | 220/561 [00:10<00:15, 21.34it/s] 40%|████████████████████████████████████████▏                                                            | 223/561 [00:10<00:15, 21.87it/s] 40%|████████████████████████████████████████▋                                                            | 226/561 [00:10<00:15, 21.96it/s] 41%|█████████████████████████████████████████▏                                                           | 229/561 [00:10<00:15, 22.09it/s] 41%|█████████████████████████████████████████▊                                                           | 232/561 [00:10<00:14, 22.10it/s] 42%|██████████████████████████████████████████▎                                                          | 235/561 [00:10<00:14, 22.08it/s] 42%|██████████████████████████████████████████▊                                                          | 238/561 [00:10<00:14, 22.02it/s] 43%|███████████████████████████████████████████▍                                                         | 241/561 [00:11<00:14, 21.99it/s] 43%|███████████████████████████████████████████▉                                                         | 244/561 [00:11<00:14, 21.82it/s] 44%|████████████████████████████████████████████▍                                                        | 247/561 [00:11<00:14, 21.81it/s] 45%|█████████████████████████████████████████████                                                        | 250/561 [00:11<00:14, 21.75it/s] 45%|█████████████████████████████████████████████▌                                                       | 253/561 [00:11<00:14, 21.99it/s] 46%|██████████████████████████████████████████████                                                       | 256/561 [00:11<00:13, 21.99it/s] 46%|██████████████████████████████████████████████▋                                                      | 259/561 [00:11<00:13, 21.95it/s] 47%|███████████████████████████████████████████████▏                                                     | 262/561 [00:11<00:13, 21.41it/s] 47%|███████████████████████████████████████████████▋                                                     | 265/561 [00:12<00:13, 21.49it/s][2025-03-28 01:37:31,878] [INFO] [logging.py:128:log_dist] [Rank 0] step=7000, skipped=14, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:37:31,879] [INFO] [timer.py:264:stop] epoch=0/micro_step=7000/global_step=7000, RunningAvgSamplesPerSec=20.463010504566935, CurrSamplesPerSec=21.564966939374916, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 48%|████████████████████████████████████████████████▏                                                    | 268/561 [00:12<00:13, 21.49it/s] 48%|████████████████████████████████████████████████▊                                                    | 271/561 [00:12<00:13, 22.00it/s] 49%|█████████████████████████████████████████████████▎                                                   | 274/561 [00:12<00:12, 22.49it/s] 49%|█████████████████████████████████████████████████▊                                                   | 277/561 [00:12<00:12, 22.74it/s] 50%|██████████████████████████████████████████████████▍                                                  | 280/561 [00:12<00:13, 20.90it/s][2025-03-28 01:37:32,574] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
 50%|██████████████████████████████████████████████████▉                                                  | 283/561 [00:12<00:13, 21.03it/s][2025-03-28 01:37:32,620] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
 51%|███████████████████████████████████████████████████▍                                                 | 286/561 [00:13<00:13, 21.06it/s] 52%|████████████████████████████████████████████████████                                                 | 289/561 [00:13<00:12, 21.37it/s] 52%|████████████████████████████████████████████████████▌                                                | 292/561 [00:13<00:12, 21.48it/s] 53%|█████████████████████████████████████████████████████                                                | 295/561 [00:13<00:12, 21.72it/s] 53%|█████████████████████████████████████████████████████▋                                               | 298/561 [00:13<00:12, 21.84it/s] 54%|██████████████████████████████████████████████████████▏                                              | 301/561 [00:13<00:11, 21.82it/s] 54%|██████████████████████████████████████████████████████▋                                              | 304/561 [00:13<00:11, 21.74it/s] 55%|███████████████████████████████████████████████████████▎                                             | 307/561 [00:14<00:11, 21.86it/s] 55%|███████████████████████████████████████████████████████▊                                             | 310/561 [00:14<00:11, 21.94it/s] 56%|████████████████████████████████████████████████████████▎                                            | 313/561 [00:14<00:11, 21.89it/s] 56%|████████████████████████████████████████████████████████▉                                            | 316/561 [00:14<00:11, 21.96it/s][2025-03-28 01:37:34,179] [INFO] [logging.py:128:log_dist] [Rank 0] step=7050, skipped=16, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:37:34,180] [INFO] [timer.py:264:stop] epoch=0/micro_step=7050/global_step=7050, RunningAvgSamplesPerSec=20.47185565210946, CurrSamplesPerSec=18.78771203855998, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 57%|█████████████████████████████████████████████████████████▍                                           | 319/561 [00:14<00:11, 21.03it/s] 57%|█████████████████████████████████████████████████████████▉                                           | 322/561 [00:14<00:11, 21.25it/s] 58%|██████████████████████████████████████████████████████████▌                                          | 325/561 [00:14<00:10, 22.10it/s] 58%|███████████████████████████████████████████████████████████                                          | 328/561 [00:14<00:10, 22.51it/s] 59%|███████████████████████████████████████████████████████████▌                                         | 331/561 [00:15<00:10, 22.93it/s] 60%|████████████████████████████████████████████████████████████▏                                        | 334/561 [00:15<00:09, 23.24it/s] 60%|████████████████████████████████████████████████████████████▋                                        | 337/561 [00:15<00:09, 23.30it/s] 61%|█████████████████████████████████████████████████████████████▏                                       | 340/561 [00:15<00:09, 23.50it/s] 61%|█████████████████████████████████████████████████████████████▊                                       | 343/561 [00:15<00:09, 23.40it/s] 62%|██████████████████████████████████████████████████████████████▎                                      | 346/561 [00:15<00:09, 23.52it/s] 62%|██████████████████████████████████████████████████████████████▊                                      | 349/561 [00:15<00:09, 22.30it/s] 63%|███████████████████████████████████████████████████████████████▎                                     | 352/561 [00:16<00:09, 21.91it/s] 63%|███████████████████████████████████████████████████████████████▉                                     | 355/561 [00:16<00:09, 21.81it/s] 64%|████████████████████████████████████████████████████████████████▍                                    | 358/561 [00:16<00:09, 21.78it/s] 64%|████████████████████████████████████████████████████████████████▉                                    | 361/561 [00:16<00:09, 22.07it/s] 65%|█████████████████████████████████████████████████████████████████▌                                   | 364/561 [00:16<00:08, 22.02it/s] 65%|██████████████████████████████████████████████████████████████████                                   | 367/561 [00:16<00:08, 21.94it/s][2025-03-28 01:37:36,408] [INFO] [logging.py:128:log_dist] [Rank 0] step=7100, skipped=16, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:37:36,409] [INFO] [timer.py:264:stop] epoch=0/micro_step=7100/global_step=7100, RunningAvgSamplesPerSec=20.484812556381552, CurrSamplesPerSec=21.59116547282088, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 66%|██████████████████████████████████████████████████████████████████▌                                  | 370/561 [00:16<00:08, 21.79it/s] 66%|███████████████████████████████████████████████████████████████████▏                                 | 373/561 [00:17<00:08, 21.89it/s] 67%|███████████████████████████████████████████████████████████████████▋                                 | 376/561 [00:17<00:08, 22.19it/s] 68%|████████████████████████████████████████████████████████████████████▏                                | 379/561 [00:17<00:08, 22.08it/s] 68%|████████████████████████████████████████████████████████████████████▊                                | 382/561 [00:17<00:08, 21.93it/s] 69%|█████████████████████████████████████████████████████████████████████▎                               | 385/561 [00:17<00:08, 21.90it/s] 69%|█████████████████████████████████████████████████████████████████████▊                               | 388/561 [00:17<00:07, 22.18it/s] 70%|██████████████████████████████████████████████████████████████████████▍                              | 391/561 [00:17<00:07, 22.79it/s] 70%|██████████████████████████████████████████████████████████████████████▉                              | 394/561 [00:17<00:07, 21.89it/s] 71%|███████████████████████████████████████████████████████████████████████▍                             | 397/561 [00:18<00:07, 21.96it/s] 71%|████████████████████████████████████████████████████████████████████████                             | 400/561 [00:18<00:07, 21.01it/s] 72%|████████████████████████████████████████████████████████████████████████▌                            | 403/561 [00:18<00:07, 21.19it/s] 72%|█████████████████████████████████████████████████████████████████████████                            | 406/561 [00:18<00:07, 21.53it/s] 73%|█████████████████████████████████████████████████████████████████████████▋                           | 409/561 [00:18<00:06, 21.79it/s] 73%|██████████████████████████████████████████████████████████████████████████▏                          | 412/561 [00:18<00:06, 22.37it/s] 74%|██████████████████████████████████████████████████████████████████████████▋                          | 415/561 [00:18<00:06, 22.76it/s][2025-03-28 01:37:38,665] [INFO] [logging.py:128:log_dist] [Rank 0] step=7150, skipped=16, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:37:38,665] [INFO] [timer.py:264:stop] epoch=0/micro_step=7150/global_step=7150, RunningAvgSamplesPerSec=20.495976765702785, CurrSamplesPerSec=23.758351555779196, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 75%|███████████████████████████████████████████████████████████████████████████▎                         | 418/561 [00:19<00:06, 22.98it/s] 75%|███████████████████████████████████████████████████████████████████████████▊                         | 421/561 [00:19<00:06, 23.02it/s] 76%|████████████████████████████████████████████████████████████████████████████▎                        | 424/561 [00:19<00:06, 22.76it/s] 76%|████████████████████████████████████████████████████████████████████████████▉                        | 427/561 [00:19<00:05, 22.36it/s] 77%|█████████████████████████████████████████████████████████████████████████████▍                       | 430/561 [00:19<00:05, 22.11it/s] 77%|█████████████████████████████████████████████████████████████████████████████▉                       | 433/561 [00:19<00:05, 22.18it/s] 78%|██████████████████████████████████████████████████████████████████████████████▍                      | 436/561 [00:19<00:05, 22.17it/s] 78%|███████████████████████████████████████████████████████████████████████████████                      | 439/561 [00:19<00:05, 22.01it/s] 79%|███████████████████████████████████████████████████████████████████████████████▌                     | 442/561 [00:20<00:05, 21.63it/s] 79%|████████████████████████████████████████████████████████████████████████████████                     | 445/561 [00:20<00:05, 21.66it/s] 80%|████████████████████████████████████████████████████████████████████████████████▋                    | 448/561 [00:20<00:05, 22.37it/s] 80%|█████████████████████████████████████████████████████████████████████████████████▏                   | 451/561 [00:20<00:04, 22.80it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▋                   | 454/561 [00:20<00:04, 22.86it/s] 81%|██████████████████████████████████████████████████████████████████████████████████▎                  | 457/561 [00:20<00:04, 22.61it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▊                  | 460/561 [00:20<00:04, 22.53it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▎                 | 463/561 [00:21<00:04, 22.49it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▉                 | 466/561 [00:21<00:04, 22.15it/s][2025-03-28 01:37:40,917] [INFO] [logging.py:128:log_dist] [Rank 0] step=7200, skipped=16, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:37:40,918] [INFO] [timer.py:264:stop] epoch=0/micro_step=7200/global_step=7200, RunningAvgSamplesPerSec=20.507268977595395, CurrSamplesPerSec=21.050333046439352, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 84%|████████████████████████████████████████████████████████████████████████████████████▍                | 469/561 [00:21<00:04, 22.09it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▉                | 472/561 [00:21<00:03, 22.53it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▌               | 475/561 [00:21<00:03, 22.99it/s] 85%|██████████████████████████████████████████████████████████████████████████████████████               | 478/561 [00:21<00:03, 23.21it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▌              | 481/561 [00:21<00:03, 23.47it/s] 86%|███████████████████████████████████████████████████████████████████████████████████████▏             | 484/561 [00:21<00:03, 23.43it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▋             | 487/561 [00:22<00:03, 23.46it/s] 87%|████████████████████████████████████████████████████████████████████████████████████████▏            | 490/561 [00:22<00:03, 23.57it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▊            | 493/561 [00:22<00:03, 22.19it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████████▎           | 496/561 [00:22<00:02, 21.68it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▊           | 499/561 [00:22<00:02, 21.88it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████▍          | 502/561 [00:22<00:02, 21.69it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▉          | 505/561 [00:22<00:02, 21.43it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▍         | 508/561 [00:23<00:02, 21.71it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▉         | 511/561 [00:23<00:02, 21.99it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████████▌        | 514/561 [00:23<00:02, 22.11it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████        | 517/561 [00:23<00:01, 22.64it/s][2025-03-28 01:37:43,131] [INFO] [logging.py:128:log_dist] [Rank 0] step=7250, skipped=16, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:37:43,131] [INFO] [timer.py:264:stop] epoch=0/micro_step=7250/global_step=7250, RunningAvgSamplesPerSec=20.520679635023384, CurrSamplesPerSec=24.30266231267601, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 93%|█████████████████████████████████████████████████████████████████████████████████████████████▌       | 520/561 [00:23<00:01, 23.05it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████████▏      | 523/561 [00:23<00:01, 22.99it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▋      | 526/561 [00:23<00:01, 22.04it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▏     | 529/561 [00:24<00:01, 22.05it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▊     | 532/561 [00:24<00:01, 21.57it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████████▎    | 535/561 [00:24<00:01, 21.69it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▊    | 538/561 [00:24<00:01, 21.82it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████▍   | 541/561 [00:24<00:00, 21.92it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████████▉   | 544/561 [00:24<00:00, 21.96it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▍  | 547/561 [00:24<00:00, 22.04it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████████  | 550/561 [00:24<00:00, 22.17it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▌ | 553/561 [00:25<00:00, 22.18it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████ | 556/561 [00:25<00:00, 22.35it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████████▋| 559/561 [00:25<00:00, 22.31it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:25<00:00, 21.99it/s]
  0%|                                                                                                               | 0/561 [00:00<?, ?it/s]  0%|▏                                                                                                      | 1/561 [00:00<03:10,  2.94it/s]  1%|▋                                                                                                      | 4/561 [00:00<00:57,  9.72it/s][2025-03-28 01:37:45,782] [INFO] [logging.py:128:log_dist] [Rank 0] step=7300, skipped=16, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:37:45,783] [INFO] [timer.py:264:stop] epoch=0/micro_step=7300/global_step=7300, RunningAvgSamplesPerSec=20.516489934016533, CurrSamplesPerSec=21.63114061806207, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
  1%|█▎                                                                                                     | 7/561 [00:00<00:40, 13.84it/s]  2%|█▊                                                                                                    | 10/561 [00:00<00:32, 16.77it/s]  2%|██▎                                                                                                   | 13/561 [00:00<00:28, 19.07it/s]  3%|██▉                                                                                                   | 16/561 [00:01<00:26, 20.38it/s]  3%|███▍                                                                                                  | 19/561 [00:01<00:25, 21.29it/s]  4%|████                                                                                                  | 22/561 [00:01<00:24, 21.84it/s]  4%|████▌                                                                                                 | 25/561 [00:01<00:24, 21.88it/s]  5%|█████                                                                                                 | 28/561 [00:01<00:24, 21.88it/s]  6%|█████▋                                                                                                | 31/561 [00:01<00:24, 21.74it/s]  6%|██████▏                                                                                               | 34/561 [00:01<00:23, 22.12it/s]  7%|██████▋                                                                                               | 37/561 [00:01<00:23, 22.69it/s]  7%|███████▎                                                                                              | 40/561 [00:02<00:22, 22.95it/s]  8%|███████▊                                                                                              | 43/561 [00:02<00:22, 23.18it/s]  8%|████████▎                                                                                             | 46/561 [00:02<00:21, 23.52it/s]  9%|████████▉                                                                                             | 49/561 [00:02<00:21, 23.54it/s]  9%|█████████▍                                                                                            | 52/561 [00:02<00:21, 23.65it/s] 10%|██████████                                                                                            | 55/561 [00:02<00:21, 23.62it/s][2025-03-28 01:37:47,960] [INFO] [logging.py:128:log_dist] [Rank 0] step=7350, skipped=16, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:37:47,961] [INFO] [timer.py:264:stop] epoch=0/micro_step=7350/global_step=7350, RunningAvgSamplesPerSec=20.53168641629004, CurrSamplesPerSec=19.075579610231944, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 10%|██████████▌                                                                                           | 58/561 [00:02<00:23, 21.73it/s] 11%|███████████                                                                                           | 61/561 [00:02<00:23, 21.56it/s] 11%|███████████▋                                                                                          | 64/561 [00:03<00:22, 21.97it/s] 12%|████████████▏                                                                                         | 67/561 [00:03<00:23, 21.46it/s] 12%|████████████▋                                                                                         | 70/561 [00:03<00:22, 21.46it/s] 13%|█████████████▎                                                                                        | 73/561 [00:03<00:22, 21.73it/s] 14%|█████████████▊                                                                                        | 76/561 [00:03<00:22, 21.99it/s] 14%|██████████████▎                                                                                       | 79/561 [00:03<00:21, 22.02it/s] 15%|██████████████▉                                                                                       | 82/561 [00:03<00:21, 21.88it/s] 15%|███████████████▍                                                                                      | 85/561 [00:04<00:21, 22.00it/s] 16%|████████████████                                                                                      | 88/561 [00:04<00:21, 22.04it/s] 16%|████████████████▌                                                                                     | 91/561 [00:04<00:21, 22.12it/s] 17%|█████████████████                                                                                     | 94/561 [00:04<00:20, 22.24it/s] 17%|█████████████████▋                                                                                    | 97/561 [00:04<00:20, 22.22it/s] 18%|██████████████████                                                                                   | 100/561 [00:04<00:20, 22.26it/s] 18%|██████████████████▌                                                                                  | 103/561 [00:04<00:20, 22.15it/s] 19%|███████████████████                                                                                  | 106/561 [00:05<00:20, 22.42it/s][2025-03-28 01:37:50,232] [INFO] [logging.py:128:log_dist] [Rank 0] step=7400, skipped=16, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:37:50,233] [INFO] [timer.py:264:stop] epoch=0/micro_step=7400/global_step=7400, RunningAvgSamplesPerSec=20.541347205104355, CurrSamplesPerSec=21.985929423846105, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 19%|███████████████████▌                                                                                 | 109/561 [00:05<00:20, 22.37it/s] 20%|████████████████████▏                                                                                | 112/561 [00:05<00:20, 22.33it/s] 20%|████████████████████▋                                                                                | 115/561 [00:05<00:19, 22.37it/s] 21%|█████████████████████▏                                                                               | 118/561 [00:05<00:19, 22.43it/s] 22%|█████████████████████▊                                                                               | 121/561 [00:05<00:19, 22.56it/s] 22%|██████████████████████▎                                                                              | 124/561 [00:05<00:19, 22.73it/s] 23%|██████████████████████▊                                                                              | 127/561 [00:05<00:18, 22.98it/s] 23%|███████████████████████▍                                                                             | 130/561 [00:06<00:19, 21.64it/s] 24%|███████████████████████▉                                                                             | 133/561 [00:06<00:19, 21.72it/s] 24%|████████████████████████▍                                                                            | 136/561 [00:06<00:18, 22.43it/s] 25%|█████████████████████████                                                                            | 139/561 [00:06<00:18, 22.24it/s] 25%|█████████████████████████▌                                                                           | 142/561 [00:06<00:18, 22.31it/s] 26%|██████████████████████████                                                                           | 145/561 [00:06<00:18, 22.79it/s] 26%|██████████████████████████▋                                                                          | 148/561 [00:06<00:19, 21.66it/s] 27%|███████████████████████████▏                                                                         | 151/561 [00:07<00:18, 21.67it/s] 27%|███████████████████████████▋                                                                         | 154/561 [00:07<00:18, 21.81it/s][2025-03-28 01:37:52,480] [INFO] [logging.py:128:log_dist] [Rank 0] step=7450, skipped=16, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:37:52,480] [INFO] [timer.py:264:stop] epoch=0/micro_step=7450/global_step=7450, RunningAvgSamplesPerSec=20.55227961393777, CurrSamplesPerSec=24.29407565474016, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 28%|████████████████████████████▎                                                                        | 157/561 [00:07<00:18, 22.33it/s] 29%|████████████████████████████▊                                                                        | 160/561 [00:07<00:17, 22.70it/s] 29%|█████████████████████████████▎                                                                       | 163/561 [00:07<00:18, 22.06it/s] 30%|█████████████████████████████▉                                                                       | 166/561 [00:07<00:17, 22.03it/s] 30%|██████████████████████████████▍                                                                      | 169/561 [00:07<00:17, 22.17it/s] 31%|██████████████████████████████▉                                                                      | 172/561 [00:07<00:17, 22.14it/s] 31%|███████████████████████████████▌                                                                     | 175/561 [00:08<00:17, 22.07it/s] 32%|████████████████████████████████                                                                     | 178/561 [00:08<00:17, 22.08it/s] 32%|████████████████████████████████▌                                                                    | 181/561 [00:08<00:17, 22.00it/s] 33%|█████████████████████████████████▏                                                                   | 184/561 [00:08<00:17, 21.93it/s] 33%|█████████████████████████████████▋                                                                   | 187/561 [00:08<00:17, 21.96it/s] 34%|██████████████████████████████████▏                                                                  | 190/561 [00:08<00:16, 22.07it/s] 34%|██████████████████████████████████▋                                                                  | 193/561 [00:08<00:16, 21.95it/s] 35%|███████████████████████████████████▎                                                                 | 196/561 [00:09<00:16, 21.78it/s] 35%|███████████████████████████████████▊                                                                 | 199/561 [00:09<00:16, 21.82it/s] 36%|████████████████████████████████████▎                                                                | 202/561 [00:09<00:16, 22.15it/s] 37%|████████████████████████████████████▉                                                                | 205/561 [00:09<00:16, 22.04it/s][2025-03-28 01:37:54,752] [INFO] [logging.py:128:log_dist] [Rank 0] step=7500, skipped=16, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:37:54,753] [INFO] [timer.py:264:stop] epoch=0/micro_step=7500/global_step=7500, RunningAvgSamplesPerSec=20.561663656313378, CurrSamplesPerSec=22.363873006430456, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 37%|█████████████████████████████████████▍                                                               | 208/561 [00:09<00:16, 21.96it/s] 38%|█████████████████████████████████████▉                                                               | 211/561 [00:09<00:15, 22.03it/s] 38%|██████████████████████████████████████▌                                                              | 214/561 [00:09<00:15, 21.93it/s] 39%|███████████████████████████████████████                                                              | 217/561 [00:10<00:15, 21.78it/s] 39%|███████████████████████████████████████▌                                                             | 220/561 [00:10<00:15, 21.76it/s] 40%|████████████████████████████████████████▏                                                            | 223/561 [00:10<00:15, 21.89it/s] 40%|████████████████████████████████████████▋                                                            | 226/561 [00:10<00:15, 22.08it/s] 41%|█████████████████████████████████████████▏                                                           | 229/561 [00:10<00:15, 21.88it/s] 41%|█████████████████████████████████████████▊                                                           | 232/561 [00:10<00:14, 22.02it/s] 42%|██████████████████████████████████████████▎                                                          | 235/561 [00:10<00:14, 21.85it/s] 42%|██████████████████████████████████████████▊                                                          | 238/561 [00:11<00:14, 22.08it/s] 43%|███████████████████████████████████████████▍                                                         | 241/561 [00:11<00:14, 22.12it/s] 43%|███████████████████████████████████████████▉                                                         | 244/561 [00:11<00:14, 22.25it/s] 44%|████████████████████████████████████████████▍                                                        | 247/561 [00:11<00:14, 22.33it/s] 45%|█████████████████████████████████████████████                                                        | 250/561 [00:11<00:14, 22.19it/s] 45%|█████████████████████████████████████████████▌                                                       | 253/561 [00:11<00:13, 22.13it/s] 46%|██████████████████████████████████████████████                                                       | 256/561 [00:11<00:13, 22.13it/s][2025-03-28 01:37:57,021] [INFO] [logging.py:128:log_dist] [Rank 0] step=7550, skipped=16, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:37:57,022] [INFO] [timer.py:264:stop] epoch=0/micro_step=7550/global_step=7550, RunningAvgSamplesPerSec=20.571154865931085, CurrSamplesPerSec=21.831211915784596, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 46%|██████████████████████████████████████████████▋                                                      | 259/561 [00:11<00:13, 22.26it/s] 47%|███████████████████████████████████████████████▏                                                     | 262/561 [00:12<00:13, 22.68it/s] 47%|███████████████████████████████████████████████▋                                                     | 265/561 [00:12<00:12, 22.81it/s] 48%|████████████████████████████████████████████████▏                                                    | 268/561 [00:12<00:12, 22.83it/s] 48%|████████████████████████████████████████████████▊                                                    | 271/561 [00:12<00:12, 22.70it/s] 49%|█████████████████████████████████████████████████▎                                                   | 274/561 [00:12<00:12, 22.50it/s] 49%|█████████████████████████████████████████████████▊                                                   | 277/561 [00:12<00:12, 22.32it/s] 50%|██████████████████████████████████████████████████▍                                                  | 280/561 [00:12<00:12, 22.40it/s] 50%|██████████████████████████████████████████████████▉                                                  | 283/561 [00:12<00:12, 22.83it/s] 51%|███████████████████████████████████████████████████▍                                                 | 286/561 [00:13<00:11, 23.01it/s] 52%|████████████████████████████████████████████████████                                                 | 289/561 [00:13<00:11, 23.17it/s] 52%|████████████████████████████████████████████████████▌                                                | 292/561 [00:13<00:11, 22.84it/s] 53%|█████████████████████████████████████████████████████                                                | 295/561 [00:13<00:11, 22.68it/s] 53%|█████████████████████████████████████████████████████▋                                               | 298/561 [00:13<00:11, 22.47it/s] 54%|██████████████████████████████████████████████████████▏                                              | 301/561 [00:13<00:11, 22.26it/s] 54%|██████████████████████████████████████████████████████▋                                              | 304/561 [00:13<00:11, 22.22it/s][2025-03-28 01:37:59,231] [INFO] [logging.py:128:log_dist] [Rank 0] step=7600, skipped=16, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:37:59,232] [INFO] [timer.py:264:stop] epoch=0/micro_step=7600/global_step=7600, RunningAvgSamplesPerSec=20.583736584875844, CurrSamplesPerSec=22.872050844247948, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 55%|███████████████████████████████████████████████████████▎                                             | 307/561 [00:14<00:11, 22.15it/s] 55%|███████████████████████████████████████████████████████▊                                             | 310/561 [00:14<00:11, 22.30it/s] 56%|████████████████████████████████████████████████████████▎                                            | 313/561 [00:14<00:11, 22.36it/s] 56%|████████████████████████████████████████████████████████▉                                            | 316/561 [00:14<00:11, 21.28it/s] 57%|█████████████████████████████████████████████████████████▍                                           | 319/561 [00:14<00:11, 21.36it/s] 57%|█████████████████████████████████████████████████████████▉                                           | 322/561 [00:14<00:11, 21.50it/s] 58%|██████████████████████████████████████████████████████████▌                                          | 325/561 [00:14<00:10, 21.60it/s] 58%|███████████████████████████████████████████████████████████                                          | 328/561 [00:15<00:11, 20.62it/s] 59%|███████████████████████████████████████████████████████████▌                                         | 331/561 [00:15<00:10, 21.28it/s] 60%|████████████████████████████████████████████████████████████▏                                        | 334/561 [00:15<00:10, 21.43it/s] 60%|████████████████████████████████████████████████████████████▋                                        | 337/561 [00:15<00:10, 21.46it/s] 61%|█████████████████████████████████████████████████████████████▏                                       | 340/561 [00:15<00:10, 21.66it/s] 61%|█████████████████████████████████████████████████████████████▊                                       | 343/561 [00:15<00:10, 21.78it/s] 62%|██████████████████████████████████████████████████████████████▎                                      | 346/561 [00:15<00:09, 21.53it/s] 62%|██████████████████████████████████████████████████████████████▊                                      | 349/561 [00:16<00:09, 21.95it/s] 63%|███████████████████████████████████████████████████████████████▎                                     | 352/561 [00:16<00:09, 22.47it/s] 63%|███████████████████████████████████████████████████████████████▉                                     | 355/561 [00:16<00:09, 21.30it/s][2025-03-28 01:38:01,571] [INFO] [logging.py:128:log_dist] [Rank 0] step=7650, skipped=16, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:38:01,572] [INFO] [timer.py:264:stop] epoch=0/micro_step=7650/global_step=7650, RunningAvgSamplesPerSec=20.589022441780727, CurrSamplesPerSec=18.177683304527726, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 64%|████████████████████████████████████████████████████████████████▍                                    | 358/561 [00:16<00:09, 20.66it/s] 64%|████████████████████████████████████████████████████████████████▉                                    | 361/561 [00:16<00:09, 21.49it/s] 65%|█████████████████████████████████████████████████████████████████▌                                   | 364/561 [00:16<00:08, 22.27it/s] 65%|██████████████████████████████████████████████████████████████████                                   | 367/561 [00:16<00:08, 22.64it/s] 66%|██████████████████████████████████████████████████████████████████▌                                  | 370/561 [00:16<00:08, 22.46it/s] 66%|███████████████████████████████████████████████████████████████████▏                                 | 373/561 [00:17<00:08, 22.03it/s] 67%|███████████████████████████████████████████████████████████████████▋                                 | 376/561 [00:17<00:08, 22.08it/s] 68%|████████████████████████████████████████████████████████████████████▏                                | 379/561 [00:17<00:08, 22.03it/s] 68%|████████████████████████████████████████████████████████████████████▊                                | 382/561 [00:17<00:08, 22.02it/s] 69%|█████████████████████████████████████████████████████████████████████▎                               | 385/561 [00:17<00:08, 21.98it/s] 69%|█████████████████████████████████████████████████████████████████████▊                               | 388/561 [00:17<00:07, 21.94it/s] 70%|██████████████████████████████████████████████████████████████████████▍                              | 391/561 [00:17<00:07, 22.32it/s] 70%|██████████████████████████████████████████████████████████████████████▉                              | 394/561 [00:18<00:07, 22.84it/s] 71%|███████████████████████████████████████████████████████████████████████▍                             | 397/561 [00:18<00:07, 23.14it/s] 71%|████████████████████████████████████████████████████████████████████████                             | 400/561 [00:18<00:06, 23.40it/s] 72%|████████████████████████████████████████████████████████████████████████▌                            | 403/561 [00:18<00:06, 23.43it/s] 72%|█████████████████████████████████████████████████████████████████████████                            | 406/561 [00:18<00:06, 23.73it/s][2025-03-28 01:38:03,755] [INFO] [logging.py:128:log_dist] [Rank 0] step=7700, skipped=16, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:38:03,756] [INFO] [timer.py:264:stop] epoch=0/micro_step=7700/global_step=7700, RunningAvgSamplesPerSec=20.60284479191587, CurrSamplesPerSec=24.275515445570623, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 73%|█████████████████████████████████████████████████████████████████████████▋                           | 409/561 [00:18<00:06, 23.59it/s] 73%|██████████████████████████████████████████████████████████████████████████▏                          | 412/561 [00:18<00:06, 23.77it/s] 74%|██████████████████████████████████████████████████████████████████████████▋                          | 415/561 [00:18<00:06, 23.55it/s] 75%|███████████████████████████████████████████████████████████████████████████▎                         | 418/561 [00:19<00:06, 23.16it/s] 75%|███████████████████████████████████████████████████████████████████████████▊                         | 421/561 [00:19<00:06, 21.88it/s] 76%|████████████████████████████████████████████████████████████████████████████▎                        | 424/561 [00:19<00:06, 21.48it/s] 76%|████████████████████████████████████████████████████████████████████████████▉                        | 427/561 [00:19<00:06, 22.00it/s] 77%|█████████████████████████████████████████████████████████████████████████████▍                       | 430/561 [00:19<00:05, 22.52it/s] 77%|█████████████████████████████████████████████████████████████████████████████▉                       | 433/561 [00:19<00:05, 22.97it/s] 78%|██████████████████████████████████████████████████████████████████████████████▍                      | 436/561 [00:19<00:05, 23.08it/s] 78%|███████████████████████████████████████████████████████████████████████████████                      | 439/561 [00:20<00:05, 23.25it/s] 79%|███████████████████████████████████████████████████████████████████████████████▌                     | 442/561 [00:20<00:05, 23.38it/s] 79%|████████████████████████████████████████████████████████████████████████████████                     | 445/561 [00:20<00:05, 22.97it/s] 80%|████████████████████████████████████████████████████████████████████████████████▋                    | 448/561 [00:20<00:04, 22.61it/s] 80%|█████████████████████████████████████████████████████████████████████████████████▏                   | 451/561 [00:20<00:05, 21.93it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▋                   | 454/561 [00:20<00:04, 21.80it/s][2025-03-28 01:38:06,009] [INFO] [logging.py:128:log_dist] [Rank 0] step=7750, skipped=16, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:38:06,010] [INFO] [timer.py:264:stop] epoch=0/micro_step=7750/global_step=7750, RunningAvgSamplesPerSec=20.612635185912854, CurrSamplesPerSec=19.731197740762443, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 81%|██████████████████████████████████████████████████████████████████████████████████▎                  | 457/561 [00:20<00:04, 20.88it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▊                  | 460/561 [00:20<00:04, 20.48it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▎                 | 463/561 [00:21<00:04, 21.06it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▉                 | 466/561 [00:21<00:04, 21.01it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▍                | 469/561 [00:21<00:04, 21.52it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▉                | 472/561 [00:21<00:04, 21.66it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▌               | 475/561 [00:21<00:03, 21.70it/s] 85%|██████████████████████████████████████████████████████████████████████████████████████               | 478/561 [00:21<00:03, 21.67it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▌              | 481/561 [00:21<00:03, 22.16it/s] 86%|███████████████████████████████████████████████████████████████████████████████████████▏             | 484/561 [00:22<00:03, 22.69it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▋             | 487/561 [00:22<00:03, 22.15it/s] 87%|████████████████████████████████████████████████████████████████████████████████████████▏            | 490/561 [00:22<00:03, 21.47it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▊            | 493/561 [00:22<00:03, 21.70it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████████▎           | 496/561 [00:22<00:02, 22.09it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▊           | 499/561 [00:22<00:02, 22.65it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████▍          | 502/561 [00:22<00:02, 22.92it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▉          | 505/561 [00:23<00:02, 23.19it/s][2025-03-28 01:38:08,257] [INFO] [logging.py:128:log_dist] [Rank 0] step=7800, skipped=16, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:38:08,258] [INFO] [timer.py:264:stop] epoch=0/micro_step=7800/global_step=7800, RunningAvgSamplesPerSec=20.622659275586024, CurrSamplesPerSec=22.527349507999382, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 91%|███████████████████████████████████████████████████████████████████████████████████████████▍         | 508/561 [00:23<00:02, 22.99it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▉         | 511/561 [00:23<00:02, 22.40it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████████▌        | 514/561 [00:23<00:02, 22.17it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████        | 517/561 [00:23<00:01, 22.07it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▌       | 520/561 [00:23<00:01, 22.10it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████████▏      | 523/561 [00:23<00:01, 22.04it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▋      | 526/561 [00:23<00:01, 21.92it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▏     | 529/561 [00:24<00:01, 21.32it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▊     | 532/561 [00:24<00:01, 20.90it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████████▎    | 535/561 [00:24<00:01, 19.68it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▊    | 538/561 [00:24<00:01, 19.88it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████▍   | 541/561 [00:24<00:01, 19.83it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████████▉   | 544/561 [00:24<00:00, 20.06it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▍  | 547/561 [00:25<00:00, 20.36it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████████  | 550/561 [00:25<00:00, 19.63it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▌ | 553/561 [00:25<00:00, 19.99it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████ | 556/561 [00:25<00:00, 19.55it/s][2025-03-28 01:38:10,717] [INFO] [logging.py:128:log_dist] [Rank 0] step=7850, skipped=16, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:38:10,720] [INFO] [timer.py:264:stop] epoch=0/micro_step=7850/global_step=7850, RunningAvgSamplesPerSec=20.620983111933718, CurrSamplesPerSec=18.7086862251993, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 99%|████████████████████████████████████████████████████████████████████████████████████████████████████▍| 558/561 [00:25<00:00, 19.63it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████████▊| 560/561 [00:25<00:00, 19.62it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:25<00:00, 21.73it/s]
  0%|                                                                                                               | 0/561 [00:00<?, ?it/s]  0%|▏                                                                                                      | 1/561 [00:00<02:53,  3.23it/s]  1%|▌                                                                                                      | 3/561 [00:00<01:06,  8.33it/s]  1%|▉                                                                                                      | 5/561 [00:00<00:47, 11.62it/s]  1%|█▎                                                                                                     | 7/561 [00:00<00:39, 13.95it/s]  2%|█▋                                                                                                     | 9/561 [00:00<00:35, 15.40it/s]  2%|██                                                                                                    | 11/561 [00:00<00:33, 16.31it/s]  2%|██▎                                                                                                   | 13/561 [00:00<00:32, 17.01it/s]  3%|██▋                                                                                                   | 15/561 [00:01<00:31, 17.37it/s]  3%|███                                                                                                   | 17/561 [00:01<00:30, 17.77it/s]  3%|███▍                                                                                                  | 19/561 [00:01<00:30, 18.03it/s]  4%|███▊                                                                                                  | 21/561 [00:01<00:29, 18.18it/s]  4%|████▏                                                                                                 | 23/561 [00:01<00:29, 18.45it/s]  4%|████▌                                                                                                 | 25/561 [00:01<00:29, 18.46it/s]  5%|████▉                                                                                                 | 27/561 [00:01<00:28, 18.51it/s]  5%|█████▎                                                                                                | 29/561 [00:01<00:28, 18.40it/s]  6%|█████▋                                                                                                | 31/561 [00:01<00:28, 18.49it/s]  6%|██████                                                                                                | 33/561 [00:02<00:28, 18.35it/s]  6%|██████▎                                                                                               | 35/561 [00:02<00:27, 18.81it/s]  7%|██████▉                                                                                               | 38/561 [00:02<00:26, 19.89it/s]  7%|███████▍                                                                                              | 41/561 [00:02<00:25, 20.08it/s]  8%|███████▊                                                                                              | 43/561 [00:02<00:27, 19.18it/s]  8%|████████▏                                                                                             | 45/561 [00:02<00:27, 18.88it/s][2025-03-28 01:38:13,705] [INFO] [logging.py:128:log_dist] [Rank 0] step=7900, skipped=16, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:38:13,709] [INFO] [timer.py:264:stop] epoch=0/micro_step=7900/global_step=7900, RunningAvgSamplesPerSec=20.5988869565127, CurrSamplesPerSec=18.16996612112834, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
  8%|████████▌                                                                                             | 47/561 [00:02<00:27, 18.65it/s]  9%|████████▉                                                                                             | 49/561 [00:02<00:27, 18.49it/s]  9%|█████████▎                                                                                            | 51/561 [00:02<00:27, 18.38it/s]  9%|█████████▋                                                                                            | 53/561 [00:03<00:27, 18.29it/s] 10%|██████████                                                                                            | 55/561 [00:03<00:27, 18.22it/s] 10%|██████████▎                                                                                           | 57/561 [00:03<00:27, 18.18it/s] 11%|██████████▋                                                                                           | 59/561 [00:03<00:27, 18.13it/s] 11%|███████████▎                                                                                          | 62/561 [00:03<00:25, 19.79it/s] 12%|███████████▊                                                                                          | 65/561 [00:03<00:23, 21.04it/s] 12%|████████████▎                                                                                         | 68/561 [00:03<00:22, 21.73it/s] 13%|████████████▉                                                                                         | 71/561 [00:03<00:23, 20.94it/s] 13%|█████████████▍                                                                                        | 74/561 [00:04<00:23, 21.08it/s] 14%|██████████████                                                                                        | 77/561 [00:04<00:22, 21.25it/s] 14%|██████████████▌                                                                                       | 80/561 [00:04<00:22, 21.41it/s] 15%|███████████████                                                                                       | 83/561 [00:04<00:22, 21.51it/s] 15%|███████████████▋                                                                                      | 86/561 [00:04<00:21, 21.69it/s] 16%|████████████████▏                                                                                     | 89/561 [00:04<00:21, 21.87it/s] 16%|████████████████▋                                                                                     | 92/561 [00:04<00:21, 21.73it/s] 17%|█████████████████▎                                                                                    | 95/561 [00:05<00:21, 21.80it/s][2025-03-28 01:38:16,114] [INFO] [logging.py:128:log_dist] [Rank 0] step=7950, skipped=16, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:38:16,114] [INFO] [timer.py:264:stop] epoch=0/micro_step=7950/global_step=7950, RunningAvgSamplesPerSec=20.6003513678651, CurrSamplesPerSec=22.235827552058883, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 17%|█████████████████▊                                                                                    | 98/561 [00:05<00:21, 21.81it/s] 18%|██████████████████▏                                                                                  | 101/561 [00:05<00:21, 21.66it/s] 19%|██████████████████▋                                                                                  | 104/561 [00:05<00:21, 21.50it/s] 19%|███████████████████▎                                                                                 | 107/561 [00:05<00:20, 21.65it/s] 20%|███████████████████▊                                                                                 | 110/561 [00:05<00:20, 21.78it/s] 20%|████████████████████▎                                                                                | 113/561 [00:05<00:20, 21.71it/s] 21%|████████████████████▉                                                                                | 116/561 [00:06<00:20, 21.68it/s] 21%|█████████████████████▍                                                                               | 119/561 [00:06<00:20, 22.07it/s] 22%|█████████████████████▉                                                                               | 122/561 [00:06<00:19, 22.59it/s] 22%|██████████████████████▌                                                                              | 125/561 [00:06<00:19, 22.79it/s] 23%|███████████████████████                                                                              | 128/561 [00:06<00:19, 22.24it/s] 23%|███████████████████████▌                                                                             | 131/561 [00:06<00:19, 21.76it/s] 24%|████████████████████████                                                                             | 134/561 [00:06<00:19, 21.66it/s] 24%|████████████████████████▋                                                                            | 137/561 [00:06<00:19, 21.74it/s] 25%|█████████████████████████▏                                                                           | 140/561 [00:07<00:19, 21.68it/s] 25%|█████████████████████████▋                                                                           | 143/561 [00:07<00:19, 21.76it/s][2025-03-28 01:38:18,395] [INFO] [logging.py:128:log_dist] [Rank 0] step=8000, skipped=16, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:38:18,395] [INFO] [timer.py:264:stop] epoch=0/micro_step=8000/global_step=8000, RunningAvgSamplesPerSec=20.608413614732232, CurrSamplesPerSec=23.0467414428513, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 26%|██████████████████████████▎                                                                          | 146/561 [00:07<00:18, 22.05it/s] 27%|██████████████████████████▊                                                                          | 149/561 [00:07<00:18, 22.09it/s] 27%|███████████████████████████▎                                                                         | 152/561 [00:07<00:18, 22.08it/s] 28%|███████████████████████████▉                                                                         | 155/561 [00:07<00:18, 21.98it/s] 28%|████████████████████████████▍                                                                        | 158/561 [00:07<00:18, 22.12it/s] 29%|████████████████████████████▉                                                                        | 161/561 [00:08<00:18, 21.96it/s][2025-03-28 01:38:19,161] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2025-03-28 01:38:19,201] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
 29%|█████████████████████████████▌                                                                       | 164/561 [00:08<00:17, 22.55it/s] 30%|██████████████████████████████                                                                       | 167/561 [00:08<00:18, 21.53it/s] 30%|██████████████████████████████▌                                                                      | 170/561 [00:08<00:18, 21.59it/s] 31%|███████████████████████████████▏                                                                     | 173/561 [00:08<00:17, 21.58it/s] 31%|███████████████████████████████▋                                                                     | 176/561 [00:08<00:18, 20.70it/s] 32%|████████████████████████████████▏                                                                    | 179/561 [00:08<00:18, 20.62it/s] 32%|████████████████████████████████▊                                                                    | 182/561 [00:09<00:18, 21.04it/s] 33%|█████████████████████████████████▎                                                                   | 185/561 [00:09<00:19, 19.78it/s] 33%|█████████████████████████████████▋                                                                   | 187/561 [00:09<00:18, 19.76it/s] 34%|██████████████████████████████████                                                                   | 189/561 [00:09<00:18, 19.81it/s] 34%|██████████████████████████████████▌                                                                  | 192/561 [00:09<00:17, 20.54it/s] 35%|███████████████████████████████████                                                                  | 195/561 [00:09<00:17, 20.85it/s][2025-03-28 01:38:20,772] [INFO] [logging.py:128:log_dist] [Rank 0] step=8050, skipped=18, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:38:20,772] [INFO] [timer.py:264:stop] epoch=0/micro_step=8050/global_step=8050, RunningAvgSamplesPerSec=20.611323270571063, CurrSamplesPerSec=21.02911935682767, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 35%|███████████████████████████████████▋                                                                 | 198/561 [00:09<00:17, 20.63it/s] 36%|████████████████████████████████████▏                                                                | 201/561 [00:10<00:17, 20.68it/s] 36%|████████████████████████████████████▋                                                                | 204/561 [00:10<00:17, 20.94it/s] 37%|█████████████████████████████████████▎                                                               | 207/561 [00:10<00:16, 20.99it/s] 37%|█████████████████████████████████████▊                                                               | 210/561 [00:10<00:16, 20.97it/s] 38%|██████████████████████████████████████▎                                                              | 213/561 [00:10<00:16, 20.70it/s] 39%|██████████████████████████████████████▉                                                              | 216/561 [00:10<00:16, 20.63it/s] 39%|███████████████████████████████████████▍                                                             | 219/561 [00:10<00:16, 20.40it/s] 40%|███████████████████████████████████████▉                                                             | 222/561 [00:11<00:16, 20.62it/s] 40%|████████████████████████████████████████▌                                                            | 225/561 [00:11<00:16, 20.55it/s] 41%|█████████████████████████████████████████                                                            | 228/561 [00:11<00:16, 19.89it/s] 41%|█████████████████████████████████████████▍                                                           | 230/561 [00:11<00:16, 19.76it/s] 42%|█████████████████████████████████████████▉                                                           | 233/561 [00:11<00:16, 19.90it/s] 42%|██████████████████████████████████████████▎                                                          | 235/561 [00:11<00:16, 19.71it/s] 42%|██████████████████████████████████████████▋                                                          | 237/561 [00:11<00:16, 19.50it/s] 43%|███████████████████████████████████████████                                                          | 239/561 [00:11<00:16, 19.50it/s] 43%|███████████████████████████████████████████▍                                                         | 241/561 [00:11<00:16, 19.58it/s] 43%|███████████████████████████████████████████▋                                                         | 243/561 [00:12<00:16, 19.67it/s] 44%|████████████████████████████████████████████                                                         | 245/561 [00:12<00:16, 19.54it/s][2025-03-28 01:38:23,259] [INFO] [logging.py:128:log_dist] [Rank 0] step=8100, skipped=18, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:38:23,262] [INFO] [timer.py:264:stop] epoch=0/micro_step=8100/global_step=8100, RunningAvgSamplesPerSec=20.608268325281262, CurrSamplesPerSec=19.424981246316715, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 44%|████████████████████████████████████████████▋                                                        | 248/561 [00:12<00:15, 19.72it/s] 45%|█████████████████████████████████████████████▏                                                       | 251/561 [00:12<00:15, 19.80it/s] 45%|█████████████████████████████████████████████▌                                                       | 253/561 [00:12<00:15, 19.82it/s] 45%|█████████████████████████████████████████████▉                                                       | 255/561 [00:12<00:15, 19.81it/s] 46%|██████████████████████████████████████████████▎                                                      | 257/561 [00:12<00:15, 19.68it/s] 46%|██████████████████████████████████████████████▋                                                      | 259/561 [00:12<00:15, 19.48it/s] 47%|██████████████████████████████████████████████▉                                                      | 261/561 [00:13<00:15, 19.22it/s] 47%|███████████████████████████████████████████████▎                                                     | 263/561 [00:13<00:15, 19.05it/s] 47%|███████████████████████████████████████████████▋                                                     | 265/561 [00:13<00:15, 19.13it/s] 48%|████████████████████████████████████████████████▏                                                    | 268/561 [00:13<00:15, 19.27it/s] 48%|████████████████████████████████████████████████▌                                                    | 270/561 [00:13<00:15, 19.35it/s] 49%|█████████████████████████████████████████████████▏                                                   | 273/561 [00:13<00:14, 19.59it/s] 49%|█████████████████████████████████████████████████▌                                                   | 275/561 [00:13<00:14, 19.67it/s] 50%|██████████████████████████████████████████████████                                                   | 278/561 [00:13<00:14, 19.89it/s] 50%|██████████████████████████████████████████████████▍                                                  | 280/561 [00:13<00:14, 19.62it/s] 50%|██████████████████████████████████████████████████▊                                                  | 282/561 [00:14<00:14, 19.40it/s] 51%|███████████████████████████████████████████████████▏                                                 | 284/561 [00:14<00:14, 19.32it/s] 51%|███████████████████████████████████████████████████▍                                                 | 286/561 [00:14<00:14, 19.23it/s] 51%|███████████████████████████████████████████████████▊                                                 | 288/561 [00:14<00:14, 19.13it/s] 52%|████████████████████████████████████████████████████▏                                                | 290/561 [00:14<00:14, 18.92it/s] 52%|████████████████████████████████████████████████████▌                                                | 292/561 [00:14<00:14, 19.17it/s] 52%|████████████████████████████████████████████████████▉                                                | 294/561 [00:14<00:13, 19.31it/s][2025-03-28 01:38:25,837] [INFO] [logging.py:128:log_dist] [Rank 0] step=8150, skipped=18, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:38:25,839] [INFO] [timer.py:264:stop] epoch=0/micro_step=8150/global_step=8150, RunningAvgSamplesPerSec=20.600723015252207, CurrSamplesPerSec=19.72590835293917, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 53%|█████████████████████████████████████████████████████▎                                               | 296/561 [00:14<00:13, 19.15it/s] 53%|█████████████████████████████████████████████████████▋                                               | 298/561 [00:14<00:13, 18.97it/s] 53%|██████████████████████████████████████████████████████                                               | 300/561 [00:15<00:13, 18.90it/s] 54%|██████████████████████████████████████████████████████▎                                              | 302/561 [00:15<00:13, 18.81it/s] 54%|██████████████████████████████████████████████████████▋                                              | 304/561 [00:15<00:13, 18.97it/s] 55%|███████████████████████████████████████████████████████                                              | 306/561 [00:15<00:13, 18.96it/s] 55%|███████████████████████████████████████████████████████▍                                             | 308/561 [00:15<00:13, 18.90it/s] 55%|███████████████████████████████████████████████████████▊                                             | 310/561 [00:15<00:13, 18.87it/s] 56%|████████████████████████████████████████████████████████▏                                            | 312/561 [00:15<00:13, 18.91it/s] 56%|████████████████████████████████████████████████████████▌                                            | 314/561 [00:15<00:13, 18.83it/s] 56%|████████████████████████████████████████████████████████▉                                            | 316/561 [00:15<00:13, 18.72it/s] 57%|█████████████████████████████████████████████████████████▎                                           | 318/561 [00:16<00:12, 18.72it/s] 57%|█████████████████████████████████████████████████████████▌                                           | 320/561 [00:16<00:13, 18.53it/s] 57%|█████████████████████████████████████████████████████████▉                                           | 322/561 [00:16<00:12, 18.46it/s] 58%|██████████████████████████████████████████████████████████▎                                          | 324/561 [00:16<00:12, 18.67it/s] 58%|██████████████████████████████████████████████████████████▋                                          | 326/561 [00:16<00:12, 18.62it/s] 58%|███████████████████████████████████████████████████████████                                          | 328/561 [00:16<00:12, 18.79it/s] 59%|███████████████████████████████████████████████████████████▍                                         | 330/561 [00:16<00:12, 18.62it/s] 59%|███████████████████████████████████████████████████████████▊                                         | 332/561 [00:16<00:12, 18.67it/s] 60%|████████████████████████████████████████████████████████████▏                                        | 334/561 [00:16<00:12, 18.67it/s] 60%|████████████████████████████████████████████████████████████▍                                        | 336/561 [00:16<00:11, 18.81it/s] 60%|████████████████████████████████████████████████████████████▊                                        | 338/561 [00:17<00:11, 18.94it/s] 61%|█████████████████████████████████████████████████████████████▏                                       | 340/561 [00:17<00:11, 18.93it/s] 61%|█████████████████████████████████████████████████████████████▌                                       | 342/561 [00:17<00:11, 18.95it/s] 61%|█████████████████████████████████████████████████████████████▉                                       | 344/561 [00:17<00:11, 18.92it/s][2025-03-28 01:38:28,493] [INFO] [logging.py:128:log_dist] [Rank 0] step=8200, skipped=18, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:38:28,496] [INFO] [timer.py:264:stop] epoch=0/micro_step=8200/global_step=8200, RunningAvgSamplesPerSec=20.58917312790471, CurrSamplesPerSec=19.840305695516346, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 62%|██████████████████████████████████████████████████████████████▎                                      | 346/561 [00:17<00:11, 19.22it/s] 62%|██████████████████████████████████████████████████████████████▋                                      | 348/561 [00:17<00:11, 18.95it/s] 62%|███████████████████████████████████████████████████████████████                                      | 350/561 [00:17<00:11, 19.09it/s] 63%|███████████████████████████████████████████████████████████████▎                                     | 352/561 [00:17<00:10, 19.13it/s] 63%|███████████████████████████████████████████████████████████████▉                                     | 355/561 [00:17<00:10, 19.39it/s] 64%|████████████████████████████████████████████████████████████████▎                                    | 357/561 [00:18<00:10, 19.17it/s] 64%|████████████████████████████████████████████████████████████████▋                                    | 359/561 [00:18<00:10, 19.19it/s] 64%|████████████████████████████████████████████████████████████████▉                                    | 361/561 [00:18<00:10, 19.01it/s] 65%|█████████████████████████████████████████████████████████████████▎                                   | 363/561 [00:18<00:10, 19.08it/s] 65%|█████████████████████████████████████████████████████████████████▋                                   | 365/561 [00:18<00:10, 19.05it/s] 65%|██████████████████████████████████████████████████████████████████                                   | 367/561 [00:18<00:10, 19.02it/s] 66%|██████████████████████████████████████████████████████████████████▍                                  | 369/561 [00:18<00:10, 18.97it/s] 66%|██████████████████████████████████████████████████████████████████▊                                  | 371/561 [00:18<00:10, 18.94it/s] 66%|███████████████████████████████████████████████████████████████████▏                                 | 373/561 [00:18<00:09, 18.90it/s] 67%|███████████████████████████████████████████████████████████████████▋                                 | 376/561 [00:19<00:09, 19.38it/s] 67%|████████████████████████████████████████████████████████████████████                                 | 378/561 [00:19<00:09, 19.22it/s] 68%|████████████████████████████████████████████████████████████████████▍                                | 380/561 [00:19<00:09, 19.04it/s] 68%|████████████████████████████████████████████████████████████████████▊                                | 382/561 [00:19<00:09, 18.96it/s] 68%|█████████████████████████████████████████████████████████████████████▏                               | 384/561 [00:19<00:09, 18.99it/s] 69%|█████████████████████████████████████████████████████████████████████▍                               | 386/561 [00:19<00:09, 18.86it/s] 69%|█████████████████████████████████████████████████████████████████████▊                               | 388/561 [00:19<00:09, 18.74it/s] 70%|██████████████████████████████████████████████████████████████████████▏                              | 390/561 [00:19<00:09, 17.33it/s] 70%|██████████████████████████████████████████████████████████████████████▌                              | 392/561 [00:19<00:09, 17.99it/s] 70%|██████████████████████████████████████████████████████████████████████▉                              | 394/561 [00:20<00:09, 18.09it/s][2025-03-28 01:38:31,164] [INFO] [logging.py:128:log_dist] [Rank 0] step=8250, skipped=18, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:38:31,167] [INFO] [timer.py:264:stop] epoch=0/micro_step=8250/global_step=8250, RunningAvgSamplesPerSec=20.577053004116724, CurrSamplesPerSec=16.029093681623205, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 71%|███████████████████████████████████████████████████████████████████████▎                             | 396/561 [00:20<00:09, 17.90it/s] 71%|███████████████████████████████████████████████████████████████████████▋                             | 398/561 [00:20<00:09, 17.99it/s] 71%|████████████████████████████████████████████████████████████████████████                             | 400/561 [00:20<00:08, 18.23it/s] 72%|████████████████████████████████████████████████████████████████████████▎                            | 402/561 [00:20<00:08, 18.61it/s] 72%|████████████████████████████████████████████████████████████████████████▋                            | 404/561 [00:20<00:08, 18.84it/s] 72%|█████████████████████████████████████████████████████████████████████████                            | 406/561 [00:20<00:08, 19.01it/s] 73%|█████████████████████████████████████████████████████████████████████████▍                           | 408/561 [00:20<00:08, 18.71it/s] 73%|█████████████████████████████████████████████████████████████████████████▊                           | 410/561 [00:20<00:08, 18.52it/s] 73%|██████████████████████████████████████████████████████████████████████████▏                          | 412/561 [00:21<00:08, 18.51it/s] 74%|██████████████████████████████████████████████████████████████████████████▌                          | 414/561 [00:21<00:08, 18.29it/s] 74%|██████████████████████████████████████████████████████████████████████████▉                          | 416/561 [00:21<00:07, 18.42it/s] 75%|███████████████████████████████████████████████████████████████████████████▎                         | 418/561 [00:21<00:07, 18.56it/s] 75%|███████████████████████████████████████████████████████████████████████████▌                         | 420/561 [00:21<00:07, 18.63it/s] 75%|███████████████████████████████████████████████████████████████████████████▉                         | 422/561 [00:21<00:07, 18.65it/s] 76%|████████████████████████████████████████████████████████████████████████████▎                        | 424/561 [00:21<00:07, 18.65it/s] 76%|████████████████████████████████████████████████████████████████████████████▋                        | 426/561 [00:21<00:07, 18.69it/s] 76%|█████████████████████████████████████████████████████████████████████████████                        | 428/561 [00:21<00:07, 18.47it/s] 77%|█████████████████████████████████████████████████████████████████████████████▍                       | 430/561 [00:21<00:07, 18.52it/s] 77%|█████████████████████████████████████████████████████████████████████████████▊                       | 432/561 [00:22<00:06, 18.51it/s] 77%|██████████████████████████████████████████████████████████████████████████████▏                      | 434/561 [00:22<00:06, 18.49it/s] 78%|██████████████████████████████████████████████████████████████████████████████▍                      | 436/561 [00:22<00:07, 17.77it/s] 78%|██████████████████████████████████████████████████████████████████████████████▊                      | 438/561 [00:22<00:06, 17.85it/s] 78%|███████████████████████████████████████████████████████████████████████████████▏                     | 440/561 [00:22<00:06, 17.95it/s] 79%|███████████████████████████████████████████████████████████████████████████████▌                     | 442/561 [00:22<00:06, 18.16it/s] 79%|███████████████████████████████████████████████████████████████████████████████▉                     | 444/561 [00:22<00:06, 18.24it/s][2025-03-28 01:38:33,869] [INFO] [logging.py:128:log_dist] [Rank 0] step=8300, skipped=18, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:38:33,872] [INFO] [timer.py:264:stop] epoch=0/micro_step=8300/global_step=8300, RunningAvgSamplesPerSec=20.563351304456653, CurrSamplesPerSec=19.41383230415015, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 80%|████████████████████████████████████████████████████████████████████████████████▎                    | 446/561 [00:22<00:06, 18.49it/s] 80%|████████████████████████████████████████████████████████████████████████████████▋                    | 448/561 [00:22<00:06, 18.64it/s] 80%|█████████████████████████████████████████████████████████████████████████████████                    | 450/561 [00:23<00:05, 18.70it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▍                   | 452/561 [00:23<00:05, 18.64it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▉                   | 455/561 [00:23<00:05, 19.12it/s] 81%|██████████████████████████████████████████████████████████████████████████████████▎                  | 457/561 [00:23<00:05, 19.01it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▋                  | 459/561 [00:23<00:05, 19.08it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▉                  | 461/561 [00:23<00:05, 18.87it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▎                 | 463/561 [00:23<00:05, 19.08it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▋                 | 465/561 [00:23<00:05, 19.13it/s] 83%|████████████████████████████████████████████████████████████████████████████████████                 | 467/561 [00:23<00:05, 18.11it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▍                | 469/561 [00:24<00:05, 18.28it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▊                | 471/561 [00:24<00:04, 18.49it/s] 84%|█████████████████████████████████████████████████████████████████████████████████████▏               | 473/561 [00:24<00:04, 18.36it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▌               | 475/561 [00:24<00:04, 18.45it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▉               | 477/561 [00:24<00:04, 18.65it/s] 85%|██████████████████████████████████████████████████████████████████████████████████████▏              | 479/561 [00:24<00:04, 19.01it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▌              | 481/561 [00:24<00:04, 18.72it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▉              | 483/561 [00:24<00:04, 18.84it/s] 86%|███████████████████████████████████████████████████████████████████████████████████████▎             | 485/561 [00:24<00:04, 18.67it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▋             | 487/561 [00:25<00:03, 18.77it/s] 87%|████████████████████████████████████████████████████████████████████████████████████████             | 489/561 [00:25<00:03, 18.75it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▍            | 491/561 [00:25<00:03, 18.71it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▊            | 493/561 [00:25<00:03, 18.63it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████████            | 495/561 [00:25<00:03, 18.44it/s][2025-03-28 01:38:36,541] [INFO] [logging.py:128:log_dist] [Rank 0] step=8350, skipped=18, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:38:36,545] [INFO] [timer.py:264:stop] epoch=0/micro_step=8350/global_step=8350, RunningAvgSamplesPerSec=20.551463895319806, CurrSamplesPerSec=18.781907031293485, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 89%|█████████████████████████████████████████████████████████████████████████████████████████▍           | 497/561 [00:25<00:03, 18.49it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▊           | 499/561 [00:25<00:03, 18.50it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████▏          | 501/561 [00:25<00:03, 18.30it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▌          | 503/561 [00:25<00:03, 18.35it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▉          | 505/561 [00:26<00:03, 18.19it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████████▎         | 507/561 [00:26<00:02, 18.22it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▋         | 509/561 [00:26<00:02, 18.05it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▉         | 511/561 [00:26<00:02, 18.09it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████████▎        | 513/561 [00:26<00:02, 18.26it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████████▋        | 515/561 [00:26<00:02, 18.34it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████        | 517/561 [00:26<00:02, 18.67it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▍       | 519/561 [00:26<00:02, 18.77it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▊       | 521/561 [00:26<00:02, 18.48it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████████▏      | 523/561 [00:27<00:02, 18.44it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▌      | 525/561 [00:27<00:01, 18.36it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▉      | 527/561 [00:27<00:01, 17.32it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▏     | 529/561 [00:27<00:01, 17.62it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▌     | 531/561 [00:27<00:01, 17.79it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▉     | 533/561 [00:27<00:01, 18.08it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████████▎    | 535/561 [00:27<00:01, 18.14it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▋    | 537/561 [00:27<00:01, 18.54it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████    | 539/561 [00:27<00:01, 18.64it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████▍   | 541/561 [00:27<00:01, 18.91it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████████▊   | 543/561 [00:28<00:00, 19.08it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████████   | 545/561 [00:28<00:00, 18.83it/s][2025-03-28 01:38:39,261] [INFO] [logging.py:128:log_dist] [Rank 0] step=8400, skipped=18, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:38:39,264] [INFO] [timer.py:264:stop] epoch=0/micro_step=8400/global_step=8400, RunningAvgSamplesPerSec=20.537415718691427, CurrSamplesPerSec=20.052686426358342, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▍  | 547/561 [00:28<00:00, 19.02it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▊  | 549/561 [00:28<00:00, 18.81it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████████▏ | 551/561 [00:28<00:00, 18.83it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▌ | 553/561 [00:28<00:00, 18.57it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▉ | 555/561 [00:28<00:00, 18.55it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████▎| 557/561 [00:28<00:00, 18.53it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████████▋| 559/561 [00:28<00:00, 18.68it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:29<00:00, 18.62it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:29<00:00, 19.26it/s]
  0%|                                                                                                               | 0/561 [00:00<?, ?it/s]  0%|▏                                                                                                      | 1/561 [00:00<02:11,  4.25it/s]  1%|▌                                                                                                      | 3/561 [00:00<00:56,  9.85it/s]  1%|▉                                                                                                      | 5/561 [00:00<00:43, 12.84it/s]  1%|█▎                                                                                                     | 7/561 [00:00<00:37, 14.67it/s]  2%|█▋                                                                                                     | 9/561 [00:00<00:34, 16.02it/s]  2%|██                                                                                                    | 11/561 [00:00<00:32, 16.85it/s]  2%|██▎                                                                                                   | 13/561 [00:00<00:31, 17.27it/s]  3%|██▋                                                                                                   | 15/561 [00:00<00:30, 17.71it/s]  3%|███                                                                                                   | 17/561 [00:01<00:30, 17.85it/s]  3%|███▍                                                                                                  | 19/561 [00:01<00:30, 17.89it/s]  4%|███▊                                                                                                  | 21/561 [00:01<00:29, 18.13it/s]  4%|████▏                                                                                                 | 23/561 [00:01<00:29, 18.08it/s]  4%|████▌                                                                                                 | 25/561 [00:01<00:29, 18.38it/s]  5%|████▉                                                                                                 | 27/561 [00:01<00:29, 17.87it/s]  5%|█████▎                                                                                                | 29/561 [00:01<00:30, 17.52it/s]  6%|█████▋                                                                                                | 31/561 [00:01<00:29, 17.78it/s]  6%|██████                                                                                                | 33/561 [00:01<00:29, 17.99it/s][2025-03-28 01:38:42,259] [INFO] [logging.py:128:log_dist] [Rank 0] step=8450, skipped=18, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:38:42,262] [INFO] [timer.py:264:stop] epoch=0/micro_step=8450/global_step=8450, RunningAvgSamplesPerSec=20.516787528939798, CurrSamplesPerSec=18.43300131576938, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
  6%|██████▎                                                                                               | 35/561 [00:02<00:29, 18.07it/s]  7%|██████▋                                                                                               | 37/561 [00:02<00:28, 18.20it/s]  7%|███████                                                                                               | 39/561 [00:02<00:28, 18.20it/s]  7%|███████▍                                                                                              | 41/561 [00:02<00:28, 18.20it/s]  8%|███████▊                                                                                              | 43/561 [00:02<00:29, 17.67it/s]  8%|████████▏                                                                                             | 45/561 [00:02<00:29, 17.70it/s]  8%|████████▌                                                                                             | 47/561 [00:02<00:28, 18.01it/s]  9%|████████▉                                                                                             | 49/561 [00:02<00:28, 17.99it/s]  9%|█████████▎                                                                                            | 51/561 [00:02<00:27, 18.35it/s]  9%|█████████▋                                                                                            | 53/561 [00:03<00:27, 18.20it/s] 10%|██████████                                                                                            | 55/561 [00:03<00:27, 18.09it/s] 10%|██████████▎                                                                                           | 57/561 [00:03<00:28, 17.96it/s] 11%|██████████▋                                                                                           | 59/561 [00:03<00:27, 18.05it/s] 11%|███████████                                                                                           | 61/561 [00:03<00:27, 17.98it/s] 11%|███████████▍                                                                                          | 63/561 [00:03<00:27, 18.38it/s] 12%|███████████▊                                                                                          | 65/561 [00:03<00:27, 18.26it/s] 12%|████████████▏                                                                                         | 67/561 [00:03<00:26, 18.71it/s] 12%|████████████▌                                                                                         | 69/561 [00:03<00:26, 18.89it/s] 13%|████████████▉                                                                                         | 71/561 [00:04<00:25, 18.89it/s] 13%|█████████████▎                                                                                        | 73/561 [00:04<00:26, 18.67it/s] 13%|█████████████▋                                                                                        | 75/561 [00:04<00:25, 18.81it/s] 14%|██████████████                                                                                        | 77/561 [00:04<00:26, 18.59it/s] 14%|██████████████▎                                                                                       | 79/561 [00:04<00:25, 18.78it/s] 14%|██████████████▋                                                                                       | 81/561 [00:04<00:25, 18.68it/s] 15%|███████████████                                                                                       | 83/561 [00:04<00:25, 18.52it/s][2025-03-28 01:38:44,978] [INFO] [logging.py:128:log_dist] [Rank 0] step=8500, skipped=18, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:38:44,981] [INFO] [timer.py:264:stop] epoch=0/micro_step=8500/global_step=8500, RunningAvgSamplesPerSec=20.503154319628937, CurrSamplesPerSec=18.888054768623963, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 15%|███████████████▍                                                                                      | 85/561 [00:04<00:25, 18.69it/s] 16%|███████████████▊                                                                                      | 87/561 [00:04<00:25, 18.62it/s] 16%|████████████████▏                                                                                     | 89/561 [00:05<00:25, 18.68it/s] 16%|████████████████▌                                                                                     | 91/561 [00:05<00:24, 18.83it/s] 17%|████████████████▉                                                                                     | 93/561 [00:05<00:25, 18.69it/s] 17%|█████████████████▎                                                                                    | 95/561 [00:05<00:25, 18.56it/s] 17%|█████████████████▋                                                                                    | 97/561 [00:05<00:24, 18.72it/s] 18%|██████████████████                                                                                    | 99/561 [00:05<00:24, 18.92it/s] 18%|██████████████████▏                                                                                  | 101/561 [00:05<00:24, 18.53it/s] 18%|██████████████████▌                                                                                  | 103/561 [00:05<00:25, 18.09it/s] 19%|██████████████████▉                                                                                  | 105/561 [00:05<00:25, 18.11it/s] 19%|███████████████████▎                                                                                 | 107/561 [00:06<00:24, 18.28it/s] 19%|███████████████████▌                                                                                 | 109/561 [00:06<00:24, 18.43it/s] 20%|███████████████████▉                                                                                 | 111/561 [00:06<00:24, 18.53it/s] 20%|████████████████████▎                                                                                | 113/561 [00:06<00:24, 18.41it/s] 20%|████████████████████▋                                                                                | 115/561 [00:06<00:24, 18.56it/s] 21%|█████████████████████                                                                                | 117/561 [00:06<00:23, 18.55it/s] 21%|█████████████████████▍                                                                               | 119/561 [00:06<00:23, 18.63it/s] 22%|█████████████████████▊                                                                               | 121/561 [00:06<00:23, 18.51it/s] 22%|██████████████████████▏                                                                              | 123/561 [00:06<00:23, 18.49it/s] 22%|██████████████████████▌                                                                              | 125/561 [00:06<00:23, 18.54it/s] 23%|██████████████████████▊                                                                              | 127/561 [00:07<00:23, 18.55it/s] 23%|███████████████████████▏                                                                             | 129/561 [00:07<00:23, 18.33it/s] 23%|███████████████████████▌                                                                             | 131/561 [00:07<00:23, 18.24it/s] 24%|███████████████████████▉                                                                             | 133/561 [00:07<00:22, 18.68it/s][2025-03-28 01:38:47,679] [INFO] [logging.py:128:log_dist] [Rank 0] step=8550, skipped=18, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:38:47,683] [INFO] [timer.py:264:stop] epoch=0/micro_step=8550/global_step=8550, RunningAvgSamplesPerSec=20.4905964484647, CurrSamplesPerSec=18.38154276620525, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 24%|████████████████████████▎                                                                            | 135/561 [00:07<00:22, 18.58it/s] 24%|████████████████████████▋                                                                            | 137/561 [00:07<00:22, 18.61it/s] 25%|█████████████████████████                                                                            | 139/561 [00:07<00:22, 18.54it/s] 25%|█████████████████████████▍                                                                           | 141/561 [00:07<00:23, 17.95it/s] 25%|█████████████████████████▋                                                                           | 143/561 [00:07<00:23, 17.90it/s] 26%|██████████████████████████                                                                           | 145/561 [00:08<00:23, 18.00it/s] 26%|██████████████████████████▍                                                                          | 147/561 [00:08<00:22, 18.11it/s] 27%|██████████████████████████▊                                                                          | 149/561 [00:08<00:23, 17.78it/s] 27%|███████████████████████████▏                                                                         | 151/561 [00:08<00:22, 17.88it/s] 27%|███████████████████████████▋                                                                         | 154/561 [00:08<00:22, 18.41it/s] 28%|████████████████████████████                                                                         | 156/561 [00:08<00:22, 18.29it/s] 28%|████████████████████████████▍                                                                        | 158/561 [00:08<00:21, 18.39it/s] 29%|████████████████████████████▊                                                                        | 160/561 [00:08<00:22, 18.04it/s] 29%|█████████████████████████████▏                                                                       | 162/561 [00:09<00:22, 18.03it/s] 29%|█████████████████████████████▌                                                                       | 164/561 [00:09<00:21, 18.19it/s] 30%|█████████████████████████████▉                                                                       | 166/561 [00:09<00:21, 18.03it/s] 30%|██████████████████████████████▏                                                                      | 168/561 [00:09<00:21, 18.34it/s] 30%|██████████████████████████████▌                                                                      | 170/561 [00:09<00:21, 18.16it/s] 31%|██████████████████████████████▉                                                                      | 172/561 [00:09<00:21, 18.38it/s] 31%|███████████████████████████████▎                                                                     | 174/561 [00:09<00:21, 18.33it/s] 32%|███████████████████████████████▊                                                                     | 177/561 [00:09<00:20, 18.71it/s] 32%|████████████████████████████████▏                                                                    | 179/561 [00:09<00:20, 18.58it/s] 32%|████████████████████████████████▊                                                                    | 182/561 [00:10<00:20, 18.85it/s] 33%|█████████████████████████████████▏                                                                   | 184/561 [00:10<00:20, 18.53it/s][2025-03-28 01:38:50,412] [INFO] [logging.py:128:log_dist] [Rank 0] step=8600, skipped=18, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:38:50,413] [INFO] [timer.py:264:stop] epoch=0/micro_step=8600/global_step=8600, RunningAvgSamplesPerSec=20.476744830102305, CurrSamplesPerSec=21.10244013962372, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 33%|█████████████████████████████████▍                                                                   | 186/561 [00:10<00:19, 18.89it/s] 34%|█████████████████████████████████▊                                                                   | 188/561 [00:10<00:19, 18.71it/s] 34%|██████████████████████████████████▏                                                                  | 190/561 [00:10<00:19, 18.72it/s] 34%|██████████████████████████████████▌                                                                  | 192/561 [00:10<00:19, 18.58it/s] 35%|██████████████████████████████████▉                                                                  | 194/561 [00:10<00:19, 18.55it/s] 35%|███████████████████████████████████▎                                                                 | 196/561 [00:10<00:19, 18.66it/s] 35%|███████████████████████████████████▋                                                                 | 198/561 [00:10<00:19, 18.55it/s] 36%|████████████████████████████████████                                                                 | 200/561 [00:11<00:19, 18.75it/s] 36%|████████████████████████████████████▎                                                                | 202/561 [00:11<00:19, 18.56it/s] 36%|████████████████████████████████████▋                                                                | 204/561 [00:11<00:19, 18.71it/s] 37%|█████████████████████████████████████                                                                | 206/561 [00:11<00:18, 18.76it/s] 37%|█████████████████████████████████████▍                                                               | 208/561 [00:11<00:18, 18.58it/s] 37%|█████████████████████████████████████▊                                                               | 210/561 [00:11<00:18, 18.71it/s] 38%|██████████████████████████████████████▏                                                              | 212/561 [00:11<00:18, 18.71it/s] 38%|██████████████████████████████████████▌                                                              | 214/561 [00:11<00:18, 18.73it/s] 39%|██████████████████████████████████████▉                                                              | 216/561 [00:11<00:18, 18.83it/s] 39%|███████████████████████████████████████▏                                                             | 218/561 [00:12<00:18, 18.82it/s] 39%|███████████████████████████████████████▌                                                             | 220/561 [00:12<00:18, 18.87it/s] 40%|███████████████████████████████████████▉                                                             | 222/561 [00:12<00:17, 19.05it/s] 40%|████████████████████████████████████████▎                                                            | 224/561 [00:12<00:17, 18.93it/s] 40%|████████████████████████████████████████▋                                                            | 226/561 [00:12<00:17, 18.88it/s] 41%|█████████████████████████████████████████                                                            | 228/561 [00:12<00:17, 18.86it/s] 41%|█████████████████████████████████████████▍                                                           | 230/561 [00:12<00:17, 18.77it/s] 41%|█████████████████████████████████████████▊                                                           | 232/561 [00:12<00:17, 18.59it/s] 42%|██████████████████████████████████████████▏                                                          | 234/561 [00:12<00:17, 18.57it/s][2025-03-28 01:38:53,084] [INFO] [logging.py:128:log_dist] [Rank 0] step=8650, skipped=18, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:38:53,087] [INFO] [timer.py:264:stop] epoch=0/micro_step=8650/global_step=8650, RunningAvgSamplesPerSec=20.46579009293389, CurrSamplesPerSec=18.585001855973445, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 42%|██████████████████████████████████████████▍                                                          | 236/561 [00:12<00:17, 18.55it/s] 43%|███████████████████████████████████████████                                                          | 239/561 [00:13<00:16, 18.94it/s] 43%|███████████████████████████████████████████▍                                                         | 241/561 [00:13<00:17, 18.13it/s] 43%|███████████████████████████████████████████▋                                                         | 243/561 [00:13<00:17, 18.23it/s] 44%|████████████████████████████████████████████▎                                                        | 246/561 [00:13<00:16, 19.01it/s] 44%|████████████████████████████████████████████▋                                                        | 248/561 [00:13<00:16, 18.71it/s] 45%|█████████████████████████████████████████████                                                        | 250/561 [00:13<00:16, 18.37it/s] 45%|█████████████████████████████████████████████▎                                                       | 252/561 [00:13<00:16, 18.24it/s] 45%|█████████████████████████████████████████████▋                                                       | 254/561 [00:13<00:16, 18.34it/s] 46%|██████████████████████████████████████████████                                                       | 256/561 [00:14<00:16, 18.35it/s] 46%|██████████████████████████████████████████████▍                                                      | 258/561 [00:14<00:16, 18.38it/s] 46%|██████████████████████████████████████████████▊                                                      | 260/561 [00:14<00:16, 18.41it/s] 47%|███████████████████████████████████████████████▎                                                     | 263/561 [00:14<00:15, 19.85it/s] 47%|███████████████████████████████████████████████▋                                                     | 265/561 [00:14<00:15, 19.44it/s] 48%|████████████████████████████████████████████████                                                     | 267/561 [00:14<00:15, 19.13it/s] 48%|████████████████████████████████████████████████▍                                                    | 269/561 [00:14<00:15, 18.95it/s] 48%|████████████████████████████████████████████████▊                                                    | 271/561 [00:14<00:15, 18.80it/s] 49%|█████████████████████████████████████████████████▏                                                   | 273/561 [00:14<00:15, 18.70it/s] 49%|█████████████████████████████████████████████████▌                                                   | 275/561 [00:15<00:15, 18.43it/s] 49%|█████████████████████████████████████████████████▊                                                   | 277/561 [00:15<00:15, 18.38it/s] 50%|██████████████████████████████████████████████████▏                                                  | 279/561 [00:15<00:15, 18.54it/s] 50%|██████████████████████████████████████████████████▌                                                  | 281/561 [00:15<00:15, 18.43it/s] 50%|██████████████████████████████████████████████████▉                                                  | 283/561 [00:15<00:15, 18.18it/s][2025-03-28 01:38:55,769] [INFO] [logging.py:128:log_dist] [Rank 0] step=8700, skipped=18, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:38:55,772] [INFO] [timer.py:264:stop] epoch=0/micro_step=8700/global_step=8700, RunningAvgSamplesPerSec=20.454472603457724, CurrSamplesPerSec=19.898380981967406, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 51%|███████████████████████████████████████████████████▎                                                 | 285/561 [00:15<00:14, 18.50it/s] 51%|███████████████████████████████████████████████████▋                                                 | 287/561 [00:15<00:14, 18.56it/s] 52%|████████████████████████████████████████████████████                                                 | 289/561 [00:15<00:14, 18.58it/s] 52%|████████████████████████████████████████████████████▍                                                | 291/561 [00:15<00:14, 18.40it/s] 52%|████████████████████████████████████████████████████▊                                                | 293/561 [00:16<00:14, 18.60it/s] 53%|█████████████████████████████████████████████████████                                                | 295/561 [00:16<00:14, 18.72it/s] 53%|█████████████████████████████████████████████████████▍                                               | 297/561 [00:16<00:14, 18.48it/s] 53%|█████████████████████████████████████████████████████▊                                               | 299/561 [00:16<00:13, 18.90it/s] 54%|██████████████████████████████████████████████████████▎                                              | 302/561 [00:16<00:13, 19.92it/s] 54%|██████████████████████████████████████████████████████▉                                              | 305/561 [00:16<00:12, 20.42it/s] 55%|███████████████████████████████████████████████████████▍                                             | 308/561 [00:16<00:12, 20.93it/s] 55%|███████████████████████████████████████████████████████▉                                             | 311/561 [00:16<00:11, 21.38it/s] 56%|████████████████████████████████████████████████████████▌                                            | 314/561 [00:17<00:11, 21.73it/s] 57%|█████████████████████████████████████████████████████████                                            | 317/561 [00:17<00:11, 21.62it/s] 57%|█████████████████████████████████████████████████████████▌                                           | 320/561 [00:17<00:11, 21.65it/s] 58%|██████████████████████████████████████████████████████████▏                                          | 323/561 [00:17<00:10, 21.80it/s] 58%|██████████████████████████████████████████████████████████▋                                          | 326/561 [00:17<00:10, 21.99it/s] 59%|███████████████████████████████████████████████████████████▏                                         | 329/561 [00:17<00:10, 21.94it/s] 59%|███████████████████████████████████████████████████████████▊                                         | 332/561 [00:17<00:10, 22.03it/s][2025-03-28 01:38:58,156] [INFO] [logging.py:128:log_dist] [Rank 0] step=8750, skipped=18, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:38:58,157] [INFO] [timer.py:264:stop] epoch=0/micro_step=8750/global_step=8750, RunningAvgSamplesPerSec=20.457626115728143, CurrSamplesPerSec=21.753764227400293, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 60%|████████████████████████████████████████████████████████████▎                                        | 335/561 [00:17<00:10, 22.05it/s] 60%|████████████████████████████████████████████████████████████▊                                        | 338/561 [00:18<00:10, 22.11it/s] 61%|█████████████████████████████████████████████████████████████▍                                       | 341/561 [00:18<00:10, 21.98it/s] 61%|█████████████████████████████████████████████████████████████▉                                       | 344/561 [00:18<00:09, 22.00it/s] 62%|██████████████████████████████████████████████████████████████▍                                      | 347/561 [00:18<00:09, 22.07it/s] 62%|███████████████████████████████████████████████████████████████                                      | 350/561 [00:18<00:09, 22.07it/s] 63%|███████████████████████████████████████████████████████████████▌                                     | 353/561 [00:18<00:10, 20.70it/s] 63%|████████████████████████████████████████████████████████████████                                     | 356/561 [00:19<00:10, 19.85it/s] 64%|████████████████████████████████████████████████████████████████▋                                    | 359/561 [00:19<00:10, 19.28it/s] 64%|████████████████████████████████████████████████████████████████▉                                    | 361/561 [00:19<00:10, 18.99it/s] 65%|█████████████████████████████████████████████████████████████████▎                                   | 363/561 [00:19<00:10, 18.74it/s] 65%|█████████████████████████████████████████████████████████████████▋                                   | 365/561 [00:19<00:10, 18.53it/s] 65%|██████████████████████████████████████████████████████████████████                                   | 367/561 [00:19<00:10, 18.38it/s] 66%|██████████████████████████████████████████████████████████████████▍                                  | 369/561 [00:19<00:10, 18.57it/s] 66%|██████████████████████████████████████████████████████████████████▉                                  | 372/561 [00:19<00:09, 19.93it/s] 67%|███████████████████████████████████████████████████████████████████▌                                 | 375/561 [00:20<00:09, 19.73it/s] 67%|████████████████████████████████████████████████████████████████████                                 | 378/561 [00:20<00:09, 20.26it/s] 68%|████████████████████████████████████████████████████████████████████▌                                | 381/561 [00:20<00:08, 20.79it/s] 68%|█████████████████████████████████████████████████████████████████████▏                               | 384/561 [00:20<00:08, 21.23it/s][2025-03-28 01:39:00,625] [INFO] [logging.py:128:log_dist] [Rank 0] step=8800, skipped=18, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:39:00,626] [INFO] [timer.py:264:stop] epoch=0/micro_step=8800/global_step=8800, RunningAvgSamplesPerSec=20.45670650774989, CurrSamplesPerSec=22.913409165981673, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 69%|█████████████████████████████████████████████████████████████████████▋                               | 387/561 [00:20<00:08, 21.34it/s] 70%|██████████████████████████████████████████████████████████████████████▏                              | 390/561 [00:20<00:07, 21.51it/s] 70%|██████████████████████████████████████████████████████████████████████▊                              | 393/561 [00:20<00:07, 21.71it/s] 71%|███████████████████████████████████████████████████████████████████████▎                             | 396/561 [00:20<00:07, 22.26it/s] 71%|███████████████████████████████████████████████████████████████████████▊                             | 399/561 [00:21<00:07, 22.54it/s] 72%|████████████████████████████████████████████████████████████████████████▎                            | 402/561 [00:21<00:07, 22.22it/s] 72%|████████████████████████████████████████████████████████████████████████▉                            | 405/561 [00:21<00:07, 20.80it/s] 73%|█████████████████████████████████████████████████████████████████████████▍                           | 408/561 [00:21<00:07, 19.90it/s] 73%|█████████████████████████████████████████████████████████████████████████▉                           | 411/561 [00:21<00:07, 19.30it/s] 74%|██████████████████████████████████████████████████████████████████████████▎                          | 413/561 [00:21<00:07, 18.56it/s] 74%|██████████████████████████████████████████████████████████████████████████▋                          | 415/561 [00:21<00:07, 18.43it/s] 74%|███████████████████████████████████████████████████████████████████████████                          | 417/561 [00:22<00:07, 18.30it/s] 75%|███████████████████████████████████████████████████████████████████████████▍                         | 419/561 [00:22<00:07, 18.20it/s] 75%|███████████████████████████████████████████████████████████████████████████▊                         | 421/561 [00:22<00:07, 18.13it/s] 76%|████████████████████████████████████████████████████████████████████████████▎                        | 424/561 [00:22<00:07, 19.49it/s] 76%|████████████████████████████████████████████████████████████████████████████▉                        | 427/561 [00:22<00:06, 20.19it/s] 77%|█████████████████████████████████████████████████████████████████████████████▍                       | 430/561 [00:22<00:06, 20.09it/s] 77%|█████████████████████████████████████████████████████████████████████████████▉                       | 433/561 [00:22<00:06, 20.67it/s][2025-03-28 01:39:03,109] [INFO] [logging.py:128:log_dist] [Rank 0] step=8850, skipped=18, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:39:03,110] [INFO] [timer.py:264:stop] epoch=0/micro_step=8850/global_step=8850, RunningAvgSamplesPerSec=20.455125783713854, CurrSamplesPerSec=21.185472692079575, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 78%|██████████████████████████████████████████████████████████████████████████████▍                      | 436/561 [00:22<00:06, 20.81it/s] 78%|███████████████████████████████████████████████████████████████████████████████                      | 439/561 [00:23<00:05, 21.33it/s] 79%|███████████████████████████████████████████████████████████████████████████████▌                     | 442/561 [00:23<00:05, 20.46it/s] 79%|████████████████████████████████████████████████████████████████████████████████                     | 445/561 [00:23<00:05, 20.53it/s] 80%|████████████████████████████████████████████████████████████████████████████████▋                    | 448/561 [00:23<00:05, 20.99it/s] 80%|█████████████████████████████████████████████████████████████████████████████████▏                   | 451/561 [00:23<00:05, 21.38it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▋                   | 454/561 [00:23<00:04, 21.42it/s] 81%|██████████████████████████████████████████████████████████████████████████████████▎                  | 457/561 [00:23<00:04, 21.68it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▊                  | 460/561 [00:24<00:04, 21.06it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▎                 | 463/561 [00:24<00:04, 20.40it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▉                 | 466/561 [00:24<00:04, 20.88it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▍                | 469/561 [00:24<00:04, 21.45it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▉                | 472/561 [00:24<00:04, 22.10it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▌               | 475/561 [00:24<00:03, 22.31it/s] 85%|██████████████████████████████████████████████████████████████████████████████████████               | 478/561 [00:24<00:03, 22.20it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▌              | 481/561 [00:25<00:03, 20.91it/s] 86%|███████████████████████████████████████████████████████████████████████████████████████▏             | 484/561 [00:25<00:03, 19.96it/s][2025-03-28 01:39:05,490] [INFO] [logging.py:128:log_dist] [Rank 0] step=8900, skipped=18, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:39:05,494] [INFO] [timer.py:264:stop] epoch=0/micro_step=8900/global_step=8900, RunningAvgSamplesPerSec=20.458256532657728, CurrSamplesPerSec=18.077323021738763, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 87%|███████████████████████████████████████████████████████████████████████████████████████▋             | 487/561 [00:25<00:03, 19.34it/s] 87%|████████████████████████████████████████████████████████████████████████████████████████             | 489/561 [00:25<00:03, 19.02it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▍            | 491/561 [00:25<00:03, 18.77it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▉            | 494/561 [00:25<00:03, 19.92it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▍           | 497/561 [00:25<00:03, 20.85it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████           | 500/561 [00:26<00:02, 21.23it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▌          | 503/561 [00:26<00:02, 21.45it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████████          | 506/561 [00:26<00:02, 21.57it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▋         | 509/561 [00:26<00:02, 21.15it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████████▏        | 512/561 [00:26<00:02, 20.96it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████████▋        | 515/561 [00:26<00:02, 21.71it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████▎       | 518/561 [00:26<00:01, 22.34it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▊       | 521/561 [00:27<00:01, 22.76it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████████▎      | 524/561 [00:27<00:01, 23.13it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▉      | 527/561 [00:27<00:01, 23.21it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▍     | 530/561 [00:27<00:01, 23.42it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▉     | 533/561 [00:27<00:01, 23.03it/s][2025-03-28 01:39:07,771] [INFO] [logging.py:128:log_dist] [Rank 0] step=8950, skipped=18, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:39:07,771] [INFO] [timer.py:264:stop] epoch=0/micro_step=8950/global_step=8950, RunningAvgSamplesPerSec=20.4663101182484, CurrSamplesPerSec=24.55103740128324, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 96%|████████████████████████████████████████████████████████████████████████████████████████████████▍    | 536/561 [00:27<00:01, 23.09it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████    | 539/561 [00:27<00:00, 22.59it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████████▌   | 542/561 [00:27<00:00, 22.05it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████████   | 545/561 [00:28<00:00, 21.85it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▋  | 548/561 [00:28<00:00, 22.05it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████████▏ | 551/561 [00:28<00:00, 21.77it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▋ | 554/561 [00:28<00:00, 21.78it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████▎| 557/561 [00:28<00:00, 21.70it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████████▊| 560/561 [00:28<00:00, 21.91it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:28<00:00, 19.43it/s]
  0%|                                                                                                               | 0/561 [00:00<?, ?it/s]  0%|▏                                                                                                      | 1/561 [00:00<02:05,  4.46it/s]  1%|▋                                                                                                      | 4/561 [00:00<00:44, 12.46it/s]  1%|█▎                                                                                                     | 7/561 [00:00<00:34, 16.28it/s]  2%|█▊                                                                                                    | 10/561 [00:00<00:30, 18.11it/s]  2%|██▏                                                                                                   | 12/561 [00:00<00:29, 18.58it/s]  3%|██▋                                                                                                   | 15/561 [00:00<00:27, 19.69it/s]  3%|███▎                                                                                                  | 18/561 [00:01<00:26, 20.36it/s]  4%|███▊                                                                                                  | 21/561 [00:01<00:25, 20.86it/s][2025-03-28 01:39:10,346] [INFO] [logging.py:128:log_dist] [Rank 0] step=9000, skipped=18, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:39:10,347] [INFO] [timer.py:264:stop] epoch=0/micro_step=9000/global_step=9000, RunningAvgSamplesPerSec=20.467145070986888, CurrSamplesPerSec=21.23706891453912, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
  4%|████▎                                                                                                 | 24/561 [00:01<00:25, 21.14it/s]  5%|████▉                                                                                                 | 27/561 [00:01<00:24, 21.37it/s]  5%|█████▍                                                                                                | 30/561 [00:01<00:24, 21.65it/s]  6%|██████                                                                                                | 33/561 [00:01<00:24, 21.70it/s]  6%|██████▌                                                                                               | 36/561 [00:01<00:24, 21.49it/s]  7%|███████                                                                                               | 39/561 [00:01<00:24, 21.60it/s]  7%|███████▋                                                                                              | 42/561 [00:02<00:24, 21.55it/s][2025-03-28 01:39:11,226] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2025-03-28 01:39:11,274] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
  8%|████████▏                                                                                             | 45/561 [00:02<00:24, 21.05it/s]  9%|████████▋                                                                                             | 48/561 [00:02<00:24, 21.23it/s]  9%|█████████▎                                                                                            | 51/561 [00:02<00:24, 20.48it/s] 10%|█████████▊                                                                                            | 54/561 [00:02<00:25, 20.18it/s] 10%|██████████▎                                                                                           | 57/561 [00:02<00:24, 20.78it/s] 11%|██████████▉                                                                                           | 60/561 [00:02<00:23, 21.15it/s] 11%|███████████▍                                                                                          | 63/561 [00:03<00:23, 21.48it/s] 12%|████████████                                                                                          | 66/561 [00:03<00:22, 21.76it/s] 12%|████████████▌                                                                                         | 69/561 [00:03<00:22, 22.05it/s] 13%|█████████████                                                                                         | 72/561 [00:03<00:22, 21.95it/s][2025-03-28 01:39:12,677] [INFO] [logging.py:128:log_dist] [Rank 0] step=9050, skipped=20, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:39:12,677] [INFO] [timer.py:264:stop] epoch=0/micro_step=9050/global_step=9050, RunningAvgSamplesPerSec=20.472631431956927, CurrSamplesPerSec=22.048107677725778, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 13%|█████████████▋                                                                                        | 75/561 [00:03<00:22, 21.92it/s] 14%|██████████████▏                                                                                       | 78/561 [00:03<00:22, 21.94it/s] 14%|██████████████▋                                                                                       | 81/561 [00:03<00:21, 21.86it/s] 15%|███████████████▎                                                                                      | 84/561 [00:04<00:22, 21.30it/s] 16%|███████████████▊                                                                                      | 87/561 [00:04<00:22, 20.91it/s] 16%|████████████████▎                                                                                     | 90/561 [00:04<00:22, 21.05it/s] 17%|████████████████▉                                                                                     | 93/561 [00:04<00:21, 21.43it/s] 17%|█████████████████▍                                                                                    | 96/561 [00:04<00:21, 21.79it/s] 18%|██████████████████                                                                                    | 99/561 [00:04<00:21, 21.85it/s] 18%|██████████████████▎                                                                                  | 102/561 [00:04<00:20, 21.92it/s] 19%|██████████████████▉                                                                                  | 105/561 [00:05<00:20, 21.84it/s] 19%|███████████████████▍                                                                                 | 108/561 [00:05<00:20, 21.81it/s] 20%|███████████████████▉                                                                                 | 111/561 [00:05<00:20, 21.70it/s] 20%|████████████████████▌                                                                                | 114/561 [00:05<00:20, 21.76it/s] 21%|█████████████████████                                                                                | 117/561 [00:05<00:20, 21.68it/s] 21%|█████████████████████▌                                                                               | 120/561 [00:05<00:20, 21.73it/s] 22%|██████████████████████▏                                                                              | 123/561 [00:05<00:20, 21.56it/s][2025-03-28 01:39:14,992] [INFO] [logging.py:128:log_dist] [Rank 0] step=9100, skipped=20, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:39:14,993] [INFO] [timer.py:264:stop] epoch=0/micro_step=9100/global_step=9100, RunningAvgSamplesPerSec=20.478748372826242, CurrSamplesPerSec=22.279766227649066, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 22%|██████████████████████▋                                                                              | 126/561 [00:06<00:20, 21.62it/s] 23%|███████████████████████▏                                                                             | 129/561 [00:06<00:19, 21.67it/s] 24%|███████████████████████▊                                                                             | 132/561 [00:06<00:19, 21.60it/s] 24%|████████████████████████▎                                                                            | 135/561 [00:06<00:19, 21.49it/s] 25%|████████████████████████▊                                                                            | 138/561 [00:06<00:19, 21.34it/s] 25%|█████████████████████████▍                                                                           | 141/561 [00:06<00:19, 21.10it/s] 26%|█████████████████████████▉                                                                           | 144/561 [00:06<00:19, 21.05it/s] 26%|██████████████████████████▍                                                                          | 147/561 [00:07<00:19, 20.76it/s] 27%|███████████████████████████                                                                          | 150/561 [00:07<00:19, 20.76it/s] 27%|███████████████████████████▌                                                                         | 153/561 [00:07<00:19, 20.90it/s] 28%|████████████████████████████                                                                         | 156/561 [00:07<00:20, 20.24it/s] 28%|████████████████████████████▋                                                                        | 159/561 [00:07<00:19, 20.33it/s] 29%|█████████████████████████████▏                                                                       | 162/561 [00:07<00:19, 20.26it/s] 29%|█████████████████████████████▋                                                                       | 165/561 [00:07<00:19, 20.13it/s] 30%|██████████████████████████████▏                                                                      | 168/561 [00:08<00:19, 20.11it/s] 30%|██████████████████████████████▊                                                                      | 171/561 [00:08<00:19, 20.19it/s][2025-03-28 01:39:17,413] [INFO] [logging.py:128:log_dist] [Rank 0] step=9150, skipped=20, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:39:17,415] [INFO] [timer.py:264:stop] epoch=0/micro_step=9150/global_step=9150, RunningAvgSamplesPerSec=20.479852777621513, CurrSamplesPerSec=20.152212233374915, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 31%|███████████████████████████████▎                                                                     | 174/561 [00:08<00:18, 20.46it/s] 32%|███████████████████████████████▊                                                                     | 177/561 [00:08<00:19, 20.14it/s] 32%|████████████████████████████████▍                                                                    | 180/561 [00:08<00:18, 20.11it/s] 33%|████████████████████████████████▉                                                                    | 183/561 [00:08<00:18, 20.13it/s] 33%|█████████████████████████████████▍                                                                   | 186/561 [00:08<00:18, 20.31it/s] 34%|██████████████████████████████████                                                                   | 189/561 [00:09<00:18, 20.30it/s] 34%|██████████████████████████████████▌                                                                  | 192/561 [00:09<00:18, 20.07it/s] 35%|███████████████████████████████████                                                                  | 195/561 [00:09<00:18, 19.94it/s] 35%|███████████████████████████████████▍                                                                 | 197/561 [00:09<00:18, 19.83it/s] 36%|████████████████████████████████████                                                                 | 200/561 [00:09<00:18, 20.02it/s] 36%|████████████████████████████████████▎                                                                | 202/561 [00:09<00:18, 19.70it/s] 36%|████████████████████████████████████▋                                                                | 204/561 [00:09<00:18, 19.65it/s] 37%|█████████████████████████████████████                                                                | 206/561 [00:09<00:18, 19.45it/s] 37%|█████████████████████████████████████▍                                                               | 208/561 [00:10<00:18, 19.54it/s] 37%|█████████████████████████████████████▊                                                               | 210/561 [00:10<00:17, 19.53it/s] 38%|██████████████████████████████████████▏                                                              | 212/561 [00:10<00:17, 19.48it/s] 38%|██████████████████████████████████████▌                                                              | 214/561 [00:10<00:17, 19.59it/s] 39%|██████████████████████████████████████▉                                                              | 216/561 [00:10<00:17, 19.50it/s] 39%|███████████████████████████████████████▏                                                             | 218/561 [00:10<00:17, 19.37it/s] 39%|███████████████████████████████████████▌                                                             | 220/561 [00:10<00:17, 19.09it/s] 40%|███████████████████████████████████████▉                                                             | 222/561 [00:10<00:17, 19.15it/s][2025-03-28 01:39:19,961] [INFO] [logging.py:128:log_dist] [Rank 0] step=9200, skipped=20, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:39:19,964] [INFO] [timer.py:264:stop] epoch=0/micro_step=9200/global_step=9200, RunningAvgSamplesPerSec=20.475222619357112, CurrSamplesPerSec=19.18718874218308, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 40%|████████████████████████████████████████▎                                                            | 224/561 [00:10<00:17, 19.16it/s] 40%|████████████████████████████████████████▋                                                            | 226/561 [00:11<00:17, 19.00it/s] 41%|█████████████████████████████████████████                                                            | 228/561 [00:11<00:17, 18.97it/s] 41%|█████████████████████████████████████████▍                                                           | 230/561 [00:11<00:17, 19.07it/s] 41%|█████████████████████████████████████████▊                                                           | 232/561 [00:11<00:17, 18.92it/s] 42%|██████████████████████████████████████████▏                                                          | 234/561 [00:11<00:17, 18.86it/s] 42%|██████████████████████████████████████████▍                                                          | 236/561 [00:11<00:17, 18.70it/s] 42%|██████████████████████████████████████████▊                                                          | 238/561 [00:11<00:17, 18.72it/s] 43%|███████████████████████████████████████████▏                                                         | 240/561 [00:11<00:17, 18.87it/s] 43%|███████████████████████████████████████████▌                                                         | 242/561 [00:11<00:16, 18.89it/s] 43%|███████████████████████████████████████████▉                                                         | 244/561 [00:11<00:16, 19.05it/s] 44%|████████████████████████████████████████████▎                                                        | 246/561 [00:12<00:16, 18.98it/s] 44%|████████████████████████████████████████████▋                                                        | 248/561 [00:12<00:16, 19.25it/s] 45%|█████████████████████████████████████████████                                                        | 250/561 [00:12<00:16, 19.25it/s] 45%|█████████████████████████████████████████████▎                                                       | 252/561 [00:12<00:16, 19.26it/s] 45%|█████████████████████████████████████████████▋                                                       | 254/561 [00:12<00:15, 19.21it/s] 46%|██████████████████████████████████████████████                                                       | 256/561 [00:12<00:15, 19.38it/s] 46%|██████████████████████████████████████████████▍                                                      | 258/561 [00:12<00:15, 19.26it/s] 46%|██████████████████████████████████████████████▊                                                      | 260/561 [00:12<00:15, 19.17it/s] 47%|███████████████████████████████████████████████▏                                                     | 262/561 [00:12<00:15, 18.83it/s] 47%|███████████████████████████████████████████████▌                                                     | 264/561 [00:13<00:15, 18.83it/s] 47%|███████████████████████████████████████████████▉                                                     | 266/561 [00:13<00:15, 18.84it/s] 48%|████████████████████████████████████████████████▏                                                    | 268/561 [00:13<00:15, 18.86it/s] 48%|████████████████████████████████████████████████▌                                                    | 270/561 [00:13<00:15, 19.03it/s] 48%|████████████████████████████████████████████████▉                                                    | 272/561 [00:13<00:15, 18.90it/s][2025-03-28 01:39:22,611] [INFO] [logging.py:128:log_dist] [Rank 0] step=9250, skipped=20, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:39:22,614] [INFO] [timer.py:264:stop] epoch=0/micro_step=9250/global_step=9250, RunningAvgSamplesPerSec=20.466125355462182, CurrSamplesPerSec=15.275277721154914, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 49%|█████████████████████████████████████████████████▎                                                   | 274/561 [00:13<00:15, 18.17it/s] 49%|█████████████████████████████████████████████████▋                                                   | 276/561 [00:13<00:15, 18.27it/s] 50%|██████████████████████████████████████████████████                                                   | 278/561 [00:13<00:15, 18.35it/s] 50%|██████████████████████████████████████████████████▍                                                  | 280/561 [00:13<00:15, 18.63it/s] 50%|██████████████████████████████████████████████████▊                                                  | 282/561 [00:13<00:14, 18.82it/s] 51%|███████████████████████████████████████████████████▏                                                 | 284/561 [00:14<00:14, 18.80it/s] 51%|███████████████████████████████████████████████████▍                                                 | 286/561 [00:14<00:14, 18.76it/s] 51%|███████████████████████████████████████████████████▊                                                 | 288/561 [00:14<00:14, 18.24it/s] 52%|████████████████████████████████████████████████████▏                                                | 290/561 [00:14<00:15, 17.77it/s] 52%|████████████████████████████████████████████████████▌                                                | 292/561 [00:14<00:15, 17.72it/s] 52%|████████████████████████████████████████████████████▉                                                | 294/561 [00:14<00:14, 17.92it/s] 53%|█████████████████████████████████████████████████████▎                                               | 296/561 [00:14<00:14, 18.49it/s] 53%|█████████████████████████████████████████████████████▋                                               | 298/561 [00:14<00:14, 18.58it/s] 53%|██████████████████████████████████████████████████████                                               | 300/561 [00:14<00:13, 18.67it/s] 54%|██████████████████████████████████████████████████████▎                                              | 302/561 [00:15<00:13, 18.67it/s] 54%|██████████████████████████████████████████████████████▋                                              | 304/561 [00:15<00:13, 18.49it/s] 55%|███████████████████████████████████████████████████████                                              | 306/561 [00:15<00:13, 18.53it/s] 55%|███████████████████████████████████████████████████████▍                                             | 308/561 [00:15<00:13, 18.70it/s] 55%|███████████████████████████████████████████████████████▊                                             | 310/561 [00:15<00:13, 18.87it/s] 56%|████████████████████████████████████████████████████████▏                                            | 312/561 [00:15<00:13, 18.86it/s] 56%|████████████████████████████████████████████████████████▌                                            | 314/561 [00:15<00:13, 18.89it/s] 56%|████████████████████████████████████████████████████████▉                                            | 316/561 [00:15<00:12, 18.91it/s] 57%|█████████████████████████████████████████████████████████▎                                           | 318/561 [00:15<00:12, 18.89it/s] 57%|█████████████████████████████████████████████████████████▌                                           | 320/561 [00:16<00:12, 18.87it/s] 57%|█████████████████████████████████████████████████████████▉                                           | 322/561 [00:16<00:12, 18.84it/s][2025-03-28 01:39:25,299] [INFO] [logging.py:128:log_dist] [Rank 0] step=9300, skipped=20, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:39:25,301] [INFO] [timer.py:264:stop] epoch=0/micro_step=9300/global_step=9300, RunningAvgSamplesPerSec=20.455407582895056, CurrSamplesPerSec=18.04458117916245, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 58%|██████████████████████████████████████████████████████████▎                                          | 324/561 [00:16<00:12, 18.62it/s] 58%|██████████████████████████████████████████████████████████▋                                          | 326/561 [00:16<00:12, 18.44it/s] 58%|███████████████████████████████████████████████████████████                                          | 328/561 [00:16<00:12, 18.66it/s] 59%|███████████████████████████████████████████████████████████▍                                         | 330/561 [00:16<00:12, 18.41it/s] 59%|███████████████████████████████████████████████████████████▊                                         | 332/561 [00:16<00:12, 18.34it/s] 60%|████████████████████████████████████████████████████████████▏                                        | 334/561 [00:16<00:12, 18.52it/s] 60%|████████████████████████████████████████████████████████████▍                                        | 336/561 [00:16<00:12, 18.62it/s] 60%|████████████████████████████████████████████████████████████▊                                        | 338/561 [00:17<00:11, 18.66it/s] 61%|█████████████████████████████████████████████████████████████▏                                       | 340/561 [00:17<00:11, 18.59it/s] 61%|█████████████████████████████████████████████████████████████▌                                       | 342/561 [00:17<00:11, 18.63it/s] 61%|█████████████████████████████████████████████████████████████▉                                       | 344/561 [00:17<00:11, 18.64it/s] 62%|██████████████████████████████████████████████████████████████▎                                      | 346/561 [00:17<00:11, 18.42it/s] 62%|██████████████████████████████████████████████████████████████▋                                      | 348/561 [00:17<00:11, 18.51it/s] 62%|███████████████████████████████████████████████████████████████                                      | 350/561 [00:17<00:11, 18.85it/s] 63%|███████████████████████████████████████████████████████████████▎                                     | 352/561 [00:17<00:11, 18.95it/s] 63%|███████████████████████████████████████████████████████████████▋                                     | 354/561 [00:17<00:11, 18.80it/s] 63%|████████████████████████████████████████████████████████████████                                     | 356/561 [00:17<00:10, 18.65it/s] 64%|████████████████████████████████████████████████████████████████▍                                    | 358/561 [00:18<00:10, 18.53it/s] 64%|████████████████████████████████████████████████████████████████▊                                    | 360/561 [00:18<00:10, 18.78it/s] 65%|█████████████████████████████████████████████████████████████████▏                                   | 362/561 [00:18<00:10, 18.77it/s] 65%|█████████████████████████████████████████████████████████████████▌                                   | 364/561 [00:18<00:10, 18.58it/s] 65%|█████████████████████████████████████████████████████████████████▉                                   | 366/561 [00:18<00:10, 18.76it/s] 66%|██████████████████████████████████████████████████████████████████▎                                  | 368/561 [00:18<00:10, 18.79it/s] 66%|██████████████████████████████████████████████████████████████████▌                                  | 370/561 [00:18<00:10, 18.65it/s] 66%|██████████████████████████████████████████████████████████████████▉                                  | 372/561 [00:18<00:10, 18.58it/s][2025-03-28 01:39:27,981] [INFO] [logging.py:128:log_dist] [Rank 0] step=9350, skipped=20, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:39:27,984] [INFO] [timer.py:264:stop] epoch=0/micro_step=9350/global_step=9350, RunningAvgSamplesPerSec=20.44502503221422, CurrSamplesPerSec=19.007546764360608, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 67%|███████████████████████████████████████████████████████████████████▎                                 | 374/561 [00:18<00:10, 18.67it/s] 67%|███████████████████████████████████████████████████████████████████▋                                 | 376/561 [00:19<00:09, 18.63it/s] 67%|████████████████████████████████████████████████████████████████████                                 | 378/561 [00:19<00:09, 18.78it/s] 68%|████████████████████████████████████████████████████████████████████▍                                | 380/561 [00:19<00:09, 18.78it/s] 68%|████████████████████████████████████████████████████████████████████▊                                | 382/561 [00:19<00:09, 18.62it/s] 68%|█████████████████████████████████████████████████████████████████████▏                               | 384/561 [00:19<00:09, 18.80it/s] 69%|█████████████████████████████████████████████████████████████████████▍                               | 386/561 [00:19<00:09, 18.57it/s] 69%|█████████████████████████████████████████████████████████████████████▊                               | 388/561 [00:19<00:09, 18.82it/s] 70%|██████████████████████████████████████████████████████████████████████▏                              | 390/561 [00:19<00:09, 18.72it/s] 70%|██████████████████████████████████████████████████████████████████████▌                              | 392/561 [00:19<00:08, 18.89it/s] 70%|██████████████████████████████████████████████████████████████████████▉                              | 394/561 [00:19<00:08, 18.82it/s] 71%|███████████████████████████████████████████████████████████████████████▎                             | 396/561 [00:20<00:08, 18.74it/s] 71%|███████████████████████████████████████████████████████████████████████▋                             | 398/561 [00:20<00:08, 18.66it/s] 71%|████████████████████████████████████████████████████████████████████████                             | 400/561 [00:20<00:08, 18.60it/s] 72%|████████████████████████████████████████████████████████████████████████▎                            | 402/561 [00:20<00:08, 18.55it/s] 72%|████████████████████████████████████████████████████████████████████████▋                            | 404/561 [00:20<00:08, 18.68it/s] 72%|█████████████████████████████████████████████████████████████████████████                            | 406/561 [00:20<00:08, 18.59it/s] 73%|█████████████████████████████████████████████████████████████████████████▍                           | 408/561 [00:20<00:08, 18.47it/s] 73%|█████████████████████████████████████████████████████████████████████████▊                           | 410/561 [00:20<00:08, 18.38it/s] 73%|██████████████████████████████████████████████████████████████████████████▏                          | 412/561 [00:20<00:08, 18.36it/s] 74%|██████████████████████████████████████████████████████████████████████████▌                          | 414/561 [00:21<00:07, 18.47it/s] 74%|██████████████████████████████████████████████████████████████████████████▉                          | 416/561 [00:21<00:07, 18.38it/s] 75%|███████████████████████████████████████████████████████████████████████████▎                         | 418/561 [00:21<00:07, 18.30it/s] 75%|███████████████████████████████████████████████████████████████████████████▌                         | 420/561 [00:21<00:07, 18.23it/s] 75%|███████████████████████████████████████████████████████████████████████████▉                         | 422/561 [00:21<00:07, 18.16it/s][2025-03-28 01:39:30,677] [INFO] [logging.py:128:log_dist] [Rank 0] step=9400, skipped=20, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:39:30,680] [INFO] [timer.py:264:stop] epoch=0/micro_step=9400/global_step=9400, RunningAvgSamplesPerSec=20.434190088812354, CurrSamplesPerSec=19.029278230118564, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 76%|████████████████████████████████████████████████████████████████████████████▎                        | 424/561 [00:21<00:07, 18.39it/s] 76%|████████████████████████████████████████████████████████████████████████████▋                        | 426/561 [00:21<00:07, 18.47it/s] 76%|█████████████████████████████████████████████████████████████████████████████                        | 428/561 [00:21<00:07, 18.72it/s] 77%|█████████████████████████████████████████████████████████████████████████████▍                       | 430/561 [00:21<00:06, 18.81it/s] 77%|█████████████████████████████████████████████████████████████████████████████▊                       | 432/561 [00:22<00:06, 18.80it/s] 77%|██████████████████████████████████████████████████████████████████████████████▏                      | 434/561 [00:22<00:06, 18.91it/s] 78%|██████████████████████████████████████████████████████████████████████████████▍                      | 436/561 [00:22<00:06, 18.97it/s] 78%|██████████████████████████████████████████████████████████████████████████████▊                      | 438/561 [00:22<00:06, 18.66it/s] 78%|███████████████████████████████████████████████████████████████████████████████▏                     | 440/561 [00:22<00:06, 18.42it/s] 79%|███████████████████████████████████████████████████████████████████████████████▌                     | 442/561 [00:22<00:06, 18.39it/s] 79%|███████████████████████████████████████████████████████████████████████████████▉                     | 444/561 [00:22<00:06, 18.48it/s] 80%|████████████████████████████████████████████████████████████████████████████████▎                    | 446/561 [00:22<00:06, 18.38it/s] 80%|████████████████████████████████████████████████████████████████████████████████▋                    | 448/561 [00:22<00:06, 18.50it/s] 80%|█████████████████████████████████████████████████████████████████████████████████                    | 450/561 [00:23<00:05, 18.56it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▍                   | 452/561 [00:23<00:05, 18.56it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▋                   | 454/561 [00:23<00:05, 18.61it/s] 81%|██████████████████████████████████████████████████████████████████████████████████                   | 456/561 [00:23<00:05, 18.44it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▍                  | 458/561 [00:23<00:05, 18.51it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▊                  | 460/561 [00:23<00:05, 18.49it/s] 82%|███████████████████████████████████████████████████████████████████████████████████▏                 | 462/561 [00:23<00:05, 18.51it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▌                 | 464/561 [00:23<00:05, 18.54it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▉                 | 466/561 [00:23<00:05, 18.57it/s] 83%|████████████████████████████████████████████████████████████████████████████████████▎                | 468/561 [00:23<00:05, 18.37it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▌                | 470/561 [00:24<00:04, 18.39it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▉                | 472/561 [00:24<00:04, 18.57it/s][2025-03-28 01:39:33,369] [INFO] [logging.py:128:log_dist] [Rank 0] step=9450, skipped=20, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:39:33,373] [INFO] [timer.py:264:stop] epoch=0/micro_step=9450/global_step=9450, RunningAvgSamplesPerSec=20.42361835939354, CurrSamplesPerSec=18.250133598143098, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 84%|█████████████████████████████████████████████████████████████████████████████████████▎               | 474/561 [00:24<00:04, 18.46it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▋               | 476/561 [00:24<00:04, 18.45it/s] 85%|██████████████████████████████████████████████████████████████████████████████████████               | 478/561 [00:24<00:04, 18.41it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▍              | 480/561 [00:24<00:04, 18.35it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▊              | 482/561 [00:24<00:04, 18.76it/s] 86%|███████████████████████████████████████████████████████████████████████████████████████▏             | 484/561 [00:24<00:04, 18.94it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▍             | 486/561 [00:24<00:04, 18.62it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▊             | 488/561 [00:25<00:03, 18.53it/s] 87%|████████████████████████████████████████████████████████████████████████████████████████▏            | 490/561 [00:25<00:03, 18.49it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▌            | 492/561 [00:25<00:03, 18.53it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▉            | 494/561 [00:25<00:03, 18.70it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████████▎           | 496/561 [00:25<00:03, 18.26it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▋           | 498/561 [00:25<00:03, 18.35it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████           | 500/561 [00:25<00:03, 18.62it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████▍          | 502/561 [00:25<00:03, 18.58it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▋          | 504/561 [00:25<00:03, 18.48it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████████          | 506/561 [00:26<00:02, 18.46it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▍         | 508/561 [00:26<00:02, 18.62it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▊         | 510/561 [00:26<00:02, 18.43it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████████▏        | 512/561 [00:26<00:02, 18.61it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████████▌        | 514/561 [00:26<00:02, 18.76it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████████▉        | 516/561 [00:26<00:02, 18.71it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████▎       | 518/561 [00:26<00:02, 19.02it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▌       | 520/561 [00:26<00:02, 19.10it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▉       | 522/561 [00:26<00:02, 18.76it/s][2025-03-28 01:39:36,052] [INFO] [logging.py:128:log_dist] [Rank 0] step=9500, skipped=20, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:39:36,055] [INFO] [timer.py:264:stop] epoch=0/micro_step=9500/global_step=9500, RunningAvgSamplesPerSec=20.41362049108511, CurrSamplesPerSec=18.51314190106938, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 93%|██████████████████████████████████████████████████████████████████████████████████████████████▎      | 524/561 [00:27<00:01, 18.78it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▋      | 526/561 [00:27<00:01, 18.87it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████      | 528/561 [00:27<00:01, 18.66it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▍     | 530/561 [00:27<00:01, 19.03it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▊     | 532/561 [00:27<00:01, 19.08it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████████▎    | 535/561 [00:27<00:01, 19.51it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▋    | 537/561 [00:27<00:01, 18.68it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████    | 539/561 [00:27<00:01, 18.70it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████▍   | 541/561 [00:27<00:01, 18.59it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████████▊   | 543/561 [00:28<00:00, 18.52it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████████   | 545/561 [00:28<00:00, 18.75it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▍  | 547/561 [00:28<00:00, 18.82it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▊  | 549/561 [00:28<00:00, 18.86it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████████▏ | 551/561 [00:28<00:00, 18.88it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▌ | 553/561 [00:28<00:00, 18.79it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▉ | 555/561 [00:28<00:00, 18.43it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████▎| 557/561 [00:28<00:00, 18.45it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████████▋| 559/561 [00:28<00:00, 18.57it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:28<00:00, 18.68it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:29<00:00, 19.32it/s]
  0%|                                                                                                               | 0/561 [00:00<?, ?it/s]  0%|▏                                                                                                      | 1/561 [00:00<02:42,  3.44it/s]  1%|▋                                                                                                      | 4/561 [00:00<00:51, 10.76it/s]  1%|█▍                                                                                                     | 8/561 [00:00<00:33, 16.74it/s]  2%|██                                                                                                    | 11/561 [00:00<00:30, 18.23it/s][2025-03-28 01:39:38,928] [INFO] [logging.py:128:log_dist] [Rank 0] step=9550, skipped=20, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:39:38,929] [INFO] [timer.py:264:stop] epoch=0/micro_step=9550/global_step=9550, RunningAvgSamplesPerSec=20.401628966919084, CurrSamplesPerSec=22.991407795238146, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
  2%|██▌                                                                                                   | 14/561 [00:00<00:27, 19.56it/s]  3%|███                                                                                                   | 17/561 [00:00<00:26, 20.38it/s]  4%|███▋                                                                                                  | 20/561 [00:01<00:26, 20.80it/s]  4%|████▏                                                                                                 | 23/561 [00:01<00:26, 20.45it/s]  5%|████▋                                                                                                 | 26/561 [00:01<00:25, 20.87it/s]  5%|█████▎                                                                                                | 29/561 [00:01<00:26, 20.31it/s]  6%|█████▊                                                                                                | 32/561 [00:01<00:25, 20.60it/s]  6%|██████▎                                                                                               | 35/561 [00:01<00:24, 21.27it/s]  7%|██████▉                                                                                               | 38/561 [00:01<00:24, 21.44it/s]  7%|███████▍                                                                                              | 41/561 [00:02<00:24, 21.60it/s]  8%|████████                                                                                              | 44/561 [00:02<00:23, 21.61it/s]  8%|████████▌                                                                                             | 47/561 [00:02<00:23, 21.72it/s]  9%|█████████                                                                                             | 50/561 [00:02<00:23, 21.90it/s]  9%|█████████▋                                                                                            | 53/561 [00:02<00:23, 21.89it/s] 10%|██████████▏                                                                                           | 56/561 [00:02<00:23, 21.94it/s] 11%|██████████▋                                                                                           | 59/561 [00:02<00:22, 21.94it/s] 11%|███████████▎                                                                                          | 62/561 [00:03<00:22, 21.99it/s][2025-03-28 01:39:41,239] [INFO] [logging.py:128:log_dist] [Rank 0] step=9600, skipped=20, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:39:41,240] [INFO] [timer.py:264:stop] epoch=0/micro_step=9600/global_step=9600, RunningAvgSamplesPerSec=20.407982729413497, CurrSamplesPerSec=21.52501484475033, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 12%|███████████▊                                                                                          | 65/561 [00:03<00:22, 22.03it/s] 12%|████████████▎                                                                                         | 68/561 [00:03<00:22, 21.86it/s] 13%|████████████▉                                                                                         | 71/561 [00:03<00:22, 22.10it/s] 13%|█████████████▍                                                                                        | 74/561 [00:03<00:21, 22.14it/s] 14%|██████████████                                                                                        | 77/561 [00:03<00:21, 22.10it/s] 14%|██████████████▌                                                                                       | 80/561 [00:03<00:21, 22.04it/s] 15%|███████████████                                                                                       | 83/561 [00:04<00:21, 22.67it/s] 15%|███████████████▋                                                                                      | 86/561 [00:04<00:20, 22.77it/s] 16%|████████████████▏                                                                                     | 89/561 [00:04<00:21, 22.25it/s] 16%|████████████████▋                                                                                     | 92/561 [00:04<00:21, 21.54it/s] 17%|█████████████████▎                                                                                    | 95/561 [00:04<00:21, 22.10it/s] 17%|█████████████████▊                                                                                    | 98/561 [00:04<00:20, 22.41it/s] 18%|██████████████████▏                                                                                  | 101/561 [00:04<00:20, 22.21it/s] 19%|██████████████████▋                                                                                  | 104/561 [00:04<00:20, 22.22it/s] 19%|███████████████████▎                                                                                 | 107/561 [00:05<00:20, 22.18it/s] 20%|███████████████████▊                                                                                 | 110/561 [00:05<00:20, 21.98it/s][2025-03-28 01:39:43,493] [INFO] [logging.py:128:log_dist] [Rank 0] step=9650, skipped=20, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:39:43,494] [INFO] [timer.py:264:stop] epoch=0/micro_step=9650/global_step=9650, RunningAvgSamplesPerSec=20.416706734012607, CurrSamplesPerSec=22.979944854836702, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 20%|████████████████████▎                                                                                | 113/561 [00:05<00:20, 22.06it/s] 21%|████████████████████▉                                                                                | 116/561 [00:05<00:20, 22.14it/s] 21%|█████████████████████▍                                                                               | 119/561 [00:05<00:19, 22.56it/s] 22%|█████████████████████▉                                                                               | 122/561 [00:05<00:19, 23.04it/s] 22%|██████████████████████▌                                                                              | 125/561 [00:05<00:18, 23.19it/s] 23%|███████████████████████                                                                              | 128/561 [00:06<00:18, 23.30it/s] 23%|███████████████████████▌                                                                             | 131/561 [00:06<00:18, 23.53it/s] 24%|████████████████████████                                                                             | 134/561 [00:06<00:18, 23.65it/s] 24%|████████████████████████▋                                                                            | 137/561 [00:06<00:18, 22.41it/s] 25%|█████████████████████████▏                                                                           | 140/561 [00:06<00:18, 22.32it/s] 25%|█████████████████████████▋                                                                           | 143/561 [00:06<00:18, 23.09it/s] 26%|██████████████████████████▎                                                                          | 146/561 [00:06<00:17, 23.50it/s] 27%|██████████████████████████▊                                                                          | 149/561 [00:06<00:17, 23.70it/s] 27%|███████████████████████████▎                                                                         | 152/561 [00:07<00:17, 23.66it/s] 28%|███████████████████████████▉                                                                         | 155/561 [00:07<00:17, 23.72it/s] 28%|████████████████████████████▍                                                                        | 158/561 [00:07<00:17, 23.52it/s] 29%|████████████████████████████▉                                                                        | 161/561 [00:07<00:17, 23.03it/s][2025-03-28 01:39:45,650] [INFO] [logging.py:128:log_dist] [Rank 0] step=9700, skipped=20, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:39:45,651] [INFO] [timer.py:264:stop] epoch=0/micro_step=9700/global_step=9700, RunningAvgSamplesPerSec=20.429504383150878, CurrSamplesPerSec=20.878174277416075, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 29%|█████████████████████████████▌                                                                       | 164/561 [00:07<00:17, 22.50it/s] 30%|██████████████████████████████                                                                       | 167/561 [00:07<00:17, 22.85it/s] 30%|██████████████████████████████▌                                                                      | 170/561 [00:07<00:16, 23.10it/s] 31%|███████████████████████████████▏                                                                     | 173/561 [00:07<00:17, 21.63it/s] 31%|███████████████████████████████▋                                                                     | 176/561 [00:08<00:17, 21.59it/s] 32%|████████████████████████████████▏                                                                    | 179/561 [00:08<00:17, 21.68it/s] 32%|████████████████████████████████▊                                                                    | 182/561 [00:08<00:17, 21.83it/s] 33%|█████████████████████████████████▎                                                                   | 185/561 [00:08<00:17, 22.00it/s] 34%|█████████████████████████████████▊                                                                   | 188/561 [00:08<00:16, 22.08it/s] 34%|██████████████████████████████████▍                                                                  | 191/561 [00:08<00:16, 22.59it/s] 35%|██████████████████████████████████▉                                                                  | 194/561 [00:08<00:17, 21.53it/s] 35%|███████████████████████████████████▍                                                                 | 197/561 [00:09<00:16, 21.54it/s] 36%|████████████████████████████████████                                                                 | 200/561 [00:09<00:16, 21.75it/s] 36%|████████████████████████████████████▌                                                                | 203/561 [00:09<00:16, 21.83it/s] 37%|█████████████████████████████████████                                                                | 206/561 [00:09<00:16, 22.01it/s] 37%|█████████████████████████████████████▋                                                               | 209/561 [00:09<00:15, 22.07it/s] 38%|██████████████████████████████████████▏                                                              | 212/561 [00:09<00:15, 21.84it/s][2025-03-28 01:39:47,936] [INFO] [logging.py:128:log_dist] [Rank 0] step=9750, skipped=20, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:39:47,936] [INFO] [timer.py:264:stop] epoch=0/micro_step=9750/global_step=9750, RunningAvgSamplesPerSec=20.43672179865665, CurrSamplesPerSec=21.3490573379861, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 38%|██████████████████████████████████████▋                                                              | 215/561 [00:09<00:15, 21.91it/s] 39%|███████████████████████████████████████▏                                                             | 218/561 [00:10<00:15, 21.99it/s] 39%|███████████████████████████████████████▊                                                             | 221/561 [00:10<00:15, 22.07it/s] 40%|████████████████████████████████████████▎                                                            | 224/561 [00:10<00:14, 22.59it/s] 40%|████████████████████████████████████████▊                                                            | 227/561 [00:10<00:14, 22.72it/s] 41%|█████████████████████████████████████████▍                                                           | 230/561 [00:10<00:14, 22.53it/s] 42%|█████████████████████████████████████████▉                                                           | 233/561 [00:10<00:14, 22.27it/s] 42%|██████████████████████████████████████████▍                                                          | 236/561 [00:10<00:14, 22.22it/s] 43%|███████████████████████████████████████████                                                          | 239/561 [00:10<00:14, 22.43it/s] 43%|███████████████████████████████████████████▌                                                         | 242/561 [00:11<00:14, 22.41it/s] 44%|████████████████████████████████████████████                                                         | 245/561 [00:11<00:14, 22.17it/s] 44%|████████████████████████████████████████████▋                                                        | 248/561 [00:11<00:14, 22.17it/s] 45%|█████████████████████████████████████████████▏                                                       | 251/561 [00:11<00:14, 21.58it/s] 45%|█████████████████████████████████████████████▋                                                       | 254/561 [00:11<00:14, 21.72it/s] 46%|██████████████████████████████████████████████▎                                                      | 257/561 [00:11<00:13, 21.84it/s] 46%|██████████████████████████████████████████████▊                                                      | 260/561 [00:11<00:13, 21.90it/s][2025-03-28 01:39:50,202] [INFO] [logging.py:128:log_dist] [Rank 0] step=9800, skipped=20, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:39:50,203] [INFO] [timer.py:264:stop] epoch=0/micro_step=9800/global_step=9800, RunningAvgSamplesPerSec=20.444672566903403, CurrSamplesPerSec=18.991796664755583, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 47%|███████████████████████████████████████████████▎                                                     | 263/561 [00:12<00:13, 21.39it/s] 47%|███████████████████████████████████████████████▉                                                     | 266/561 [00:12<00:13, 21.28it/s] 48%|████████████████████████████████████████████████▍                                                    | 269/561 [00:12<00:13, 21.41it/s] 48%|████████████████████████████████████████████████▉                                                    | 272/561 [00:12<00:13, 22.08it/s] 49%|█████████████████████████████████████████████████▌                                                   | 275/561 [00:12<00:12, 23.12it/s] 50%|██████████████████████████████████████████████████                                                   | 278/561 [00:12<00:12, 23.29it/s] 50%|██████████████████████████████████████████████████▌                                                  | 281/561 [00:12<00:12, 21.94it/s] 51%|███████████████████████████████████████████████████▏                                                 | 284/561 [00:13<00:12, 22.05it/s] 51%|███████████████████████████████████████████████████▋                                                 | 287/561 [00:13<00:12, 22.18it/s] 52%|████████████████████████████████████████████████████▏                                                | 290/561 [00:13<00:12, 22.04it/s] 52%|████████████████████████████████████████████████████▊                                                | 293/561 [00:13<00:12, 21.81it/s] 53%|█████████████████████████████████████████████████████▎                                               | 296/561 [00:13<00:12, 21.62it/s] 53%|█████████████████████████████████████████████████████▊                                               | 299/561 [00:13<00:12, 21.08it/s] 54%|██████████████████████████████████████████████████████▎                                              | 302/561 [00:13<00:12, 20.73it/s] 54%|██████████████████████████████████████████████████████▉                                              | 305/561 [00:14<00:12, 20.95it/s] 55%|███████████████████████████████████████████████████████▍                                             | 308/561 [00:14<00:11, 21.11it/s] 55%|███████████████████████████████████████████████████████▉                                             | 311/561 [00:14<00:12, 20.70it/s][2025-03-28 01:39:52,518] [INFO] [logging.py:128:log_dist] [Rank 0] step=9850, skipped=20, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:39:52,519] [INFO] [timer.py:264:stop] epoch=0/micro_step=9850/global_step=9850, RunningAvgSamplesPerSec=20.450442982758453, CurrSamplesPerSec=21.65112786931402, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 56%|████████████████████████████████████████████████████████▌                                            | 314/561 [00:14<00:11, 21.10it/s] 57%|█████████████████████████████████████████████████████████                                            | 317/561 [00:14<00:11, 21.36it/s] 57%|█████████████████████████████████████████████████████████▌                                           | 320/561 [00:14<00:11, 21.51it/s] 58%|██████████████████████████████████████████████████████████▏                                          | 323/561 [00:14<00:10, 21.65it/s] 58%|██████████████████████████████████████████████████████████▋                                          | 326/561 [00:14<00:10, 21.68it/s] 59%|███████████████████████████████████████████████████████████▏                                         | 329/561 [00:15<00:10, 21.45it/s] 59%|███████████████████████████████████████████████████████████▊                                         | 332/561 [00:15<00:10, 21.82it/s] 60%|████████████████████████████████████████████████████████████▎                                        | 335/561 [00:15<00:09, 22.94it/s] 60%|████████████████████████████████████████████████████████████▊                                        | 338/561 [00:15<00:09, 22.55it/s] 61%|█████████████████████████████████████████████████████████████▍                                       | 341/561 [00:15<00:09, 22.24it/s] 61%|█████████████████████████████████████████████████████████████▉                                       | 344/561 [00:15<00:09, 21.98it/s] 62%|██████████████████████████████████████████████████████████████▍                                      | 347/561 [00:15<00:09, 22.18it/s] 62%|███████████████████████████████████████████████████████████████                                      | 350/561 [00:16<00:09, 22.22it/s] 63%|███████████████████████████████████████████████████████████████▌                                     | 353/561 [00:16<00:09, 22.75it/s] 63%|████████████████████████████████████████████████████████████████                                     | 356/561 [00:16<00:09, 22.02it/s] 64%|████████████████████████████████████████████████████████████████▋                                    | 359/561 [00:16<00:09, 22.11it/s] 65%|█████████████████████████████████████████████████████████████████▏                                   | 362/561 [00:16<00:08, 22.16it/s][2025-03-28 01:39:54,772] [INFO] [logging.py:128:log_dist] [Rank 0] step=9900, skipped=20, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:39:54,773] [INFO] [timer.py:264:stop] epoch=0/micro_step=9900/global_step=9900, RunningAvgSamplesPerSec=20.45879135353425, CurrSamplesPerSec=21.708390215737964, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 65%|█████████████████████████████████████████████████████████████████▋                                   | 365/561 [00:16<00:08, 21.97it/s] 66%|██████████████████████████████████████████████████████████████████▎                                  | 368/561 [00:16<00:09, 21.08it/s] 66%|██████████████████████████████████████████████████████████████████▊                                  | 371/561 [00:17<00:08, 21.49it/s] 67%|███████████████████████████████████████████████████████████████████▎                                 | 374/561 [00:17<00:08, 21.68it/s] 67%|███████████████████████████████████████████████████████████████████▊                                 | 377/561 [00:17<00:08, 21.30it/s] 68%|████████████████████████████████████████████████████████████████████▍                                | 380/561 [00:17<00:08, 20.77it/s] 68%|████████████████████████████████████████████████████████████████████▉                                | 383/561 [00:17<00:08, 21.30it/s] 69%|█████████████████████████████████████████████████████████████████████▍                               | 386/561 [00:17<00:07, 21.93it/s] 69%|██████████████████████████████████████████████████████████████████████                               | 389/561 [00:17<00:07, 22.55it/s] 70%|██████████████████████████████████████████████████████████████████████▌                              | 392/561 [00:17<00:07, 23.01it/s] 70%|███████████████████████████████████████████████████████████████████████                              | 395/561 [00:18<00:07, 23.23it/s] 71%|███████████████████████████████████████████████████████████████████████▋                             | 398/561 [00:18<00:06, 23.32it/s] 71%|████████████████████████████████████████████████████████████████████████▏                            | 401/561 [00:18<00:06, 23.41it/s] 72%|████████████████████████████████████████████████████████████████████████▋                            | 404/561 [00:18<00:06, 23.38it/s] 73%|█████████████████████████████████████████████████████████████████████████▎                           | 407/561 [00:18<00:06, 23.06it/s] 73%|█████████████████████████████████████████████████████████████████████████▊                           | 410/561 [00:18<00:06, 22.87it/s][2025-03-28 01:39:57,016] [INFO] [logging.py:128:log_dist] [Rank 0] step=9950, skipped=20, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:39:57,017] [INFO] [timer.py:264:stop] epoch=0/micro_step=9950/global_step=9950, RunningAvgSamplesPerSec=20.467429814942022, CurrSamplesPerSec=20.57956224361406, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 74%|██████████████████████████████████████████████████████████████████████████▎                          | 413/561 [00:18<00:06, 22.29it/s] 74%|██████████████████████████████████████████████████████████████████████████▉                          | 416/561 [00:19<00:06, 22.67it/s] 75%|███████████████████████████████████████████████████████████████████████████▍                         | 419/561 [00:19<00:06, 22.98it/s] 75%|███████████████████████████████████████████████████████████████████████████▉                         | 422/561 [00:19<00:05, 23.38it/s] 76%|████████████████████████████████████████████████████████████████████████████▌                        | 425/561 [00:19<00:05, 23.56it/s] 76%|█████████████████████████████████████████████████████████████████████████████                        | 428/561 [00:19<00:05, 23.46it/s] 77%|█████████████████████████████████████████████████████████████████████████████▌                       | 431/561 [00:19<00:05, 23.70it/s] 77%|██████████████████████████████████████████████████████████████████████████████▏                      | 434/561 [00:19<00:05, 23.44it/s] 78%|██████████████████████████████████████████████████████████████████████████████▋                      | 437/561 [00:19<00:05, 23.65it/s] 78%|███████████████████████████████████████████████████████████████████████████████▏                     | 440/561 [00:20<00:05, 23.60it/s] 79%|███████████████████████████████████████████████████████████████████████████████▊                     | 443/561 [00:20<00:04, 23.68it/s] 80%|████████████████████████████████████████████████████████████████████████████████▎                    | 446/561 [00:20<00:04, 23.79it/s] 80%|████████████████████████████████████████████████████████████████████████████████▊                    | 449/561 [00:20<00:04, 23.84it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▍                   | 452/561 [00:20<00:04, 23.71it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▉                   | 455/561 [00:20<00:04, 23.91it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▍                  | 458/561 [00:20<00:04, 23.64it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▉                  | 461/561 [00:20<00:04, 23.77it/s][2025-03-28 01:39:59,121] [INFO] [logging.py:128:log_dist] [Rank 0] step=10000, skipped=20, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:39:59,122] [INFO] [timer.py:264:stop] epoch=0/micro_step=10000/global_step=10000, RunningAvgSamplesPerSec=20.481841193717827, CurrSamplesPerSec=21.92868583242865, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 83%|███████████████████████████████████████████████████████████████████████████████████▌                 | 464/561 [00:21<00:04, 23.50it/s] 83%|████████████████████████████████████████████████████████████████████████████████████                 | 467/561 [00:21<00:04, 23.01it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▌                | 470/561 [00:21<00:04, 22.25it/s] 84%|█████████████████████████████████████████████████████████████████████████████████████▏               | 473/561 [00:21<00:04, 21.36it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▋               | 476/561 [00:21<00:03, 21.58it/s] 85%|██████████████████████████████████████████████████████████████████████████████████████▏              | 479/561 [00:21<00:03, 21.64it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▊              | 482/561 [00:21<00:03, 21.77it/s][2025-03-28 01:40:00,097] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2025-03-28 01:40:00,145] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
 86%|███████████████████████████████████████████████████████████████████████████████████████▎             | 485/561 [00:22<00:03, 21.99it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▊             | 488/561 [00:22<00:03, 21.78it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▍            | 491/561 [00:22<00:03, 22.02it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▉            | 494/561 [00:22<00:03, 22.05it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▍           | 497/561 [00:22<00:02, 21.99it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████           | 500/561 [00:22<00:02, 21.70it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▌          | 503/561 [00:22<00:02, 21.73it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████████          | 506/561 [00:22<00:02, 21.65it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▋         | 509/561 [00:23<00:02, 21.64it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████████▏        | 512/561 [00:23<00:02, 21.65it/s][2025-03-28 01:40:01,435] [INFO] [logging.py:128:log_dist] [Rank 0] step=10050, skipped=22, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:40:01,436] [INFO] [timer.py:264:stop] epoch=0/micro_step=10050/global_step=10050, RunningAvgSamplesPerSec=20.48741893854893, CurrSamplesPerSec=21.499196901036157, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 92%|████████████████████████████████████████████████████████████████████████████████████████████▋        | 515/561 [00:23<00:02, 21.55it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████▎       | 518/561 [00:23<00:01, 21.79it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▊       | 521/561 [00:23<00:01, 21.88it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████████▎      | 524/561 [00:23<00:01, 21.86it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▉      | 527/561 [00:23<00:01, 22.02it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▍     | 530/561 [00:24<00:01, 21.42it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▉     | 533/561 [00:24<00:01, 21.21it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▍    | 536/561 [00:24<00:01, 21.61it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████    | 539/561 [00:24<00:01, 20.82it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████████▌   | 542/561 [00:24<00:00, 21.09it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████████   | 545/561 [00:24<00:00, 20.76it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▋  | 548/561 [00:24<00:00, 20.89it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████████▏ | 551/561 [00:25<00:00, 21.04it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▋ | 554/561 [00:25<00:00, 21.17it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████▎| 557/561 [00:25<00:00, 21.27it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████████▊| 560/561 [00:25<00:00, 21.56it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:25<00:00, 21.89it/s]
  0%|                                                                                                               | 0/561 [00:00<?, ?it/s]  0%|▏                                                                                                      | 1/561 [00:00<03:07,  2.98it/s][2025-03-28 01:40:04,160] [INFO] [logging.py:128:log_dist] [Rank 0] step=10100, skipped=22, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:40:04,162] [INFO] [timer.py:264:stop] epoch=0/micro_step=10100/global_step=10100, RunningAvgSamplesPerSec=20.48210627720506, CurrSamplesPerSec=19.12071209646815, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
  1%|▌                                                                                                      | 3/561 [00:00<01:09,  7.99it/s]  1%|█                                                                                                      | 6/561 [00:00<00:41, 13.25it/s]  2%|█▋                                                                                                     | 9/561 [00:00<00:34, 16.21it/s]  2%|██▏                                                                                                   | 12/561 [00:00<00:30, 18.11it/s]  3%|██▋                                                                                                   | 15/561 [00:00<00:28, 19.43it/s]  3%|███▎                                                                                                  | 18/561 [00:01<00:26, 20.33it/s]  4%|███▊                                                                                                  | 21/561 [00:01<00:25, 20.83it/s]  4%|████▎                                                                                                 | 24/561 [00:01<00:25, 21.45it/s]  5%|████▉                                                                                                 | 27/561 [00:01<00:24, 21.66it/s]  5%|█████▍                                                                                                | 30/561 [00:01<00:24, 21.88it/s]  6%|██████                                                                                                | 33/561 [00:01<00:23, 22.58it/s]  6%|██████▌                                                                                               | 36/561 [00:01<00:22, 22.83it/s]  7%|███████                                                                                               | 39/561 [00:02<00:22, 23.21it/s]  7%|███████▋                                                                                              | 42/561 [00:02<00:22, 23.27it/s]  8%|████████▏                                                                                             | 45/561 [00:02<00:22, 23.28it/s]  9%|████████▋                                                                                             | 48/561 [00:02<00:23, 21.91it/s]  9%|█████████▎                                                                                            | 51/561 [00:02<00:23, 21.88it/s][2025-03-28 01:40:06,404] [INFO] [logging.py:128:log_dist] [Rank 0] step=10150, skipped=22, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:40:06,405] [INFO] [timer.py:264:stop] epoch=0/micro_step=10150/global_step=10150, RunningAvgSamplesPerSec=20.490553652051894, CurrSamplesPerSec=18.698427495600985, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 10%|█████████▊                                                                                            | 54/561 [00:02<00:24, 20.87it/s] 10%|██████████▎                                                                                           | 57/561 [00:02<00:23, 21.16it/s] 11%|██████████▉                                                                                           | 60/561 [00:03<00:23, 21.27it/s] 11%|███████████▍                                                                                          | 63/561 [00:03<00:22, 21.69it/s] 12%|████████████                                                                                          | 66/561 [00:03<00:22, 22.06it/s] 12%|████████████▌                                                                                         | 69/561 [00:03<00:21, 22.50it/s] 13%|█████████████                                                                                         | 72/561 [00:03<00:21, 22.35it/s] 13%|█████████████▋                                                                                        | 75/561 [00:03<00:21, 22.27it/s] 14%|██████████████▏                                                                                       | 78/561 [00:03<00:21, 22.21it/s] 14%|██████████████▋                                                                                       | 81/561 [00:03<00:21, 22.21it/s] 15%|███████████████▎                                                                                      | 84/561 [00:04<00:22, 21.46it/s] 16%|███████████████▊                                                                                      | 87/561 [00:04<00:22, 21.51it/s] 16%|████████████████▎                                                                                     | 90/561 [00:04<00:21, 21.61it/s] 17%|████████████████▉                                                                                     | 93/561 [00:04<00:21, 21.53it/s] 17%|█████████████████▍                                                                                    | 96/561 [00:04<00:21, 21.50it/s] 18%|██████████████████                                                                                    | 99/561 [00:04<00:21, 21.84it/s][2025-03-28 01:40:08,692] [INFO] [logging.py:128:log_dist] [Rank 0] step=10200, skipped=22, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:40:08,693] [INFO] [timer.py:264:stop] epoch=0/micro_step=10200/global_step=10200, RunningAvgSamplesPerSec=20.4970769260313, CurrSamplesPerSec=21.937976229612932, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 18%|██████████████████▎                                                                                  | 102/561 [00:04<00:20, 22.00it/s] 19%|██████████████████▉                                                                                  | 105/561 [00:05<00:20, 21.76it/s] 19%|███████████████████▍                                                                                 | 108/561 [00:05<00:20, 21.71it/s] 20%|███████████████████▉                                                                                 | 111/561 [00:05<00:20, 21.76it/s] 20%|████████████████████▌                                                                                | 114/561 [00:05<00:20, 21.82it/s] 21%|█████████████████████                                                                                | 117/561 [00:05<00:20, 21.96it/s] 21%|█████████████████████▌                                                                               | 120/561 [00:05<00:19, 22.05it/s] 22%|██████████████████████▏                                                                              | 123/561 [00:05<00:19, 22.05it/s] 22%|██████████████████████▋                                                                              | 126/561 [00:06<00:20, 21.26it/s] 23%|███████████████████████▏                                                                             | 129/561 [00:06<00:20, 21.27it/s] 24%|███████████████████████▊                                                                             | 132/561 [00:06<00:19, 21.53it/s] 24%|████████████████████████▎                                                                            | 135/561 [00:06<00:19, 21.94it/s] 25%|████████████████████████▊                                                                            | 138/561 [00:06<00:19, 21.98it/s] 25%|█████████████████████████▍                                                                           | 141/561 [00:06<00:19, 21.91it/s] 26%|█████████████████████████▉                                                                           | 144/561 [00:06<00:18, 22.33it/s] 26%|██████████████████████████▍                                                                          | 147/561 [00:06<00:19, 21.61it/s] 27%|███████████████████████████                                                                          | 150/561 [00:07<00:19, 21.54it/s][2025-03-28 01:40:10,995] [INFO] [logging.py:128:log_dist] [Rank 0] step=10250, skipped=22, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:40:10,995] [INFO] [timer.py:264:stop] epoch=0/micro_step=10250/global_step=10250, RunningAvgSamplesPerSec=20.502935707881814, CurrSamplesPerSec=21.290213816971537, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 27%|███████████████████████████▌                                                                         | 153/561 [00:07<00:19, 20.82it/s] 28%|████████████████████████████                                                                         | 156/561 [00:07<00:19, 20.88it/s] 28%|████████████████████████████▋                                                                        | 159/561 [00:07<00:18, 22.11it/s] 29%|█████████████████████████████▏                                                                       | 162/561 [00:07<00:16, 23.98it/s] 29%|█████████████████████████████▋                                                                       | 165/561 [00:07<00:16, 23.34it/s] 30%|██████████████████████████████▏                                                                      | 168/561 [00:07<00:17, 22.95it/s] 30%|██████████████████████████████▊                                                                      | 171/561 [00:08<00:17, 22.62it/s] 31%|███████████████████████████████▎                                                                     | 174/561 [00:08<00:18, 21.39it/s] 32%|███████████████████████████████▊                                                                     | 177/561 [00:08<00:17, 21.51it/s] 32%|████████████████████████████████▍                                                                    | 180/561 [00:08<00:17, 21.26it/s] 33%|████████████████████████████████▉                                                                    | 183/561 [00:08<00:18, 20.59it/s] 33%|█████████████████████████████████▍                                                                   | 186/561 [00:08<00:18, 20.78it/s] 34%|██████████████████████████████████                                                                   | 189/561 [00:08<00:17, 21.06it/s] 34%|██████████████████████████████████▌                                                                  | 192/561 [00:09<00:17, 21.41it/s] 35%|███████████████████████████████████                                                                  | 195/561 [00:09<00:16, 21.55it/s] 35%|███████████████████████████████████▋                                                                 | 198/561 [00:09<00:16, 21.54it/s] 36%|████████████████████████████████████▏                                                                | 201/561 [00:09<00:16, 21.60it/s][2025-03-28 01:40:13,302] [INFO] [logging.py:128:log_dist] [Rank 0] step=10300, skipped=22, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:40:13,303] [INFO] [timer.py:264:stop] epoch=0/micro_step=10300/global_step=10300, RunningAvgSamplesPerSec=20.508560145642015, CurrSamplesPerSec=20.88004511700608, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 36%|████████████████████████████████████▋                                                                | 204/561 [00:09<00:16, 21.53it/s] 37%|█████████████████████████████████████▎                                                               | 207/561 [00:09<00:16, 21.63it/s] 37%|█████████████████████████████████████▊                                                               | 210/561 [00:09<00:16, 21.77it/s] 38%|██████████████████████████████████████▎                                                              | 213/561 [00:10<00:15, 22.03it/s] 39%|██████████████████████████████████████▉                                                              | 216/561 [00:10<00:15, 22.07it/s] 39%|███████████████████████████████████████▍                                                             | 219/561 [00:10<00:15, 22.14it/s] 40%|███████████████████████████████████████▉                                                             | 222/561 [00:10<00:15, 22.10it/s] 40%|████████████████████████████████████████▌                                                            | 225/561 [00:10<00:15, 22.08it/s] 41%|█████████████████████████████████████████                                                            | 228/561 [00:10<00:15, 21.96it/s] 41%|█████████████████████████████████████████▌                                                           | 231/561 [00:10<00:14, 22.01it/s] 42%|██████████████████████████████████████████▏                                                          | 234/561 [00:10<00:14, 22.11it/s] 42%|██████████████████████████████████████████▋                                                          | 237/561 [00:11<00:14, 22.10it/s] 43%|███████████████████████████████████████████▏                                                         | 240/561 [00:11<00:14, 21.99it/s] 43%|███████████████████████████████████████████▋                                                         | 243/561 [00:11<00:14, 21.87it/s] 44%|████████████████████████████████████████████▎                                                        | 246/561 [00:11<00:14, 21.92it/s] 44%|████████████████████████████████████████████▊                                                        | 249/561 [00:11<00:14, 21.99it/s][2025-03-28 01:40:15,570] [INFO] [logging.py:128:log_dist] [Rank 0] step=10350, skipped=22, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:40:15,571] [INFO] [timer.py:264:stop] epoch=0/micro_step=10350/global_step=10350, RunningAvgSamplesPerSec=20.515728126964834, CurrSamplesPerSec=22.247385971696367, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 45%|█████████████████████████████████████████████▎                                                       | 252/561 [00:11<00:14, 22.01it/s] 45%|█████████████████████████████████████████████▉                                                       | 255/561 [00:11<00:13, 22.08it/s] 46%|██████████████████████████████████████████████▍                                                      | 258/561 [00:12<00:13, 22.10it/s] 47%|██████████████████████████████████████████████▉                                                      | 261/561 [00:12<00:13, 22.48it/s] 47%|███████████████████████████████████████████████▌                                                     | 264/561 [00:12<00:13, 22.46it/s] 48%|████████████████████████████████████████████████                                                     | 267/561 [00:12<00:12, 22.94it/s] 48%|████████████████████████████████████████████████▌                                                    | 270/561 [00:12<00:12, 22.96it/s] 49%|█████████████████████████████████████████████████▏                                                   | 273/561 [00:12<00:12, 23.36it/s] 49%|█████████████████████████████████████████████████▋                                                   | 276/561 [00:12<00:13, 21.31it/s] 50%|██████████████████████████████████████████████████▏                                                  | 279/561 [00:13<00:13, 20.87it/s] 50%|██████████████████████████████████████████████████▊                                                  | 282/561 [00:13<00:13, 21.10it/s] 51%|███████████████████████████████████████████████████▎                                                 | 285/561 [00:13<00:12, 21.33it/s] 51%|███████████████████████████████████████████████████▊                                                 | 288/561 [00:13<00:12, 21.54it/s] 52%|████████████████████████████████████████████████████▍                                                | 291/561 [00:13<00:12, 21.48it/s] 52%|████████████████████████████████████████████████████▉                                                | 294/561 [00:13<00:12, 21.79it/s] 53%|█████████████████████████████████████████████████████▍                                               | 297/561 [00:13<00:12, 21.77it/s] 53%|██████████████████████████████████████████████████████                                               | 300/561 [00:13<00:11, 21.85it/s][2025-03-28 01:40:17,851] [INFO] [logging.py:128:log_dist] [Rank 0] step=10400, skipped=22, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:40:17,852] [INFO] [timer.py:264:stop] epoch=0/micro_step=10400/global_step=10400, RunningAvgSamplesPerSec=20.522295420324248, CurrSamplesPerSec=22.524687976215045, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 54%|██████████████████████████████████████████████████████▌                                              | 303/561 [00:14<00:11, 21.92it/s] 55%|███████████████████████████████████████████████████████                                              | 306/561 [00:14<00:11, 22.02it/s] 55%|███████████████████████████████████████████████████████▋                                             | 309/561 [00:14<00:11, 21.10it/s] 56%|████████████████████████████████████████████████████████▏                                            | 312/561 [00:14<00:11, 21.28it/s] 56%|████████████████████████████████████████████████████████▋                                            | 315/561 [00:14<00:11, 22.05it/s] 57%|█████████████████████████████████████████████████████████▎                                           | 318/561 [00:14<00:10, 22.41it/s] 57%|█████████████████████████████████████████████████████████▊                                           | 321/561 [00:14<00:10, 22.76it/s] 58%|██████████████████████████████████████████████████████████▎                                          | 324/561 [00:15<00:10, 23.17it/s] 58%|██████████████████████████████████████████████████████████▊                                          | 327/561 [00:15<00:10, 23.00it/s] 59%|███████████████████████████████████████████████████████████▍                                         | 330/561 [00:15<00:10, 22.75it/s] 59%|███████████████████████████████████████████████████████████▉                                         | 333/561 [00:15<00:10, 22.63it/s] 60%|████████████████████████████████████████████████████████████▍                                        | 336/561 [00:15<00:10, 21.49it/s] 60%|█████████████████████████████████████████████████████████████                                        | 339/561 [00:15<00:10, 21.44it/s] 61%|█████████████████████████████████████████████████████████████▌                                       | 342/561 [00:15<00:10, 21.51it/s] 61%|██████████████████████████████████████████████████████████████                                       | 345/561 [00:16<00:10, 21.59it/s] 62%|██████████████████████████████████████████████████████████████▋                                      | 348/561 [00:16<00:09, 21.93it/s] 63%|███████████████████████████████████████████████████████████████▏                                     | 351/561 [00:16<00:09, 21.02it/s][2025-03-28 01:40:20,140] [INFO] [logging.py:128:log_dist] [Rank 0] step=10450, skipped=22, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:40:20,141] [INFO] [timer.py:264:stop] epoch=0/micro_step=10450/global_step=10450, RunningAvgSamplesPerSec=20.528479726304976, CurrSamplesPerSec=21.175632524990398, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 63%|███████████████████████████████████████████████████████████████▋                                     | 354/561 [00:16<00:09, 21.38it/s] 64%|████████████████████████████████████████████████████████████████▎                                    | 357/561 [00:16<00:09, 21.60it/s] 64%|████████████████████████████████████████████████████████████████▊                                    | 360/561 [00:16<00:09, 21.69it/s] 65%|█████████████████████████████████████████████████████████████████▎                                   | 363/561 [00:16<00:09, 21.80it/s] 65%|█████████████████████████████████████████████████████████████████▉                                   | 366/561 [00:16<00:08, 22.00it/s] 66%|██████████████████████████████████████████████████████████████████▍                                  | 369/561 [00:17<00:08, 22.26it/s] 66%|██████████████████████████████████████████████████████████████████▉                                  | 372/561 [00:17<00:08, 22.49it/s] 67%|███████████████████████████████████████████████████████████████████▌                                 | 375/561 [00:17<00:08, 22.13it/s] 67%|████████████████████████████████████████████████████████████████████                                 | 378/561 [00:17<00:08, 21.76it/s] 68%|████████████████████████████████████████████████████████████████████▌                                | 381/561 [00:17<00:08, 21.68it/s] 68%|█████████████████████████████████████████████████████████████████████▏                               | 384/561 [00:17<00:08, 22.05it/s] 69%|█████████████████████████████████████████████████████████████████████▋                               | 387/561 [00:17<00:07, 22.71it/s] 70%|██████████████████████████████████████████████████████████████████████▏                              | 390/561 [00:18<00:07, 23.04it/s] 70%|██████████████████████████████████████████████████████████████████████▊                              | 393/561 [00:18<00:07, 22.77it/s] 71%|███████████████████████████████████████████████████████████████████████▎                             | 396/561 [00:18<00:07, 22.40it/s] 71%|███████████████████████████████████████████████████████████████████████▊                             | 399/561 [00:18<00:07, 22.16it/s][2025-03-28 01:40:22,383] [INFO] [logging.py:128:log_dist] [Rank 0] step=10500, skipped=22, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:40:22,384] [INFO] [timer.py:264:stop] epoch=0/micro_step=10500/global_step=10500, RunningAvgSamplesPerSec=20.536469305376237, CurrSamplesPerSec=22.516707152939112, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 72%|████████████████████████████████████████████████████████████████████████▎                            | 402/561 [00:18<00:07, 22.08it/s] 72%|████████████████████████████████████████████████████████████████████████▉                            | 405/561 [00:18<00:06, 22.70it/s] 73%|█████████████████████████████████████████████████████████████████████████▍                           | 408/561 [00:18<00:06, 22.87it/s] 73%|█████████████████████████████████████████████████████████████████████████▉                           | 411/561 [00:18<00:06, 23.22it/s] 74%|██████████████████████████████████████████████████████████████████████████▌                          | 414/561 [00:19<00:06, 22.09it/s] 74%|███████████████████████████████████████████████████████████████████████████                          | 417/561 [00:19<00:06, 21.98it/s] 75%|███████████████████████████████████████████████████████████████████████████▌                         | 420/561 [00:19<00:06, 21.96it/s] 75%|████████████████████████████████████████████████████████████████████████████▏                        | 423/561 [00:19<00:06, 21.98it/s] 76%|████████████████████████████████████████████████████████████████████████████▋                        | 426/561 [00:19<00:06, 22.35it/s] 76%|█████████████████████████████████████████████████████████████████████████████▏                       | 429/561 [00:19<00:05, 22.99it/s] 77%|█████████████████████████████████████████████████████████████████████████████▊                       | 432/561 [00:19<00:05, 22.26it/s] 78%|██████████████████████████████████████████████████████████████████████████████▎                      | 435/561 [00:20<00:05, 22.30it/s] 78%|██████████████████████████████████████████████████████████████████████████████▊                      | 438/561 [00:20<00:05, 22.05it/s] 79%|███████████████████████████████████████████████████████████████████████████████▍                     | 441/561 [00:20<00:05, 22.11it/s] 79%|███████████████████████████████████████████████████████████████████████████████▉                     | 444/561 [00:20<00:05, 22.08it/s] 80%|████████████████████████████████████████████████████████████████████████████████▍                    | 447/561 [00:20<00:05, 21.79it/s] 80%|█████████████████████████████████████████████████████████████████████████████████                    | 450/561 [00:20<00:05, 21.87it/s][2025-03-28 01:40:24,634] [INFO] [logging.py:128:log_dist] [Rank 0] step=10550, skipped=22, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:40:24,634] [INFO] [timer.py:264:stop] epoch=0/micro_step=10550/global_step=10550, RunningAvgSamplesPerSec=20.544077151454445, CurrSamplesPerSec=22.39755026575242, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 81%|█████████████████████████████████████████████████████████████████████████████████▌                   | 453/561 [00:20<00:04, 21.87it/s] 81%|██████████████████████████████████████████████████████████████████████████████████                   | 456/561 [00:21<00:04, 21.78it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▋                  | 459/561 [00:21<00:04, 21.80it/s] 82%|███████████████████████████████████████████████████████████████████████████████████▏                 | 462/561 [00:21<00:04, 21.67it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▋                 | 465/561 [00:21<00:04, 21.69it/s] 83%|████████████████████████████████████████████████████████████████████████████████████▎                | 468/561 [00:21<00:04, 21.91it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▊                | 471/561 [00:21<00:04, 21.89it/s] 84%|█████████████████████████████████████████████████████████████████████████████████████▎               | 474/561 [00:21<00:03, 22.19it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▉               | 477/561 [00:21<00:03, 22.26it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▍              | 480/561 [00:22<00:03, 21.91it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▉              | 483/561 [00:22<00:03, 22.01it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▍             | 486/561 [00:22<00:03, 21.09it/s] 87%|████████████████████████████████████████████████████████████████████████████████████████             | 489/561 [00:22<00:03, 21.15it/s] 88%|████████████████████████████████████████████████████████████████████████████████████████▌            | 492/561 [00:22<00:03, 21.58it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████████            | 495/561 [00:22<00:03, 21.72it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▋           | 498/561 [00:22<00:02, 21.88it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████▏          | 501/561 [00:23<00:02, 21.84it/s][2025-03-28 01:40:26,931] [INFO] [logging.py:128:log_dist] [Rank 0] step=10600, skipped=22, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:40:26,932] [INFO] [timer.py:264:stop] epoch=0/micro_step=10600/global_step=10600, RunningAvgSamplesPerSec=20.54976773956478, CurrSamplesPerSec=21.303839194325626, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 90%|██████████████████████████████████████████████████████████████████████████████████████████▋          | 504/561 [00:23<00:02, 21.78it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████████▎         | 507/561 [00:23<00:02, 21.75it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▊         | 510/561 [00:23<00:02, 21.89it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████████▎        | 513/561 [00:23<00:02, 22.02it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████████▉        | 516/561 [00:23<00:02, 21.93it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▍       | 519/561 [00:23<00:01, 21.78it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▉       | 522/561 [00:24<00:01, 21.85it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▌      | 525/561 [00:24<00:01, 22.07it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████      | 528/561 [00:24<00:01, 22.13it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▌     | 531/561 [00:24<00:01, 22.10it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████████▏    | 534/561 [00:24<00:01, 22.13it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▋    | 537/561 [00:24<00:01, 22.17it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████▏   | 540/561 [00:24<00:00, 22.22it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████████▊   | 543/561 [00:25<00:00, 22.19it/s] 97%|██████████████████████████████████████████████████████████████████████████████████████████████████▎  | 546/561 [00:25<00:00, 22.15it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▊  | 549/561 [00:25<00:00, 22.13it/s][2025-03-28 01:40:29,211] [INFO] [logging.py:128:log_dist] [Rank 0] step=10650, skipped=22, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:40:29,212] [INFO] [timer.py:264:stop] epoch=0/micro_step=10650/global_step=10650, RunningAvgSamplesPerSec=20.556082518256492, CurrSamplesPerSec=19.262971985393023, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 98%|███████████████████████████████████████████████████████████████████████████████████████████████████▍ | 552/561 [00:25<00:00, 21.36it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▉ | 555/561 [00:25<00:00, 21.47it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████▍| 558/561 [00:25<00:00, 22.08it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:25<00:00, 22.00it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:25<00:00, 21.66it/s]
  0%|                                                                                                               | 0/561 [00:00<?, ?it/s]  0%|▏                                                                                                      | 1/561 [00:00<01:46,  5.26it/s]  1%|▌                                                                                                      | 3/561 [00:00<00:50, 11.00it/s]  1%|█                                                                                                      | 6/561 [00:00<00:35, 15.75it/s]  2%|█▋                                                                                                     | 9/561 [00:00<00:29, 18.56it/s]  2%|██▏                                                                                                   | 12/561 [00:00<00:27, 19.90it/s]  3%|██▋                                                                                                   | 15/561 [00:00<00:25, 21.14it/s]  3%|███▎                                                                                                  | 18/561 [00:00<00:24, 22.09it/s]  4%|███▊                                                                                                  | 21/561 [00:01<00:24, 21.85it/s]  4%|████▎                                                                                                 | 24/561 [00:01<00:25, 21.41it/s]  5%|████▉                                                                                                 | 27/561 [00:01<00:24, 21.41it/s]  5%|█████▍                                                                                                | 30/561 [00:01<00:24, 21.64it/s]  6%|██████                                                                                                | 33/561 [00:01<00:24, 21.70it/s]  6%|██████▌                                                                                               | 36/561 [00:01<00:24, 21.87it/s]  7%|███████                                                                                               | 39/561 [00:01<00:23, 22.54it/s][2025-03-28 01:40:31,696] [INFO] [logging.py:128:log_dist] [Rank 0] step=10700, skipped=22, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:40:31,697] [INFO] [timer.py:264:stop] epoch=0/micro_step=10700/global_step=10700, RunningAvgSamplesPerSec=20.559839294908112, CurrSamplesPerSec=22.932451662308566, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
  7%|███████▋                                                                                              | 42/561 [00:02<00:22, 22.79it/s]  8%|████████▏                                                                                             | 45/561 [00:02<00:22, 23.23it/s]  9%|████████▋                                                                                             | 48/561 [00:02<00:22, 23.30it/s]  9%|█████████▎                                                                                            | 51/561 [00:02<00:22, 23.05it/s] 10%|█████████▊                                                                                            | 54/561 [00:02<00:22, 22.70it/s] 10%|██████████▎                                                                                           | 57/561 [00:02<00:22, 22.40it/s] 11%|██████████▉                                                                                           | 60/561 [00:02<00:22, 22.25it/s] 11%|███████████▍                                                                                          | 63/561 [00:02<00:22, 22.14it/s] 12%|████████████                                                                                          | 66/561 [00:03<00:23, 21.00it/s] 12%|████████████▌                                                                                         | 69/561 [00:03<00:23, 21.28it/s] 13%|█████████████                                                                                         | 72/561 [00:03<00:23, 20.57it/s] 13%|█████████████▋                                                                                        | 75/561 [00:03<00:23, 20.99it/s] 14%|██████████████▏                                                                                       | 78/561 [00:03<00:22, 21.74it/s] 14%|██████████████▋                                                                                       | 81/561 [00:03<00:21, 22.46it/s] 15%|███████████████▎                                                                                      | 84/561 [00:03<00:20, 22.85it/s] 16%|███████████████▊                                                                                      | 87/561 [00:04<00:20, 23.08it/s] 16%|████████████████▎                                                                                     | 90/561 [00:04<00:20, 23.27it/s][2025-03-28 01:40:33,934] [INFO] [logging.py:128:log_dist] [Rank 0] step=10750, skipped=22, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:40:33,935] [INFO] [timer.py:264:stop] epoch=0/micro_step=10750/global_step=10750, RunningAvgSamplesPerSec=20.567726032303664, CurrSamplesPerSec=24.114869857898736, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 17%|████████████████▉                                                                                     | 93/561 [00:04<00:19, 23.44it/s] 17%|█████████████████▍                                                                                    | 96/561 [00:04<00:19, 23.55it/s] 18%|██████████████████                                                                                    | 99/561 [00:04<00:19, 23.69it/s] 18%|██████████████████▎                                                                                  | 102/561 [00:04<00:19, 23.71it/s] 19%|██████████████████▉                                                                                  | 105/561 [00:04<00:19, 23.87it/s] 19%|███████████████████▍                                                                                 | 108/561 [00:04<00:19, 23.28it/s] 20%|███████████████████▉                                                                                 | 111/561 [00:05<00:19, 23.01it/s] 20%|████████████████████▌                                                                                | 114/561 [00:05<00:20, 21.66it/s] 21%|█████████████████████                                                                                | 117/561 [00:05<00:20, 22.14it/s] 21%|█████████████████████▌                                                                               | 120/561 [00:05<00:19, 22.70it/s] 22%|██████████████████████▏                                                                              | 123/561 [00:05<00:19, 23.03it/s] 22%|██████████████████████▋                                                                              | 126/561 [00:05<00:19, 22.76it/s] 23%|███████████████████████▏                                                                             | 129/561 [00:05<00:19, 22.55it/s] 24%|███████████████████████▊                                                                             | 132/561 [00:06<00:18, 22.59it/s] 24%|████████████████████████▎                                                                            | 135/561 [00:06<00:18, 22.42it/s] 25%|████████████████████████▊                                                                            | 138/561 [00:06<00:18, 22.44it/s][2025-03-28 01:40:36,139] [INFO] [logging.py:128:log_dist] [Rank 0] step=10800, skipped=22, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:40:36,140] [INFO] [timer.py:264:stop] epoch=0/micro_step=10800/global_step=10800, RunningAvgSamplesPerSec=20.57681156261157, CurrSamplesPerSec=22.28248856695341, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 25%|█████████████████████████▍                                                                           | 141/561 [00:06<00:19, 22.08it/s] 26%|█████████████████████████▉                                                                           | 144/561 [00:06<00:18, 22.10it/s] 26%|██████████████████████████▍                                                                          | 147/561 [00:06<00:18, 22.00it/s] 27%|███████████████████████████                                                                          | 150/561 [00:06<00:18, 22.19it/s] 27%|███████████████████████████▌                                                                         | 153/561 [00:06<00:18, 22.07it/s] 28%|████████████████████████████                                                                         | 156/561 [00:07<00:18, 22.09it/s] 28%|████████████████████████████▋                                                                        | 159/561 [00:07<00:18, 21.92it/s] 29%|█████████████████████████████▏                                                                       | 162/561 [00:07<00:18, 22.02it/s] 29%|█████████████████████████████▋                                                                       | 165/561 [00:07<00:18, 21.76it/s] 30%|██████████████████████████████▏                                                                      | 168/561 [00:07<00:17, 21.88it/s] 30%|██████████████████████████████▊                                                                      | 171/561 [00:07<00:17, 22.16it/s] 31%|███████████████████████████████▎                                                                     | 174/561 [00:07<00:17, 22.50it/s] 32%|███████████████████████████████▊                                                                     | 177/561 [00:08<00:17, 21.45it/s] 32%|████████████████████████████████▍                                                                    | 180/561 [00:08<00:17, 21.53it/s] 33%|████████████████████████████████▉                                                                    | 183/561 [00:08<00:17, 21.75it/s] 33%|█████████████████████████████████▍                                                                   | 186/561 [00:08<00:17, 21.97it/s] 34%|██████████████████████████████████                                                                   | 189/561 [00:08<00:16, 21.91it/s][2025-03-28 01:40:38,417] [INFO] [logging.py:128:log_dist] [Rank 0] step=10850, skipped=22, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:40:38,418] [INFO] [timer.py:264:stop] epoch=0/micro_step=10850/global_step=10850, RunningAvgSamplesPerSec=20.58296342867871, CurrSamplesPerSec=22.47652636929296, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 34%|██████████████████████████████████▌                                                                  | 192/561 [00:08<00:16, 21.93it/s] 35%|███████████████████████████████████                                                                  | 195/561 [00:08<00:16, 21.78it/s] 35%|███████████████████████████████████▋                                                                 | 198/561 [00:09<00:16, 21.63it/s] 36%|████████████████████████████████████▏                                                                | 201/561 [00:09<00:16, 21.78it/s] 36%|████████████████████████████████████▋                                                                | 204/561 [00:09<00:16, 21.51it/s] 37%|█████████████████████████████████████▎                                                               | 207/561 [00:09<00:16, 21.75it/s] 37%|█████████████████████████████████████▊                                                               | 210/561 [00:09<00:16, 21.30it/s] 38%|██████████████████████████████████████▎                                                              | 213/561 [00:09<00:16, 20.85it/s] 39%|██████████████████████████████████████▉                                                              | 216/561 [00:09<00:16, 20.51it/s] 39%|███████████████████████████████████████▍                                                             | 219/561 [00:10<00:16, 20.76it/s] 40%|███████████████████████████████████████▉                                                             | 222/561 [00:10<00:16, 20.99it/s] 40%|████████████████████████████████████████▌                                                            | 225/561 [00:10<00:15, 21.24it/s] 41%|█████████████████████████████████████████                                                            | 228/561 [00:10<00:15, 20.84it/s] 41%|█████████████████████████████████████████▌                                                           | 231/561 [00:10<00:15, 20.69it/s] 42%|██████████████████████████████████████████▏                                                          | 234/561 [00:10<00:15, 20.95it/s] 42%|██████████████████████████████████████████▋                                                          | 237/561 [00:10<00:15, 21.13it/s] 43%|███████████████████████████████████████████▏                                                         | 240/561 [00:11<00:14, 22.21it/s][2025-03-28 01:40:40,768] [INFO] [logging.py:128:log_dist] [Rank 0] step=10900, skipped=22, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:40:40,769] [INFO] [timer.py:264:stop] epoch=0/micro_step=10900/global_step=10900, RunningAvgSamplesPerSec=20.586276454441805, CurrSamplesPerSec=21.425833994221218, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 43%|███████████████████████████████████████████▋                                                         | 243/561 [00:11<00:14, 22.04it/s] 44%|████████████████████████████████████████████▎                                                        | 246/561 [00:11<00:14, 22.15it/s] 44%|████████████████████████████████████████████▊                                                        | 249/561 [00:11<00:13, 22.73it/s] 45%|█████████████████████████████████████████████▎                                                       | 252/561 [00:11<00:13, 22.51it/s] 45%|█████████████████████████████████████████████▉                                                       | 255/561 [00:11<00:13, 22.30it/s] 46%|██████████████████████████████████████████████▍                                                      | 258/561 [00:11<00:14, 21.37it/s] 47%|██████████████████████████████████████████████▉                                                      | 261/561 [00:11<00:14, 21.06it/s] 47%|███████████████████████████████████████████████▌                                                     | 264/561 [00:12<00:13, 21.30it/s] 48%|████████████████████████████████████████████████                                                     | 267/561 [00:12<00:14, 20.45it/s] 48%|████████████████████████████████████████████████▌                                                    | 270/561 [00:12<00:14, 20.52it/s] 49%|█████████████████████████████████████████████████▏                                                   | 273/561 [00:12<00:14, 20.30it/s] 49%|█████████████████████████████████████████████████▋                                                   | 276/561 [00:12<00:14, 20.32it/s] 50%|██████████████████████████████████████████████████▏                                                  | 279/561 [00:12<00:13, 20.87it/s] 50%|██████████████████████████████████████████████████▊                                                  | 282/561 [00:13<00:13, 21.13it/s] 51%|███████████████████████████████████████████████████▎                                                 | 285/561 [00:13<00:13, 21.05it/s] 51%|███████████████████████████████████████████████████▊                                                 | 288/561 [00:13<00:12, 21.48it/s][2025-03-28 01:40:43,120] [INFO] [logging.py:128:log_dist] [Rank 0] step=10950, skipped=22, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:40:43,121] [INFO] [timer.py:264:stop] epoch=0/micro_step=10950/global_step=10950, RunningAvgSamplesPerSec=20.589495664984153, CurrSamplesPerSec=22.024026846197202, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 52%|████████████████████████████████████████████████████▍                                                | 291/561 [00:13<00:12, 21.57it/s] 52%|████████████████████████████████████████████████████▉                                                | 294/561 [00:13<00:12, 21.48it/s] 53%|█████████████████████████████████████████████████████▍                                               | 297/561 [00:13<00:11, 22.07it/s] 53%|██████████████████████████████████████████████████████                                               | 300/561 [00:13<00:12, 21.48it/s] 54%|██████████████████████████████████████████████████████▌                                              | 303/561 [00:13<00:11, 21.51it/s] 55%|███████████████████████████████████████████████████████                                              | 306/561 [00:14<00:11, 21.60it/s] 55%|███████████████████████████████████████████████████████▋                                             | 309/561 [00:14<00:11, 21.98it/s] 56%|████████████████████████████████████████████████████████▏                                            | 312/561 [00:14<00:11, 21.80it/s] 56%|████████████████████████████████████████████████████████▋                                            | 315/561 [00:14<00:11, 21.85it/s] 57%|█████████████████████████████████████████████████████████▎                                           | 318/561 [00:14<00:10, 22.17it/s] 57%|█████████████████████████████████████████████████████████▊                                           | 321/561 [00:14<00:10, 22.30it/s] 58%|██████████████████████████████████████████████████████████▎                                          | 324/561 [00:14<00:10, 22.31it/s] 58%|██████████████████████████████████████████████████████████▊                                          | 327/561 [00:15<00:11, 20.35it/s] 59%|███████████████████████████████████████████████████████████▍                                         | 330/561 [00:15<00:11, 20.46it/s] 59%|███████████████████████████████████████████████████████████▉                                         | 333/561 [00:15<00:10, 20.85it/s] 60%|████████████████████████████████████████████████████████████▍                                        | 336/561 [00:15<00:10, 20.63it/s] 60%|█████████████████████████████████████████████████████████████                                        | 339/561 [00:15<00:10, 21.09it/s][2025-03-28 01:40:45,451] [INFO] [logging.py:128:log_dist] [Rank 0] step=11000, skipped=22, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:40:45,452] [INFO] [timer.py:264:stop] epoch=0/micro_step=11000/global_step=11000, RunningAvgSamplesPerSec=20.593513927563993, CurrSamplesPerSec=22.643738056638345, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 61%|█████████████████████████████████████████████████████████████▌                                       | 342/561 [00:15<00:10, 21.50it/s] 61%|██████████████████████████████████████████████████████████████                                       | 345/561 [00:15<00:09, 21.85it/s] 62%|██████████████████████████████████████████████████████████████▋                                      | 348/561 [00:16<00:09, 22.10it/s] 63%|███████████████████████████████████████████████████████████████▏                                     | 351/561 [00:16<00:09, 22.24it/s] 63%|███████████████████████████████████████████████████████████████▋                                     | 354/561 [00:16<00:09, 22.14it/s] 64%|████████████████████████████████████████████████████████████████▎                                    | 357/561 [00:16<00:09, 22.12it/s] 64%|████████████████████████████████████████████████████████████████▊                                    | 360/561 [00:16<00:09, 22.08it/s] 65%|█████████████████████████████████████████████████████████████████▎                                   | 363/561 [00:16<00:09, 21.93it/s][2025-03-28 01:40:46,482] [INFO] [loss_scaler.py:190:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, but hysteresis is 2. Reducing hysteresis to 1
[2025-03-28 01:40:46,523] [INFO] [loss_scaler.py:183:update_scale] [deepspeed] OVERFLOW! Rank 0 Skipping step. Attempted loss scale: 65536, reducing to 32768
 65%|█████████████████████████████████████████████████████████████████▉                                   | 366/561 [00:16<00:08, 22.41it/s] 66%|██████████████████████████████████████████████████████████████████▍                                  | 369/561 [00:16<00:08, 22.61it/s] 66%|██████████████████████████████████████████████████████████████████▉                                  | 372/561 [00:17<00:08, 22.26it/s] 67%|███████████████████████████████████████████████████████████████████▌                                 | 375/561 [00:17<00:08, 22.17it/s] 67%|████████████████████████████████████████████████████████████████████                                 | 378/561 [00:17<00:08, 22.08it/s] 68%|████████████████████████████████████████████████████████████████████▌                                | 381/561 [00:17<00:08, 22.08it/s] 68%|█████████████████████████████████████████████████████████████████████▏                               | 384/561 [00:17<00:08, 22.02it/s] 69%|█████████████████████████████████████████████████████████████████████▋                               | 387/561 [00:17<00:07, 21.96it/s] 70%|██████████████████████████████████████████████████████████████████████▏                              | 390/561 [00:17<00:07, 21.94it/s][2025-03-28 01:40:47,703] [INFO] [logging.py:128:log_dist] [Rank 0] step=11050, skipped=24, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:40:47,704] [INFO] [timer.py:264:stop] epoch=0/micro_step=11050/global_step=11050, RunningAvgSamplesPerSec=20.60048549117485, CurrSamplesPerSec=22.796097496777424, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 70%|██████████████████████████████████████████████████████████████████████▊                              | 393/561 [00:18<00:07, 22.02it/s] 71%|███████████████████████████████████████████████████████████████████████▎                             | 396/561 [00:18<00:07, 21.91it/s] 71%|███████████████████████████████████████████████████████████████████████▊                             | 399/561 [00:18<00:07, 21.65it/s] 72%|████████████████████████████████████████████████████████████████████████▎                            | 402/561 [00:18<00:07, 21.75it/s] 72%|████████████████████████████████████████████████████████████████████████▉                            | 405/561 [00:18<00:07, 21.88it/s] 73%|█████████████████████████████████████████████████████████████████████████▍                           | 408/561 [00:18<00:06, 21.92it/s] 73%|█████████████████████████████████████████████████████████████████████████▉                           | 411/561 [00:18<00:06, 21.81it/s] 74%|██████████████████████████████████████████████████████████████████████████▌                          | 414/561 [00:19<00:06, 21.89it/s] 74%|███████████████████████████████████████████████████████████████████████████                          | 417/561 [00:19<00:06, 21.92it/s] 75%|███████████████████████████████████████████████████████████████████████████▌                         | 420/561 [00:19<00:06, 21.93it/s] 75%|████████████████████████████████████████████████████████████████████████████▏                        | 423/561 [00:19<00:06, 21.85it/s] 76%|████████████████████████████████████████████████████████████████████████████▋                        | 426/561 [00:19<00:06, 21.95it/s] 76%|█████████████████████████████████████████████████████████████████████████████▏                       | 429/561 [00:19<00:06, 21.88it/s] 77%|█████████████████████████████████████████████████████████████████████████████▊                       | 432/561 [00:19<00:05, 22.00it/s] 78%|██████████████████████████████████████████████████████████████████████████████▎                      | 435/561 [00:20<00:05, 22.03it/s] 78%|██████████████████████████████████████████████████████████████████████████████▊                      | 438/561 [00:20<00:05, 22.05it/s][2025-03-28 01:40:49,986] [INFO] [logging.py:128:log_dist] [Rank 0] step=11100, skipped=24, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:40:49,987] [INFO] [timer.py:264:stop] epoch=0/micro_step=11100/global_step=11100, RunningAvgSamplesPerSec=20.60625412974388, CurrSamplesPerSec=21.835871770030515, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 79%|███████████████████████████████████████████████████████████████████████████████▍                     | 441/561 [00:20<00:05, 21.99it/s] 79%|███████████████████████████████████████████████████████████████████████████████▉                     | 444/561 [00:20<00:05, 22.16it/s] 80%|████████████████████████████████████████████████████████████████████████████████▍                    | 447/561 [00:20<00:05, 22.32it/s] 80%|█████████████████████████████████████████████████████████████████████████████████                    | 450/561 [00:20<00:04, 22.44it/s] 81%|█████████████████████████████████████████████████████████████████████████████████▌                   | 453/561 [00:20<00:04, 22.62it/s] 81%|██████████████████████████████████████████████████████████████████████████████████                   | 456/561 [00:20<00:04, 22.51it/s] 82%|██████████████████████████████████████████████████████████████████████████████████▋                  | 459/561 [00:21<00:04, 22.38it/s] 82%|███████████████████████████████████████████████████████████████████████████████████▏                 | 462/561 [00:21<00:04, 22.33it/s] 83%|███████████████████████████████████████████████████████████████████████████████████▋                 | 465/561 [00:21<00:04, 22.18it/s] 83%|████████████████████████████████████████████████████████████████████████████████████▎                | 468/561 [00:21<00:04, 22.39it/s] 84%|████████████████████████████████████████████████████████████████████████████████████▊                | 471/561 [00:21<00:04, 22.11it/s] 84%|█████████████████████████████████████████████████████████████████████████████████████▎               | 474/561 [00:21<00:04, 21.40it/s] 85%|█████████████████████████████████████████████████████████████████████████████████████▉               | 477/561 [00:21<00:03, 21.10it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▍              | 480/561 [00:22<00:03, 20.44it/s] 86%|██████████████████████████████████████████████████████████████████████████████████████▉              | 483/561 [00:22<00:03, 19.80it/s] 87%|███████████████████████████████████████████████████████████████████████████████████████▍             | 486/561 [00:22<00:03, 20.07it/s] 87%|████████████████████████████████████████████████████████████████████████████████████████             | 489/561 [00:22<00:03, 20.27it/s][2025-03-28 01:40:52,330] [INFO] [logging.py:128:log_dist] [Rank 0] step=11150, skipped=24, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:40:52,333] [INFO] [timer.py:264:stop] epoch=0/micro_step=11150/global_step=11150, RunningAvgSamplesPerSec=20.60952596123261, CurrSamplesPerSec=19.551386077684764, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 88%|████████████████████████████████████████████████████████████████████████████████████████▌            | 492/561 [00:22<00:03, 20.32it/s] 88%|█████████████████████████████████████████████████████████████████████████████████████████            | 495/561 [00:22<00:03, 20.00it/s] 89%|█████████████████████████████████████████████████████████████████████████████████████████▋           | 498/561 [00:22<00:03, 19.94it/s] 89%|██████████████████████████████████████████████████████████████████████████████████████████▏          | 501/561 [00:23<00:02, 20.04it/s] 90%|██████████████████████████████████████████████████████████████████████████████████████████▋          | 504/561 [00:23<00:02, 19.67it/s] 90%|███████████████████████████████████████████████████████████████████████████████████████████▎         | 507/561 [00:23<00:02, 19.58it/s] 91%|███████████████████████████████████████████████████████████████████████████████████████████▊         | 510/561 [00:23<00:02, 19.67it/s] 91%|████████████████████████████████████████████████████████████████████████████████████████████▏        | 512/561 [00:23<00:02, 19.46it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████████▌        | 514/561 [00:23<00:02, 19.20it/s] 92%|████████████████████████████████████████████████████████████████████████████████████████████▉        | 516/561 [00:23<00:02, 19.05it/s] 92%|█████████████████████████████████████████████████████████████████████████████████████████████▎       | 518/561 [00:24<00:02, 18.94it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▌       | 520/561 [00:24<00:02, 18.84it/s] 93%|█████████████████████████████████████████████████████████████████████████████████████████████▉       | 522/561 [00:24<00:02, 18.72it/s] 93%|██████████████████████████████████████████████████████████████████████████████████████████████▎      | 524/561 [00:24<00:01, 18.65it/s] 94%|██████████████████████████████████████████████████████████████████████████████████████████████▋      | 526/561 [00:24<00:01, 18.58it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████      | 528/561 [00:24<00:01, 18.36it/s] 94%|███████████████████████████████████████████████████████████████████████████████████████████████▍     | 530/561 [00:24<00:01, 18.40it/s] 95%|███████████████████████████████████████████████████████████████████████████████████████████████▊     | 532/561 [00:24<00:01, 18.43it/s] 95%|████████████████████████████████████████████████████████████████████████████████████████████████▏    | 534/561 [00:24<00:01, 18.63it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▍    | 536/561 [00:25<00:01, 18.59it/s] 96%|████████████████████████████████████████████████████████████████████████████████████████████████▊    | 538/561 [00:25<00:01, 18.58it/s] 96%|█████████████████████████████████████████████████████████████████████████████████████████████████▏   | 540/561 [00:25<00:01, 18.38it/s][2025-03-28 01:40:54,971] [INFO] [logging.py:128:log_dist] [Rank 0] step=11200, skipped=24, lr=[0.0002], mom=[(0.9, 0.999)]
[2025-03-28 01:40:54,974] [INFO] [timer.py:264:stop] epoch=0/micro_step=11200/global_step=11200, RunningAvgSamplesPerSec=20.60161321456578, CurrSamplesPerSec=20.22528833751525, MemAllocated=0.03GB, MaxMemAllocated=1.89GB
 97%|█████████████████████████████████████████████████████████████████████████████████████████████████▌   | 542/561 [00:25<00:01, 18.57it/s] 97%|█████████████████████████████████████████████████████████████████████████████████████████████████▉   | 544/561 [00:25<00:00, 18.54it/s] 98%|██████████████████████████████████████████████████████████████████████████████████████████████████▍  | 547/561 [00:25<00:00, 20.25it/s] 98%|███████████████████████████████████████████████████████████████████████████████████████████████████  | 550/561 [00:25<00:00, 21.13it/s] 99%|███████████████████████████████████████████████████████████████████████████████████████████████████▌ | 553/561 [00:25<00:00, 20.37it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████ | 556/561 [00:26<00:00, 19.57it/s] 99%|████████████████████████████████████████████████████████████████████████████████████████████████████▍| 558/561 [00:26<00:00, 19.19it/s]100%|████████████████████████████████████████████████████████████████████████████████████████████████████▊| 560/561 [00:26<00:00, 18.90it/s]100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 561/561 [00:26<00:00, 21.28it/s]
[rank0]: Traceback (most recent call last):
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/main.py", line 9, in <module>
[rank0]:     train_deepspeed(cfg)
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/train.py", line 209, in train_deepspeed
[rank0]:     generate_during_training(model_engine, sample_dir, config, epoch, num_images=config.num_images//config.image_size, p=p)
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/generate.py", line 233, in generate_during_training_simulation_dif
[rank0]:     pred_noise = model_engine(x, t_batch)
[rank0]:                  ^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/deepspeed/utils/nvtx.py", line 18, in wrapped_fn
[rank0]:     ret_val = func(*args, **kwargs)
[rank0]:               ^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/deepspeed/runtime/engine.py", line 1987, in forward
[rank0]:     loss = self.module(*inputs, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/diffusion_noise_agent/unet.py", line 216, in forward
[rank0]:     return self.final_conv(x)
[rank0]:            ^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
[rank0]:     input = module(input)
[rank0]:             ^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/hpc2hdd/home/yli045/.conda/envs/ywj/lib/python3.12/site-packages/torch/nn/modules/activation.py", line 734, in forward
[rank0]:     return F.gelu(input, approximate=self.approximate)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]: torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 2.00 MiB. GPU 0 has a total capacity of 47.33 GiB of which 1.69 MiB is free. Process 3785418 has 294.00 MiB memory in use. Process 3794194 has 4.08 GiB memory in use. Process 3794200 has 3.13 GiB memory in use. Process 3794201 has 32.75 GiB memory in use. Process 3794198 has 4.07 GiB memory in use. Process 2640766 has 2.96 GiB memory in use. Of the allocated memory 2.27 GiB is allocated by PyTorch, and 41.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
[rank0]:[W328 01:41:00.516817975 ProcessGroupNCCL.cpp:1496] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
[2025-03-28 01:41:02,112] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 584785
[2025-03-28 01:41:02,113] [ERROR] [launch.py:325:sigkill_handler] ['/hpc2hdd/home/yli045/.conda/envs/ywj/bin/python', '-u', 'main.py', '--local_rank=0', '--image_size', '16', '--batch_size', '1', '--num_epochs', '200', '--timesteps', '1000', '--lr', '2e-4', '--time_emb_dim', '256', '--mu1', '4', '--sigma1', '1', '--num1', '9000', '--mu2', '10', '--sigma2', '4', '--num2', '1000', '--samples_dir', './samples', '--checkpoints_dir', './checkpoints', '--fp16', '--mode', 'train', '--model_path', '', '--num_images', '1000', '--simulation_distribution', 'normal', '--use_different_noise', '--use_moe', '--num_experts', '4', '--moe_hidden_dim', '64', '--moe_tau', '0.1'] exits with return code = 1
[?2004h(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ [K(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ git add .
[?2004l[?2004h(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ git commit -m "new commit"
[?2004l[main 1335a23] new commit
 22 files changed, 8578 insertions(+), 114 deletions(-)
 rewrite __pycache__/diffusion.cpython-312.pyc (99%)
 rewrite __pycache__/generate.cpython-312.pyc (97%)
 rewrite __pycache__/train.cpython-312.pyc (77%)
 rewrite __pycache__/unet.cpython-312.pyc (91%)
 create mode 100644 archive/reparam_moe_2.py
 copy test.py => archive/test.py (100%)
 create mode 100644 archive/train_3.py
 create mode 100644 diffusion.py
 create mode 100644 generate.py
 rename archive/test.py => reparam_moe.py (99%)
 rewrite test.py (88%)
 create mode 100644 train.py
 create mode 100644 unet.py
 rewrite zzzzz.py (94%)
[?2004h(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ git push origin main
[?2004lEnumerating objects: 40, done.
Counting objects:   2% (1/40)Counting objects:   5% (2/40)Counting objects:   7% (3/40)Counting objects:  10% (4/40)Counting objects:  12% (5/40)Counting objects:  15% (6/40)Counting objects:  17% (7/40)Counting objects:  20% (8/40)Counting objects:  22% (9/40)Counting objects:  25% (10/40)Counting objects:  27% (11/40)Counting objects:  30% (12/40)Counting objects:  32% (13/40)Counting objects:  35% (14/40)Counting objects:  37% (15/40)Counting objects:  40% (16/40)Counting objects:  42% (17/40)Counting objects:  45% (18/40)Counting objects:  47% (19/40)Counting objects:  50% (20/40)Counting objects:  52% (21/40)Counting objects:  55% (22/40)Counting objects:  57% (23/40)Counting objects:  60% (24/40)Counting objects:  62% (25/40)Counting objects:  65% (26/40)Counting objects:  67% (27/40)Counting objects:  70% (28/40)Counting objects:  72% (29/40)Counting objects:  75% (30/40)Counting objects:  77% (31/40)Counting objects:  80% (32/40)Counting objects:  82% (33/40)Counting objects:  85% (34/40)Counting objects:  87% (35/40)Counting objects:  90% (36/40)Counting objects:  92% (37/40)Counting objects:  95% (38/40)Counting objects:  97% (39/40)Counting objects: 100% (40/40)Counting objects: 100% (40/40), done.
Delta compression using up to 64 threads
Compressing objects:   4% (1/25)Compressing objects:   8% (2/25)Compressing objects:  12% (3/25)Compressing objects:  16% (4/25)Compressing objects:  20% (5/25)Compressing objects:  24% (6/25)Compressing objects:  28% (7/25)Compressing objects:  32% (8/25)Compressing objects:  36% (9/25)Compressing objects:  40% (10/25)Compressing objects:  44% (11/25)Compressing objects:  48% (12/25)Compressing objects:  52% (13/25)Compressing objects:  56% (14/25)Compressing objects:  60% (15/25)Compressing objects:  64% (16/25)Compressing objects:  68% (17/25)Compressing objects:  72% (18/25)Compressing objects:  76% (19/25)Compressing objects:  80% (20/25)Compressing objects:  84% (21/25)Compressing objects:  88% (22/25)Compressing objects:  92% (23/25)Compressing objects:  96% (24/25)Compressing objects: 100% (25/25)Compressing objects: 100% (25/25), done.
Writing objects:   4% (1/25)Writing objects:   8% (2/25)Writing objects:  12% (3/25)Writing objects:  16% (4/25)Writing objects:  20% (5/25)Writing objects:  24% (6/25)Writing objects:  28% (7/25)Writing objects:  32% (8/25)Writing objects:  36% (9/25)Writing objects:  40% (10/25)Writing objects:  44% (11/25)Writing objects:  48% (12/25)Writing objects:  60% (15/25)Writing objects:  64% (16/25)Writing objects:  68% (17/25)Writing objects:  72% (18/25)Writing objects:  76% (19/25)Writing objects:  80% (20/25)Writing objects:  84% (21/25)Writing objects:  88% (22/25)Writing objects:  92% (23/25)Writing objects:  96% (24/25)Writing objects: 100% (25/25)Writing objects: 100% (25/25), 301.47 KiB | 3.86 MiB/s, done.
Total 25 (delta 14), reused 0 (delta 0), pack-reused 0
remote: Resolving deltas:   0% (0/14)[Kremote: Resolving deltas:   7% (1/14)[Kremote: Resolving deltas:  14% (2/14)[Kremote: Resolving deltas:  21% (3/14)[Kremote: Resolving deltas:  28% (4/14)[Kremote: Resolving deltas:  35% (5/14)[Kremote: Resolving deltas:  42% (6/14)[Kremote: Resolving deltas:  50% (7/14)[Kremote: Resolving deltas:  57% (8/14)[Kremote: Resolving deltas:  64% (9/14)[Kremote: Resolving deltas:  71% (10/14)[Kremote: Resolving deltas:  78% (11/14)[Kremote: Resolving deltas:  85% (12/14)[Kremote: Resolving deltas:  92% (13/14)[Kremote: Resolving deltas: 100% (14/14)[Kremote: Resolving deltas: 100% (14/14), completed with 8 local objects.[K
To https://github.com/ameliayinn/diffusion_noise_agent.git
   5dc6579..1335a23  main -> main
[?2004h(ywj) yli045@7b9adf13479a:~/diffusion_noise_agent$ 